(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function Jh(e,t){const r=Object.create(null),n=e.split(",");for(let i=0;i<n.length;i++)r[n[i]]=!0;return t?i=>!!r[i.toLowerCase()]:i=>!!r[i]}const RE="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",OE=Jh(RE);function TS(e){return!!e||e===""}function Yh(e){if(Ke(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=lr(n)?ME(n):Yh(n);if(i)for(const a in i)t[a]=i[a]}return t}else{if(lr(e))return e;if(jt(e))return e}}const AE=/;(?![^(]*\))/g,PE=/:(.+)/;function ME(e){const t={};return e.split(AE).forEach(r=>{if(r){const n=r.split(PE);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function ja(e){let t="";if(lr(e))t=e;else if(Ke(e))for(let r=0;r<e.length;r++){const n=ja(e[r]);n&&(t+=n+" ")}else if(jt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}function NE(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=Nu(e[n],t[n]);return r}function Nu(e,t){if(e===t)return!0;let r=ny(e),n=ny(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=yu(e),n=yu(t),r||n)return e===t;if(r=Ke(e),n=Ke(t),r||n)return r&&n?NE(e,t):!1;if(r=jt(e),n=jt(t),r||n){if(!r||!n)return!1;const i=Object.keys(e).length,a=Object.keys(t).length;if(i!==a)return!1;for(const s in e){const o=e.hasOwnProperty(s),u=t.hasOwnProperty(s);if(o&&!u||!o&&u||!Nu(e[s],t[s]))return!1}}return String(e)===String(t)}function Qh(e,t){return e.findIndex(r=>Nu(r,t))}const bt=e=>lr(e)?e:e==null?"":Ke(e)||jt(e)&&(e.toString===IS||!lt(e.toString))?JSON.stringify(e,ES,2):String(e),ES=(e,t)=>t&&t.__v_isRef?ES(e,t.value):Ds(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,i])=>(r[`${n} =>`]=i,r),{})}:so(t)?{[`Set(${t.size})`]:[...t.values()]}:jt(t)&&!Ke(t)&&!RS(t)?String(t):t,xt={},Us=[],Cn=()=>{},xE=()=>!1,LE=/^on[^a-z]/,qc=e=>LE.test(e),Xh=e=>e.startsWith("onUpdate:"),gr=Object.assign,Zh=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},jE=Object.prototype.hasOwnProperty,ht=(e,t)=>jE.call(e,t),Ke=Array.isArray,Ds=e=>xu(e)==="[object Map]",so=e=>xu(e)==="[object Set]",ny=e=>xu(e)==="[object Date]",lt=e=>typeof e=="function",lr=e=>typeof e=="string",yu=e=>typeof e=="symbol",jt=e=>e!==null&&typeof e=="object",CS=e=>jt(e)&&lt(e.then)&&lt(e.catch),IS=Object.prototype.toString,xu=e=>IS.call(e),UE=e=>xu(e).slice(8,-1),RS=e=>xu(e)==="[object Object]",ev=e=>lr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Zl=Jh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wc=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},DE=/-(\w)/g,qn=Wc(e=>e.replace(DE,(t,r)=>r?r.toUpperCase():"")),FE=/\B([A-Z])/g,Ka=Wc(e=>e.replace(FE,"-$1").toLowerCase()),Hc=Wc(e=>e.charAt(0).toUpperCase()+e.slice(1)),jf=Wc(e=>e?`on${Hc(e)}`:""),mu=(e,t)=>!Object.is(e,t),ec=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},fc=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},dc=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let iy;const BE=()=>iy||(iy=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let xn;class OS{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&xn&&(this.parent=xn,this.index=(xn.scopes||(xn.scopes=[])).push(this)-1)}run(t){if(this.active){const r=xn;try{return xn=this,t()}finally{xn=r}}}on(){xn=this}off(){xn=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function AS(e){return new OS(e)}function qE(e,t=xn){t&&t.active&&t.effects.push(e)}const tv=e=>{const t=new Set(e);return t.w=0,t.n=0,t},PS=e=>(e.w&Qi)>0,MS=e=>(e.n&Qi)>0,WE=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Qi},HE=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const i=t[n];PS(i)&&!MS(i)?i.delete(e):t[r++]=i,i.w&=~Qi,i.n&=~Qi}t.length=r}},Ep=new WeakMap;let Xo=0,Qi=1;const Cp=30;let _n;const Fa=Symbol(""),Ip=Symbol("");class rv{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,qE(this,n)}run(){if(!this.active)return this.fn();let t=_n,r=Hi;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=_n,_n=this,Hi=!0,Qi=1<<++Xo,Xo<=Cp?WE(this):ay(this),this.fn()}finally{Xo<=Cp&&HE(this),Qi=1<<--Xo,_n=this.parent,Hi=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){_n===this?this.deferStop=!0:this.active&&(ay(this),this.onStop&&this.onStop(),this.active=!1)}}function ay(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Hi=!0;const NS=[];function oo(){NS.push(Hi),Hi=!1}function uo(){const e=NS.pop();Hi=e===void 0?!0:e}function Wr(e,t,r){if(Hi&&_n){let n=Ep.get(e);n||Ep.set(e,n=new Map);let i=n.get(r);i||n.set(r,i=tv()),xS(i)}}function xS(e,t){let r=!1;Xo<=Cp?MS(e)||(e.n|=Qi,r=!PS(e)):r=!e.has(_n),r&&(e.add(_n),_n.deps.push(e))}function ui(e,t,r,n,i,a){const s=Ep.get(e);if(!s)return;let o=[];if(t==="clear")o=[...s.values()];else if(r==="length"&&Ke(e))s.forEach((u,c)=>{(c==="length"||c>=n)&&o.push(u)});else switch(r!==void 0&&o.push(s.get(r)),t){case"add":Ke(e)?ev(r)&&o.push(s.get("length")):(o.push(s.get(Fa)),Ds(e)&&o.push(s.get(Ip)));break;case"delete":Ke(e)||(o.push(s.get(Fa)),Ds(e)&&o.push(s.get(Ip)));break;case"set":Ds(e)&&o.push(s.get(Fa));break}if(o.length===1)o[0]&&Rp(o[0]);else{const u=[];for(const c of o)c&&u.push(...c);Rp(tv(u))}}function Rp(e,t){const r=Ke(e)?e:[...e];for(const n of r)n.computed&&sy(n);for(const n of r)n.computed||sy(n)}function sy(e,t){(e!==_n||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const GE=Jh("__proto__,__v_isRef,__isVue"),LS=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(yu)),VE=nv(),zE=nv(!1,!0),KE=nv(!0),oy=JE();function JE(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=yt(this);for(let a=0,s=this.length;a<s;a++)Wr(n,"get",a+"");const i=n[t](...r);return i===-1||i===!1?n[t](...r.map(yt)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){oo();const n=yt(this)[t].apply(this,r);return uo(),n}}),e}function nv(e=!1,t=!1){return function(n,i,a){if(i==="__v_isReactive")return!e;if(i==="__v_isReadonly")return e;if(i==="__v_isShallow")return t;if(i==="__v_raw"&&a===(e?t?fC:BS:t?FS:DS).get(n))return n;const s=Ke(n);if(!e&&s&&ht(oy,i))return Reflect.get(oy,i,a);const o=Reflect.get(n,i,a);return(yu(i)?LS.has(i):GE(i))||(e||Wr(n,"get",i),t)?o:Qt(o)?s&&ev(i)?o:o.value:jt(o)?e?qS(o):Ja(o):o}}const YE=jS(),QE=jS(!0);function jS(e=!1){return function(r,n,i,a){let s=r[n];if(zs(s)&&Qt(s)&&!Qt(i))return!1;if(!e&&(!pc(i)&&!zs(i)&&(s=yt(s),i=yt(i)),!Ke(r)&&Qt(s)&&!Qt(i)))return s.value=i,!0;const o=Ke(r)&&ev(n)?Number(n)<r.length:ht(r,n),u=Reflect.set(r,n,i,a);return r===yt(a)&&(o?mu(i,s)&&ui(r,"set",n,i):ui(r,"add",n,i)),u}}function XE(e,t){const r=ht(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&ui(e,"delete",t,void 0),n}function ZE(e,t){const r=Reflect.has(e,t);return(!yu(t)||!LS.has(t))&&Wr(e,"has",t),r}function eC(e){return Wr(e,"iterate",Ke(e)?"length":Fa),Reflect.ownKeys(e)}const US={get:VE,set:YE,deleteProperty:XE,has:ZE,ownKeys:eC},tC={get:KE,set(e,t){return!0},deleteProperty(e,t){return!0}},rC=gr({},US,{get:zE,set:QE}),iv=e=>e,Gc=e=>Reflect.getPrototypeOf(e);function gl(e,t,r=!1,n=!1){e=e.__v_raw;const i=yt(e),a=yt(t);r||(t!==a&&Wr(i,"get",t),Wr(i,"get",a));const{has:s}=Gc(i),o=n?iv:r?ov:bu;if(s.call(i,t))return o(e.get(t));if(s.call(i,a))return o(e.get(a));e!==i&&e.get(t)}function yl(e,t=!1){const r=this.__v_raw,n=yt(r),i=yt(e);return t||(e!==i&&Wr(n,"has",e),Wr(n,"has",i)),e===i?r.has(e):r.has(e)||r.has(i)}function ml(e,t=!1){return e=e.__v_raw,!t&&Wr(yt(e),"iterate",Fa),Reflect.get(e,"size",e)}function uy(e){e=yt(e);const t=yt(this);return Gc(t).has.call(t,e)||(t.add(e),ui(t,"add",e,e)),this}function ly(e,t){t=yt(t);const r=yt(this),{has:n,get:i}=Gc(r);let a=n.call(r,e);a||(e=yt(e),a=n.call(r,e));const s=i.call(r,e);return r.set(e,t),a?mu(t,s)&&ui(r,"set",e,t):ui(r,"add",e,t),this}function cy(e){const t=yt(this),{has:r,get:n}=Gc(t);let i=r.call(t,e);i||(e=yt(e),i=r.call(t,e)),n&&n.call(t,e);const a=t.delete(e);return i&&ui(t,"delete",e,void 0),a}function fy(){const e=yt(this),t=e.size!==0,r=e.clear();return t&&ui(e,"clear",void 0,void 0),r}function bl(e,t){return function(n,i){const a=this,s=a.__v_raw,o=yt(s),u=t?iv:e?ov:bu;return!e&&Wr(o,"iterate",Fa),s.forEach((c,d)=>n.call(i,u(c),u(d),a))}}function wl(e,t,r){return function(...n){const i=this.__v_raw,a=yt(i),s=Ds(a),o=e==="entries"||e===Symbol.iterator&&s,u=e==="keys"&&s,c=i[e](...n),d=r?iv:t?ov:bu;return!t&&Wr(a,"iterate",u?Ip:Fa),{next(){const{value:y,done:_}=c.next();return _?{value:y,done:_}:{value:o?[d(y[0]),d(y[1])]:d(y),done:_}},[Symbol.iterator](){return this}}}}function Ri(e){return function(...t){return e==="delete"?!1:this}}function nC(){const e={get(a){return gl(this,a)},get size(){return ml(this)},has:yl,add:uy,set:ly,delete:cy,clear:fy,forEach:bl(!1,!1)},t={get(a){return gl(this,a,!1,!0)},get size(){return ml(this)},has:yl,add:uy,set:ly,delete:cy,clear:fy,forEach:bl(!1,!0)},r={get(a){return gl(this,a,!0)},get size(){return ml(this,!0)},has(a){return yl.call(this,a,!0)},add:Ri("add"),set:Ri("set"),delete:Ri("delete"),clear:Ri("clear"),forEach:bl(!0,!1)},n={get(a){return gl(this,a,!0,!0)},get size(){return ml(this,!0)},has(a){return yl.call(this,a,!0)},add:Ri("add"),set:Ri("set"),delete:Ri("delete"),clear:Ri("clear"),forEach:bl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=wl(a,!1,!1),r[a]=wl(a,!0,!1),t[a]=wl(a,!1,!0),n[a]=wl(a,!0,!0)}),[e,r,t,n]}const[iC,aC,sC,oC]=nC();function av(e,t){const r=t?e?oC:sC:e?aC:iC;return(n,i,a)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(ht(r,i)&&i in n?r:n,i,a)}const uC={get:av(!1,!1)},lC={get:av(!1,!0)},cC={get:av(!0,!1)},DS=new WeakMap,FS=new WeakMap,BS=new WeakMap,fC=new WeakMap;function dC(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pC(e){return e.__v_skip||!Object.isExtensible(e)?0:dC(UE(e))}function Ja(e){return zs(e)?e:sv(e,!1,US,uC,DS)}function hC(e){return sv(e,!1,rC,lC,FS)}function qS(e){return sv(e,!0,tC,cC,BS)}function sv(e,t,r,n,i){if(!jt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=i.get(e);if(a)return a;const s=pC(e);if(s===0)return e;const o=new Proxy(e,s===2?n:r);return i.set(e,o),o}function Gi(e){return zs(e)?Gi(e.__v_raw):!!(e&&e.__v_isReactive)}function zs(e){return!!(e&&e.__v_isReadonly)}function pc(e){return!!(e&&e.__v_isShallow)}function WS(e){return Gi(e)||zs(e)}function yt(e){const t=e&&e.__v_raw;return t?yt(t):e}function Ks(e){return fc(e,"__v_skip",!0),e}const bu=e=>jt(e)?Ja(e):e,ov=e=>jt(e)?qS(e):e;function HS(e){Hi&&_n&&(e=yt(e),xS(e.dep||(e.dep=tv())))}function GS(e,t){e=yt(e),e.dep&&Rp(e.dep)}function Qt(e){return!!(e&&e.__v_isRef===!0)}function Ye(e){return VS(e,!1)}function vC(e){return VS(e,!0)}function VS(e,t){return Qt(e)?e:new gC(e,t)}class gC{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:yt(t),this._value=r?t:bu(t)}get value(){return HS(this),this._value}set value(t){const r=this.__v_isShallow||pc(t)||zs(t);t=r?t:yt(t),mu(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:bu(t),GS(this))}}function Rt(e){return Qt(e)?e.value:e}const yC={get:(e,t,r)=>Rt(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return Qt(i)&&!Qt(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function zS(e){return Gi(e)?e:new Proxy(e,yC)}function mC(e){const t=Ke(e)?new Array(e.length):{};for(const r in e)t[r]=wC(e,r);return t}class bC{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function wC(e,t,r){const n=e[t];return Qt(n)?n:new bC(e,t,r)}var KS;class _C{constructor(t,r,n,i){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[KS]=!1,this._dirty=!0,this.effect=new rv(t,()=>{this._dirty||(this._dirty=!0,GS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const t=yt(this);return HS(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}KS="__v_isReadonly";function SC(e,t,r=!1){let n,i;const a=lt(e);return a?(n=e,i=Cn):(n=e.get,i=e.set),new _C(n,i,a||!i,r)}function Vi(e,t,r,n){let i;try{i=n?e(...n):e()}catch(a){Vc(a,t,r)}return i}function ln(e,t,r,n){if(lt(e)){const a=Vi(e,t,r,n);return a&&CS(a)&&a.catch(s=>{Vc(s,t,r)}),a}const i=[];for(let a=0;a<e.length;a++)i.push(ln(e[a],t,r,n));return i}function Vc(e,t,r,n=!0){const i=t?t.vnode:null;if(t){let a=t.parent;const s=t.proxy,o=r;for(;a;){const c=a.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](e,s,o)===!1)return}a=a.parent}const u=t.appContext.config.errorHandler;if(u){Vi(u,null,10,[e,s,o]);return}}$C(e,r,i,n)}function $C(e,t,r,n=!0){console.error(e)}let wu=!1,Op=!1;const hr=[];let Un=0;const Fs=[];let ti=null,Aa=0;const JS=Promise.resolve();let uv=null;function lv(e){const t=uv||JS;return e?t.then(this?e.bind(this):e):t}function kC(e){let t=Un+1,r=hr.length;for(;t<r;){const n=t+r>>>1;_u(hr[n])<e?t=n+1:r=n}return t}function cv(e){(!hr.length||!hr.includes(e,wu&&e.allowRecurse?Un+1:Un))&&(e.id==null?hr.push(e):hr.splice(kC(e.id),0,e),YS())}function YS(){!wu&&!Op&&(Op=!0,uv=JS.then(XS))}function TC(e){const t=hr.indexOf(e);t>Un&&hr.splice(t,1)}function EC(e){Ke(e)?Fs.push(...e):(!ti||!ti.includes(e,e.allowRecurse?Aa+1:Aa))&&Fs.push(e),YS()}function dy(e,t=wu?Un+1:0){for(;t<hr.length;t++){const r=hr[t];r&&r.pre&&(hr.splice(t,1),t--,r())}}function QS(e){if(Fs.length){const t=[...new Set(Fs)];if(Fs.length=0,ti){ti.push(...t);return}for(ti=t,ti.sort((r,n)=>_u(r)-_u(n)),Aa=0;Aa<ti.length;Aa++)ti[Aa]();ti=null,Aa=0}}const _u=e=>e.id==null?1/0:e.id,CC=(e,t)=>{const r=_u(e)-_u(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function XS(e){Op=!1,wu=!0,hr.sort(CC);const t=Cn;try{for(Un=0;Un<hr.length;Un++){const r=hr[Un];r&&r.active!==!1&&Vi(r,null,14)}}finally{Un=0,hr.length=0,QS(),wu=!1,uv=null,(hr.length||Fs.length)&&XS()}}function IC(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||xt;let i=r;const a=t.startsWith("update:"),s=a&&t.slice(7);if(s&&s in n){const d=`${s==="modelValue"?"model":s}Modifiers`,{number:y,trim:_}=n[d]||xt;_&&(i=r.map(b=>b.trim())),y&&(i=r.map(dc))}let o,u=n[o=jf(t)]||n[o=jf(qn(t))];!u&&a&&(u=n[o=jf(Ka(t))]),u&&ln(u,e,6,i);const c=n[o+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,ln(c,e,6,i)}}function ZS(e,t,r=!1){const n=t.emitsCache,i=n.get(e);if(i!==void 0)return i;const a=e.emits;let s={},o=!1;if(!lt(e)){const u=c=>{const d=ZS(c,t,!0);d&&(o=!0,gr(s,d))};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!a&&!o?(jt(e)&&n.set(e,null),null):(Ke(a)?a.forEach(u=>s[u]=null):gr(s,a),jt(e)&&n.set(e,s),s)}function zc(e,t){return!e||!qc(t)?!1:(t=t.slice(2).replace(/Once$/,""),ht(e,t[0].toLowerCase()+t.slice(1))||ht(e,Ka(t))||ht(e,t))}let vr=null,e$=null;function hc(e){const t=vr;return vr=e,e$=e&&e.type.__scopeId||null,t}function sr(e,t=vr,r){if(!t||e._n)return e;const n=(...i)=>{n._d&&$y(-1);const a=hc(t),s=e(...i);return hc(a),n._d&&$y(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function Uf(e){const{type:t,vnode:r,proxy:n,withProxy:i,props:a,propsOptions:[s],slots:o,attrs:u,emit:c,render:d,renderCache:y,data:_,setupState:b,ctx:k,inheritAttrs:N}=e;let P,j;const F=hc(e);try{if(r.shapeFlag&4){const ce=i||n;P=Ln(d.call(ce,ce,y,a,b,_,k)),j=u}else{const ce=t;P=Ln(ce.length>1?ce(a,{attrs:u,slots:o,emit:c}):ce(a,null)),j=t.props?u:RC(u)}}catch(ce){su.length=0,Vc(ce,e,1),P=wt(cn)}let me=P;if(j&&N!==!1){const ce=Object.keys(j),{shapeFlag:xe}=me;ce.length&&xe&7&&(s&&ce.some(Xh)&&(j=OC(j,s)),me=Xi(me,j))}return r.dirs&&(me=Xi(me),me.dirs=me.dirs?me.dirs.concat(r.dirs):r.dirs),r.transition&&(me.transition=r.transition),P=me,hc(F),P}const RC=e=>{let t;for(const r in e)(r==="class"||r==="style"||qc(r))&&((t||(t={}))[r]=e[r]);return t},OC=(e,t)=>{const r={};for(const n in e)(!Xh(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function AC(e,t,r){const{props:n,children:i,component:a}=e,{props:s,children:o,patchFlag:u}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return n?py(n,s,c):!!s;if(u&8){const d=t.dynamicProps;for(let y=0;y<d.length;y++){const _=d[y];if(s[_]!==n[_]&&!zc(c,_))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===s?!1:n?s?py(n,s,c):!0:!!s;return!1}function py(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const a=n[i];if(t[a]!==e[a]&&!zc(r,a))return!0}return!1}function PC({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const MC=e=>e.__isSuspense;function NC(e,t){t&&t.pendingBranch?Ke(e)?t.effects.push(...e):t.effects.push(e):EC(e)}function tc(e,t){if(or){let r=or.provides;const n=or.parent&&or.parent.provides;n===r&&(r=or.provides=Object.create(n)),r[e]=t}}function In(e,t,r=!1){const n=or||vr;if(n){const i=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return r&&lt(t)?t.call(n.proxy):t}}const hy={};function iu(e,t,r){return t$(e,t,r)}function t$(e,t,{immediate:r,deep:n,flush:i,onTrack:a,onTrigger:s}=xt){const o=or;let u,c=!1,d=!1;if(Qt(e)?(u=()=>e.value,c=pc(e)):Gi(e)?(u=()=>e,n=!0):Ke(e)?(d=!0,c=e.some(j=>Gi(j)||pc(j)),u=()=>e.map(j=>{if(Qt(j))return j.value;if(Gi(j))return Ua(j);if(lt(j))return Vi(j,o,2)})):lt(e)?t?u=()=>Vi(e,o,2):u=()=>{if(!(o&&o.isUnmounted))return y&&y(),ln(e,o,3,[_])}:u=Cn,t&&n){const j=u;u=()=>Ua(j())}let y,_=j=>{y=P.onStop=()=>{Vi(j,o,4)}};if($u)return _=Cn,t?r&&ln(t,o,3,[u(),d?[]:void 0,_]):u(),Cn;let b=d?[]:hy;const k=()=>{if(!!P.active)if(t){const j=P.run();(n||c||(d?j.some((F,me)=>mu(F,b[me])):mu(j,b)))&&(y&&y(),ln(t,o,3,[j,b===hy?void 0:b,_]),b=j)}else P.run()};k.allowRecurse=!!t;let N;i==="sync"?N=k:i==="post"?N=()=>Ar(k,o&&o.suspense):(k.pre=!0,o&&(k.id=o.uid),N=()=>cv(k));const P=new rv(u,N);return t?r?k():b=P.run():i==="post"?Ar(P.run.bind(P),o&&o.suspense):P.run(),()=>{P.stop(),o&&o.scope&&Zh(o.scope.effects,P)}}function xC(e,t,r){const n=this.proxy,i=lr(e)?e.includes(".")?r$(n,e):()=>n[e]:e.bind(n,n);let a;lt(t)?a=t:(a=t.handler,r=t);const s=or;Js(this);const o=t$(i,a.bind(n),r);return s?Js(s):Ba(),o}function r$(e,t){const r=t.split(".");return()=>{let n=e;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}function Ua(e,t){if(!jt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Qt(e))Ua(e.value,t);else if(Ke(e))for(let r=0;r<e.length;r++)Ua(e[r],t);else if(so(e)||Ds(e))e.forEach(r=>{Ua(r,t)});else if(RS(e))for(const r in e)Ua(e[r],t);return e}function LC(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return lo(()=>{e.isMounted=!0}),u$(()=>{e.isUnmounting=!0}),e}const en=[Function,Array],jC={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:en,onEnter:en,onAfterEnter:en,onEnterCancelled:en,onBeforeLeave:en,onLeave:en,onAfterLeave:en,onLeaveCancelled:en,onBeforeAppear:en,onAppear:en,onAfterAppear:en,onAppearCancelled:en},setup(e,{slots:t}){const r=gv(),n=LC();let i;return()=>{const a=t.default&&i$(t.default(),!0);if(!a||!a.length)return;let s=a[0];if(a.length>1){for(const N of a)if(N.type!==cn){s=N;break}}const o=yt(e),{mode:u}=o;if(n.isLeaving)return Df(s);const c=vy(s);if(!c)return Df(s);const d=Ap(c,o,n,r);Pp(c,d);const y=r.subTree,_=y&&vy(y);let b=!1;const{getTransitionKey:k}=c.type;if(k){const N=k();i===void 0?i=N:N!==i&&(i=N,b=!0)}if(_&&_.type!==cn&&(!Pa(c,_)||b)){const N=Ap(_,o,n,r);if(Pp(_,N),u==="out-in")return n.isLeaving=!0,N.afterLeave=()=>{n.isLeaving=!1,r.update()},Df(s);u==="in-out"&&c.type!==cn&&(N.delayLeave=(P,j,F)=>{const me=n$(n,_);me[String(_.key)]=_,P._leaveCb=()=>{j(),P._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=F})}return s}}},UC=jC;function n$(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function Ap(e,t,r,n){const{appear:i,mode:a,persisted:s=!1,onBeforeEnter:o,onEnter:u,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:y,onLeave:_,onAfterLeave:b,onLeaveCancelled:k,onBeforeAppear:N,onAppear:P,onAfterAppear:j,onAppearCancelled:F}=t,me=String(e.key),ce=n$(r,e),xe=(x,le)=>{x&&ln(x,n,9,le)},Ne=(x,le)=>{const D=le[1];xe(x,le),Ke(x)?x.every(Re=>Re.length<=1)&&D():x.length<=1&&D()},Me={mode:a,persisted:s,beforeEnter(x){let le=o;if(!r.isMounted)if(i)le=N||o;else return;x._leaveCb&&x._leaveCb(!0);const D=ce[me];D&&Pa(e,D)&&D.el._leaveCb&&D.el._leaveCb(),xe(le,[x])},enter(x){let le=u,D=c,Re=d;if(!r.isMounted)if(i)le=P||u,D=j||c,Re=F||d;else return;let Ie=!1;const ue=x._enterCb=ee=>{Ie||(Ie=!0,ee?xe(Re,[x]):xe(D,[x]),Me.delayedLeave&&Me.delayedLeave(),x._enterCb=void 0)};le?Ne(le,[x,ue]):ue()},leave(x,le){const D=String(e.key);if(x._enterCb&&x._enterCb(!0),r.isUnmounting)return le();xe(y,[x]);let Re=!1;const Ie=x._leaveCb=ue=>{Re||(Re=!0,le(),ue?xe(k,[x]):xe(b,[x]),x._leaveCb=void 0,ce[D]===e&&delete ce[D])};ce[D]=e,_?Ne(_,[x,Ie]):Ie()},clone(x){return Ap(x,t,r,n)}};return Me}function Df(e){if(Kc(e))return e=Xi(e),e.children=null,e}function vy(e){return Kc(e)?e.children?e.children[0]:void 0:e}function Pp(e,t){e.shapeFlag&6&&e.component?Pp(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function i$(e,t=!1,r){let n=[],i=0;for(let a=0;a<e.length;a++){let s=e[a];const o=r==null?s.key:String(r)+String(s.key!=null?s.key:a);s.type===qt?(s.patchFlag&128&&i++,n=n.concat(i$(s.children,t,o))):(t||s.type!==cn)&&n.push(o!=null?Xi(s,{key:o}):s)}if(i>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}function a$(e){return lt(e)?{setup:e,name:e.name}:e}const au=e=>!!e.type.__asyncLoader,Kc=e=>e.type.__isKeepAlive;function DC(e,t){s$(e,"a",t)}function FC(e,t){s$(e,"da",t)}function s$(e,t,r=or){const n=e.__wdc||(e.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(Jc(t,n,r),r){let i=r.parent;for(;i&&i.parent;)Kc(i.parent.vnode)&&BC(n,t,r,i),i=i.parent}}function BC(e,t,r,n){const i=Jc(t,e,n,!0);fv(()=>{Zh(n[t],i)},r)}function Jc(e,t,r=or,n=!1){if(r){const i=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;oo(),Js(r);const o=ln(t,r,e,s);return Ba(),uo(),o});return n?i.unshift(a):i.push(a),a}}const pi=e=>(t,r=or)=>(!$u||e==="sp")&&Jc(e,t,r),o$=pi("bm"),lo=pi("m"),qC=pi("bu"),WC=pi("u"),u$=pi("bum"),fv=pi("um"),HC=pi("sp"),GC=pi("rtg"),VC=pi("rtc");function zC(e,t=or){Jc("ec",e,t)}function He(e,t){const r=vr;if(r===null)return e;const n=Qc(r)||r.proxy,i=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[s,o,u,c=xt]=t[a];lt(s)&&(s={mounted:s,updated:s}),s.deep&&Ua(o),i.push({dir:s,instance:n,value:o,oldValue:void 0,arg:u,modifiers:c})}return e}function wa(e,t,r,n){const i=e.dirs,a=t&&t.dirs;for(let s=0;s<i.length;s++){const o=i[s];a&&(o.oldValue=a[s].value);let u=o.dir[n];u&&(oo(),ln(u,r,8,[e.el,o,e,t]),uo())}}const l$="components";function Tr(e,t){return JC(l$,e,!0,t)||e}const KC=Symbol();function JC(e,t,r=!0,n=!1){const i=vr||or;if(i){const a=i.type;if(e===l$){const o=TI(a,!1);if(o&&(o===t||o===qn(t)||o===Hc(qn(t))))return a}const s=gy(i[e]||a[e],t)||gy(i.appContext[e],t);return!s&&n?a:s}}function gy(e,t){return e&&(e[t]||e[qn(t)]||e[Hc(qn(t))])}function Dr(e,t,r,n){let i;const a=r&&r[n];if(Ke(e)||lr(e)){i=new Array(e.length);for(let s=0,o=e.length;s<o;s++)i[s]=t(e[s],s,void 0,a&&a[s])}else if(typeof e=="number"){i=new Array(e);for(let s=0;s<e;s++)i[s]=t(s+1,s,void 0,a&&a[s])}else if(jt(e))if(e[Symbol.iterator])i=Array.from(e,(s,o)=>t(s,o,void 0,a&&a[o]));else{const s=Object.keys(e);i=new Array(s.length);for(let o=0,u=s.length;o<u;o++){const c=s[o];i[o]=t(e[c],c,o,a&&a[o])}}else i=[];return r&&(r[n]=i),i}function YC(e,t,r={},n,i){if(vr.isCE||vr.parent&&au(vr.parent)&&vr.parent.isCE)return wt("slot",t==="default"?null:{name:t},n&&n());let a=e[t];a&&a._c&&(a._d=!1),qe();const s=a&&c$(a(r)),o=Rn(qt,{key:r.key||s&&s.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!i&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),a&&a._c&&(a._d=!0),o}function c$(e){return e.some(t=>yc(t)?!(t.type===cn||t.type===qt&&!c$(t.children)):!0)?e:null}const Mp=e=>e?_$(e)?Qc(e)||e.proxy:Mp(e.parent):null,vc=gr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Mp(e.parent),$root:e=>Mp(e.root),$emit:e=>e.emit,$options:e=>dv(e),$forceUpdate:e=>e.f||(e.f=()=>cv(e.update)),$nextTick:e=>e.n||(e.n=lv.bind(e.proxy)),$watch:e=>xC.bind(e)}),QC={get({_:e},t){const{ctx:r,setupState:n,data:i,props:a,accessCache:s,type:o,appContext:u}=e;let c;if(t[0]!=="$"){const b=s[t];if(b!==void 0)switch(b){case 1:return n[t];case 2:return i[t];case 4:return r[t];case 3:return a[t]}else{if(n!==xt&&ht(n,t))return s[t]=1,n[t];if(i!==xt&&ht(i,t))return s[t]=2,i[t];if((c=e.propsOptions[0])&&ht(c,t))return s[t]=3,a[t];if(r!==xt&&ht(r,t))return s[t]=4,r[t];Np&&(s[t]=0)}}const d=vc[t];let y,_;if(d)return t==="$attrs"&&Wr(e,"get",t),d(e);if((y=o.__cssModules)&&(y=y[t]))return y;if(r!==xt&&ht(r,t))return s[t]=4,r[t];if(_=u.config.globalProperties,ht(_,t))return _[t]},set({_:e},t,r){const{data:n,setupState:i,ctx:a}=e;return i!==xt&&ht(i,t)?(i[t]=r,!0):n!==xt&&ht(n,t)?(n[t]=r,!0):ht(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,propsOptions:a}},s){let o;return!!r[s]||e!==xt&&ht(e,s)||t!==xt&&ht(t,s)||(o=a[0])&&ht(o,s)||ht(n,s)||ht(vc,s)||ht(i.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:ht(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let Np=!0;function XC(e){const t=dv(e),r=e.proxy,n=e.ctx;Np=!1,t.beforeCreate&&yy(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:s,watch:o,provide:u,inject:c,created:d,beforeMount:y,mounted:_,beforeUpdate:b,updated:k,activated:N,deactivated:P,beforeDestroy:j,beforeUnmount:F,destroyed:me,unmounted:ce,render:xe,renderTracked:Ne,renderTriggered:Me,errorCaptured:x,serverPrefetch:le,expose:D,inheritAttrs:Re,components:Ie,directives:ue,filters:ee}=t;if(c&&ZC(c,n,null,e.appContext.config.unwrapInjectedRef),s)for(const be in s){const O=s[be];lt(O)&&(n[be]=O.bind(r))}if(i){const be=i.call(r,r);jt(be)&&(e.data=Ja(be))}if(Np=!0,a)for(const be in a){const O=a[be],je=lt(O)?O.bind(r,r):lt(O.get)?O.get.bind(r,r):Cn,ft=!lt(O)&&lt(O.set)?O.set.bind(r):Cn,Je=Jt({get:je,set:ft});Object.defineProperty(n,be,{enumerable:!0,configurable:!0,get:()=>Je.value,set:fe=>Je.value=fe})}if(o)for(const be in o)f$(o[be],n,r,be);if(u){const be=lt(u)?u.call(r):u;Reflect.ownKeys(be).forEach(O=>{tc(O,be[O])})}d&&yy(d,e,"c");function ne(be,O){Ke(O)?O.forEach(je=>be(je.bind(r))):O&&be(O.bind(r))}if(ne(o$,y),ne(lo,_),ne(qC,b),ne(WC,k),ne(DC,N),ne(FC,P),ne(zC,x),ne(VC,Ne),ne(GC,Me),ne(u$,F),ne(fv,ce),ne(HC,le),Ke(D))if(D.length){const be=e.exposed||(e.exposed={});D.forEach(O=>{Object.defineProperty(be,O,{get:()=>r[O],set:je=>r[O]=je})})}else e.exposed||(e.exposed={});xe&&e.render===Cn&&(e.render=xe),Re!=null&&(e.inheritAttrs=Re),Ie&&(e.components=Ie),ue&&(e.directives=ue)}function ZC(e,t,r=Cn,n=!1){Ke(e)&&(e=xp(e));for(const i in e){const a=e[i];let s;jt(a)?"default"in a?s=In(a.from||i,a.default,!0):s=In(a.from||i):s=In(a),Qt(s)&&n?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):t[i]=s}}function yy(e,t,r){ln(Ke(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function f$(e,t,r,n){const i=n.includes(".")?r$(r,n):()=>r[n];if(lr(e)){const a=t[e];lt(a)&&iu(i,a)}else if(lt(e))iu(i,e.bind(r));else if(jt(e))if(Ke(e))e.forEach(a=>f$(a,t,r,n));else{const a=lt(e.handler)?e.handler.bind(r):t[e.handler];lt(a)&&iu(i,a,e)}}function dv(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:s}}=e.appContext,o=a.get(t);let u;return o?u=o:!i.length&&!r&&!n?u=t:(u={},i.length&&i.forEach(c=>gc(u,c,s,!0)),gc(u,t,s)),jt(t)&&a.set(t,u),u}function gc(e,t,r,n=!1){const{mixins:i,extends:a}=t;a&&gc(e,a,r,!0),i&&i.forEach(s=>gc(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const o=eI[s]||r&&r[s];e[s]=o?o(e[s],t[s]):t[s]}return e}const eI={data:my,props:Oa,emits:Oa,methods:Oa,computed:Oa,beforeCreate:$r,created:$r,beforeMount:$r,mounted:$r,beforeUpdate:$r,updated:$r,beforeDestroy:$r,beforeUnmount:$r,destroyed:$r,unmounted:$r,activated:$r,deactivated:$r,errorCaptured:$r,serverPrefetch:$r,components:Oa,directives:Oa,watch:rI,provide:my,inject:tI};function my(e,t){return t?e?function(){return gr(lt(e)?e.call(this,this):e,lt(t)?t.call(this,this):t)}:t:e}function tI(e,t){return Oa(xp(e),xp(t))}function xp(e){if(Ke(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function $r(e,t){return e?[...new Set([].concat(e,t))]:t}function Oa(e,t){return e?gr(gr(Object.create(null),e),t):t}function rI(e,t){if(!e)return t;if(!t)return e;const r=gr(Object.create(null),e);for(const n in t)r[n]=$r(e[n],t[n]);return r}function nI(e,t,r,n=!1){const i={},a={};fc(a,Yc,1),e.propsDefaults=Object.create(null),d$(e,t,i,a);for(const s in e.propsOptions[0])s in i||(i[s]=void 0);r?e.props=n?i:hC(i):e.type.props?e.props=i:e.props=a,e.attrs=a}function iI(e,t,r,n){const{props:i,attrs:a,vnode:{patchFlag:s}}=e,o=yt(i),[u]=e.propsOptions;let c=!1;if((n||s>0)&&!(s&16)){if(s&8){const d=e.vnode.dynamicProps;for(let y=0;y<d.length;y++){let _=d[y];if(zc(e.emitsOptions,_))continue;const b=t[_];if(u)if(ht(a,_))b!==a[_]&&(a[_]=b,c=!0);else{const k=qn(_);i[k]=Lp(u,o,k,b,e,!1)}else b!==a[_]&&(a[_]=b,c=!0)}}}else{d$(e,t,i,a)&&(c=!0);let d;for(const y in o)(!t||!ht(t,y)&&((d=Ka(y))===y||!ht(t,d)))&&(u?r&&(r[y]!==void 0||r[d]!==void 0)&&(i[y]=Lp(u,o,y,void 0,e,!0)):delete i[y]);if(a!==o)for(const y in a)(!t||!ht(t,y)&&!0)&&(delete a[y],c=!0)}c&&ui(e,"set","$attrs")}function d$(e,t,r,n){const[i,a]=e.propsOptions;let s=!1,o;if(t)for(let u in t){if(Zl(u))continue;const c=t[u];let d;i&&ht(i,d=qn(u))?!a||!a.includes(d)?r[d]=c:(o||(o={}))[d]=c:zc(e.emitsOptions,u)||(!(u in n)||c!==n[u])&&(n[u]=c,s=!0)}if(a){const u=yt(r),c=o||xt;for(let d=0;d<a.length;d++){const y=a[d];r[y]=Lp(i,u,y,c[y],e,!ht(c,y))}}return s}function Lp(e,t,r,n,i,a){const s=e[r];if(s!=null){const o=ht(s,"default");if(o&&n===void 0){const u=s.default;if(s.type!==Function&&lt(u)){const{propsDefaults:c}=i;r in c?n=c[r]:(Js(i),n=c[r]=u.call(null,t),Ba())}else n=u}s[0]&&(a&&!o?n=!1:s[1]&&(n===""||n===Ka(r))&&(n=!0))}return n}function p$(e,t,r=!1){const n=t.propsCache,i=n.get(e);if(i)return i;const a=e.props,s={},o=[];let u=!1;if(!lt(e)){const d=y=>{u=!0;const[_,b]=p$(y,t,!0);gr(s,_),b&&o.push(...b)};!r&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!a&&!u)return jt(e)&&n.set(e,Us),Us;if(Ke(a))for(let d=0;d<a.length;d++){const y=qn(a[d]);by(y)&&(s[y]=xt)}else if(a)for(const d in a){const y=qn(d);if(by(y)){const _=a[d],b=s[y]=Ke(_)||lt(_)?{type:_}:_;if(b){const k=Sy(Boolean,b.type),N=Sy(String,b.type);b[0]=k>-1,b[1]=N<0||k<N,(k>-1||ht(b,"default"))&&o.push(y)}}}const c=[s,o];return jt(e)&&n.set(e,c),c}function by(e){return e[0]!=="$"}function wy(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function _y(e,t){return wy(e)===wy(t)}function Sy(e,t){return Ke(t)?t.findIndex(r=>_y(r,e)):lt(t)&&_y(t,e)?0:-1}const h$=e=>e[0]==="_"||e==="$stable",pv=e=>Ke(e)?e.map(Ln):[Ln(e)],aI=(e,t,r)=>{if(t._n)return t;const n=sr((...i)=>pv(t(...i)),r);return n._c=!1,n},v$=(e,t,r)=>{const n=e._ctx;for(const i in e){if(h$(i))continue;const a=e[i];if(lt(a))t[i]=aI(i,a,n);else if(a!=null){const s=pv(a);t[i]=()=>s}}},g$=(e,t)=>{const r=pv(t);e.slots.default=()=>r},sI=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=yt(t),fc(t,"_",r)):v$(t,e.slots={})}else e.slots={},t&&g$(e,t);fc(e.slots,Yc,1)},oI=(e,t,r)=>{const{vnode:n,slots:i}=e;let a=!0,s=xt;if(n.shapeFlag&32){const o=t._;o?r&&o===1?a=!1:(gr(i,t),!r&&o===1&&delete i._):(a=!t.$stable,v$(t,i)),s=t}else t&&(g$(e,t),s={default:1});if(a)for(const o in i)!h$(o)&&!(o in s)&&delete i[o]};function y$(){return{app:null,config:{isNativeTag:xE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uI=0;function lI(e,t){return function(n,i=null){lt(n)||(n=Object.assign({},n)),i!=null&&!jt(i)&&(i=null);const a=y$(),s=new Set;let o=!1;const u=a.app={_uid:uI++,_component:n,_props:i,_container:null,_context:a,_instance:null,version:CI,get config(){return a.config},set config(c){},use(c,...d){return s.has(c)||(c&&lt(c.install)?(s.add(c),c.install(u,...d)):lt(c)&&(s.add(c),c(u,...d))),u},mixin(c){return a.mixins.includes(c)||a.mixins.push(c),u},component(c,d){return d?(a.components[c]=d,u):a.components[c]},directive(c,d){return d?(a.directives[c]=d,u):a.directives[c]},mount(c,d,y){if(!o){const _=wt(n,i);return _.appContext=a,d&&t?t(_,c):e(_,c,y),o=!0,u._container=c,c.__vue_app__=u,Qc(_.component)||_.component.proxy}},unmount(){o&&(e(null,u._container),delete u._container.__vue_app__)},provide(c,d){return a.provides[c]=d,u}};return u}}function jp(e,t,r,n,i=!1){if(Ke(e)){e.forEach((_,b)=>jp(_,t&&(Ke(t)?t[b]:t),r,n,i));return}if(au(n)&&!i)return;const a=n.shapeFlag&4?Qc(n.component)||n.component.proxy:n.el,s=i?null:a,{i:o,r:u}=e,c=t&&t.r,d=o.refs===xt?o.refs={}:o.refs,y=o.setupState;if(c!=null&&c!==u&&(lr(c)?(d[c]=null,ht(y,c)&&(y[c]=null)):Qt(c)&&(c.value=null)),lt(u))Vi(u,o,12,[s,d]);else{const _=lr(u),b=Qt(u);if(_||b){const k=()=>{if(e.f){const N=_?d[u]:u.value;i?Ke(N)&&Zh(N,a):Ke(N)?N.includes(a)||N.push(a):_?(d[u]=[a],ht(y,u)&&(y[u]=d[u])):(u.value=[a],e.k&&(d[e.k]=u.value))}else _?(d[u]=s,ht(y,u)&&(y[u]=s)):b&&(u.value=s,e.k&&(d[e.k]=s))};s?(k.id=-1,Ar(k,r)):k()}}}const Ar=NC;function cI(e){return fI(e)}function fI(e,t){const r=BE();r.__VUE__=!0;const{insert:n,remove:i,patchProp:a,createElement:s,createText:o,createComment:u,setText:c,setElementText:d,parentNode:y,nextSibling:_,setScopeId:b=Cn,cloneNode:k,insertStaticContent:N}=e,P=(E,T,V,re=null,W=null,ke=null,he=!1,we=null,Oe=!!T.dynamicChildren)=>{if(E===T)return;E&&!Pa(E,T)&&(re=te(E),G(E,W,ke,!0),E=null),T.patchFlag===-2&&(Oe=!1,T.dynamicChildren=null);const{type:z,ref:Ue,shapeFlag:ae}=T;switch(z){case hv:j(E,T,V,re);break;case cn:F(E,T,V,re);break;case Ff:E==null&&me(T,V,re,he);break;case qt:ue(E,T,V,re,W,ke,he,we,Oe);break;default:ae&1?Ne(E,T,V,re,W,ke,he,we,Oe):ae&6?ee(E,T,V,re,W,ke,he,we,Oe):(ae&64||ae&128)&&z.process(E,T,V,re,W,ke,he,we,Oe,De)}Ue!=null&&W&&jp(Ue,E&&E.ref,ke,T||E,!T)},j=(E,T,V,re)=>{if(E==null)n(T.el=o(T.children),V,re);else{const W=T.el=E.el;T.children!==E.children&&c(W,T.children)}},F=(E,T,V,re)=>{E==null?n(T.el=u(T.children||""),V,re):T.el=E.el},me=(E,T,V,re)=>{[E.el,E.anchor]=N(E.children,T,V,re,E.el,E.anchor)},ce=({el:E,anchor:T},V,re)=>{let W;for(;E&&E!==T;)W=_(E),n(E,V,re),E=W;n(T,V,re)},xe=({el:E,anchor:T})=>{let V;for(;E&&E!==T;)V=_(E),i(E),E=V;i(T)},Ne=(E,T,V,re,W,ke,he,we,Oe)=>{he=he||T.type==="svg",E==null?Me(T,V,re,W,ke,he,we,Oe):D(E,T,W,ke,he,we,Oe)},Me=(E,T,V,re,W,ke,he,we)=>{let Oe,z;const{type:Ue,props:ae,shapeFlag:q,transition:Ce,patchFlag:B,dirs:Se}=E;if(E.el&&k!==void 0&&B===-1)Oe=E.el=k(E.el);else{if(Oe=E.el=s(E.type,ke,ae&&ae.is,ae),q&8?d(Oe,E.children):q&16&&le(E.children,Oe,null,re,W,ke&&Ue!=="foreignObject",he,we),Se&&wa(E,null,re,"created"),ae){for(const tt in ae)tt!=="value"&&!Zl(tt)&&a(Oe,tt,null,ae[tt],ke,E.children,re,W,Z);"value"in ae&&a(Oe,"value",null,ae.value),(z=ae.onVnodeBeforeMount)&&Mn(z,re,E)}x(Oe,E,E.scopeId,he,re)}Se&&wa(E,null,re,"beforeMount");const Ge=(!W||W&&!W.pendingBranch)&&Ce&&!Ce.persisted;Ge&&Ce.beforeEnter(Oe),n(Oe,T,V),((z=ae&&ae.onVnodeMounted)||Ge||Se)&&Ar(()=>{z&&Mn(z,re,E),Ge&&Ce.enter(Oe),Se&&wa(E,null,re,"mounted")},W)},x=(E,T,V,re,W)=>{if(V&&b(E,V),re)for(let ke=0;ke<re.length;ke++)b(E,re[ke]);if(W){let ke=W.subTree;if(T===ke){const he=W.vnode;x(E,he,he.scopeId,he.slotScopeIds,W.parent)}}},le=(E,T,V,re,W,ke,he,we,Oe=0)=>{for(let z=Oe;z<E.length;z++){const Ue=E[z]=we?Li(E[z]):Ln(E[z]);P(null,Ue,T,V,re,W,ke,he,we)}},D=(E,T,V,re,W,ke,he)=>{const we=T.el=E.el;let{patchFlag:Oe,dynamicChildren:z,dirs:Ue}=T;Oe|=E.patchFlag&16;const ae=E.props||xt,q=T.props||xt;let Ce;V&&_a(V,!1),(Ce=q.onVnodeBeforeUpdate)&&Mn(Ce,V,T,E),Ue&&wa(T,E,V,"beforeUpdate"),V&&_a(V,!0);const B=W&&T.type!=="foreignObject";if(z?Re(E.dynamicChildren,z,we,V,re,B,ke):he||je(E,T,we,null,V,re,B,ke,!1),Oe>0){if(Oe&16)Ie(we,T,ae,q,V,re,W);else if(Oe&2&&ae.class!==q.class&&a(we,"class",null,q.class,W),Oe&4&&a(we,"style",ae.style,q.style,W),Oe&8){const Se=T.dynamicProps;for(let Ge=0;Ge<Se.length;Ge++){const tt=Se[Ge],tr=ae[tt],wr=q[tt];(wr!==tr||tt==="value")&&a(we,tt,tr,wr,W,E.children,V,re,Z)}}Oe&1&&E.children!==T.children&&d(we,T.children)}else!he&&z==null&&Ie(we,T,ae,q,V,re,W);((Ce=q.onVnodeUpdated)||Ue)&&Ar(()=>{Ce&&Mn(Ce,V,T,E),Ue&&wa(T,E,V,"updated")},re)},Re=(E,T,V,re,W,ke,he)=>{for(let we=0;we<T.length;we++){const Oe=E[we],z=T[we],Ue=Oe.el&&(Oe.type===qt||!Pa(Oe,z)||Oe.shapeFlag&70)?y(Oe.el):V;P(Oe,z,Ue,null,re,W,ke,he,!0)}},Ie=(E,T,V,re,W,ke,he)=>{if(V!==re){for(const we in re){if(Zl(we))continue;const Oe=re[we],z=V[we];Oe!==z&&we!=="value"&&a(E,we,z,Oe,he,T.children,W,ke,Z)}if(V!==xt)for(const we in V)!Zl(we)&&!(we in re)&&a(E,we,V[we],null,he,T.children,W,ke,Z);"value"in re&&a(E,"value",V.value,re.value)}},ue=(E,T,V,re,W,ke,he,we,Oe)=>{const z=T.el=E?E.el:o(""),Ue=T.anchor=E?E.anchor:o("");let{patchFlag:ae,dynamicChildren:q,slotScopeIds:Ce}=T;Ce&&(we=we?we.concat(Ce):Ce),E==null?(n(z,V,re),n(Ue,V,re),le(T.children,V,Ue,W,ke,he,we,Oe)):ae>0&&ae&64&&q&&E.dynamicChildren?(Re(E.dynamicChildren,q,V,W,ke,he,we),(T.key!=null||W&&T===W.subTree)&&m$(E,T,!0)):je(E,T,V,Ue,W,ke,he,we,Oe)},ee=(E,T,V,re,W,ke,he,we,Oe)=>{T.slotScopeIds=we,E==null?T.shapeFlag&512?W.ctx.activate(T,V,re,he,Oe):se(T,V,re,W,ke,he,Oe):ne(E,T,Oe)},se=(E,T,V,re,W,ke,he)=>{const we=E.component=wI(E,re,W);if(Kc(E)&&(we.ctx.renderer=De),_I(we),we.asyncDep){if(W&&W.registerDep(we,be),!E.el){const Oe=we.subTree=wt(cn);F(null,Oe,T,V)}return}be(we,E,T,V,W,ke,he)},ne=(E,T,V)=>{const re=T.component=E.component;if(AC(E,T,V))if(re.asyncDep&&!re.asyncResolved){O(re,T,V);return}else re.next=T,TC(re.update),re.update();else T.el=E.el,re.vnode=T},be=(E,T,V,re,W,ke,he)=>{const we=()=>{if(E.isMounted){let{next:Ue,bu:ae,u:q,parent:Ce,vnode:B}=E,Se=Ue,Ge;_a(E,!1),Ue?(Ue.el=B.el,O(E,Ue,he)):Ue=B,ae&&ec(ae),(Ge=Ue.props&&Ue.props.onVnodeBeforeUpdate)&&Mn(Ge,Ce,Ue,B),_a(E,!0);const tt=Uf(E),tr=E.subTree;E.subTree=tt,P(tr,tt,y(tr.el),te(tr),E,W,ke),Ue.el=tt.el,Se===null&&PC(E,tt.el),q&&Ar(q,W),(Ge=Ue.props&&Ue.props.onVnodeUpdated)&&Ar(()=>Mn(Ge,Ce,Ue,B),W)}else{let Ue;const{el:ae,props:q}=T,{bm:Ce,m:B,parent:Se}=E,Ge=au(T);if(_a(E,!1),Ce&&ec(Ce),!Ge&&(Ue=q&&q.onVnodeBeforeMount)&&Mn(Ue,Se,T),_a(E,!0),ae&&$e){const tt=()=>{E.subTree=Uf(E),$e(ae,E.subTree,E,W,null)};Ge?T.type.__asyncLoader().then(()=>!E.isUnmounted&&tt()):tt()}else{const tt=E.subTree=Uf(E);P(null,tt,V,re,E,W,ke),T.el=tt.el}if(B&&Ar(B,W),!Ge&&(Ue=q&&q.onVnodeMounted)){const tt=T;Ar(()=>Mn(Ue,Se,tt),W)}(T.shapeFlag&256||Se&&au(Se.vnode)&&Se.vnode.shapeFlag&256)&&E.a&&Ar(E.a,W),E.isMounted=!0,T=V=re=null}},Oe=E.effect=new rv(we,()=>cv(z),E.scope),z=E.update=()=>Oe.run();z.id=E.uid,_a(E,!0),z()},O=(E,T,V)=>{T.component=E;const re=E.vnode.props;E.vnode=T,E.next=null,iI(E,T.props,re,V),oI(E,T.children,V),oo(),dy(),uo()},je=(E,T,V,re,W,ke,he,we,Oe=!1)=>{const z=E&&E.children,Ue=E?E.shapeFlag:0,ae=T.children,{patchFlag:q,shapeFlag:Ce}=T;if(q>0){if(q&128){Je(z,ae,V,re,W,ke,he,we,Oe);return}else if(q&256){ft(z,ae,V,re,W,ke,he,we,Oe);return}}Ce&8?(Ue&16&&Z(z,W,ke),ae!==z&&d(V,ae)):Ue&16?Ce&16?Je(z,ae,V,re,W,ke,he,we,Oe):Z(z,W,ke,!0):(Ue&8&&d(V,""),Ce&16&&le(ae,V,re,W,ke,he,we,Oe))},ft=(E,T,V,re,W,ke,he,we,Oe)=>{E=E||Us,T=T||Us;const z=E.length,Ue=T.length,ae=Math.min(z,Ue);let q;for(q=0;q<ae;q++){const Ce=T[q]=Oe?Li(T[q]):Ln(T[q]);P(E[q],Ce,V,null,W,ke,he,we,Oe)}z>Ue?Z(E,W,ke,!0,!1,ae):le(T,V,re,W,ke,he,we,Oe,ae)},Je=(E,T,V,re,W,ke,he,we,Oe)=>{let z=0;const Ue=T.length;let ae=E.length-1,q=Ue-1;for(;z<=ae&&z<=q;){const Ce=E[z],B=T[z]=Oe?Li(T[z]):Ln(T[z]);if(Pa(Ce,B))P(Ce,B,V,null,W,ke,he,we,Oe);else break;z++}for(;z<=ae&&z<=q;){const Ce=E[ae],B=T[q]=Oe?Li(T[q]):Ln(T[q]);if(Pa(Ce,B))P(Ce,B,V,null,W,ke,he,we,Oe);else break;ae--,q--}if(z>ae){if(z<=q){const Ce=q+1,B=Ce<Ue?T[Ce].el:re;for(;z<=q;)P(null,T[z]=Oe?Li(T[z]):Ln(T[z]),V,B,W,ke,he,we,Oe),z++}}else if(z>q)for(;z<=ae;)G(E[z],W,ke,!0),z++;else{const Ce=z,B=z,Se=new Map;for(z=B;z<=q;z++){const Ut=T[z]=Oe?Li(T[z]):Ln(T[z]);Ut.key!=null&&Se.set(Ut.key,z)}let Ge,tt=0;const tr=q-B+1;let wr=!1,hn=0;const Ir=new Array(tr);for(z=0;z<tr;z++)Ir[z]=0;for(z=Ce;z<=ae;z++){const Ut=E[z];if(tt>=tr){G(Ut,W,ke,!0);continue}let oe;if(Ut.key!=null)oe=Se.get(Ut.key);else for(Ge=B;Ge<=q;Ge++)if(Ir[Ge-B]===0&&Pa(Ut,T[Ge])){oe=Ge;break}oe===void 0?G(Ut,W,ke,!0):(Ir[oe-B]=z+1,oe>=hn?hn=oe:wr=!0,P(Ut,T[oe],V,null,W,ke,he,we,Oe),tt++)}const mt=wr?dI(Ir):Us;for(Ge=mt.length-1,z=tr-1;z>=0;z--){const Ut=B+z,oe=T[Ut],pe=Ut+1<Ue?T[Ut+1].el:re;Ir[z]===0?P(null,oe,V,pe,W,ke,he,we,Oe):wr&&(Ge<0||z!==mt[Ge]?fe(oe,V,pe,2):Ge--)}}},fe=(E,T,V,re,W=null)=>{const{el:ke,type:he,transition:we,children:Oe,shapeFlag:z}=E;if(z&6){fe(E.component.subTree,T,V,re);return}if(z&128){E.suspense.move(T,V,re);return}if(z&64){he.move(E,T,V,De);return}if(he===qt){n(ke,T,V);for(let ae=0;ae<Oe.length;ae++)fe(Oe[ae],T,V,re);n(E.anchor,T,V);return}if(he===Ff){ce(E,T,V);return}if(re!==2&&z&1&&we)if(re===0)we.beforeEnter(ke),n(ke,T,V),Ar(()=>we.enter(ke),W);else{const{leave:ae,delayLeave:q,afterLeave:Ce}=we,B=()=>n(ke,T,V),Se=()=>{ae(ke,()=>{B(),Ce&&Ce()})};q?q(ke,B,Se):Se()}else n(ke,T,V)},G=(E,T,V,re=!1,W=!1)=>{const{type:ke,props:he,ref:we,children:Oe,dynamicChildren:z,shapeFlag:Ue,patchFlag:ae,dirs:q}=E;if(we!=null&&jp(we,null,V,E,!0),Ue&256){T.ctx.deactivate(E);return}const Ce=Ue&1&&q,B=!au(E);let Se;if(B&&(Se=he&&he.onVnodeBeforeUnmount)&&Mn(Se,T,E),Ue&6)C(E.component,V,re);else{if(Ue&128){E.suspense.unmount(V,re);return}Ce&&wa(E,null,T,"beforeUnmount"),Ue&64?E.type.remove(E,T,V,W,De,re):z&&(ke!==qt||ae>0&&ae&64)?Z(z,T,V,!1,!0):(ke===qt&&ae&384||!W&&Ue&16)&&Z(Oe,T,V),re&&Y(E)}(B&&(Se=he&&he.onVnodeUnmounted)||Ce)&&Ar(()=>{Se&&Mn(Se,T,E),Ce&&wa(E,null,T,"unmounted")},V)},Y=E=>{const{type:T,el:V,anchor:re,transition:W}=E;if(T===qt){$(V,re);return}if(T===Ff){xe(E);return}const ke=()=>{i(V),W&&!W.persisted&&W.afterLeave&&W.afterLeave()};if(E.shapeFlag&1&&W&&!W.persisted){const{leave:he,delayLeave:we}=W,Oe=()=>he(V,ke);we?we(E.el,ke,Oe):Oe()}else ke()},$=(E,T)=>{let V;for(;E!==T;)V=_(E),i(E),E=V;i(T)},C=(E,T,V)=>{const{bum:re,scope:W,update:ke,subTree:he,um:we}=E;re&&ec(re),W.stop(),ke&&(ke.active=!1,G(he,E,T,V)),we&&Ar(we,T),Ar(()=>{E.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},Z=(E,T,V,re=!1,W=!1,ke=0)=>{for(let he=ke;he<E.length;he++)G(E[he],T,V,re,W)},te=E=>E.shapeFlag&6?te(E.component.subTree):E.shapeFlag&128?E.suspense.next():_(E.anchor||E.el),Ae=(E,T,V)=>{E==null?T._vnode&&G(T._vnode,null,null,!0):P(T._vnode||null,E,T,null,null,null,V),dy(),QS(),T._vnode=E},De={p:P,um:G,m:fe,r:Y,mt:se,mc:le,pc:je,pbc:Re,n:te,o:e};let de,$e;return t&&([de,$e]=t(De)),{render:Ae,hydrate:de,createApp:lI(Ae,de)}}function _a({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function m$(e,t,r=!1){const n=e.children,i=t.children;if(Ke(n)&&Ke(i))for(let a=0;a<n.length;a++){const s=n[a];let o=i[a];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[a]=Li(i[a]),o.el=s.el),r||m$(s,o))}}function dI(e){const t=e.slice(),r=[0];let n,i,a,s,o;const u=e.length;for(n=0;n<u;n++){const c=e[n];if(c!==0){if(i=r[r.length-1],e[i]<c){t[n]=i,r.push(n);continue}for(a=0,s=r.length-1;a<s;)o=a+s>>1,e[r[o]]<c?a=o+1:s=o;c<e[r[a]]&&(a>0&&(t[n]=r[a-1]),r[a]=n)}}for(a=r.length,s=r[a-1];a-- >0;)r[a]=s,s=t[s];return r}const pI=e=>e.__isTeleport,qt=Symbol(void 0),hv=Symbol(void 0),cn=Symbol(void 0),Ff=Symbol(void 0),su=[];let $n=null;function qe(e=!1){su.push($n=e?null:[])}function hI(){su.pop(),$n=su[su.length-1]||null}let Su=1;function $y(e){Su+=e}function b$(e){return e.dynamicChildren=Su>0?$n||Us:null,hI(),Su>0&&$n&&$n.push(e),e}function ze(e,t,r,n,i,a){return b$(M(e,t,r,n,i,a,!0))}function Rn(e,t,r,n,i){return b$(wt(e,t,r,n,i,!0))}function yc(e){return e?e.__v_isVNode===!0:!1}function Pa(e,t){return e.type===t.type&&e.key===t.key}const Yc="__vInternal",w$=({key:e})=>e!=null?e:null,rc=({ref:e,ref_key:t,ref_for:r})=>e!=null?lr(e)||Qt(e)||lt(e)?{i:vr,r:e,k:t,f:!!r}:e:null;function M(e,t=null,r=null,n=0,i=null,a=e===qt?0:1,s=!1,o=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&w$(t),ref:t&&rc(t),scopeId:e$,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null};return o?(vv(u,r),a&128&&e.normalize(u)):r&&(u.shapeFlag|=lr(r)?8:16),Su>0&&!s&&$n&&(u.patchFlag>0||a&6)&&u.patchFlag!==32&&$n.push(u),u}const wt=vI;function vI(e,t=null,r=null,n=0,i=null,a=!1){if((!e||e===KC)&&(e=cn),yc(e)){const o=Xi(e,t,!0);return r&&vv(o,r),Su>0&&!a&&$n&&(o.shapeFlag&6?$n[$n.indexOf(e)]=o:$n.push(o)),o.patchFlag|=-2,o}if(EI(e)&&(e=e.__vccOpts),t){t=gI(t);let{class:o,style:u}=t;o&&!lr(o)&&(t.class=ja(o)),jt(u)&&(WS(u)&&!Ke(u)&&(u=gr({},u)),t.style=Yh(u))}const s=lr(e)?1:MC(e)?128:pI(e)?64:jt(e)?4:lt(e)?2:0;return M(e,t,r,n,i,s,a,!0)}function gI(e){return e?WS(e)||Yc in e?gr({},e):e:null}function Xi(e,t,r=!1){const{props:n,ref:i,patchFlag:a,children:s}=e,o=t?yI(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&w$(o),ref:t&&t.ref?r&&i?Ke(i)?i.concat(rc(t)):[i,rc(t)]:rc(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==qt?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Xi(e.ssContent),ssFallback:e.ssFallback&&Xi(e.ssFallback),el:e.el,anchor:e.anchor}}function Ze(e=" ",t=0){return wt(hv,null,e,t)}function Yt(e="",t=!1){return t?(qe(),Rn(cn,null,e)):wt(cn,null,e)}function Ln(e){return e==null||typeof e=="boolean"?wt(cn):Ke(e)?wt(qt,null,e.slice()):typeof e=="object"?Li(e):wt(hv,null,String(e))}function Li(e){return e.el===null||e.memo?e:Xi(e)}function vv(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Ke(t))r=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),vv(e,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!(Yc in t)?t._ctx=vr:i===3&&vr&&(vr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else lt(t)?(t={default:t,_ctx:vr},r=32):(t=String(t),n&64?(r=16,t=[Ze(t)]):r=8);e.children=t,e.shapeFlag|=r}function yI(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=ja([t.class,n.class]));else if(i==="style")t.style=Yh([t.style,n.style]);else if(qc(i)){const a=t[i],s=n[i];s&&a!==s&&!(Ke(a)&&a.includes(s))&&(t[i]=a?[].concat(a,s):s)}else i!==""&&(t[i]=n[i])}return t}function Mn(e,t,r,n=null){ln(e,t,7,[r,n])}const mI=y$();let bI=0;function wI(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||mI,a={uid:bI++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new OS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:p$(n,i),emitsOptions:ZS(n,i),emit:null,emitted:null,propsDefaults:xt,inheritAttrs:n.inheritAttrs,ctx:xt,data:xt,props:xt,attrs:xt,slots:xt,refs:xt,setupState:xt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=IC.bind(null,a),e.ce&&e.ce(a),a}let or=null;const gv=()=>or||vr,Js=e=>{or=e,e.scope.on()},Ba=()=>{or&&or.scope.off(),or=null};function _$(e){return e.vnode.shapeFlag&4}let $u=!1;function _I(e,t=!1){$u=t;const{props:r,children:n}=e.vnode,i=_$(e);nI(e,r,i,t),sI(e,n);const a=i?SI(e,t):void 0;return $u=!1,a}function SI(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Ks(new Proxy(e.ctx,QC));const{setup:n}=r;if(n){const i=e.setupContext=n.length>1?kI(e):null;Js(e),oo();const a=Vi(n,e,0,[e.props,i]);if(uo(),Ba(),CS(a)){if(a.then(Ba,Ba),t)return a.then(s=>{ky(e,s,t)}).catch(s=>{Vc(s,e,0)});e.asyncDep=a}else ky(e,a,t)}else S$(e,t)}function ky(e,t,r){lt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:jt(t)&&(e.setupState=zS(t)),S$(e,r)}let Ty;function S$(e,t,r){const n=e.type;if(!e.render){if(!t&&Ty&&!n.render){const i=n.template||dv(e).template;if(i){const{isCustomElement:a,compilerOptions:s}=e.appContext.config,{delimiters:o,compilerOptions:u}=n,c=gr(gr({isCustomElement:a,delimiters:o},s),u);n.render=Ty(i,c)}}e.render=n.render||Cn}Js(e),oo(),XC(e),uo(),Ba()}function $I(e){return new Proxy(e.attrs,{get(t,r){return Wr(e,"get","$attrs"),t[r]}})}function kI(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=$I(e))},slots:e.slots,emit:e.emit,expose:t}}function Qc(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(zS(Ks(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in vc)return vc[r](e)}}))}function TI(e,t=!0){return lt(e)?e.displayName||e.name:e.name||t&&e.__name}function EI(e){return lt(e)&&"__vccOpts"in e}const Jt=(e,t)=>SC(e,t,$u);function $$(e,t,r){const n=arguments.length;return n===2?jt(t)&&!Ke(t)?yc(t)?wt(e,null,[t]):wt(e,t):wt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&yc(r)&&(r=[r]),wt(e,t,r))}const CI="3.2.39",II="http://www.w3.org/2000/svg",Ma=typeof document<"u"?document:null,Ey=Ma&&Ma.createElement("template"),RI={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t?Ma.createElementNS(II,e):Ma.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>Ma.createTextNode(e),createComment:e=>Ma.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ma.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,i,a){const s=r?r.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===a||!(i=i.nextSibling)););else{Ey.innerHTML=n?`<svg>${e}</svg>`:e;const o=Ey.content;if(n){const u=o.firstChild;for(;u.firstChild;)o.appendChild(u.firstChild);o.removeChild(u)}t.insertBefore(o,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function OI(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function AI(e,t,r){const n=e.style,i=lr(r);if(r&&!i){for(const a in r)Up(n,a,r[a]);if(t&&!lr(t))for(const a in t)r[a]==null&&Up(n,a,"")}else{const a=n.display;i?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=a)}}const Cy=/\s*!important$/;function Up(e,t,r){if(Ke(r))r.forEach(n=>Up(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=PI(e,t);Cy.test(r)?e.setProperty(Ka(n),r.replace(Cy,""),"important"):e[n]=r}}const Iy=["Webkit","Moz","ms"],Bf={};function PI(e,t){const r=Bf[t];if(r)return r;let n=qn(t);if(n!=="filter"&&n in e)return Bf[t]=n;n=Hc(n);for(let i=0;i<Iy.length;i++){const a=Iy[i]+n;if(a in e)return Bf[t]=a}return t}const Ry="http://www.w3.org/1999/xlink";function MI(e,t,r,n,i){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(Ry,t.slice(6,t.length)):e.setAttributeNS(Ry,t,r);else{const a=OE(t);r==null||a&&!TS(r)?e.removeAttribute(t):e.setAttribute(t,a?"":r)}}function NI(e,t,r,n,i,a,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,i,a),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const u=r==null?"":r;(e.value!==u||e.tagName==="OPTION")&&(e.value=u),r==null&&e.removeAttribute(t);return}let o=!1;if(r===""||r==null){const u=typeof e[t];u==="boolean"?r=TS(r):r==null&&u==="string"?(r="",o=!0):u==="number"&&(r=0,o=!0)}try{e[t]=r}catch{}o&&e.removeAttribute(t)}const[k$,xI]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let Dp=0;const LI=Promise.resolve(),jI=()=>{Dp=0},UI=()=>Dp||(LI.then(jI),Dp=k$());function Di(e,t,r,n){e.addEventListener(t,r,n)}function DI(e,t,r,n){e.removeEventListener(t,r,n)}function FI(e,t,r,n,i=null){const a=e._vei||(e._vei={}),s=a[t];if(n&&s)s.value=n;else{const[o,u]=BI(t);if(n){const c=a[t]=qI(n,i);Di(e,o,c,u)}else s&&(DI(e,o,s,u),a[t]=void 0)}}const Oy=/(?:Once|Passive|Capture)$/;function BI(e){let t;if(Oy.test(e)){t={};let n;for(;n=e.match(Oy);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ka(e.slice(2)),t]}function qI(e,t){const r=n=>{const i=n.timeStamp||k$();(xI||i>=r.attached-1)&&ln(WI(n,r.value),t,5,[n])};return r.value=e,r.attached=UI(),r}function WI(e,t){if(Ke(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const Ay=/^on[a-z]/,HI=(e,t,r,n,i=!1,a,s,o,u)=>{t==="class"?OI(e,n,i):t==="style"?AI(e,r,n):qc(t)?Xh(t)||FI(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):GI(e,t,n,i))?NI(e,t,n,a,s,o,u):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),MI(e,t,n,i))};function GI(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&Ay.test(t)&&lt(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Ay.test(t)&&lr(r)?!1:t in e}const VI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};UC.props;const Ys=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Ke(t)?r=>ec(t,r):t};function zI(e){e.target.composing=!0}function Py(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Na={created(e,{modifiers:{lazy:t,trim:r,number:n}},i){e._assign=Ys(i);const a=n||i.props&&i.props.type==="number";Di(e,t?"change":"input",s=>{if(s.target.composing)return;let o=e.value;r&&(o=o.trim()),a&&(o=dc(o)),e._assign(o)}),r&&Di(e,"change",()=>{e.value=e.value.trim()}),t||(Di(e,"compositionstart",zI),Di(e,"compositionend",Py),Di(e,"change",Py))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:i}},a){if(e._assign=Ys(a),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(i||e.type==="number")&&dc(e.value)===t))return;const s=t==null?"":t;e.value!==s&&(e.value=s)}},KI={deep:!0,created(e,t,r){e._assign=Ys(r),Di(e,"change",()=>{const n=e._modelValue,i=ku(e),a=e.checked,s=e._assign;if(Ke(n)){const o=Qh(n,i),u=o!==-1;if(a&&!u)s(n.concat(i));else if(!a&&u){const c=[...n];c.splice(o,1),s(c)}}else if(so(n)){const o=new Set(n);a?o.add(i):o.delete(i),s(o)}else s(T$(e,a))})},mounted:My,beforeUpdate(e,t,r){e._assign=Ys(r),My(e,t,r)}};function My(e,{value:t,oldValue:r},n){e._modelValue=t,Ke(t)?e.checked=Qh(t,n.props.value)>-1:so(t)?e.checked=t.has(n.props.value):t!==r&&(e.checked=Nu(t,T$(e,!0)))}const ou={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const i=so(t);Di(e,"change",()=>{const a=Array.prototype.filter.call(e.options,s=>s.selected).map(s=>r?dc(ku(s)):ku(s));e._assign(e.multiple?i?new Set(a):a:a[0])}),e._assign=Ys(n)},mounted(e,{value:t}){Ny(e,t)},beforeUpdate(e,t,r){e._assign=Ys(r)},updated(e,{value:t}){Ny(e,t)}};function Ny(e,t){const r=e.multiple;if(!(r&&!Ke(t)&&!so(t))){for(let n=0,i=e.options.length;n<i;n++){const a=e.options[n],s=ku(a);if(r)Ke(t)?a.selected=Qh(t,s)>-1:a.selected=t.has(s);else if(Nu(ku(a),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function ku(e){return"_value"in e?e._value:e.value}function T$(e,t){const r=t?"_trueValue":"_falseValue";return r in e?e[r]:t}const JI=["ctrl","shift","alt","meta"],YI={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>JI.some(r=>e[`${r}Key`]&&!t.includes(r))},QI=(e,t)=>(r,...n)=>{for(let i=0;i<t.length;i++){const a=YI[t[i]];if(a&&a(r,t))return}return e(r,...n)},XI={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ZI=(e,t)=>r=>{if(!("key"in r))return;const n=Ka(r.key);if(t.some(i=>i===n||XI[i]===n))return e(r)},it={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):xo(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),xo(e,!0),n.enter(e)):n.leave(e,()=>{xo(e,!1)}):xo(e,t))},beforeUnmount(e,{value:t}){xo(e,t)}};function xo(e,t){e.style.display=t?e._vod:"none"}const eR=gr({patchProp:HI},RI);let xy;function tR(){return xy||(xy=cI(eR))}const rR=(...e)=>{const t=tR().createApp(...e),{mount:r}=t;return t.mount=n=>{const i=nR(n);if(!i)return;const a=t._component;!lt(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.innerHTML="";const s=r(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},t};function nR(e){return lr(e)?document.querySelector(e):e}var iR=!1;/*!
  * pinia v2.0.22
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let E$;const Xc=e=>E$=e,C$=Symbol();function Fp(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var uu;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(uu||(uu={}));function aR(){const e=AS(!0),t=e.run(()=>Ye({}));let r=[],n=[];const i=Ks({install(a){Xc(i),i._a=a,a.provide(C$,i),a.config.globalProperties.$pinia=i,n.forEach(s=>r.push(s)),n=[]},use(a){return!this._a&&!iR?n.push(a):r.push(a),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return i}const I$=()=>{};function Ly(e,t,r,n=I$){e.push(t);const i=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),n())};return!r&&gv()&&fv(i),i}function vs(e,...t){e.slice().forEach(r=>{r(...t)})}function Bp(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,n)=>e.set(n,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const n=t[r],i=e[r];Fp(i)&&Fp(n)&&e.hasOwnProperty(r)&&!Qt(n)&&!Gi(n)?e[r]=Bp(i,n):e[r]=n}return e}const sR=Symbol();function oR(e){return!Fp(e)||!e.hasOwnProperty(sR)}const{assign:ri}=Object;function uR(e){return!!(Qt(e)&&e.effect)}function lR(e,t,r,n){const{state:i,actions:a,getters:s}=t,o=r.state.value[e];let u;function c(){o||(r.state.value[e]=i?i():{});const d=mC(r.state.value[e]);return ri(d,a,Object.keys(s||{}).reduce((y,_)=>(y[_]=Ks(Jt(()=>{Xc(r);const b=r._s.get(e);return s[_].call(b,b)})),y),{}))}return u=R$(e,c,t,r,n,!0),u.$reset=function(){const y=i?i():{};this.$patch(_=>{ri(_,y)})},u}function R$(e,t,r={},n,i,a){let s;const o=ri({actions:{}},r),u={deep:!0};let c,d,y=Ks([]),_=Ks([]),b;const k=n.state.value[e];!a&&!k&&(n.state.value[e]={}),Ye({});let N;function P(Me){let x;c=d=!1,typeof Me=="function"?(Me(n.state.value[e]),x={type:uu.patchFunction,storeId:e,events:b}):(Bp(n.state.value[e],Me),x={type:uu.patchObject,payload:Me,storeId:e,events:b});const le=N=Symbol();lv().then(()=>{N===le&&(c=!0)}),d=!0,vs(y,x,n.state.value[e])}const j=I$;function F(){s.stop(),y=[],_=[],n._s.delete(e)}function me(Me,x){return function(){Xc(n);const le=Array.from(arguments),D=[],Re=[];function Ie(se){D.push(se)}function ue(se){Re.push(se)}vs(_,{args:le,name:Me,store:xe,after:Ie,onError:ue});let ee;try{ee=x.apply(this&&this.$id===e?this:xe,le)}catch(se){throw vs(Re,se),se}return ee instanceof Promise?ee.then(se=>(vs(D,se),se)).catch(se=>(vs(Re,se),Promise.reject(se))):(vs(D,ee),ee)}}const ce={_p:n,$id:e,$onAction:Ly.bind(null,_),$patch:P,$reset:j,$subscribe(Me,x={}){const le=Ly(y,Me,x.detached,()=>D()),D=s.run(()=>iu(()=>n.state.value[e],Re=>{(x.flush==="sync"?d:c)&&Me({storeId:e,type:uu.direct,events:b},Re)},ri({},u,x)));return le},$dispose:F},xe=Ja(ri({},ce));n._s.set(e,xe);const Ne=n._e.run(()=>(s=AS(),s.run(()=>t())));for(const Me in Ne){const x=Ne[Me];if(Qt(x)&&!uR(x)||Gi(x))a||(k&&oR(x)&&(Qt(x)?x.value=k[Me]:Bp(x,k[Me])),n.state.value[e][Me]=x);else if(typeof x=="function"){const le=me(Me,x);Ne[Me]=le,o.actions[Me]=x}}return ri(xe,Ne),ri(yt(xe),Ne),Object.defineProperty(xe,"$state",{get:()=>n.state.value[e],set:Me=>{P(x=>{ri(x,Me)})}}),n._p.forEach(Me=>{ri(xe,s.run(()=>Me({store:xe,app:n._a,pinia:n,options:o})))}),k&&a&&r.hydrate&&r.hydrate(xe.$state,k),c=!0,d=!0,xe}function Zc(e,t,r){let n,i;const a=typeof t=="function";typeof e=="string"?(n=e,i=a?r:t):(i=e,n=e.id);function s(o,u){const c=gv();return o=o||c&&In(C$),o&&Xc(o),o=E$,o._s.has(n)||(a?R$(n,t,i,o):lR(n,i,o)),o._s.get(n)}return s.$id=n,s}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Os=typeof window<"u";function cR(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const It=Object.assign;function qf(e,t){const r={};for(const n in t){const i=t[n];r[n]=On(i)?i.map(e):e(i)}return r}const lu=()=>{},On=Array.isArray,fR=/\/$/,dR=e=>e.replace(fR,"");function Wf(e,t,r="/"){let n,i={},a="",s="";const o=t.indexOf("#");let u=t.indexOf("?");return o<u&&o>=0&&(u=-1),u>-1&&(n=t.slice(0,u),a=t.slice(u+1,o>-1?o:t.length),i=e(a)),o>-1&&(n=n||t.slice(0,o),s=t.slice(o,t.length)),n=gR(n!=null?n:t,r),{fullPath:n+(a&&"?")+a+s,path:n,query:i,hash:s}}function pR(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function jy(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function hR(e,t,r){const n=t.matched.length-1,i=r.matched.length-1;return n>-1&&n===i&&Qs(t.matched[n],r.matched[i])&&O$(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Qs(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function O$(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!vR(e[r],t[r]))return!1;return!0}function vR(e,t){return On(e)?Uy(e,t):On(t)?Uy(t,e):e===t}function Uy(e,t){return On(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function gR(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let i=r.length-1,a,s;for(a=0;a<n.length;a++)if(s=n[a],s!==".")if(s==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a-(a===n.length?1:0)).join("/")}var Tu;(function(e){e.pop="pop",e.push="push"})(Tu||(Tu={}));var cu;(function(e){e.back="back",e.forward="forward",e.unknown=""})(cu||(cu={}));function yR(e){if(!e)if(Os){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),dR(e)}const mR=/^[^#]+#/;function bR(e,t){return e.replace(mR,"#")+t}function wR(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const ef=()=>({left:window.pageXOffset,top:window.pageYOffset});function _R(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),i=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!i)return;t=wR(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Dy(e,t){return(history.state?history.state.position-t:-1)+e}const qp=new Map;function SR(e,t){qp.set(e,t)}function $R(e){const t=qp.get(e);return qp.delete(e),t}let kR=()=>location.protocol+"//"+location.host;function A$(e,t){const{pathname:r,search:n,hash:i}=t,a=e.indexOf("#");if(a>-1){let o=i.includes(e.slice(a))?e.slice(a).length:1,u=i.slice(o);return u[0]!=="/"&&(u="/"+u),jy(u,"")}return jy(r,e)+n+i}function TR(e,t,r,n){let i=[],a=[],s=null;const o=({state:_})=>{const b=A$(e,location),k=r.value,N=t.value;let P=0;if(_){if(r.value=b,t.value=_,s&&s===k){s=null;return}P=N?_.position-N.position:0}else n(b);i.forEach(j=>{j(r.value,k,{delta:P,type:Tu.pop,direction:P?P>0?cu.forward:cu.back:cu.unknown})})};function u(){s=r.value}function c(_){i.push(_);const b=()=>{const k=i.indexOf(_);k>-1&&i.splice(k,1)};return a.push(b),b}function d(){const{history:_}=window;!_.state||_.replaceState(It({},_.state,{scroll:ef()}),"")}function y(){for(const _ of a)_();a=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",d),{pauseListeners:u,listen:c,destroy:y}}function Fy(e,t,r,n=!1,i=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:i?ef():null}}function ER(e){const{history:t,location:r}=window,n={value:A$(e,r)},i={value:t.state};i.value||a(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(u,c,d){const y=e.indexOf("#"),_=y>-1?(r.host&&document.querySelector("base")?e:e.slice(y))+u:kR()+e+u;try{t[d?"replaceState":"pushState"](c,"",_),i.value=c}catch(b){console.error(b),r[d?"replace":"assign"](_)}}function s(u,c){const d=It({},t.state,Fy(i.value.back,u,i.value.forward,!0),c,{position:i.value.position});a(u,d,!0),n.value=u}function o(u,c){const d=It({},i.value,t.state,{forward:u,scroll:ef()});a(d.current,d,!0);const y=It({},Fy(n.value,u,null),{position:d.position+1},c);a(u,y,!1),n.value=u}return{location:n,state:i,push:o,replace:s}}function CR(e){e=yR(e);const t=ER(e),r=TR(e,t.state,t.location,t.replace);function n(a,s=!0){s||r.pauseListeners(),history.go(a)}const i=It({location:"",base:e,go:n,createHref:bR.bind(null,e)},t,r);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function IR(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),CR(e)}function RR(e){return typeof e=="string"||e&&typeof e=="object"}function P$(e){return typeof e=="string"||typeof e=="symbol"}const Oi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},M$=Symbol("");var By;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(By||(By={}));function Xs(e,t){return It(new Error,{type:e,[M$]:!0},t)}function Xn(e,t){return e instanceof Error&&M$ in e&&(t==null||!!(e.type&t))}const qy="[^/]+?",OR={sensitive:!1,strict:!1,start:!0,end:!0},AR=/[.+*?^${}()[\]/\\]/g;function PR(e,t){const r=It({},OR,t),n=[];let i=r.start?"^":"";const a=[];for(const c of e){const d=c.length?[]:[90];r.strict&&!c.length&&(i+="/");for(let y=0;y<c.length;y++){const _=c[y];let b=40+(r.sensitive?.25:0);if(_.type===0)y||(i+="/"),i+=_.value.replace(AR,"\\$&"),b+=40;else if(_.type===1){const{value:k,repeatable:N,optional:P,regexp:j}=_;a.push({name:k,repeatable:N,optional:P});const F=j||qy;if(F!==qy){b+=10;try{new RegExp(`(${F})`)}catch(ce){throw new Error(`Invalid custom RegExp for param "${k}" (${F}): `+ce.message)}}let me=N?`((?:${F})(?:/(?:${F}))*)`:`(${F})`;y||(me=P&&c.length<2?`(?:/${me})`:"/"+me),P&&(me+="?"),i+=me,b+=20,P&&(b+=-8),N&&(b+=-20),F===".*"&&(b+=-50)}d.push(b)}n.push(d)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(i+="/?"),r.end?i+="$":r.strict&&(i+="(?:/|$)");const s=new RegExp(i,r.sensitive?"":"i");function o(c){const d=c.match(s),y={};if(!d)return null;for(let _=1;_<d.length;_++){const b=d[_]||"",k=a[_-1];y[k.name]=b&&k.repeatable?b.split("/"):b}return y}function u(c){let d="",y=!1;for(const _ of e){(!y||!d.endsWith("/"))&&(d+="/"),y=!1;for(const b of _)if(b.type===0)d+=b.value;else if(b.type===1){const{value:k,repeatable:N,optional:P}=b,j=k in c?c[k]:"";if(On(j)&&!N)throw new Error(`Provided param "${k}" is an array but it is not repeatable (* or + modifiers)`);const F=On(j)?j.join("/"):j;if(!F)if(P)_.length<2&&(d.endsWith("/")?d=d.slice(0,-1):y=!0);else throw new Error(`Missing required param "${k}"`);d+=F}}return d||"/"}return{re:s,score:n,keys:a,parse:o,stringify:u}}function MR(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function NR(e,t){let r=0;const n=e.score,i=t.score;for(;r<n.length&&r<i.length;){const a=MR(n[r],i[r]);if(a)return a;r++}if(Math.abs(i.length-n.length)===1){if(Wy(n))return 1;if(Wy(i))return-1}return i.length-n.length}function Wy(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const xR={type:0,value:""},LR=/[a-zA-Z0-9_]/;function jR(e){if(!e)return[[]];if(e==="/")return[[xR]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${r})/"${c}": ${b}`)}let r=0,n=r;const i=[];let a;function s(){a&&i.push(a),a=[]}let o=0,u,c="",d="";function y(){!c||(r===0?a.push({type:0,value:c}):r===1||r===2||r===3?(a.length>1&&(u==="*"||u==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:c,regexp:d,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):t("Invalid state to consume buffer"),c="")}function _(){c+=u}for(;o<e.length;){if(u=e[o++],u==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:u==="/"?(c&&y(),s()):u===":"?(y(),r=1):_();break;case 4:_(),r=n;break;case 1:u==="("?r=2:LR.test(u)?_():(y(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&o--);break;case 2:u===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+u:r=3:d+=u;break;case 3:y(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&o--,d="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),y(),s(),i}function UR(e,t,r){const n=PR(jR(e.path),r),i=It(n,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function DR(e,t){const r=[],n=new Map;t=Vy({strict:!1,end:!0,sensitive:!1},t);function i(d){return n.get(d)}function a(d,y,_){const b=!_,k=FR(d);k.aliasOf=_&&_.record;const N=Vy(t,d),P=[k];if("alias"in d){const me=typeof d.alias=="string"?[d.alias]:d.alias;for(const ce of me)P.push(It({},k,{components:_?_.record.components:k.components,path:ce,aliasOf:_?_.record:k}))}let j,F;for(const me of P){const{path:ce}=me;if(y&&ce[0]!=="/"){const xe=y.record.path,Ne=xe[xe.length-1]==="/"?"":"/";me.path=y.record.path+(ce&&Ne+ce)}if(j=UR(me,y,N),_?_.alias.push(j):(F=F||j,F!==j&&F.alias.push(j),b&&d.name&&!Gy(j)&&s(d.name)),k.children){const xe=k.children;for(let Ne=0;Ne<xe.length;Ne++)a(xe[Ne],j,_&&_.children[Ne])}_=_||j,u(j)}return F?()=>{s(F)}:lu}function s(d){if(P$(d)){const y=n.get(d);y&&(n.delete(d),r.splice(r.indexOf(y),1),y.children.forEach(s),y.alias.forEach(s))}else{const y=r.indexOf(d);y>-1&&(r.splice(y,1),d.record.name&&n.delete(d.record.name),d.children.forEach(s),d.alias.forEach(s))}}function o(){return r}function u(d){let y=0;for(;y<r.length&&NR(d,r[y])>=0&&(d.record.path!==r[y].record.path||!N$(d,r[y]));)y++;r.splice(y,0,d),d.record.name&&!Gy(d)&&n.set(d.record.name,d)}function c(d,y){let _,b={},k,N;if("name"in d&&d.name){if(_=n.get(d.name),!_)throw Xs(1,{location:d});N=_.record.name,b=It(Hy(y.params,_.keys.filter(F=>!F.optional).map(F=>F.name)),d.params&&Hy(d.params,_.keys.map(F=>F.name))),k=_.stringify(b)}else if("path"in d)k=d.path,_=r.find(F=>F.re.test(k)),_&&(b=_.parse(k),N=_.record.name);else{if(_=y.name?n.get(y.name):r.find(F=>F.re.test(y.path)),!_)throw Xs(1,{location:d,currentLocation:y});N=_.record.name,b=It({},y.params,d.params),k=_.stringify(b)}const P=[];let j=_;for(;j;)P.unshift(j.record),j=j.parent;return{name:N,path:k,params:b,matched:P,meta:qR(P)}}return e.forEach(d=>a(d)),{addRoute:a,resolve:c,removeRoute:s,getRoutes:o,getRecordMatcher:i}}function Hy(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function FR(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:BR(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function BR(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function Gy(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function qR(e){return e.reduce((t,r)=>It(t,r.meta),{})}function Vy(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function N$(e,t){return t.children.some(r=>r===e||N$(e,r))}const x$=/#/g,WR=/&/g,HR=/\//g,GR=/=/g,VR=/\?/g,L$=/\+/g,zR=/%5B/g,KR=/%5D/g,j$=/%5E/g,JR=/%60/g,U$=/%7B/g,YR=/%7C/g,D$=/%7D/g,QR=/%20/g;function yv(e){return encodeURI(""+e).replace(YR,"|").replace(zR,"[").replace(KR,"]")}function XR(e){return yv(e).replace(U$,"{").replace(D$,"}").replace(j$,"^")}function Wp(e){return yv(e).replace(L$,"%2B").replace(QR,"+").replace(x$,"%23").replace(WR,"%26").replace(JR,"`").replace(U$,"{").replace(D$,"}").replace(j$,"^")}function ZR(e){return Wp(e).replace(GR,"%3D")}function eO(e){return yv(e).replace(x$,"%23").replace(VR,"%3F")}function tO(e){return e==null?"":eO(e).replace(HR,"%2F")}function mc(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function rO(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<n.length;++i){const a=n[i].replace(L$," "),s=a.indexOf("="),o=mc(s<0?a:a.slice(0,s)),u=s<0?null:mc(a.slice(s+1));if(o in t){let c=t[o];On(c)||(c=t[o]=[c]),c.push(u)}else t[o]=u}return t}function zy(e){let t="";for(let r in e){const n=e[r];if(r=ZR(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(On(n)?n.map(a=>a&&Wp(a)):[n&&Wp(n)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+r,a!=null&&(t+="="+a))})}return t}function nO(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=On(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return t}const iO=Symbol(""),Ky=Symbol(""),tf=Symbol(""),mv=Symbol(""),Hp=Symbol("");function Lo(){let e=[];function t(n){return e.push(n),()=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function ji(e,t,r,n,i){const a=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((s,o)=>{const u=y=>{y===!1?o(Xs(4,{from:r,to:t})):y instanceof Error?o(y):RR(y)?o(Xs(2,{from:t,to:y})):(a&&n.enterCallbacks[i]===a&&typeof y=="function"&&a.push(y),s())},c=e.call(n&&n.instances[i],t,r,u);let d=Promise.resolve(c);e.length<3&&(d=d.then(u)),d.catch(y=>o(y))})}function Hf(e,t,r,n){const i=[];for(const a of e)for(const s in a.components){let o=a.components[s];if(!(t!=="beforeRouteEnter"&&!a.instances[s]))if(aO(o)){const c=(o.__vccOpts||o)[t];c&&i.push(ji(c,r,n,a,s))}else{let u=o();i.push(()=>u.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${a.path}"`));const d=cR(c)?c.default:c;a.components[s]=d;const _=(d.__vccOpts||d)[t];return _&&ji(_,r,n,a,s)()}))}}return i}function aO(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Jy(e){const t=In(tf),r=In(mv),n=Jt(()=>t.resolve(Rt(e.to))),i=Jt(()=>{const{matched:u}=n.value,{length:c}=u,d=u[c-1],y=r.matched;if(!d||!y.length)return-1;const _=y.findIndex(Qs.bind(null,d));if(_>-1)return _;const b=Yy(u[c-2]);return c>1&&Yy(d)===b&&y[y.length-1].path!==b?y.findIndex(Qs.bind(null,u[c-2])):_}),a=Jt(()=>i.value>-1&&uO(r.params,n.value.params)),s=Jt(()=>i.value>-1&&i.value===r.matched.length-1&&O$(r.params,n.value.params));function o(u={}){return oO(u)?t[Rt(e.replace)?"replace":"push"](Rt(e.to)).catch(lu):Promise.resolve()}return{route:n,href:Jt(()=>n.value.href),isActive:a,isExactActive:s,navigate:o}}const sO=a$({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Jy,setup(e,{slots:t}){const r=Ja(Jy(e)),{options:n}=In(tf),i=Jt(()=>({[Qy(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Qy(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const a=t.default&&t.default(r);return e.custom?a:$$("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:i.value},a)}}}),Bs=sO;function oO(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function uO(e,t){for(const r in t){const n=t[r],i=e[r];if(typeof n=="string"){if(n!==i)return!1}else if(!On(i)||i.length!==n.length||n.some((a,s)=>a!==i[s]))return!1}return!0}function Yy(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Qy=(e,t,r)=>e!=null?e:t!=null?t:r,lO=a$({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=In(Hp),i=Jt(()=>e.route||n.value),a=In(Ky,0),s=Jt(()=>{let c=Rt(a);const{matched:d}=i.value;let y;for(;(y=d[c])&&!y.components;)c++;return c}),o=Jt(()=>i.value.matched[s.value]);tc(Ky,Jt(()=>s.value+1)),tc(iO,o),tc(Hp,i);const u=Ye();return iu(()=>[u.value,o.value,e.name],([c,d,y],[_,b,k])=>{d&&(d.instances[y]=c,b&&b!==d&&c&&c===_&&(d.leaveGuards.size||(d.leaveGuards=b.leaveGuards),d.updateGuards.size||(d.updateGuards=b.updateGuards))),c&&d&&(!b||!Qs(d,b)||!_)&&(d.enterCallbacks[y]||[]).forEach(N=>N(c))},{flush:"post"}),()=>{const c=i.value,d=e.name,y=o.value,_=y&&y.components[d];if(!_)return Xy(r.default,{Component:_,route:c});const b=y.props[d],k=b?b===!0?c.params:typeof b=="function"?b(c):b:null,P=$$(_,It({},k,t,{onVnodeUnmounted:j=>{j.component.isUnmounted&&(y.instances[d]=null)},ref:u}));return Xy(r.default,{Component:P,route:c})||P}}});function Xy(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const F$=lO;function cO(e){const t=DR(e.routes,e),r=e.parseQuery||rO,n=e.stringifyQuery||zy,i=e.history,a=Lo(),s=Lo(),o=Lo(),u=vC(Oi);let c=Oi;Os&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=qf.bind(null,$=>""+$),y=qf.bind(null,tO),_=qf.bind(null,mc);function b($,C){let Z,te;return P$($)?(Z=t.getRecordMatcher($),te=C):te=$,t.addRoute(te,Z)}function k($){const C=t.getRecordMatcher($);C&&t.removeRoute(C)}function N(){return t.getRoutes().map($=>$.record)}function P($){return!!t.getRecordMatcher($)}function j($,C){if(C=It({},C||u.value),typeof $=="string"){const $e=Wf(r,$,C.path),E=t.resolve({path:$e.path},C),T=i.createHref($e.fullPath);return It($e,E,{params:_(E.params),hash:mc($e.hash),redirectedFrom:void 0,href:T})}let Z;if("path"in $)Z=It({},$,{path:Wf(r,$.path,C.path).path});else{const $e=It({},$.params);for(const E in $e)$e[E]==null&&delete $e[E];Z=It({},$,{params:y($.params)}),C.params=y(C.params)}const te=t.resolve(Z,C),Ae=$.hash||"";te.params=d(_(te.params));const De=pR(n,It({},$,{hash:XR(Ae),path:te.path})),de=i.createHref(De);return It({fullPath:De,hash:Ae,query:n===zy?nO($.query):$.query||{}},te,{redirectedFrom:void 0,href:de})}function F($){return typeof $=="string"?Wf(r,$,u.value.path):It({},$)}function me($,C){if(c!==$)return Xs(8,{from:C,to:$})}function ce($){return Me($)}function xe($){return ce(It(F($),{replace:!0}))}function Ne($){const C=$.matched[$.matched.length-1];if(C&&C.redirect){const{redirect:Z}=C;let te=typeof Z=="function"?Z($):Z;return typeof te=="string"&&(te=te.includes("?")||te.includes("#")?te=F(te):{path:te},te.params={}),It({query:$.query,hash:$.hash,params:"path"in te?{}:$.params},te)}}function Me($,C){const Z=c=j($),te=u.value,Ae=$.state,De=$.force,de=$.replace===!0,$e=Ne(Z);if($e)return Me(It(F($e),{state:typeof $e=="object"?It({},Ae,$e.state):Ae,force:De,replace:de}),C||Z);const E=Z;E.redirectedFrom=C;let T;return!De&&hR(n,te,Z)&&(T=Xs(16,{to:E,from:te}),ft(te,te,!0,!1)),(T?Promise.resolve(T):le(E,te)).catch(V=>Xn(V)?Xn(V,2)?V:je(V):be(V,E,te)).then(V=>{if(V){if(Xn(V,2))return Me(It({replace:de},F(V.to),{state:typeof V.to=="object"?It({},Ae,V.to.state):Ae,force:De}),C||E)}else V=Re(E,te,!0,de,Ae);return D(E,te,V),V})}function x($,C){const Z=me($,C);return Z?Promise.reject(Z):Promise.resolve()}function le($,C){let Z;const[te,Ae,De]=fO($,C);Z=Hf(te.reverse(),"beforeRouteLeave",$,C);for(const $e of te)$e.leaveGuards.forEach(E=>{Z.push(ji(E,$,C))});const de=x.bind(null,$,C);return Z.push(de),gs(Z).then(()=>{Z=[];for(const $e of a.list())Z.push(ji($e,$,C));return Z.push(de),gs(Z)}).then(()=>{Z=Hf(Ae,"beforeRouteUpdate",$,C);for(const $e of Ae)$e.updateGuards.forEach(E=>{Z.push(ji(E,$,C))});return Z.push(de),gs(Z)}).then(()=>{Z=[];for(const $e of $.matched)if($e.beforeEnter&&!C.matched.includes($e))if(On($e.beforeEnter))for(const E of $e.beforeEnter)Z.push(ji(E,$,C));else Z.push(ji($e.beforeEnter,$,C));return Z.push(de),gs(Z)}).then(()=>($.matched.forEach($e=>$e.enterCallbacks={}),Z=Hf(De,"beforeRouteEnter",$,C),Z.push(de),gs(Z))).then(()=>{Z=[];for(const $e of s.list())Z.push(ji($e,$,C));return Z.push(de),gs(Z)}).catch($e=>Xn($e,8)?$e:Promise.reject($e))}function D($,C,Z){for(const te of o.list())te($,C,Z)}function Re($,C,Z,te,Ae){const De=me($,C);if(De)return De;const de=C===Oi,$e=Os?history.state:{};Z&&(te||de?i.replace($.fullPath,It({scroll:de&&$e&&$e.scroll},Ae)):i.push($.fullPath,Ae)),u.value=$,ft($,C,Z,de),je()}let Ie;function ue(){Ie||(Ie=i.listen(($,C,Z)=>{if(!Y.listening)return;const te=j($),Ae=Ne(te);if(Ae){Me(It(Ae,{replace:!0}),te).catch(lu);return}c=te;const De=u.value;Os&&SR(Dy(De.fullPath,Z.delta),ef()),le(te,De).catch(de=>Xn(de,12)?de:Xn(de,2)?(Me(de.to,te).then($e=>{Xn($e,20)&&!Z.delta&&Z.type===Tu.pop&&i.go(-1,!1)}).catch(lu),Promise.reject()):(Z.delta&&i.go(-Z.delta,!1),be(de,te,De))).then(de=>{de=de||Re(te,De,!1),de&&(Z.delta&&!Xn(de,8)?i.go(-Z.delta,!1):Z.type===Tu.pop&&Xn(de,20)&&i.go(-1,!1)),D(te,De,de)}).catch(lu)}))}let ee=Lo(),se=Lo(),ne;function be($,C,Z){je($);const te=se.list();return te.length?te.forEach(Ae=>Ae($,C,Z)):console.error($),Promise.reject($)}function O(){return ne&&u.value!==Oi?Promise.resolve():new Promise(($,C)=>{ee.add([$,C])})}function je($){return ne||(ne=!$,ue(),ee.list().forEach(([C,Z])=>$?Z($):C()),ee.reset()),$}function ft($,C,Z,te){const{scrollBehavior:Ae}=e;if(!Os||!Ae)return Promise.resolve();const De=!Z&&$R(Dy($.fullPath,0))||(te||!Z)&&history.state&&history.state.scroll||null;return lv().then(()=>Ae($,C,De)).then(de=>de&&_R(de)).catch(de=>be(de,$,C))}const Je=$=>i.go($);let fe;const G=new Set,Y={currentRoute:u,listening:!0,addRoute:b,removeRoute:k,hasRoute:P,getRoutes:N,resolve:j,options:e,push:ce,replace:xe,go:Je,back:()=>Je(-1),forward:()=>Je(1),beforeEach:a.add,beforeResolve:s.add,afterEach:o.add,onError:se.add,isReady:O,install($){const C=this;$.component("RouterLink",Bs),$.component("RouterView",F$),$.config.globalProperties.$router=C,Object.defineProperty($.config.globalProperties,"$route",{enumerable:!0,get:()=>Rt(u)}),Os&&!fe&&u.value===Oi&&(fe=!0,ce(i.location).catch(Ae=>{}));const Z={};for(const Ae in Oi)Z[Ae]=Jt(()=>u.value[Ae]);$.provide(tf,C),$.provide(mv,Ja(Z)),$.provide(Hp,u);const te=$.unmount;G.add($),$.unmount=function(){G.delete($),G.size<1&&(c=Oi,Ie&&Ie(),Ie=null,u.value=Oi,fe=!1,ne=!1),te()}}};return Y}function gs(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function fO(e,t){const r=[],n=[],i=[],a=Math.max(t.matched.length,e.matched.length);for(let s=0;s<a;s++){const o=t.matched[s];o&&(e.matched.find(c=>Qs(c,o))?n.push(o):r.push(o));const u=e.matched[s];u&&(t.matched.find(c=>Qs(c,u))||i.push(u))}return[r,n,i]}function B$(){return In(tf)}function q$(){return In(mv)}const dO={__name:"App",setup(e){return(t,r)=>(qe(),Rn(Rt(F$)))}},Ya=Zc("list",{state:()=>({lists:[]}),getters:{},actions:{async getAllSyncLists(){try{const t=await fetch("/sync/list-all",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.lists=r}}catch(e){console.log("getAllSyncLists error => ",e)}}}}),co=Zc("agent",{state:()=>({agent:{identity:null,accessToken:""},agents:[]}),getters:{},actions:{async getToken(){try{let e=`/auth/token?identity=${this.agent.identity}`;const t=await fetch(e,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.agent.accessToken=r.accessToken,console.log("token value set...")}}catch(e){console.log("getToken error => ",e)}},async getAgents(){const t=Ya().lists.find(r=>r.uniqueName==="AgentList");try{let r=`/sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();this.agents=i.map(a=>a.data.Identity).sort((a,s)=>a.localeCompare(s,void 0,{sensitivity:"base"}))}}catch(r){console.log("getAgents error => ",r)}}}}),hi=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},pO={name:"Header",setup(){return{agentStore:co()}}},hO={class:"container-fluid"},vO={class:"d-flex flex-wrap justify-content-center py-3 mb-2 border-bottom"},gO=M("img",{class:"me-4",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"},null,-1),yO=M("span",{class:"fs-4",style:{color:"#f22f46"}},"Conversations (Agent)",-1),mO={class:"nav nav-pills"},bO={class:"nav-item"},wO=M("i",{class:"bi-house"},null,-1),_O=Ze(" Home"),SO={key:0,class:"nav-item"},$O=M("i",{class:"bi-chat-left-dots-fill"},null,-1),kO=Ze(" Conversations"),TO={key:1,class:"nav-item"},EO=M("i",{class:"bi-person"},null,-1),CO={key:2,class:"nav-item"},IO=M("i",{class:"bi-box-arrow-in-right"},null,-1),RO=Ze(" Login");function OO(e,t,r,n,i,a){const s=Tr("router-link");return qe(),ze("div",hO,[M("header",vO,[wt(s,{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",to:"/"},{default:sr(()=>[gO,yO]),_:1}),M("ul",mO,[M("li",bO,[wt(s,{class:"nav-link",to:"/"},{default:sr(()=>[wO,_O]),_:1})]),n.agentStore.agent.identity!=null?(qe(),ze("li",SO,[wt(s,{class:"nav-link",to:"/conversations"},{default:sr(()=>[$O,kO]),_:1})])):Yt("",!0),n.agentStore.agent.identity!=null?(qe(),ze("li",TO,[wt(s,{class:"nav-link",to:"/agent"},{default:sr(()=>[EO,Ze(" "+bt(n.agentStore.agent.identity),1)]),_:1})])):Yt("",!0),n.agentStore.agent.identity===null?(qe(),ze("li",CO,[wt(s,{class:"btn btn-warning btn-sm",to:"/login"},{default:sr(()=>[IO,RO]),_:1})])):Yt("",!0)])])])}const AO=hi(pO,[["render",OO]]),PO={name:"Footer"},MO={class:"footer mt-auto py-3 bg-light pb-5"},NO=M("div",{class:"container text-center pb-5"},[M("img",{class:"",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"})],-1),xO=[NO];function LO(e,t,r,n,i,a){return qe(),ze("footer",MO,xO)}const jO=hi(PO,[["render",LO]]),UO={name:"Layout",components:{Header:AO,Footer:jO}};function DO(e,t,r,n,i,a){const s=Tr("Header"),o=Tr("Footer");return qe(),ze("div",null,[wt(s),YC(e.$slots,"default"),wt(o)])}const Lu=hi(UO,[["render",DO]]),FO={class:"container-fluid"},BO={class:"row"},qO={class:"col pt-5"},WO=M("h2",null,"Twilio Conversations",-1),HO=M("p",{class:"mt-5 fs-3"},[M("b",null,"A single API for seamless conversational messaging"),M("br"),Ze(" Integrate once and extend across customers\u2019 preferred channels to support scalable, multiparty conversations. ")],-1),GO=M("p",{class:"lead fs-3 mb-5"}," This demo gives demonstrates an agent or administrator view into an multi channel communication tool powered by Twilio Conversations. ",-1),VO={class:"text-center mt-5"},zO=M("i",{class:"bi-chat-left-dots-fill"},null,-1),KO=Ze(" Conversations "),JO=M("i",{class:"bi-box-arrow-in-right"},null,-1),YO=Ze(" Login "),QO=M("div",{class:"col"},[M("div",{class:"text-center pt-5 pb-5"},[M("img",{class:"img-fluid",style:{"max-width":"600px"},src:"https://twilio-cms-prod.s3.amazonaws.com/images/diagram-conversat.width-1200.format-webp.webpquality-75.webp"})])],-1),XO={__name:"Home",setup(e){const t=Ya(),r=co();return o$(async()=>{t.lists.length===0&&await t.getAllSyncLists()}),(n,i)=>(qe(),ze("div",FO,[M("div",BO,[M("div",qO,[WO,HO,GO,M("div",VO,[Rt(r).agent.identity!=null?(qe(),Rn(Rt(Bs),{key:0,class:"btn btn-lg btn-primary",to:"/conversations"},{default:sr(()=>[zO,KO]),_:1})):Yt("",!0),Rt(r).agent.identity===null?(qe(),Rn(Rt(Bs),{key:1,class:"btn btn-lg btn-warning",to:"/login"},{default:sr(()=>[JO,YO]),_:1})):Yt("",!0)])]),QO])]))}},ZO={name:"App",components:{Layout:Lu,Home:XO}};function eA(e,t,r,n,i,a){const s=Tr("Home"),o=Tr("Layout");return qe(),Rn(o,null,{default:sr(()=>[wt(s)]),_:1})}const tA=hi(ZO,[["render",eA]]),W$=Zc("webhooks",{state:()=>({webhooks:[]}),getters:{},actions:{async getWebhooks(){const t=Ya().lists.find(r=>r.uniqueName==="WebhookList");try{let r=`/sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();this.webhooks=i}}catch(r){console.log("in webhookStore getWebhooks error => ",r)}}}}),H$=Zc("chatButtons",{state:()=>({chatbuttons:[]}),getters:{},actions:{async getChatButtons(){const t=Ya().lists.find(r=>r.uniqueName==="ChatButtonList");try{let r=`/sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();this.chatbuttons=i}}catch(r){console.log("in chatButtonStore getChatButtons error => ",r)}}}}),rA={class:"container-fluid pt-5 pb-5"},nA={class:"alert alert-success text-center fw-bold mb-5"},iA=M("i",{class:"bi-house"},null,-1),aA=Ze(" Home "),sA=M("i",{class:"bi-chat-left-dots-fill"},null,-1),oA=Ze(" Conversations "),uA=M("i",{class:"bi-person"},null,-1),lA=Ze(" Agent "),cA={class:"d-flex justify-content-center mt-3 mb-5"},fA=M("ul",{class:"nav nav-pills mb-3",id:"myTab",role:"tablist"},[M("li",{class:"nav-item",role:"presentation"},[M("button",{class:"nav-link active",id:"login-tab","data-bs-toggle":"tab","data-bs-target":"#login",type:"button",role:"tab","aria-controls":"login","aria-selected":"false"},"Existing Agent Login")]),M("li",{class:"nav-item",role:"presentation"},[M("button",{class:"nav-link",id:"create-tab","data-bs-toggle":"tab","data-bs-target":"#create",type:"button",role:"tab","aria-controls":"create","aria-selected":"true"},"Create Agent")])],-1),dA={class:"tab-content"},pA={class:"tab-pane",id:"create",role:"tabpanel","aria-labelledby":"create-tab"},hA={class:"card p-5",style:{width:"36rem"}},vA={class:"mb-3"},gA=M("label",{for:"exampleFormControlInput1",class:"form-label"},"Agent",-1),yA={class:"d-grid"},mA=M("i",{class:"bi-person-plus"},null,-1),bA=Ze(" Create Agent "),wA=[mA,bA],_A={class:"tab-pane active",id:"login",role:"tabpanel","aria-labelledby":"login-tab"},SA={class:"card p-5",style:{width:"36rem"}},$A={class:"mb-3"},kA=M("label",{for:"exampleFormControlInput1",class:"form-label"},"Agent",-1),TA=["value"],EA={class:"d-grid"},CA=M("i",{class:"bi-box-arrow-in-right"},null,-1),IA=Ze(" Login "),RA=[CA,IA],OA={__name:"Login",setup(e){const t=Ya(),r=W$(),n=H$(),i=co(),a=B$(),s=t.lists.find(_=>_.uniqueName==="AgentList"),o=Ye(""),u=Ye(""),c=async()=>{let _={Identity:o.value},b=`/sync/list-item-create?targetList=${s.sid}`;const k=await fetch(b,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:_})});if(k.ok)await k.json(),i.agent.identity=o.value,await i.getToken(),y();else return!1},d=async()=>{i.agent.identity=u.value,await i.getToken(),y()};function y(){a.replace({name:"conversations"})}return lo(async()=>{await i.getAgents(),await r.getWebhooks(),await n.getChatButtons()}),(_,b)=>(qe(),ze("div",rA,[He(M("div",nA,[Ze(" You are logged in as "+bt(Rt(i).agent.identity)+" ",1),wt(Rt(Bs),{class:"btn btn-sm btn-primary",to:"/"},{default:sr(()=>[iA,aA]),_:1}),wt(Rt(Bs),{class:"btn btn-sm btn-primary ms-2",to:"/conversations"},{default:sr(()=>[sA,oA]),_:1}),wt(Rt(Bs),{class:"btn btn-sm btn-primary ms-2",to:"/agent"},{default:sr(()=>[uA,lA]),_:1})],512),[[it,Rt(i).agent.identity!==null]]),He(M("div",null,[M("div",cA,[M("div",null,[fA,M("div",dA,[M("div",pA,[M("div",hA,[M("div",vA,[gA,He(M("input",{type:"text","onUpdate:modelValue":b[0]||(b[0]=k=>o.value=k),class:"form-control",id:"exampleFormControlInput1",placeholder:""},null,512),[[Na,o.value]])]),M("div",yA,[M("button",{onClick:b[1]||(b[1]=k=>c()),class:"btn btn-primary btn-lg"},wA)])])]),M("div",_A,[M("div",SA,[M("div",$A,[kA,He(M("select",{class:"form-select","onUpdate:modelValue":b[2]||(b[2]=k=>u.value=k)},[(qe(!0),ze(qt,null,Dr(Rt(i).agents,k=>(qe(),ze("option",{key:k,value:k},bt(k),9,TA))),128))],512),[[ou,u.value]])]),M("div",EA,[M("button",{onClick:b[3]||(b[3]=k=>d()),class:"btn btn-success btn-lg"},RA)])])])])])])],512),[[it,Rt(i).agent.identity===null]])]))}},AA={name:"App",components:{Layout:Lu,Login:OA}};function PA(e,t,r,n,i,a){const s=Tr("Login"),o=Tr("Layout");return qe(),Rn(o,null,{default:sr(()=>[wt(s)]),_:1})}const MA=hi(AA,[["render",PA]]),NA={class:"container-fluid"},xA={class:"card text-dark bg-light mt-5 mb-5"},LA=M("div",{class:"card-header fs-4"},[M("i",{class:"bi-person-workspace me-2"}),M("b",null,"Agent")],-1),jA={class:"card-body"},UA={class:"card-title fs-2 mb-5"},DA=M("p",{class:"card-text fs-5 mb-5"}," In order order to enter a conversation, you need a valid access token. ",-1),FA={class:"card-text fs-5 mb-5"},BA=M("i",{class:"bi-recycle"},null,-1),qA=Ze(" Refresh Token "),WA=[BA,qA],HA={class:"spinner-border",role:"status"},GA=M("span",{class:"visually-hidden"},"Loading...",-1),VA=[GA],zA={disabled:"",class:"btn btn-success"},KA=M("i",{class:"bi-check"},null,-1),JA=Ze(" Token Refreshed "),YA=[KA,JA],QA=M("i",{class:"bi-eye"},null,-1),XA=Ze(" View Token "),ZA=[QA,XA],eP={class:"text-break mb-5 p-2 bg-warning"},tP=M("i",{class:"bi-box-arrow-left"},null,-1),rP=Ze(" Logout "),nP=[tP,rP],iP={__name:"Agent",setup(e){const t=co(),r=Jt(()=>t.agent.accessToken!=""),n=Ye(!1),i=Ye(!1),a=Ye(!1),s=async()=>{i.value=!0,await t.getToken(),i.value=!1,a.value=!0};function o(){t.$reset(),n.value=!1,i.value=!1,a.value=!1}return(u,c)=>(qe(),ze("div",NA,[M("div",xA,[LA,M("div",jA,[M("h5",UA,[M("b",null,bt(Rt(t).agent.identity),1)]),DA,M("p",FA,[He(M("button",{onClick:c[0]||(c[0]=d=>s()),class:"btn btn-primary"},[He(M("span",null,WA,512),[[it,!i.value]]),He(M("div",HA,VA,512),[[it,i.value]])],512),[[it,Rt(r)&&!a.value]]),He(M("button",zA,YA,512),[[it,a.value]]),He(M("button",{onClick:c[1]||(c[1]=d=>n.value=!n.value),class:"btn btn-warning ms-2"},ZA,512),[[it,Rt(r)]])]),He(M("p",eP,[M("i",null,bt(Rt(t).agent.accessToken),1)],512),[[it,n.value]]),M("p",null,[He(M("button",{onClick:c[2]||(c[2]=d=>o()),class:"btn btn-danger float-end"},nP,512),[[it,Rt(r)]])])])])]))}},aP={name:"App",components:{Layout:Lu,Agent:iP}};function sP(e,t,r,n,i,a){const s=Tr("Agent"),o=Tr("Layout");return qe(),Rn(o,null,{default:sr(()=>[wt(s)]),_:1})}const oP=hi(aP,[["render",sP]]);function G$(e){let t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} @ ${t.getHours()}:${String(t.getMinutes()).padStart(2,"0")}`}const uP={class:"container-fluid pt-4"},lP=M("i",{class:"bi bi-arrow-clockwise"},null,-1),cP=Ze(" Refresh "),fP=[lP,cP],dP=M("h3",null,"Conversations",-1),pP={class:"table table-striped mt-4 mb-5 fs-4"},hP=M("thead",null,[M("tr",null,[M("th",{class:"text-center"},"Friendly Name"),M("th",{class:"text-center"},"Type"),M("th",{class:"text-center"},"Chat ID"),M("th",{class:"text-center"},"Date Created"),M("th",{class:"text-center"},"\xA0")])],-1),vP={class:"text-center"},gP={class:"text-center"},yP={class:"text-center"},mP={class:"text-center"},bP={class:"text-center"},wP=["onClick"],_P=M("i",{class:"bi-play-fill"},null,-1),SP=Ze(" Enter "),$P=[_P,SP],kP=["onClick"],TP=M("i",{class:"bi-trash"},null,-1),EP=[TP],CP={class:"row pb-5"},IP={class:"col-6"},RP=M("i",{class:"bi-plus-circle-fill me-1"},null,-1),OP=Ze(" Create New Conversation "),AP=[RP,OP],PP={class:"card text-bg-warning mb-3"},MP=M("div",{class:"card-header fs-3"},"Create a new conversation",-1),NP={class:"card-body"},xP={class:"form-group mb-3"},LP=M("label",{for:"conversationType "},[M("span",{class:"fw-bold fs-4"},"Conversation Type")],-1),jP=["value"],UP={class:"form-group mb-3"},DP=M("label",{for:"friendlyName "},[M("span",{class:"fw-bold fs-4"},"Friendly Name")],-1),FP={class:"form-group"},BP={class:"d-grid gap-2"},qP=M("i",{class:"bi-plus-circle-fill me-2"},null,-1),WP=Ze(" Create "),HP=[qP,WP],GP={__name:"Conversations",setup(e){const t=co();q$();const r=Ye([]),n=async()=>{try{const y=await fetch("/conversations/return-conversations",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(y.ok){let _=await y.json();r.value=_;for(let b=0;b<r.value.length;b++)Object.keys(r.value[b].attributes).length>0&&(r.value[b].attributes=JSON.parse(r.value[b].attributes)),(r.value[b].attributes.conversationType===void 0||r.value[b].attributes.conversationType==="")&&(r.value[b].attributes.conversationType="Support"),(r.value[b].friendlyName===null||r.value[b].friendlyName==="")&&(r.value[b].friendlyName="no name...")}}catch(d){console.log("getConversations error => ",d)}},i=Ye(""),a=Ye(!1),s=Ye("Support"),o=Ye(["Support","ChatChannel"]),u=async()=>{let d={conversationType:s.value,createdBy:t.agent.identity};try{(await fetch("/conversations/conversation-create",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationName:i.value,attributes:d}})})).ok?(console.log("Success! Created a new conversation..."),i.value="",a.value=!1,n()):console.log("Error! Unable to create new conversation...")}catch(y){console.log("createNewConversation error => ",y)}},c=async d=>{try{(await fetch("/conversations/conversation-delete",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:d}})})).ok&&(console.log("Success! Conversation deleted..."),n())}catch(y){console.log("deleteConversations error => ",y)}};return lo(()=>{n()}),(d,y)=>{const _=Tr("router-link");return qe(),ze("div",uP,[M("button",{onClick:y[0]||(y[0]=b=>n()),class:"float-end btn btn-lg btn-secondary"},fP),dP,M("table",pP,[hP,M("tbody",null,[(qe(!0),ze(qt,null,Dr(r.value,b=>(qe(),ze("tr",{key:b.sid},[M("td",vP,bt(b.friendlyName),1),M("td",gP,bt(b.attributes.conversationType),1),M("td",yP,bt(b.sid),1),M("td",mP,bt(Rt(G$)(b.dateCreated)),1),M("td",bP,[wt(_,{to:{name:"conversation",params:{sid:b.sid}},custom:""},{default:sr(({navigate:k})=>[M("button",{class:"btn btn-primary",onClick:k},$P,8,wP)]),_:2},1032,["to"]),M("button",{class:"btn btn-danger ms-2",onClick:k=>c(b.sid)},EP,8,kP)])]))),128))])]),M("div",CP,[M("div",IP,[He(M("button",{type:"button",class:"btn btn-info",onClick:y[1]||(y[1]=b=>a.value=!0)},AP,512),[[it,!a.value]]),He(M("div",PP,[MP,M("div",NP,[M("div",xP,[LP,He(M("select",{class:"form-select form-control-lg","onUpdate:modelValue":y[2]||(y[2]=b=>s.value=b)},[(qe(!0),ze(qt,null,Dr(o.value,b=>(qe(),ze("option",{key:b,value:b},bt(b),9,jP))),128))],512),[[ou,s.value]])]),M("div",UP,[DP,He(M("input",{type:"text","onUpdate:modelValue":y[3]||(y[3]=b=>i.value=b),class:"form-control form-control-lg"},null,512),[[Na,i.value]])]),M("div",FP,[M("div",BP,[M("button",{type:"button",class:"btn btn-success btn-block",onClick:y[4]||(y[4]=b=>u())},HP)])])])],512),[[it,a.value]])])])])}}},VP={name:"App",components:{Layout:Lu,Conversations:GP}};function zP(e,t,r,n,i,a){const s=Tr("Conversations"),o=Tr("Layout");return qe(),Rn(o,null,{default:sr(()=>[wt(s)]),_:1})}const KP=hi(VP,[["render",zP]]);function V$(e){return e?e.replace("EndUser:",""):""}function Sa(e,t,r){let n={displayName:r,avatar:JP(),sms:!1,chat:!1,whatsapp:!1,enduser:!1,agent:!1,bot:!1};switch(e){case"sms":n.sms=!0;break;case"chat":n.chat=!0;break;case"whatsapp":n.whatsapp=!0;break}switch(t){case"enduser":n.enduser=!0;break;case"agent":n.agent=!0;break;case"bot":n.bot=!0;break}return JSON.stringify(n)}function JP(){let e=1,t=700;return`https://picsum.photos/id/${Math.floor(Math.random()*(t-e+1)+e)}/50`}var kn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function YP(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var z$={},_l=function(e){return e&&e.Math==Math&&e},dt=_l(typeof globalThis=="object"&&globalThis)||_l(typeof window=="object"&&window)||_l(typeof self=="object"&&self)||_l(typeof kn=="object"&&kn)||function(){return this}()||Function("return this")(),Hn={},nt=function(e){try{return!!e()}catch{return!0}},QP=nt,Wt=!QP(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),XP=nt,ju=!XP(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),ZP=ju,Sl=Function.prototype.call,Mt=ZP?Sl.bind(Sl):function(){return Sl.apply(Sl,arguments)},Uu={},K$={}.propertyIsEnumerable,J$=Object.getOwnPropertyDescriptor,eM=J$&&!K$.call({1:2},1);Uu.f=eM?function(t){var r=J$(this,t);return!!r&&r.enumerable}:K$;var Qa=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},Y$=ju,Q$=Function.prototype,tM=Q$.bind,Gp=Q$.call,rM=Y$&&tM.bind(Gp,Gp),et=Y$?function(e){return e&&rM(e)}:function(e){return e&&function(){return Gp.apply(e,arguments)}},X$=et,nM=X$({}.toString),iM=X$("".slice),ta=function(e){return iM(nM(e),8,-1)},aM=et,sM=nt,oM=ta,Gf=Object,uM=aM("".split),Du=sM(function(){return!Gf("z").propertyIsEnumerable(0)})?function(e){return oM(e)=="String"?uM(e,""):Gf(e)}:Gf,Gn=function(e){return e==null},lM=Gn,cM=TypeError,Vn=function(e){if(lM(e))throw cM("Can't call method on "+e);return e},fM=Du,dM=Vn,Hr=function(e){return fM(dM(e))},Nt=function(e){return typeof e=="function"},Zy=Nt,Vp=typeof document=="object"&&document.all,pM=typeof Vp>"u"&&Vp!==void 0,Vt=pM?function(e){return typeof e=="object"?e!==null:Zy(e)||e===Vp}:function(e){return typeof e=="object"?e!==null:Zy(e)},Vf=dt,hM=Nt,vM=function(e){return hM(e)?e:void 0},fn=function(e,t){return arguments.length<2?vM(Vf[e]):Vf[e]&&Vf[e][t]},gM=et,vi=gM({}.isPrototypeOf),yM=fn,Xa=yM("navigator","userAgent")||"",Z$=dt,zf=Xa,em=Z$.process,tm=Z$.Deno,rm=em&&em.versions||tm&&tm.version,nm=rm&&rm.v8,wn,bc;nm&&(wn=nm.split("."),bc=wn[0]>0&&wn[0]<4?1:+(wn[0]+wn[1]));!bc&&zf&&(wn=zf.match(/Edge\/(\d+)/),(!wn||wn[1]>=74)&&(wn=zf.match(/Chrome\/(\d+)/),wn&&(bc=+wn[1])));var Za=bc,im=Za,mM=nt,fo=!!Object.getOwnPropertySymbols&&!mM(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&im&&im<41}),bM=fo,ek=bM&&!Symbol.sham&&typeof Symbol.iterator=="symbol",wM=fn,_M=Nt,SM=vi,$M=ek,kM=Object,po=$M?function(e){return typeof e=="symbol"}:function(e){var t=wM("Symbol");return _M(t)&&SM(t.prototype,kM(e))},TM=String,es=function(e){try{return TM(e)}catch{return"Object"}},EM=Nt,CM=es,IM=TypeError,An=function(e){if(EM(e))return e;throw IM(CM(e)+" is not a function")},RM=An,OM=Gn,ts=function(e,t){var r=e[t];return OM(r)?void 0:RM(r)},Kf=Mt,Jf=Nt,Yf=Vt,AM=TypeError,PM=function(e,t){var r,n;if(t==="string"&&Jf(r=e.toString)&&!Yf(n=Kf(r,e))||Jf(r=e.valueOf)&&!Yf(n=Kf(r,e))||t!=="string"&&Jf(r=e.toString)&&!Yf(n=Kf(r,e)))return n;throw AM("Can't convert object to primitive value")},rs={exports:{}},MM=!1,am=dt,NM=Object.defineProperty,bv=function(e,t){try{NM(am,e,{value:t,configurable:!0,writable:!0})}catch{am[e]=t}return t},xM=dt,LM=bv,sm="__core-js_shared__",jM=xM[sm]||LM(sm,{}),wv=jM,om=wv;(rs.exports=function(e,t){return om[e]||(om[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.25.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.1/LICENSE",source:"https://github.com/zloirock/core-js"});var UM=Vn,DM=Object,yr=function(e){return DM(UM(e))},FM=et,BM=yr,qM=FM({}.hasOwnProperty),zt=Object.hasOwn||function(t,r){return qM(BM(t),r)},WM=et,HM=0,GM=Math.random(),VM=WM(1 .toString),Fu=function(e){return"Symbol("+(e===void 0?"":e)+")_"+VM(++HM+GM,36)},zM=dt,KM=rs.exports,um=zt,JM=Fu,lm=fo,tk=ek,ys=KM("wks"),qa=zM.Symbol,cm=qa&&qa.for,YM=tk?qa:qa&&qa.withoutSetter||JM,Ot=function(e){if(!um(ys,e)||!(lm||typeof ys[e]=="string")){var t="Symbol."+e;lm&&um(qa,e)?ys[e]=qa[e]:tk&&cm?ys[e]=cm(t):ys[e]=YM(t)}return ys[e]},QM=Mt,fm=Vt,dm=po,XM=ts,ZM=PM,e2=Ot,t2=TypeError,r2=e2("toPrimitive"),_v=function(e,t){if(!fm(e)||dm(e))return e;var r=XM(e,r2),n;if(r){if(t===void 0&&(t="default"),n=QM(r,e,t),!fm(n)||dm(n))return n;throw t2("Can't convert object to primitive value")}return t===void 0&&(t="number"),ZM(e,t)},n2=_v,i2=po,Bu=function(e){var t=n2(e,"string");return i2(t)?t:t+""},a2=dt,pm=Vt,zp=a2.document,s2=pm(zp)&&pm(zp.createElement),rf=function(e){return s2?zp.createElement(e):{}},o2=Wt,u2=nt,l2=rf,rk=!o2&&!u2(function(){return Object.defineProperty(l2("div"),"a",{get:function(){return 7}}).a!=7}),c2=Wt,f2=Mt,d2=Uu,p2=Qa,h2=Hr,v2=Bu,g2=zt,y2=rk,hm=Object.getOwnPropertyDescriptor;Hn.f=c2?hm:function(t,r){if(t=h2(t),r=v2(r),y2)try{return hm(t,r)}catch{}if(g2(t,r))return p2(!f2(d2.f,t,r),t[r])};var Zt={},m2=Wt,b2=nt,nk=m2&&b2(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),w2=Vt,_2=String,S2=TypeError,er=function(e){if(w2(e))return e;throw S2(_2(e)+" is not an object")},$2=Wt,k2=rk,T2=nk,$l=er,vm=Bu,E2=TypeError,Qf=Object.defineProperty,C2=Object.getOwnPropertyDescriptor,Xf="enumerable",Zf="configurable",ed="writable";Zt.f=$2?T2?function(t,r,n){if($l(t),r=vm(r),$l(n),typeof t=="function"&&r==="prototype"&&"value"in n&&ed in n&&!n[ed]){var i=C2(t,r);i&&i[ed]&&(t[r]=n.value,n={configurable:Zf in n?n[Zf]:i[Zf],enumerable:Xf in n?n[Xf]:i[Xf],writable:!1})}return Qf(t,r,n)}:Qf:function(t,r,n){if($l(t),r=vm(r),$l(n),k2)try{return Qf(t,r,n)}catch{}if("get"in n||"set"in n)throw E2("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var I2=Wt,R2=Zt,O2=Qa,gi=I2?function(e,t,r){return R2.f(e,t,O2(1,r))}:function(e,t,r){return e[t]=r,e},Sv={exports:{}},Kp=Wt,A2=zt,ik=Function.prototype,P2=Kp&&Object.getOwnPropertyDescriptor,$v=A2(ik,"name"),M2=$v&&function(){}.name==="something",N2=$v&&(!Kp||Kp&&P2(ik,"name").configurable),qu={EXISTS:$v,PROPER:M2,CONFIGURABLE:N2},x2=et,L2=Nt,Jp=wv,j2=x2(Function.toString);L2(Jp.inspectSource)||(Jp.inspectSource=function(e){return j2(e)});var kv=Jp.inspectSource,U2=dt,D2=Nt,gm=U2.WeakMap,F2=D2(gm)&&/native code/.test(String(gm)),B2=rs.exports,q2=Fu,ym=B2("keys"),nf=function(e){return ym[e]||(ym[e]=q2(e))},Wu={},W2=F2,ak=dt,td=et,H2=Vt,G2=gi,rd=zt,nd=wv,V2=nf,z2=Wu,mm="Object already initialized",Yp=ak.TypeError,K2=ak.WeakMap,wc,Eu,_c,J2=function(e){return _c(e)?Eu(e):wc(e,{})},Y2=function(e){return function(t){var r;if(!H2(t)||(r=Eu(t)).type!==e)throw Yp("Incompatible receiver, "+e+" required");return r}};if(W2||nd.state){var $a=nd.state||(nd.state=new K2),Q2=td($a.get),bm=td($a.has),X2=td($a.set);wc=function(e,t){if(bm($a,e))throw Yp(mm);return t.facade=e,X2($a,e,t),t},Eu=function(e){return Q2($a,e)||{}},_c=function(e){return bm($a,e)}}else{var ms=V2("state");z2[ms]=!0,wc=function(e,t){if(rd(e,ms))throw Yp(mm);return t.facade=e,G2(e,ms,t),t},Eu=function(e){return rd(e,ms)?e[ms]:{}},_c=function(e){return rd(e,ms)}}var dn={set:wc,get:Eu,has:_c,enforce:J2,getterFor:Y2},Z2=nt,eN=Nt,kl=zt,Qp=Wt,tN=qu.CONFIGURABLE,rN=kv,sk=dn,nN=sk.enforce,iN=sk.get,nc=Object.defineProperty,aN=Qp&&!Z2(function(){return nc(function(){},"length",{value:8}).length!==8}),sN=String(String).split("String"),oN=Sv.exports=function(e,t,r){String(t).slice(0,7)==="Symbol("&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!kl(e,"name")||tN&&e.name!==t)&&(Qp?nc(e,"name",{value:t,configurable:!0}):e.name=t),aN&&r&&kl(r,"arity")&&e.length!==r.arity&&nc(e,"length",{value:r.arity});try{r&&kl(r,"constructor")&&r.constructor?Qp&&nc(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=nN(e);return kl(n,"source")||(n.source=sN.join(typeof t=="string"?t:"")),e};Function.prototype.toString=oN(function(){return eN(this)&&iN(this).source||rN(this)},"toString");var uN=Nt,lN=Zt,cN=Sv.exports,fN=bv,mr=function(e,t,r,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:t;if(uN(r)&&cN(r,a,n),n.global)i?e[t]=r:fN(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:lN.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},ra={},dN=Math.ceil,pN=Math.floor,hN=Math.trunc||function(t){var r=+t;return(r>0?pN:dN)(r)},vN=hN,yi=function(e){var t=+e;return t!==t||t===0?0:vN(t)},gN=yi,yN=Math.max,mN=Math.min,ns=function(e,t){var r=gN(e);return r<0?yN(r+t,0):mN(r,t)},bN=yi,wN=Math.min,mi=function(e){return e>0?wN(bN(e),9007199254740991):0},_N=mi,br=function(e){return _N(e.length)},SN=Hr,$N=ns,kN=br,wm=function(e){return function(t,r,n){var i=SN(t),a=kN(i),s=$N(n,a),o;if(e&&r!=r){for(;a>s;)if(o=i[s++],o!=o)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===r)return e||s||0;return!e&&-1}},af={includes:wm(!0),indexOf:wm(!1)},TN=et,id=zt,EN=Hr,CN=af.indexOf,IN=Wu,_m=TN([].push),ok=function(e,t){var r=EN(e),n=0,i=[],a;for(a in r)!id(IN,a)&&id(r,a)&&_m(i,a);for(;t.length>n;)id(r,a=t[n++])&&(~CN(i,a)||_m(i,a));return i},Tv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],RN=ok,ON=Tv,AN=ON.concat("length","prototype");ra.f=Object.getOwnPropertyNames||function(t){return RN(t,AN)};var Hu={};Hu.f=Object.getOwnPropertySymbols;var PN=fn,MN=et,NN=ra,xN=Hu,LN=er,jN=MN([].concat),uk=PN("Reflect","ownKeys")||function(t){var r=NN.f(LN(t)),n=xN.f;return n?jN(r,n(t)):r},Sm=zt,UN=uk,DN=Hn,FN=Zt,lk=function(e,t,r){for(var n=UN(t),i=FN.f,a=DN.f,s=0;s<n.length;s++){var o=n[s];!Sm(e,o)&&!(r&&Sm(r,o))&&i(e,o,a(t,o))}},BN=nt,qN=Nt,WN=/#|\.prototype\./,Gu=function(e,t){var r=GN[HN(e)];return r==zN?!0:r==VN?!1:qN(t)?BN(t):!!t},HN=Gu.normalize=function(e){return String(e).replace(WN,".").toLowerCase()},GN=Gu.data={},VN=Gu.NATIVE="N",zN=Gu.POLYFILL="P",sf=Gu,ad=dt,KN=Hn.f,JN=gi,YN=mr,QN=bv,XN=lk,ZN=sf,ct=function(e,t){var r=e.target,n=e.global,i=e.stat,a,s,o,u,c,d;if(n?s=ad:i?s=ad[r]||QN(r,{}):s=(ad[r]||{}).prototype,s)for(o in t){if(c=t[o],e.dontCallGetSet?(d=KN(s,o),u=d&&d.value):u=s[o],a=ZN(n?o:r+(i?".":"#")+o,e.forced),!a&&u!==void 0){if(typeof c==typeof u)continue;XN(c,u)}(e.sham||u&&u.sham)&&JN(c,"sham",!0),YN(s,o,c,e)}},ex=ju,ck=Function.prototype,$m=ck.apply,km=ck.call,na=typeof Reflect=="object"&&Reflect.apply||(ex?km.bind($m):function(){return km.apply($m,arguments)}),tx=et,ho=tx([].slice),fk=et,rx=An,nx=Vt,ix=zt,Tm=ho,ax=ju,dk=Function,sx=fk([].concat),ox=fk([].join),sd={},ux=function(e,t,r){if(!ix(sd,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";sd[t]=dk("C,a","return new C("+ox(n,",")+")")}return sd[t](e,r)},lx=ax?dk.bind:function(t){var r=rx(this),n=r.prototype,i=Tm(arguments,1),a=function(){var o=sx(i,Tm(arguments));return this instanceof a?ux(r,o.length,o):r.apply(t,o)};return nx(n)&&(a.prototype=n),a},cx=Ot,fx=cx("toStringTag"),pk={};pk[fx]="z";var Ev=String(pk)==="[object z]",dx=Ev,px=Nt,ic=ta,hx=Ot,vx=hx("toStringTag"),gx=Object,yx=ic(function(){return arguments}())=="Arguments",mx=function(e,t){try{return e[t]}catch{}},bi=dx?ic:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=mx(t=gx(e),vx))=="string"?r:yx?ic(t):(n=ic(t))=="Object"&&px(t.callee)?"Arguments":n},bx=et,wx=nt,hk=Nt,_x=bi,Sx=fn,$x=kv,vk=function(){},kx=[],gk=Sx("Reflect","construct"),Cv=/^\s*(?:class|function)\b/,Tx=bx(Cv.exec),Ex=!Cv.exec(vk),jo=function(t){if(!hk(t))return!1;try{return gk(vk,kx,t),!0}catch{return!1}},yk=function(t){if(!hk(t))return!1;switch(_x(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ex||!!Tx(Cv,$x(t))}catch{return!0}};yk.sham=!0;var of=!gk||wx(function(){var e;return jo(jo.call)||!jo(Object)||!jo(function(){e=!0})||e})?yk:jo,Cx=of,Ix=es,Rx=TypeError,Iv=function(e){if(Cx(e))return e;throw Rx(Ix(e)+" is not a constructor")},Rv={},Ox=ok,Ax=Tv,Vu=Object.keys||function(t){return Ox(t,Ax)},Px=Wt,Mx=nk,Nx=Zt,xx=er,Lx=Hr,jx=Vu;Rv.f=Px&&!Mx?Object.defineProperties:function(t,r){xx(t);for(var n=Lx(r),i=jx(r),a=i.length,s=0,o;a>s;)Nx.f(t,o=i[s++],n[o]);return t};var Ux=fn,mk=Ux("document","documentElement"),Dx=er,Fx=Rv,Em=Tv,Bx=Wu,qx=mk,Wx=rf,Hx=nf,Cm=">",Im="<",Xp="prototype",Zp="script",bk=Hx("IE_PROTO"),od=function(){},wk=function(e){return Im+Zp+Cm+e+Im+"/"+Zp+Cm},Rm=function(e){e.write(wk("")),e.close();var t=e.parentWindow.Object;return e=null,t},Gx=function(){var e=Wx("iframe"),t="java"+Zp+":",r;return e.style.display="none",qx.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(wk("document.F=Object")),r.close(),r.F},Tl,ac=function(){try{Tl=new ActiveXObject("htmlfile")}catch{}ac=typeof document<"u"?document.domain&&Tl?Rm(Tl):Gx():Rm(Tl);for(var e=Em.length;e--;)delete ac[Xp][Em[e]];return ac()};Bx[bk]=!0;var ia=Object.create||function(t,r){var n;return t!==null?(od[Xp]=Dx(t),n=new od,od[Xp]=null,n[bk]=t):n=ac(),r===void 0?n:Fx.f(n,r)},Vx=ct,zx=fn,ud=na,Kx=lx,Om=Iv,Jx=er,Am=Vt,Yx=ia,_k=nt,Ov=zx("Reflect","construct"),Qx=Object.prototype,Xx=[].push,Sk=_k(function(){function e(){}return!(Ov(function(){},[],e)instanceof e)}),$k=!_k(function(){Ov(function(){})}),Pm=Sk||$k;Vx({target:"Reflect",stat:!0,forced:Pm,sham:Pm},{construct:function(t,r){Om(t),Jx(r);var n=arguments.length<3?t:Om(arguments[2]);if($k&&!Sk)return Ov(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return ud(Xx,i,r),new(ud(Kx,t,i))}var a=n.prototype,s=Yx(Am(a)?a:Qx),o=ud(t,s,r);return Am(o)?o:s}});var Zx=ct,eL=yr,kk=Vu,tL=nt,rL=tL(function(){kk(1)});Zx({target:"Object",stat:!0,forced:rL},{keys:function(t){return kk(eL(t))}});var nL=bi,iL=String,fr=function(e){if(nL(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return iL(e)},Av={},aL=Bu,sL=Zt,oL=Qa,vo=function(e,t,r){var n=aL(t);n in e?sL.f(e,n,oL(0,r)):e[n]=r},Mm=ns,uL=br,lL=vo,cL=Array,fL=Math.max,zu=function(e,t,r){for(var n=uL(e),i=Mm(t,n),a=Mm(r===void 0?n:r,n),s=cL(fL(a-i,0)),o=0;i<a;i++,o++)lL(s,o,e[i]);return s.length=o,s},dL=ta,pL=Hr,Tk=ra.f,hL=zu,Ek=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],vL=function(e){try{return Tk(e)}catch{return hL(Ek)}};Av.f=function(t){return Ek&&dL(t)=="Window"?vL(t):Tk(pL(t))};var Pv={},gL=Ot;Pv.f=gL;var yL=dt,mL=yL,Nm=mL,bL=zt,wL=Pv,_L=Zt.f,Ck=function(e){var t=Nm.Symbol||(Nm.Symbol={});bL(t,e)||_L(t,e,{value:wL.f(e)})},SL=Mt,$L=fn,kL=Ot,TL=mr,EL=function(){var e=$L("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=kL("toPrimitive");t&&!t[n]&&TL(t,n,function(i){return SL(r,this)},{arity:1})},CL=Zt.f,IL=zt,RL=Ot,xm=RL("toStringTag"),aa=function(e,t,r){e&&!r&&(e=e.prototype),e&&!IL(e,xm)&&CL(e,xm,{configurable:!0,value:t})},Lm=et,OL=An,AL=ju,PL=Lm(Lm.bind),wi=function(e,t){return OL(e),t===void 0?e:AL?PL(e,t):function(){return e.apply(t,arguments)}},ML=ta,Ku=Array.isArray||function(t){return ML(t)=="Array"},jm=Ku,NL=of,xL=Vt,LL=Ot,jL=LL("species"),Um=Array,UL=function(e){var t;return jm(e)&&(t=e.constructor,NL(t)&&(t===Um||jm(t.prototype))?t=void 0:xL(t)&&(t=t[jL],t===null&&(t=void 0))),t===void 0?Um:t},DL=UL,Mv=function(e,t){return new(DL(e))(t===0?0:t)},FL=wi,BL=et,qL=Du,WL=yr,HL=br,GL=Mv,Dm=BL([].push),Ai=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,a=e==6,s=e==7,o=e==5||a;return function(u,c,d,y){for(var _=WL(u),b=qL(_),k=FL(c,d),N=HL(b),P=0,j=y||GL,F=t?j(u,N):r||s?j(u,0):void 0,me,ce;N>P;P++)if((o||P in b)&&(me=b[P],ce=k(me,P,_),e))if(t)F[P]=ce;else if(ce)switch(e){case 3:return!0;case 5:return me;case 6:return P;case 2:Dm(F,me)}else switch(e){case 4:return!1;case 7:Dm(F,me)}return a?-1:n||i?i:F}},Gr={forEach:Ai(0),map:Ai(1),filter:Ai(2),some:Ai(3),every:Ai(4),find:Ai(5),findIndex:Ai(6),filterReject:Ai(7)},uf=ct,Nv=dt,xv=Mt,VL=et,Zs=Wt,eo=fo,zL=nt,ur=zt,KL=vi,eh=er,lf=Hr,Lv=Bu,JL=fr,th=Qa,Cu=ia,Ik=Vu,YL=ra,Rk=Av,QL=Hu,Ok=Hn,Ak=Zt,XL=Rv,Pk=Uu,ld=mr,jv=rs.exports,ZL=nf,Mk=Wu,Fm=Fu,ej=Ot,tj=Pv,rj=Ck,nj=EL,ij=aa,Nk=dn,cf=Gr.forEach,Pr=ZL("hidden"),ff="Symbol",Iu="prototype",aj=Nk.set,Bm=Nk.getterFor(ff),un=Object[Iu],Wa=Nv.Symbol,Zo=Wa&&Wa[Iu],sj=Nv.TypeError,cd=Nv.QObject,xk=Ok.f,Fi=Ak.f,Lk=Rk.f,oj=Pk.f,jk=VL([].push),li=jv("symbols"),Ju=jv("op-symbols"),uj=jv("wks"),rh=!cd||!cd[Iu]||!cd[Iu].findChild,nh=Zs&&zL(function(){return Cu(Fi({},"a",{get:function(){return Fi(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=xk(un,t);n&&delete un[t],Fi(e,t,r),n&&e!==un&&Fi(un,t,n)}:Fi,fd=function(e,t){var r=li[e]=Cu(Zo);return aj(r,{type:ff,tag:e,description:t}),Zs||(r.description=t),r},df=function(t,r,n){t===un&&df(Ju,r,n),eh(t);var i=Lv(r);return eh(n),ur(li,i)?(n.enumerable?(ur(t,Pr)&&t[Pr][i]&&(t[Pr][i]=!1),n=Cu(n,{enumerable:th(0,!1)})):(ur(t,Pr)||Fi(t,Pr,th(1,{})),t[Pr][i]=!0),nh(t,i,n)):Fi(t,i,n)},Uv=function(t,r){eh(t);var n=lf(r),i=Ik(n).concat(Fk(n));return cf(i,function(a){(!Zs||xv(ih,n,a))&&df(t,a,n[a])}),t},lj=function(t,r){return r===void 0?Cu(t):Uv(Cu(t),r)},ih=function(t){var r=Lv(t),n=xv(oj,this,r);return this===un&&ur(li,r)&&!ur(Ju,r)?!1:n||!ur(this,r)||!ur(li,r)||ur(this,Pr)&&this[Pr][r]?n:!0},Uk=function(t,r){var n=lf(t),i=Lv(r);if(!(n===un&&ur(li,i)&&!ur(Ju,i))){var a=xk(n,i);return a&&ur(li,i)&&!(ur(n,Pr)&&n[Pr][i])&&(a.enumerable=!0),a}},Dk=function(t){var r=Lk(lf(t)),n=[];return cf(r,function(i){!ur(li,i)&&!ur(Mk,i)&&jk(n,i)}),n},Fk=function(e){var t=e===un,r=Lk(t?Ju:lf(e)),n=[];return cf(r,function(i){ur(li,i)&&(!t||ur(un,i))&&jk(n,li[i])}),n};eo||(Wa=function(){if(KL(Zo,this))throw sj("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:JL(arguments[0]),r=Fm(t),n=function(i){this===un&&xv(n,Ju,i),ur(this,Pr)&&ur(this[Pr],r)&&(this[Pr][r]=!1),nh(this,r,th(1,i))};return Zs&&rh&&nh(un,r,{configurable:!0,set:n}),fd(r,t)},Zo=Wa[Iu],ld(Zo,"toString",function(){return Bm(this).tag}),ld(Wa,"withoutSetter",function(e){return fd(Fm(e),e)}),Pk.f=ih,Ak.f=df,XL.f=Uv,Ok.f=Uk,YL.f=Rk.f=Dk,QL.f=Fk,tj.f=function(e){return fd(ej(e),e)},Zs&&(Fi(Zo,"description",{configurable:!0,get:function(){return Bm(this).description}}),ld(un,"propertyIsEnumerable",ih,{unsafe:!0})));uf({global:!0,constructor:!0,wrap:!0,forced:!eo,sham:!eo},{Symbol:Wa});cf(Ik(uj),function(e){rj(e)});uf({target:ff,stat:!0,forced:!eo},{useSetter:function(){rh=!0},useSimple:function(){rh=!1}});uf({target:"Object",stat:!0,forced:!eo,sham:!Zs},{create:lj,defineProperty:df,defineProperties:Uv,getOwnPropertyDescriptor:Uk});uf({target:"Object",stat:!0,forced:!eo},{getOwnPropertyNames:Dk});nj();ij(Wa,ff);Mk[Pr]=!0;var cj=fo,Bk=cj&&!!Symbol.for&&!!Symbol.keyFor,fj=ct,dj=fn,pj=zt,hj=fr,qk=rs.exports,vj=Bk,dd=qk("string-to-symbol-registry"),gj=qk("symbol-to-string-registry");fj({target:"Symbol",stat:!0,forced:!vj},{for:function(e){var t=hj(e);if(pj(dd,t))return dd[t];var r=dj("Symbol")(t);return dd[t]=r,gj[r]=t,r}});var yj=ct,mj=zt,bj=po,wj=es,_j=rs.exports,Sj=Bk,qm=_j("symbol-to-string-registry");yj({target:"Symbol",stat:!0,forced:!Sj},{keyFor:function(t){if(!bj(t))throw TypeError(wj(t)+" is not a symbol");if(mj(qm,t))return qm[t]}});var $j=ct,Wk=fn,Hk=na,kj=Mt,Yu=et,Gk=nt,Tj=Ku,Ej=Nt,Cj=Vt,Wm=po,Vk=ho,Ij=fo,zi=Wk("JSON","stringify"),El=Yu(/./.exec),Hm=Yu("".charAt),Rj=Yu("".charCodeAt),Oj=Yu("".replace),Aj=Yu(1 .toString),Pj=/[\uD800-\uDFFF]/g,Gm=/^[\uD800-\uDBFF]$/,Vm=/^[\uDC00-\uDFFF]$/,zm=!Ij||Gk(function(){var e=Wk("Symbol")();return zi([e])!="[null]"||zi({a:e})!="{}"||zi(Object(e))!="{}"}),Km=Gk(function(){return zi("\uDF06\uD834")!=='"\\udf06\\ud834"'||zi("\uDEAD")!=='"\\udead"'}),Mj=function(e,t){var r=Vk(arguments),n=t;if(!(!Cj(t)&&e===void 0||Wm(e)))return Tj(t)||(t=function(i,a){if(Ej(n)&&(a=kj(n,this,i,a)),!Wm(a))return a}),r[1]=t,Hk(zi,null,r)},Nj=function(e,t,r){var n=Hm(r,t-1),i=Hm(r,t+1);return El(Gm,e)&&!El(Vm,i)||El(Vm,e)&&!El(Gm,n)?"\\u"+Aj(Rj(e,0),16):e};zi&&$j({target:"JSON",stat:!0,arity:3,forced:zm||Km},{stringify:function(t,r,n){var i=Vk(arguments),a=Hk(zm?Mj:zi,null,i);return Km&&typeof a=="string"?Oj(a,Pj,Nj):a}});var xj=ct,Lj=fo,jj=nt,zk=Hu,Uj=yr,Dj=!Lj||jj(function(){zk.f(1)});xj({target:"Object",stat:!0,forced:Dj},{getOwnPropertySymbols:function(t){var r=zk.f;return r?r(Uj(t)):[]}});var Fj=nt,Bj=Ot,qj=Za,Wj=Bj("species"),Qu=function(e){return qj>=51||!Fj(function(){var t=[],r=t.constructor={};return r[Wj]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Hj=ct,Gj=Gr.filter,Vj=Qu,zj=Vj("filter");Hj({target:"Array",proto:!0,forced:!zj},{filter:function(t){return Gj(this,t,arguments.length>1?arguments[1]:void 0)}});var Kj=ct,Jj=nt,Yj=Hr,Kk=Hn.f,Jk=Wt,Qj=Jj(function(){Kk(1)}),Xj=!Jk||Qj;Kj({target:"Object",stat:!0,forced:Xj,sham:!Jk},{getOwnPropertyDescriptor:function(t,r){return Kk(Yj(t),r)}});var Zj=ct,eU=Wt,tU=uk,rU=Hr,nU=Hn,iU=vo;Zj({target:"Object",stat:!0,sham:!eU},{getOwnPropertyDescriptors:function(t){for(var r=rU(t),n=nU.f,i=tU(r),a={},s=0,o,u;i.length>s;)u=n(r,o=i[s++]),u!==void 0&&iU(a,o,u);return a}});var go={exports:{}};(function(e){function t(n,i,a,s,o,u,c){try{var d=n[u](c),y=d.value}catch(_){a(_);return}d.done?i(y):Promise.resolve(y).then(s,o)}function r(n){return function(){var i=this,a=arguments;return new Promise(function(s,o){var u=n.apply(i,a);function c(y){t(u,s,o,c,d,"next",y)}function d(y){t(u,s,o,c,d,"throw",y)}c(void 0)})}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(go);var is={exports:{}};(function(e){function t(n,i){for(var a=0;a<i.length;a++){var s=i[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function r(n,i,a){return i&&t(n.prototype,i),a&&t(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(is);var sa={exports:{}};(function(e){function t(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(sa);var oa={exports:{}},pf={exports:{}};(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(pf);(function(e){var t=pf.exports;function r(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),i&&t(n,i)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(oa);var ua={exports:{}},la={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(la);(function(e){var t=la.exports.default,r=sa.exports;function n(i,a){if(a&&(t(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(i)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(ua);var zn={exports:{}};(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(zn);var ca={exports:{}};(function(e){function t(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ca);var fa={exports:{}};(function(e){function t(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(fa);var aU=Ev,sU=bi,oU=aU?{}.toString:function(){return"[object "+sU(this)+"]"},uU=Ev,lU=mr,cU=oU;uU||lU(Object.prototype,"toString",cU,{unsafe:!0});var fU=ta,dU=dt,Xu=fU(dU.process)=="process",pU=Nt,hU=String,vU=TypeError,gU=function(e){if(typeof e=="object"||pU(e))return e;throw vU("Can't set "+hU(e)+" as a prototype")},yU=et,mU=er,bU=gU,yo=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=yU(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(i,a){return mU(i),bU(a),e?r(i,a):i.__proto__=a,i}}():void 0),wU=fn,_U=Zt,SU=Ot,$U=Wt,Jm=SU("species"),hf=function(e){var t=wU(e),r=_U.f;$U&&t&&!t[Jm]&&r(t,Jm,{configurable:!0,get:function(){return this}})},kU=vi,TU=TypeError,as=function(e,t){if(kU(t,e))return e;throw TU("Incorrect invocation")},Ym=er,EU=Iv,CU=Gn,IU=Ot,RU=IU("species"),Dv=function(e,t){var r=Ym(e).constructor,n;return r===void 0||CU(n=Ym(r)[RU])?t:EU(n)},OU=TypeError,Fv=function(e,t){if(e<t)throw OU("Not enough arguments");return e},AU=Xa,Yk=/(?:ipad|iphone|ipod).*applewebkit/i.test(AU),qr=dt,PU=na,MU=wi,Qm=Nt,NU=zt,xU=nt,Xm=mk,LU=ho,Zm=rf,jU=Fv,UU=Yk,DU=Xu,ah=qr.setImmediate,sh=qr.clearImmediate,FU=qr.process,pd=qr.Dispatch,BU=qr.Function,eb=qr.MessageChannel,qU=qr.String,hd=0,fu={},tb="onreadystatechange",Ru,ka,vd,gd;try{Ru=qr.location}catch{}var Bv=function(e){if(NU(fu,e)){var t=fu[e];delete fu[e],t()}},yd=function(e){return function(){Bv(e)}},rb=function(e){Bv(e.data)},nb=function(e){qr.postMessage(qU(e),Ru.protocol+"//"+Ru.host)};(!ah||!sh)&&(ah=function(t){jU(arguments.length,1);var r=Qm(t)?t:BU(t),n=LU(arguments,1);return fu[++hd]=function(){PU(r,void 0,n)},ka(hd),hd},sh=function(t){delete fu[t]},DU?ka=function(e){FU.nextTick(yd(e))}:pd&&pd.now?ka=function(e){pd.now(yd(e))}:eb&&!UU?(vd=new eb,gd=vd.port2,vd.port1.onmessage=rb,ka=MU(gd.postMessage,gd)):qr.addEventListener&&Qm(qr.postMessage)&&!qr.importScripts&&Ru&&Ru.protocol!=="file:"&&!xU(nb)?(ka=nb,qr.addEventListener("message",rb,!1)):tb in Zm("script")?ka=function(e){Xm.appendChild(Zm("script"))[tb]=function(){Xm.removeChild(this),Bv(e)}}:ka=function(e){setTimeout(yd(e),0)});var Qk={set:ah,clear:sh},WU=Xa,HU=dt,GU=/ipad|iphone|ipod/i.test(WU)&&HU.Pebble!==void 0,VU=Xa,zU=/web0s(?!.*chrome)/i.test(VU),Ga=dt,ib=wi,KU=Hn.f,md=Qk.set,JU=Yk,YU=GU,QU=zU,bd=Xu,ab=Ga.MutationObserver||Ga.WebKitMutationObserver,sb=Ga.document,ob=Ga.process,Cl=Ga.Promise,ub=KU(Ga,"queueMicrotask"),Xk=ub&&ub.value,Uo,xa,du,As,wd,_d,Il,lb;Xk||(Uo=function(){var e,t;for(bd&&(e=ob.domain)&&e.exit();xa;){t=xa.fn,xa=xa.next;try{t()}catch(r){throw xa?As():du=void 0,r}}du=void 0,e&&e.enter()},!JU&&!bd&&!QU&&ab&&sb?(wd=!0,_d=sb.createTextNode(""),new ab(Uo).observe(_d,{characterData:!0}),As=function(){_d.data=wd=!wd}):!YU&&Cl&&Cl.resolve?(Il=Cl.resolve(void 0),Il.constructor=Cl,lb=ib(Il.then,Il),As=function(){lb(Uo)}):bd?As=function(){ob.nextTick(Uo)}:(md=ib(md,Ga),As=function(){md(Uo)}));var XU=Xk||function(e){var t={fn:e,next:void 0};du&&(du.next=t),xa||(xa=t,As()),du=t},ZU=dt,eD=function(e,t){var r=ZU.console;r&&r.error&&(arguments.length==1?r.error(e):r.error(e,t))},qv=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},Zk=function(){this.head=null,this.tail=null};Zk.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var tD=Zk,rD=dt,vf=rD.Promise,e0=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",nD=e0,iD=Xu,aD=!nD&&!iD&&typeof window=="object"&&typeof document=="object",sD=dt,pu=vf,oD=Nt,uD=sf,lD=kv,cD=Ot,fD=aD,dD=e0,Sd=Za;pu&&pu.prototype;var pD=cD("species"),oh=!1,t0=oD(sD.PromiseRejectionEvent),hD=uD("Promise",function(){var e=lD(pu),t=e!==String(pu);if(!t&&Sd===66)return!0;if(!Sd||Sd<51||!/native code/.test(e)){var r=new pu(function(a){a(1)}),n=function(a){a(function(){},function(){})},i=r.constructor={};if(i[pD]=n,oh=r.then(function(){})instanceof n,!oh)return!0}return!t&&(fD||dD)&&!t0}),Zu={CONSTRUCTOR:hD,REJECTION_EVENT:t0,SUBCLASSING:oh},mo={},cb=An,vD=TypeError,gD=function(e){var t,r;this.promise=new e(function(n,i){if(t!==void 0||r!==void 0)throw vD("Bad Promise constructor");t=n,r=i}),this.resolve=cb(t),this.reject=cb(r)};mo.f=function(e){return new gD(e)};var yD=ct,Sc=Xu,Zi=dt,to=Mt,fb=mr,db=yo,mD=aa,bD=hf,wD=An,sc=Nt,_D=Vt,SD=as,$D=Dv,r0=Qk.set,Wv=XU,kD=eD,TD=qv,ED=tD,n0=dn,$c=vf,Hv=Zu,i0=mo,gf="Promise",a0=Hv.CONSTRUCTOR,CD=Hv.REJECTION_EVENT,ID=Hv.SUBCLASSING,$d=n0.getterFor(gf),RD=n0.set,Ps=$c&&$c.prototype,La=$c,Rl=Ps,s0=Zi.TypeError,uh=Zi.document,Gv=Zi.process,lh=i0.f,OD=lh,AD=!!(uh&&uh.createEvent&&Zi.dispatchEvent),o0="unhandledrejection",PD="rejectionhandled",pb=0,u0=1,MD=2,Vv=1,l0=2,Ol,hb,ND,vb,c0=function(e){var t;return _D(e)&&sc(t=e.then)?t:!1},f0=function(e,t){var r=t.value,n=t.state==u0,i=n?e.ok:e.fail,a=e.resolve,s=e.reject,o=e.domain,u,c,d;try{i?(n||(t.rejection===l0&&LD(t),t.rejection=Vv),i===!0?u=r:(o&&o.enter(),u=i(r),o&&(o.exit(),d=!0)),u===e.promise?s(s0("Promise-chain cycle")):(c=c0(u))?to(c,u,a,s):a(u)):s(r)}catch(y){o&&!d&&o.exit(),s(y)}},d0=function(e,t){e.notified||(e.notified=!0,Wv(function(){for(var r=e.reactions,n;n=r.get();)f0(n,e);e.notified=!1,t&&!e.rejection&&xD(e)}))},p0=function(e,t,r){var n,i;AD?(n=uh.createEvent("Event"),n.promise=t,n.reason=r,n.initEvent(e,!1,!0),Zi.dispatchEvent(n)):n={promise:t,reason:r},!CD&&(i=Zi["on"+e])?i(n):e===o0&&kD("Unhandled promise rejection",r)},xD=function(e){to(r0,Zi,function(){var t=e.facade,r=e.value,n=gb(e),i;if(n&&(i=TD(function(){Sc?Gv.emit("unhandledRejection",r,t):p0(o0,t,r)}),e.rejection=Sc||gb(e)?l0:Vv,i.error))throw i.value})},gb=function(e){return e.rejection!==Vv&&!e.parent},LD=function(e){to(r0,Zi,function(){var t=e.facade;Sc?Gv.emit("rejectionHandled",t):p0(PD,t,e.value)})},xs=function(e,t,r){return function(n){e(t,n,r)}},qs=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=MD,d0(e,!0))},ch=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw s0("Promise can't be resolved itself");var n=c0(t);n?Wv(function(){var i={done:!1};try{to(n,t,xs(ch,i,e),xs(qs,i,e))}catch(a){qs(i,a,e)}}):(e.value=t,e.state=u0,d0(e,!1))}catch(i){qs({done:!1},i,e)}}};if(a0&&(La=function(t){SD(this,Rl),wD(t),to(Ol,this);var r=$d(this);try{t(xs(ch,r),xs(qs,r))}catch(n){qs(r,n)}},Rl=La.prototype,Ol=function(t){RD(this,{type:gf,done:!1,notified:!1,parent:!1,reactions:new ED,rejection:!1,state:pb,value:void 0})},Ol.prototype=fb(Rl,"then",function(t,r){var n=$d(this),i=lh($D(this,La));return n.parent=!0,i.ok=sc(t)?t:!0,i.fail=sc(r)&&r,i.domain=Sc?Gv.domain:void 0,n.state==pb?n.reactions.add(i):Wv(function(){f0(i,n)}),i.promise}),hb=function(){var e=new Ol,t=$d(e);this.promise=e,this.resolve=xs(ch,t),this.reject=xs(qs,t)},i0.f=lh=function(e){return e===La||e===ND?new hb(e):OD(e)},sc($c)&&Ps!==Object.prototype)){vb=Ps.then,ID||fb(Ps,"then",function(t,r){var n=this;return new La(function(i,a){to(vb,n,i,a)}).then(t,r)},{unsafe:!0});try{delete Ps.constructor}catch{}db&&db(Ps,Rl)}yD({global:!0,constructor:!0,wrap:!0,forced:a0},{Promise:La});mD(La,gf,!1);bD(gf);var el={},jD=Ot,UD=el,DD=jD("iterator"),FD=Array.prototype,zv=function(e){return e!==void 0&&(UD.Array===e||FD[DD]===e)},BD=bi,yb=ts,qD=Gn,WD=el,HD=Ot,GD=HD("iterator"),tl=function(e){if(!qD(e))return yb(e,GD)||yb(e,"@@iterator")||WD[BD(e)]},VD=Mt,zD=An,KD=er,JD=es,YD=tl,QD=TypeError,yf=function(e,t){var r=arguments.length<2?YD(e):t;if(zD(r))return KD(VD(r,e));throw QD(JD(e)+" is not iterable")},XD=Mt,mb=er,ZD=ts,h0=function(e,t,r){var n,i;mb(e);try{if(n=ZD(e,"return"),!n){if(t==="throw")throw r;return r}n=XD(n,e)}catch(a){i=!0,n=a}if(t==="throw")throw r;if(i)throw n;return mb(n),r},eF=wi,tF=Mt,rF=er,nF=es,iF=zv,aF=br,bb=vi,sF=yf,oF=tl,wb=h0,uF=TypeError,oc=function(e,t){this.stopped=e,this.result=t},_b=oc.prototype,mf=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),a=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),o=!!(r&&r.INTERRUPTED),u=eF(t,n),c,d,y,_,b,k,N,P=function(F){return c&&wb(c,"normal",F),new oc(!0,F)},j=function(F){return i?(rF(F),o?u(F[0],F[1],P):u(F[0],F[1])):o?u(F,P):u(F)};if(a)c=e.iterator;else if(s)c=e;else{if(d=oF(e),!d)throw uF(nF(e)+" is not iterable");if(iF(d)){for(y=0,_=aF(e);_>y;y++)if(b=j(e[y]),b&&bb(_b,b))return b;return new oc(!1)}c=sF(e,d)}for(k=a?e.next:c.next;!(N=tF(k,c)).done;){try{b=j(N.value)}catch(F){wb(c,"throw",F)}if(typeof b=="object"&&b&&bb(_b,b))return b}return new oc(!1)},lF=Ot,v0=lF("iterator"),g0=!1;try{var cF=0,Sb={next:function(){return{done:!!cF++}},return:function(){g0=!0}};Sb[v0]=function(){return this},Array.from(Sb,function(){throw 2})}catch{}var bf=function(e,t){if(!t&&!g0)return!1;var r=!1;try{var n={};n[v0]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},fF=vf,dF=bf,pF=Zu.CONSTRUCTOR,y0=pF||!dF(function(e){fF.all(e).then(void 0,function(){})}),hF=ct,vF=Mt,gF=An,yF=mo,mF=qv,bF=mf,wF=y0;hF({target:"Promise",stat:!0,forced:wF},{all:function(t){var r=this,n=yF.f(r),i=n.resolve,a=n.reject,s=mF(function(){var o=gF(r.resolve),u=[],c=0,d=1;bF(t,function(y){var _=c++,b=!1;d++,vF(o,r,y).then(function(k){b||(b=!0,u[_]=k,--d||i(u))},a)}),--d||i(u)});return s.error&&a(s.value),n.promise}});var _F=ct,SF=Zu.CONSTRUCTOR,fh=vf,$F=fn,kF=Nt,TF=mr,$b=fh&&fh.prototype;_F({target:"Promise",proto:!0,forced:SF,real:!0},{catch:function(e){return this.then(void 0,e)}});if(kF(fh)){var kb=$F("Promise").prototype.catch;$b.catch!==kb&&TF($b,"catch",kb,{unsafe:!0})}var EF=ct,CF=Mt,IF=An,RF=mo,OF=qv,AF=mf,PF=y0;EF({target:"Promise",stat:!0,forced:PF},{race:function(t){var r=this,n=RF.f(r),i=n.reject,a=OF(function(){var s=IF(r.resolve);AF(t,function(o){CF(s,r,o).then(n.resolve,i)})});return a.error&&i(a.value),n.promise}});var MF=ct,NF=Mt,xF=mo,LF=Zu.CONSTRUCTOR;MF({target:"Promise",stat:!0,forced:LF},{reject:function(t){var r=xF.f(this);return NF(r.reject,void 0,t),r.promise}});var jF=er,UF=Vt,DF=mo,FF=function(e,t){if(jF(e),UF(t)&&t.constructor===e)return t;var r=DF.f(e),n=r.resolve;return n(t),r.promise},BF=ct,qF=fn,WF=Zu.CONSTRUCTOR,HF=FF;qF("Promise");BF({target:"Promise",stat:!0,forced:WF},{resolve:function(t){return HF(this,t)}});var m0={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},GF=rf,kd=GF("span").classList,Tb=kd&&kd.constructor&&kd.constructor.prototype,b0=Tb===Object.prototype?void 0:Tb,VF=nt,rl=function(e,t){var r=[][e];return!!r&&VF(function(){r.call(null,t||function(){return 1},1)})},zF=Gr.forEach,KF=rl,JF=KF("forEach"),YF=JF?[].forEach:function(t){return zF(this,t,arguments.length>1?arguments[1]:void 0)},Eb=dt,Cb=m0,QF=b0,Td=YF,XF=gi,w0=function(e){if(e&&e.forEach!==Td)try{XF(e,"forEach",Td)}catch{e.forEach=Td}};for(var Ed in Cb)Cb[Ed]&&w0(Eb[Ed]&&Eb[Ed].prototype);w0(QF);var ZF=Nt,e3=Vt,Ib=yo,Kv=function(e,t,r){var n,i;return Ib&&ZF(n=t.constructor)&&n!==r&&e3(i=n.prototype)&&i!==r.prototype&&Ib(e,i),e},t3=et,r3=t3(1 .valueOf),n3=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,i3=et,a3=Vn,s3=fr,o3=n3,Rb=i3("".replace),kc="["+o3+"]",u3=RegExp("^"+kc+kc+"*"),l3=RegExp(kc+kc+"*$"),Cd=function(e){return function(t){var r=s3(a3(t));return e&1&&(r=Rb(r,u3,"")),e&2&&(r=Rb(r,l3,"")),r}},c3={start:Cd(1),end:Cd(2),trim:Cd(3)},f3=Wt,Jv=dt,_0=et,d3=sf,p3=mr,Ob=zt,h3=Kv,v3=vi,g3=po,S0=_v,y3=nt,m3=ra.f,b3=Hn.f,w3=Zt.f,_3=r3,S3=c3.trim,dh="Number",xi=Jv[dh],Id=xi.prototype,$3=Jv.TypeError,k3=_0("".slice),Al=_0("".charCodeAt),T3=function(e){var t=S0(e,"number");return typeof t=="bigint"?t:E3(t)},E3=function(e){var t=S0(e,"number"),r,n,i,a,s,o,u,c;if(g3(t))throw $3("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=S3(t),r=Al(t,0),r===43||r===45){if(n=Al(t,2),n===88||n===120)return NaN}else if(r===48){switch(Al(t,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(s=k3(t,2),o=s.length,u=0;u<o;u++)if(c=Al(s,u),c<48||c>a)return NaN;return parseInt(s,i)}}return+t};if(d3(dh,!xi(" 0o1")||!xi("0b1")||xi("+0x1"))){for(var bs=function(t){var r=arguments.length<1?0:xi(T3(t)),n=this;return v3(Id,n)&&y3(function(){_3(n)})?h3(Object(r),n,bs):r},Ab=f3?m3(xi):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Rd=0,Pl;Ab.length>Rd;Rd++)Ob(xi,Pl=Ab[Rd])&&!Ob(bs,Pl)&&w3(bs,Pl,b3(xi,Pl));bs.prototype=Id,Id.constructor=bs,p3(Jv,dh,bs,{constructor:!0})}var $0={exports:{}};(function(e){var t=la.exports.default;function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},i=Object.prototype,a=i.hasOwnProperty,s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function d(ue,ee,se){return Object.defineProperty(ue,ee,{value:se,enumerable:!0,configurable:!0,writable:!0}),ue[ee]}try{d({},"")}catch{d=function(se,ne,be){return se[ne]=be}}function y(ue,ee,se,ne){var be=ee&&ee.prototype instanceof k?ee:k,O=Object.create(be.prototype),je=new D(ne||[]);return O._invoke=function(ft,Je,fe){var G="suspendedStart";return function(Y,$){if(G==="executing")throw new Error("Generator is already running");if(G==="completed"){if(Y==="throw")throw $;return Ie()}for(fe.method=Y,fe.arg=$;;){var C=fe.delegate;if(C){var Z=Me(C,fe);if(Z){if(Z===b)continue;return Z}}if(fe.method==="next")fe.sent=fe._sent=fe.arg;else if(fe.method==="throw"){if(G==="suspendedStart")throw G="completed",fe.arg;fe.dispatchException(fe.arg)}else fe.method==="return"&&fe.abrupt("return",fe.arg);G="executing";var te=_(ft,Je,fe);if(te.type==="normal"){if(G=fe.done?"completed":"suspendedYield",te.arg===b)continue;return{value:te.arg,done:fe.done}}te.type==="throw"&&(G="completed",fe.method="throw",fe.arg=te.arg)}}}(ue,se,je),O}function _(ue,ee,se){try{return{type:"normal",arg:ue.call(ee,se)}}catch(ne){return{type:"throw",arg:ne}}}n.wrap=y;var b={};function k(){}function N(){}function P(){}var j={};d(j,o,function(){return this});var F=Object.getPrototypeOf,me=F&&F(F(Re([])));me&&me!==i&&a.call(me,o)&&(j=me);var ce=P.prototype=k.prototype=Object.create(j);function xe(ue){["next","throw","return"].forEach(function(ee){d(ue,ee,function(se){return this._invoke(ee,se)})})}function Ne(ue,ee){function se(be,O,je,ft){var Je=_(ue[be],ue,O);if(Je.type!=="throw"){var fe=Je.arg,G=fe.value;return G&&t(G)=="object"&&a.call(G,"__await")?ee.resolve(G.__await).then(function(Y){se("next",Y,je,ft)},function(Y){se("throw",Y,je,ft)}):ee.resolve(G).then(function(Y){fe.value=Y,je(fe)},function(Y){return se("throw",Y,je,ft)})}ft(Je.arg)}var ne;this._invoke=function(be,O){function je(){return new ee(function(ft,Je){se(be,O,ft,Je)})}return ne=ne?ne.then(je,je):je()}}function Me(ue,ee){var se=ue.iterator[ee.method];if(se===void 0){if(ee.delegate=null,ee.method==="throw"){if(ue.iterator.return&&(ee.method="return",ee.arg=void 0,Me(ue,ee),ee.method==="throw"))return b;ee.method="throw",ee.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var ne=_(se,ue.iterator,ee.arg);if(ne.type==="throw")return ee.method="throw",ee.arg=ne.arg,ee.delegate=null,b;var be=ne.arg;return be?be.done?(ee[ue.resultName]=be.value,ee.next=ue.nextLoc,ee.method!=="return"&&(ee.method="next",ee.arg=void 0),ee.delegate=null,b):be:(ee.method="throw",ee.arg=new TypeError("iterator result is not an object"),ee.delegate=null,b)}function x(ue){var ee={tryLoc:ue[0]};1 in ue&&(ee.catchLoc=ue[1]),2 in ue&&(ee.finallyLoc=ue[2],ee.afterLoc=ue[3]),this.tryEntries.push(ee)}function le(ue){var ee=ue.completion||{};ee.type="normal",delete ee.arg,ue.completion=ee}function D(ue){this.tryEntries=[{tryLoc:"root"}],ue.forEach(x,this),this.reset(!0)}function Re(ue){if(ue){var ee=ue[o];if(ee)return ee.call(ue);if(typeof ue.next=="function")return ue;if(!isNaN(ue.length)){var se=-1,ne=function be(){for(;++se<ue.length;)if(a.call(ue,se))return be.value=ue[se],be.done=!1,be;return be.value=void 0,be.done=!0,be};return ne.next=ne}}return{next:Ie}}function Ie(){return{value:void 0,done:!0}}return N.prototype=P,d(ce,"constructor",P),d(P,"constructor",N),N.displayName=d(P,c,"GeneratorFunction"),n.isGeneratorFunction=function(ue){var ee=typeof ue=="function"&&ue.constructor;return!!ee&&(ee===N||(ee.displayName||ee.name)==="GeneratorFunction")},n.mark=function(ue){return Object.setPrototypeOf?Object.setPrototypeOf(ue,P):(ue.__proto__=P,d(ue,c,"GeneratorFunction")),ue.prototype=Object.create(ce),ue},n.awrap=function(ue){return{__await:ue}},xe(Ne.prototype),d(Ne.prototype,u,function(){return this}),n.AsyncIterator=Ne,n.async=function(ue,ee,se,ne,be){be===void 0&&(be=Promise);var O=new Ne(y(ue,ee,se,ne),be);return n.isGeneratorFunction(ee)?O:O.next().then(function(je){return je.done?je.value:O.next()})},xe(ce),d(ce,c,"Generator"),d(ce,o,function(){return this}),d(ce,"toString",function(){return"[object Generator]"}),n.keys=function(ue){var ee=[];for(var se in ue)ee.push(se);return ee.reverse(),function ne(){for(;ee.length;){var be=ee.pop();if(be in ue)return ne.value=be,ne.done=!1,ne}return ne.done=!0,ne}},n.values=Re,D.prototype={constructor:D,reset:function(ee){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(le),!ee)for(var se in this)se.charAt(0)==="t"&&a.call(this,se)&&!isNaN(+se.slice(1))&&(this[se]=void 0)},stop:function(){this.done=!0;var ee=this.tryEntries[0].completion;if(ee.type==="throw")throw ee.arg;return this.rval},dispatchException:function(ee){if(this.done)throw ee;var se=this;function ne(fe,G){return je.type="throw",je.arg=ee,se.next=fe,G&&(se.method="next",se.arg=void 0),!!G}for(var be=this.tryEntries.length-1;be>=0;--be){var O=this.tryEntries[be],je=O.completion;if(O.tryLoc==="root")return ne("end");if(O.tryLoc<=this.prev){var ft=a.call(O,"catchLoc"),Je=a.call(O,"finallyLoc");if(ft&&Je){if(this.prev<O.catchLoc)return ne(O.catchLoc,!0);if(this.prev<O.finallyLoc)return ne(O.finallyLoc)}else if(ft){if(this.prev<O.catchLoc)return ne(O.catchLoc,!0)}else{if(!Je)throw new Error("try statement without catch or finally");if(this.prev<O.finallyLoc)return ne(O.finallyLoc)}}}},abrupt:function(ee,se){for(var ne=this.tryEntries.length-1;ne>=0;--ne){var be=this.tryEntries[ne];if(be.tryLoc<=this.prev&&a.call(be,"finallyLoc")&&this.prev<be.finallyLoc){var O=be;break}}O&&(ee==="break"||ee==="continue")&&O.tryLoc<=se&&se<=O.finallyLoc&&(O=null);var je=O?O.completion:{};return je.type=ee,je.arg=se,O?(this.method="next",this.next=O.finallyLoc,b):this.complete(je)},complete:function(ee,se){if(ee.type==="throw")throw ee.arg;return ee.type==="break"||ee.type==="continue"?this.next=ee.arg:ee.type==="return"?(this.rval=this.arg=ee.arg,this.method="return",this.next="end"):ee.type==="normal"&&se&&(this.next=se),b},finish:function(ee){for(var se=this.tryEntries.length-1;se>=0;--se){var ne=this.tryEntries[se];if(ne.finallyLoc===ee)return this.complete(ne.completion,ne.afterLoc),le(ne),b}},catch:function(ee){for(var se=this.tryEntries.length-1;se>=0;--se){var ne=this.tryEntries[se];if(ne.tryLoc===ee){var be=ne.completion;if(be.type==="throw"){var O=be.arg;le(ne)}return O}}throw new Error("illegal catch attempt")},delegateYield:function(ee,se,ne){return this.delegate={iterator:Re(ee),resultName:se,nextLoc:ne},this.method==="next"&&(this.arg=void 0),b}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})($0);var uc=$0.exports(),nl=uc;try{regeneratorRuntime=uc}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=uc:Function("r","regeneratorRuntime = r")(uc)}var C3=TypeError,I3=9007199254740991,k0=function(e){if(e>I3)throw C3("Maximum allowed index exceeded");return e},R3=ct,O3=nt,A3=Ku,P3=Vt,M3=yr,N3=br,Pb=k0,Mb=vo,x3=Mv,L3=Qu,j3=Ot,U3=Za,T0=j3("isConcatSpreadable"),D3=U3>=51||!O3(function(){var e=[];return e[T0]=!1,e.concat()[0]!==e}),F3=L3("concat"),B3=function(e){if(!P3(e))return!1;var t=e[T0];return t!==void 0?!!t:A3(e)},q3=!D3||!F3;R3({target:"Array",proto:!0,arity:1,forced:q3},{concat:function(t){var r=M3(this),n=x3(r,0),i=0,a,s,o,u,c;for(a=-1,o=arguments.length;a<o;a++)if(c=a===-1?r:arguments[a],B3(c))for(u=N3(c),Pb(i+u),s=0;s<u;s++,i++)s in c&&Mb(n,i,c[s]);else Pb(i+1),Mb(n,i++,c);return n.length=i,n}});var W3=er,H3=h0,G3=function(e,t,r,n){try{return n?t(W3(r)[0],r[1]):t(r)}catch(i){H3(e,"throw",i)}},V3=wi,z3=Mt,K3=yr,J3=G3,Y3=zv,Q3=of,X3=br,Nb=vo,Z3=yf,eB=tl,xb=Array,E0=function(t){var r=K3(t),n=Q3(this),i=arguments.length,a=i>1?arguments[1]:void 0,s=a!==void 0;s&&(a=V3(a,i>2?arguments[2]:void 0));var o=eB(r),u=0,c,d,y,_,b,k;if(o&&!(this===xb&&Y3(o)))for(_=Z3(r,o),b=_.next,d=n?new this:[];!(y=z3(b,_)).done;u++)k=s?J3(_,a,[y.value,u],!0):y.value,Nb(d,u,k);else for(c=X3(r),d=n?new this(c):xb(c);c>u;u++)k=s?a(r[u],u):r[u],Nb(d,u,k);return d.length=u,d},tB=ct,rB=E0,nB=bf,iB=!nB(function(e){Array.from(e)});tB({target:"Array",stat:!0,forced:iB},{from:rB});var Yv=et,aB=yi,sB=fr,oB=Vn,uB=Yv("".charAt),Lb=Yv("".charCodeAt),lB=Yv("".slice),jb=function(e){return function(t,r){var n=sB(oB(t)),i=aB(r),a=n.length,s,o;return i<0||i>=a?e?"":void 0:(s=Lb(n,i),s<55296||s>56319||i+1===a||(o=Lb(n,i+1))<56320||o>57343?e?uB(n,i):s:e?lB(n,i,i+2):(s-55296<<10)+(o-56320)+65536)}},Qv={codeAt:jb(!1),charAt:jb(!0)},cB=nt,fB=!cB(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),dB=zt,pB=Nt,hB=yr,vB=nf,gB=fB,Ub=vB("IE_PROTO"),ph=Object,yB=ph.prototype,wf=gB?ph.getPrototypeOf:function(e){var t=hB(e);if(dB(t,Ub))return t[Ub];var r=t.constructor;return pB(r)&&t instanceof r?r.prototype:t instanceof ph?yB:null},mB=nt,bB=Nt,wB=Vt,Db=wf,_B=mr,SB=Ot,hh=SB("iterator"),C0=!1,Va,Od,Ad;[].keys&&(Ad=[].keys(),"next"in Ad?(Od=Db(Db(Ad)),Od!==Object.prototype&&(Va=Od)):C0=!0);var $B=!wB(Va)||mB(function(){var e={};return Va[hh].call(e)!==e});$B&&(Va={});bB(Va[hh])||_B(Va,hh,function(){return this});var I0={IteratorPrototype:Va,BUGGY_SAFARI_ITERATORS:C0},kB=I0.IteratorPrototype,TB=ia,EB=Qa,CB=aa,IB=el,RB=function(){return this},R0=function(e,t,r,n){var i=t+" Iterator";return e.prototype=TB(kB,{next:EB(+!n,r)}),CB(e,i,!1),IB[i]=RB,e},OB=ct,AB=Mt,O0=qu,PB=Nt,MB=R0,Fb=wf,Bb=yo,NB=aa,xB=gi,Pd=mr,LB=Ot,jB=el,A0=I0,UB=O0.PROPER,DB=O0.CONFIGURABLE,qb=A0.IteratorPrototype,Ml=A0.BUGGY_SAFARI_ITERATORS,Do=LB("iterator"),Wb="keys",Fo="values",Hb="entries",FB=function(){return this},Xv=function(e,t,r,n,i,a,s){MB(r,t,n);var o=function(j){if(j===i&&_)return _;if(!Ml&&j in d)return d[j];switch(j){case Wb:return function(){return new r(this,j)};case Fo:return function(){return new r(this,j)};case Hb:return function(){return new r(this,j)}}return function(){return new r(this)}},u=t+" Iterator",c=!1,d=e.prototype,y=d[Do]||d["@@iterator"]||i&&d[i],_=!Ml&&y||o(i),b=t=="Array"&&d.entries||y,k,N,P;if(b&&(k=Fb(b.call(new e)),k!==Object.prototype&&k.next&&(Fb(k)!==qb&&(Bb?Bb(k,qb):PB(k[Do])||Pd(k,Do,FB)),NB(k,u,!0))),UB&&i==Fo&&y&&y.name!==Fo&&(DB?xB(d,"name",Fo):(c=!0,_=function(){return AB(y,this)})),i)if(N={values:o(Fo),keys:a?_:o(Wb),entries:o(Hb)},s)for(P in N)(Ml||c||!(P in d))&&Pd(d,P,N[P]);else OB({target:t,proto:!0,forced:Ml||c},N);return d[Do]!==_&&Pd(d,Do,_,{name:i}),jB[t]=_,N},Zv=function(e,t){return{value:e,done:t}},BB=Qv.charAt,qB=fr,P0=dn,WB=Xv,Gb=Zv,M0="String Iterator",HB=P0.set,GB=P0.getterFor(M0);WB(String,"String",function(e){HB(this,{type:M0,string:qB(e),index:0})},function(){var t=GB(this),r=t.string,n=t.index,i;return n>=r.length?Gb(void 0,!0):(i=BB(r,n),t.index+=i.length,Gb(i,!1))});var bo={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})(kn,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function a(N,P){var j=N[P];if(typeof j.bind=="function")return j.bind(N);try{return Function.prototype.bind.call(j,N)}catch{return function(){return Function.prototype.apply.apply(j,[N,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(N){return N==="debug"&&(N="log"),typeof console===r?!1:N==="trace"&&n?s:console[N]!==void 0?a(console,N):console.log!==void 0?a(console,"log"):t}function u(N,P){for(var j=0;j<i.length;j++){var F=i[j];this[F]=j<N?t:this.methodFactory(F,N,P)}this.log=this.debug}function c(N,P,j){return function(){typeof console!==r&&(u.call(this,P,j),this[N].apply(this,arguments))}}function d(N,P,j){return o(N)||c.apply(this,arguments)}function y(N,P,j){var F=this,me;P=P==null?"WARN":P;var ce="loglevel";typeof N=="string"?ce+=":"+N:typeof N=="symbol"&&(ce=void 0);function xe(le){var D=(i[le]||"silent").toUpperCase();if(!(typeof window===r||!ce)){try{window.localStorage[ce]=D;return}catch{}try{window.document.cookie=encodeURIComponent(ce)+"="+D+";"}catch{}}}function Ne(){var le;if(!(typeof window===r||!ce)){try{le=window.localStorage[ce]}catch{}if(typeof le===r)try{var D=window.document.cookie,Re=D.indexOf(encodeURIComponent(ce)+"=");Re!==-1&&(le=/^([^;]+)/.exec(D.slice(Re))[1])}catch{}return F.levels[le]===void 0&&(le=void 0),le}}function Me(){if(!(typeof window===r||!ce)){try{window.localStorage.removeItem(ce);return}catch{}try{window.document.cookie=encodeURIComponent(ce)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}F.name=N,F.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},F.methodFactory=j||d,F.getLevel=function(){return me},F.setLevel=function(le,D){if(typeof le=="string"&&F.levels[le.toUpperCase()]!==void 0&&(le=F.levels[le.toUpperCase()]),typeof le=="number"&&le>=0&&le<=F.levels.SILENT){if(me=le,D!==!1&&xe(le),u.call(F,le,N),typeof console===r&&le<F.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+le},F.setDefaultLevel=function(le){P=le,Ne()||F.setLevel(le,!1)},F.resetLevel=function(){F.setLevel(P,!1),Me()},F.enableAll=function(le){F.setLevel(F.levels.TRACE,le)},F.disableAll=function(le){F.setLevel(F.levels.SILENT,le)};var x=Ne();x==null&&(x=P),F.setLevel(x,!1)}var _=new y,b={};_.getLogger=function(P){if(typeof P!="symbol"&&typeof P!="string"||P==="")throw new TypeError("You must supply a name when creating a logger.");var j=b[P];return j||(j=b[P]=new y(P,_.getLevel(),_.methodFactory)),j};var k=typeof window!==r?window.log:void 0;return _.noConflict=function(){return typeof window!==r&&window.log===_&&(window.log=k),_},_.getLoggers=function(){return b},_.default=_,_})})(bo);const Ha="\\d+(?:[\\.,]\\d+)?",VB=`(${Ha}W)`,zB=`(${Ha}Y)?(${Ha}M)?(${Ha}D)?`,KB=`T(${Ha}H)?(${Ha}M)?(${Ha}S)?`,JB=`P(?:${VB}|${zB}(?:${KB})?)`,YB=["weeks","years","months","days","hours","minutes","seconds"],eg=new RegExp(JB),N0=e=>e.match(eg).slice(1).reduce((t,r,n)=>(t[YB[n]]=parseFloat(r)||0,t),{}),tg=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return n.setFullYear(n.getFullYear()+e.years),n.setMonth(n.getMonth()+e.months),n.setDate(n.getDate()+e.days),n.setHours(n.getHours()+e.hours),n.setMinutes(n.getMinutes()+e.minutes),n.setMilliseconds(n.getMilliseconds()+e.seconds*1e3),n.setDate(n.getDate()+e.weeks*7),n},x0=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return(tg(e,n).getTime()-n.getTime())/1e3},QB={end:tg,toSeconds:x0,pattern:eg,parse:N0},XB=Object.freeze(Object.defineProperty({__proto__:null,pattern:eg,parse:N0,end:tg,toSeconds:x0,default:QB},Symbol.toStringTag,{value:"Module"})),ZB=YP(XB);var e4=ct,t4=Gr.map,r4=Qu,n4=r4("map");e4({target:"Array",proto:!0,forced:!n4},{map:function(t){return t4(this,t,arguments.length>1?arguments[1]:void 0)}});var i4=Ot,a4=ia,s4=Zt.f,vh=i4("unscopables"),gh=Array.prototype;gh[vh]==null&&s4(gh,vh,{configurable:!0,value:a4(null)});var rg=function(e){gh[vh][e]=!0},o4=Hr,ng=rg,Vb=el,L0=dn,u4=Zt.f,l4=Xv,Nl=Zv,c4=Wt,j0="Array Iterator",f4=L0.set,d4=L0.getterFor(j0),U0=l4(Array,"Array",function(e,t){f4(this,{type:j0,target:o4(e),index:0,kind:t})},function(){var e=d4(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Nl(void 0,!0)):r=="keys"?Nl(n,!1):r=="values"?Nl(t[n],!1):Nl([n,t[n]],!1)},"values"),zb=Vb.Arguments=Vb.Array;ng("keys");ng("values");ng("entries");if(c4&&zb.name!=="values")try{u4(zb,"name",{value:"values"})}catch{}var Kb=dt,D0=m0,p4=b0,eu=U0,Md=gi,F0=Ot,Nd=F0("iterator"),Jb=F0("toStringTag"),xd=eu.values,B0=function(e,t){if(e){if(e[Nd]!==xd)try{Md(e,Nd,xd)}catch{e[Nd]=xd}if(e[Jb]||Md(e,Jb,t),D0[t]){for(var r in eu)if(e[r]!==eu[r])try{Md(e,r,eu[r])}catch{e[r]=eu[r]}}}};for(var Ld in D0)B0(Kb[Ld]&&Kb[Ld].prototype,Ld);B0(p4,"DOMTokenList");var h4=er,q0=function(){var e=h4(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},ig=nt,v4=dt,ag=v4.RegExp,sg=ig(function(){var e=ag("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),g4=sg||ig(function(){return!ag("a","y").sticky}),y4=sg||ig(function(){var e=ag("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),W0={BROKEN_CARET:y4,MISSED_STICKY:g4,UNSUPPORTED_Y:sg},m4=nt,b4=dt,w4=b4.RegExp,_4=m4(function(){var e=w4(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),S4=nt,$4=dt,k4=$4.RegExp,T4=S4(function(){var e=k4("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Ls=Mt,_f=et,E4=fr,C4=q0,I4=W0,R4=rs.exports,O4=ia,A4=dn.get,P4=_4,M4=T4,N4=R4("native-string-replace",String.prototype.replace),Tc=RegExp.prototype.exec,yh=Tc,x4=_f("".charAt),L4=_f("".indexOf),j4=_f("".replace),jd=_f("".slice),mh=function(){var e=/a/,t=/b*/g;return Ls(Tc,e,"a"),Ls(Tc,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),H0=I4.BROKEN_CARET,bh=/()??/.exec("")[1]!==void 0,U4=mh||bh||H0||P4||M4;U4&&(yh=function(t){var r=this,n=A4(r),i=E4(t),a=n.raw,s,o,u,c,d,y,_;if(a)return a.lastIndex=r.lastIndex,s=Ls(yh,a,i),r.lastIndex=a.lastIndex,s;var b=n.groups,k=H0&&r.sticky,N=Ls(C4,r),P=r.source,j=0,F=i;if(k&&(N=j4(N,"y",""),L4(N,"g")===-1&&(N+="g"),F=jd(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&x4(i,r.lastIndex-1)!==`
`)&&(P="(?: "+P+")",F=" "+F,j++),o=new RegExp("^(?:"+P+")",N)),bh&&(o=new RegExp("^"+P+"$(?!\\s)",N)),mh&&(u=r.lastIndex),c=Ls(Tc,k?o:r,F),k?c?(c.input=jd(c.input,j),c[0]=jd(c[0],j),c.index=r.lastIndex,r.lastIndex+=c[0].length):r.lastIndex=0:mh&&c&&(r.lastIndex=r.global?c.index+c[0].length:u),bh&&c&&c.length>1&&Ls(N4,c[0],o,function(){for(d=1;d<arguments.length-2;d++)arguments[d]===void 0&&(c[d]=void 0)}),c&&b)for(c.groups=y=O4(null),d=0;d<b.length;d++)_=b[d],y[_[0]]=c[_[1]];return c});var Sf=yh,D4=ct,Yb=Sf;D4({target:"RegExp",proto:!0,forced:/./.exec!==Yb},{exec:Yb});var Qb=et,Xb=mr,F4=Sf,Zb=nt,G0=Ot,B4=gi,q4=G0("species"),Ud=RegExp.prototype,$f=function(e,t,r,n){var i=G0(e),a=!Zb(function(){var c={};return c[i]=function(){return 7},""[e](c)!=7}),s=a&&!Zb(function(){var c=!1,d=/a/;return e==="split"&&(d={},d.constructor={},d.constructor[q4]=function(){return d},d.flags="",d[i]=/./[i]),d.exec=function(){return c=!0,null},d[i](""),!c});if(!a||!s||r){var o=Qb(/./[i]),u=t(i,""[e],function(c,d,y,_,b){var k=Qb(c),N=d.exec;return N===F4||N===Ud.exec?a&&!b?{done:!0,value:o(d,y,_)}:{done:!0,value:k(y,d,_)}:{done:!1}});Xb(String.prototype,e,u[0]),Xb(Ud,i,u[1])}n&&B4(Ud[i],"sham",!0)},W4=Qv.charAt,og=function(e,t,r){return t+(r?W4(e,t).length:1)},ug=et,H4=yr,G4=Math.floor,Dd=ug("".charAt),V4=ug("".replace),Fd=ug("".slice),z4=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,K4=/\$([$&'`]|\d{1,2})/g,J4=function(e,t,r,n,i,a){var s=r+e.length,o=n.length,u=K4;return i!==void 0&&(i=H4(i),u=z4),V4(a,u,function(c,d){var y;switch(Dd(d,0)){case"$":return"$";case"&":return e;case"`":return Fd(t,0,r);case"'":return Fd(t,s);case"<":y=i[Fd(d,1,-1)];break;default:var _=+d;if(_===0)return c;if(_>o){var b=G4(_/10);return b===0?c:b<=o?n[b-1]===void 0?Dd(d,1):n[b-1]+Dd(d,1):c}y=n[_-1]}return y===void 0?"":y})},ew=Mt,Y4=er,Q4=Nt,X4=ta,Z4=Sf,e5=TypeError,kf=function(e,t){var r=e.exec;if(Q4(r)){var n=ew(r,e,t);return n!==null&&Y4(n),n}if(X4(e)==="RegExp")return ew(Z4,e,t);throw e5("RegExp#exec called on incompatible receiver")},t5=na,tw=Mt,Tf=et,r5=$f,n5=nt,i5=er,a5=Nt,s5=Gn,o5=yi,u5=mi,ws=fr,l5=Vn,c5=og,f5=ts,d5=J4,p5=kf,h5=Ot,wh=h5("replace"),v5=Math.max,g5=Math.min,y5=Tf([].concat),Bd=Tf([].push),rw=Tf("".indexOf),nw=Tf("".slice),m5=function(e){return e===void 0?e:String(e)},b5=function(){return"a".replace(/./,"$0")==="$0"}(),iw=function(){return/./[wh]?/./[wh]("a","$0")==="":!1}(),w5=!n5(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});r5("replace",function(e,t,r){var n=iw?"$":"$0";return[function(a,s){var o=l5(this),u=s5(a)?void 0:f5(a,wh);return u?tw(u,a,o,s):tw(t,ws(o),a,s)},function(i,a){var s=i5(this),o=ws(i);if(typeof a=="string"&&rw(a,n)===-1&&rw(a,"$<")===-1){var u=r(t,s,o,a);if(u.done)return u.value}var c=a5(a);c||(a=ws(a));var d=s.global;if(d){var y=s.unicode;s.lastIndex=0}for(var _=[];;){var b=p5(s,o);if(b===null||(Bd(_,b),!d))break;var k=ws(b[0]);k===""&&(s.lastIndex=c5(o,u5(s.lastIndex),y))}for(var N="",P=0,j=0;j<_.length;j++){b=_[j];for(var F=ws(b[0]),me=v5(g5(o5(b.index),o.length),0),ce=[],xe=1;xe<b.length;xe++)Bd(ce,m5(b[xe]));var Ne=b.groups;if(c){var Me=y5([F],ce,me,o);Ne!==void 0&&Bd(Me,Ne);var x=ws(t5(a,void 0,Me))}else x=d5(F,o,me,ce,Ne,a);me>=P&&(N+=nw(o,P,me)+x,P=me+F.length)}return N+nw(o,P)}]},!w5||!b5||iw);var _5=ct,S5=et,$5=Du,k5=Hr,T5=rl,E5=S5([].join),C5=$5!=Object,I5=T5("join",",");_5({target:"Array",proto:!0,forced:C5||!I5},{join:function(t){return E5(k5(this),t===void 0?",":t)}});var ir={},R5=ct,aw=Ku,O5=of,A5=Vt,sw=ns,P5=br,M5=Hr,N5=vo,x5=Ot,L5=Qu,j5=ho,U5=L5("slice"),D5=x5("species"),qd=Array,F5=Math.max;R5({target:"Array",proto:!0,forced:!U5},{slice:function(t,r){var n=M5(this),i=P5(n),a=sw(t,i),s=sw(r===void 0?i:r,i),o,u,c;if(aw(n)&&(o=n.constructor,O5(o)&&(o===qd||aw(o.prototype))?o=void 0:A5(o)&&(o=o[D5],o===null&&(o=void 0)),o===qd||o===void 0))return j5(n,a,s);for(u=new(o===void 0?qd:o)(F5(s-a,0)),c=0;a<s;a++,c++)a in n&&N5(u,c,n[a]);return u.length=c,u}});var B5=ct,q5=Wt,W5=dt,xl=et,H5=zt,G5=Nt,V5=vi,z5=fr,K5=Zt.f,J5=lk,ni=W5.Symbol,Ta=ni&&ni.prototype;if(q5&&G5(ni)&&(!("description"in Ta)||ni().description!==void 0)){var ow={},Ll=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:z5(arguments[0]),r=V5(Ta,this)?new ni(t):t===void 0?ni():ni(t);return t===""&&(ow[r]=!0),r};J5(Ll,ni),Ll.prototype=Ta,Ta.constructor=Ll;var Y5=String(ni("test"))=="Symbol(test)",Q5=xl(Ta.valueOf),X5=xl(Ta.toString),Z5=/^Symbol\((.*)\)[^)]+$/,e6=xl("".replace),t6=xl("".slice);K5(Ta,"description",{configurable:!0,get:function(){var t=Q5(this);if(H5(ow,t))return"";var r=X5(t),n=Y5?t6(r,7,-1):e6(r,Z5,"$1");return n===""?void 0:n}}),B5({global:!0,constructor:!0,forced:!0},{Symbol:Ll})}var r6=Ck;r6("iterator");var n6=Wt,i6=qu.EXISTS,V0=et,a6=Zt.f,z0=Function.prototype,s6=V0(z0.toString),K0=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,o6=V0(K0.exec),u6="name";n6&&!i6&&a6(z0,u6,{configurable:!0,get:function(){try{return o6(K0,s6(this))[1]}catch{return""}}});var l6=Vt,c6=Math.floor,J0=Number.isInteger||function(t){return!l6(t)&&isFinite(t)&&c6(t)===t},f6=ct,d6=J0;f6({target:"Number",stat:!0},{isInteger:d6});var il={exports:{}},Y0={exports:{}};(function(e){function t(r){if(Array.isArray(r))return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Y0);var Q0={exports:{}};(function(e){function t(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var a=[],s=!0,o=!1,u,c;try{for(i=i.call(r);!(s=(u=i.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(d){o=!0,c=d}finally{try{!s&&i.return!=null&&i.return()}finally{if(o)throw c}}return a}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Q0);var lg={exports:{}},cg={exports:{}};(function(e){function t(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,a=new Array(n);i<n;i++)a[i]=r[i];return a}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(cg);(function(e){var t=cg.exports;function r(n,i){if(!!n){if(typeof n=="string")return t(n,i);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(n,i)}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(lg);var X0={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(X0);(function(e){var t=Y0.exports,r=Q0.exports,n=lg.exports,i=X0.exports;function a(s,o){return t(s)||r(s,o)||n(s,o)||i()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(il);var p6=Wt,Z0=et,h6=Vu,v6=Hr,g6=Uu.f,y6=Z0(g6),m6=Z0([].push),uw=function(e){return function(t){for(var r=v6(t),n=h6(r),i=n.length,a=0,s=[],o;i>a;)o=n[a++],(!p6||y6(r,o))&&m6(s,e?[o,r[o]]:r[o]);return s}},b6={entries:uw(!0),values:uw(!1)},w6=ct,_6=b6.entries;w6({target:"Object",stat:!0},{entries:function(t){return _6(t)}});var al={exports:{}},e1={exports:{}};(function(e){var t=cg.exports;function r(n){if(Array.isArray(n))return t(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(e1);var t1={exports:{}};(function(e){function t(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(t1);var r1={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(r1);(function(e){var t=e1.exports,r=t1.exports,n=lg.exports,i=r1.exports;function a(s){return t(s)||r(s)||n(s)||i()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(al);var S6=ct,$6=af.includes,k6=nt,T6=rg,E6=k6(function(){return!Array(1).includes()});S6({target:"Array",proto:!0,forced:E6},{includes:function(t){return $6(this,t,arguments.length>1?arguments[1]:void 0)}});T6("includes");/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(ir,"__esModule",{value:!0});var C6=la.exports,I6=il.exports,R6=al.exports,O6=fa.exports,A6=oa.exports,P6=ua.exports,M6=zn.exports;function ss(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ws=ss(C6),za=ss(I6),Wd=ss(R6),N6=ss(O6),x6=ss(A6),L6=ss(P6),lw=ss(M6),da=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function j6(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=U6(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function U6(e,t){if(!!e){if(typeof e=="string")return cw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cw(e,t)}}function cw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var n1=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return da(function(i){var a=!1,s=[],o=j6(r),u;try{for(o.s();!(u=o.n()).done;){var c=u.value;if(typeof c=="string"){a=a||Ws.default(i)===c,s.push("of type ".concat(c));continue}a=a||i instanceof c,s.push("an instance of ".concat(c.name))}}catch(d){o.e(d)}finally{o.f()}return[a,s]})};function D6(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=F6(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function F6(e,t){if(!!e){if(typeof e=="string")return fw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fw(e,t)}}function fw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var B6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return da(function(i){var a=!1,s=[],o=D6(r),u;try{for(o.s();!(u=o.n()).done;){var c=u.value;a=a||i===c,s.push(typeof c=="string"?'"'.concat(c,'"'):"".concat(c))}}catch(d){o.e(d)}finally{o.f()}return[a,s]})},q6=da(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),W6=da(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),H6=da(function(e){return[Ws.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]});function G6(e){var t=V6();return function(){var n=lw.default(e),i;if(t){var a=lw.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return L6.default(this,i)}}function V6(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ou(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=z6(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function z6(e,t){if(!!e){if(typeof e=="string")return dw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dw(e,t)}}function dw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ef=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Ou(r.entries()),i;try{for(n.s();!(i=n.n()).done;){var a=za.default(i.value,2),s=a[0],o=a[1],u=pg(t[s],o),c=za.default(u,4),d=c[0],y=c[1],_=c[2],b=c[3];if(!d){var k=s+1;throw new Error("Argument ".concat(k," is expected to be ").concat(_).concat(b," but got ").concat(y))}}}catch(N){n.e(N)}finally{n.f()}},i1=function(t){var r,n,i=["undefined","boolean","number","bigint","string"];if(i.includes(Ws.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Ws.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var a;n=t===null?"null":"instance of ".concat(t==null||(a=t.constructor)===null||a===void 0?void 0:a.name)}return n||(n=Ws.default(t)),n},K6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=fg(r);return function(a){return function(s){x6.default(u,s);var o=G6(u);function u(){N6.default(this,u);for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];return Ef(i,d),o.call.apply(o,[this].concat(d))}return u}(a)}},J6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=fg(r);return function(a,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];return Ef(i,d),u.apply(this,d)}}},Y6=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=fg(r);return function(a,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];try{Ef(i,d)}catch(_){return Promise.reject(_)}return u.apply(this,d)}}},fg=function(t){var r=[],n=Ou(t),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;r.push(dg(a))}}catch(s){n.e(s)}finally{n.f()}return r},dg=function(t){var r=[],n=Array.isArray(t)?t:[t],i=Ou(n),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;if(typeof s=="string"||typeof s=="function"){r.push(n1(s));continue}r.push(s)}}catch(o){i.e(o)}finally{i.f()}return r},pg=function(t,r){var n=[],i,a=!1,s=Ou(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,c=Ou(u.checks),d;try{for(c.s();!(d=c.n()).done;){var y=d.value,_=y(r),b=za.default(_,3),k=b[0],N=b[1],P=b[2];a=a||k,!i&&P&&(i=P),N&&(n=typeof N=="string"?[].concat(Wd.default(n),[N]):[].concat(Wd.default(n),Wd.default(N)))}}catch(ce){c.e(ce)}finally{c.f()}}}catch(ce){s.e(ce)}finally{s.f()}if(a)return[!0];var j=i||i1(r),F=n.length-1,me=F>0?"".concat(n.slice(0,F).join(", ")," or ").concat(n[F]):n.join(", ");return[!1,j,me,F>1?";":","]},Q6=function(t,r){return da(function(n){if(Ws.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var i=0,a=Object.entries(r);i<a.length;i++){var s=za.default(a[i],2),o=s[0],u=s[1],c=pg(dg(u),n[o]),d=za.default(c,3),y=d[0],_=d[1],b=d[2];if(!y)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(_,")")]}return[!0]})};function X6(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Z6(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function Z6(e,t){if(!!e){if(typeof e=="string")return pw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pw(e,t)}}function pw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var e8=function(t,r){return da(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var i=X6(n.entries()),a;try{for(i.s();!(a=i.n()).done;){var s=za.default(a.value,2),o=s[0],u=s[1],c=pg(dg(r),u),d=za.default(c,3),y=d[0],_=d[1],b=d[2];if(!y)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(_,")")]}}catch(k){i.e(k)}finally{i.f()}return[!0]})};ir.array=e8;ir.custom=da;ir.literal=B6;ir.nonEmptyString=q6;ir.nonNegativeInteger=W6;ir.objectSchema=Q6;ir.pureObject=H6;ir.runtimeTypeValidation=Ef;ir.stringifyReceivedType=i1;ir.type=n1;ir.validateConstructorTypes=K6;ir.validateTypes=J6;ir.validateTypesAsync=Y6;var hg={},Cf={exports:{}},a1={exports:{}};(function(e){var t=zn.exports;function r(n,i){for(;!Object.prototype.hasOwnProperty.call(n,i)&&(n=t(n),n!==null););return n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(a1);(function(e){var t=a1.exports;function r(){return typeof Reflect<"u"&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(i,a,s){var o=t(i,a);if(!!o){var u=Object.getOwnPropertyDescriptor(o,a);return u.get?u.get.call(arguments.length<3?i:s):u.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Cf);/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(hg,"__esModule",{value:!0});var t8=al.exports,r8=fa.exports,n8=is.exports,i8=sa.exports,a8=Cf.exports,s8=oa.exports,o8=ua.exports,u8=zn.exports,l8=ca.exports;function _i(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var c8=_i(t8),f8=_i(r8),d8=_i(n8),p8=_i(i8),_s=_i(a8),h8=_i(s8),v8=_i(o8),Ui=_i(u8),g8=_i(l8),y8;function Ki(){}Ki.prototype=Object.create(null);function Pt(){Pt.init.call(this)}Pt.EventEmitter=Pt;Pt.usingDomains=!1;Pt.prototype.domain=void 0;Pt.prototype._events=void 0;Pt.prototype._maxListeners=void 0;Pt.defaultMaxListeners=10;Pt.init=function(){this.domain=null,Pt.usingDomains&&y8.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ki,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Pt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function s1(e){return e._maxListeners===void 0?Pt.defaultMaxListeners:e._maxListeners}Pt.prototype.getMaxListeners=function(){return s1(this)};function m8(e,t,r){if(t)e.call(r);else for(var n=e.length,i=sl(e,n),a=0;a<n;++a)i[a].call(r)}function b8(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=sl(e,i),s=0;s<i;++s)a[s].call(r,n)}function w8(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=sl(e,a),o=0;o<a;++o)s[o].call(r,n,i)}function _8(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,o=sl(e,s),u=0;u<s;++u)o[u].call(r,n,i,a)}function S8(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=sl(e,i),s=0;s<i;++s)a[s].apply(r,n)}Pt.prototype.emit=function(t){var r,n,i,a,s,o,u,c=t==="error";if(o=this._events,o)c=c&&o.error==null;else if(!c)return!1;if(u=this.domain,c){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=o[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:m8(n,y,this);break;case 2:b8(n,y,this,arguments[1]);break;case 3:w8(n,y,this,arguments[1],arguments[2]);break;case 4:_8(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];S8(n,y,this,a)}return!0};function o1(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Ki,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=s1(e),i&&i>0&&s.length>i)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,$8(o)}return e}function $8(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Pt.prototype.addListener=function(t,r){return o1(this,t,r,!1)};Pt.prototype.on=Pt.prototype.addListener;Pt.prototype.prependListener=function(t,r){return o1(this,t,r,!0)};function u1(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}Pt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,u1(this,t,r)),this};Pt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,u1(this,t,r)),this};Pt.prototype.removeListener=function(t,r){var n,i,a,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Ki:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Ki,this;delete i[t]}else k8(n,a);i.removeListener&&this.emit("removeListener",t,o||r)}return this};Pt.prototype.off=function(e,t){return this.removeListener(e,t)};Pt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Ki,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Ki:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Ki,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Pt.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=T8(r):n=[]):n=[],n};Pt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):l1.call(e,t)};Pt.prototype.listenerCount=l1;function l1(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Pt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function k8(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function sl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function T8(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function E8(e){var t=C8();return function(){var n=Ui.default(e),i;if(t){var a=Ui.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return v8.default(this,i)}}function C8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var I8=function(e){h8.default(r,e);var t=E8(r);function r(){var n;return f8.default(this,r),n=t.call(this),g8.default(p8.default(n),"eventHistory",new Map),n}return d8.default(r,[{key:"on",value:function(i,a){return _s.default(Ui.default(r.prototype),"on",this).call(this,i,a)}},{key:"once",value:function(i,a){return _s.default(Ui.default(r.prototype),"once",this).call(this,i,a)}},{key:"off",value:function(i,a){return _s.default(Ui.default(r.prototype),"off",this).call(this,i,a)}},{key:"emit",value:function(i){for(var a,s=arguments.length,o=new Array(s>1?s-1:0),u=1;u<s;u++)o[u-1]=arguments[u];return this.eventHistory.set(i,o),(a=_s.default(Ui.default(r.prototype),"emit",this)).call.apply(a,[this,i].concat(o))}},{key:"addListener",value:function(i,a){return _s.default(Ui.default(r.prototype),"addListener",this).call(this,i,a)}},{key:"removeListener",value:function(i,a){return _s.default(Ui.default(r.prototype),"removeListener",this).call(this,i,a)}},{key:"addListenerWithReplay",value:function(i,a){var s=this.eventHistory.get(i);return s!==void 0&&a.apply(void 0,c8.default(s)),this.addListener(i,a)}},{key:"onWithReplay",value:function(i,a){return this.addListenerWithReplay(i,a)}}]),r}(Pt);hg.ReplayEventEmitter=I8;var _h={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,a=2,s=9007199254740991,o="[object Arguments]",u="[object Array]",c="[object AsyncFunction]",d="[object Boolean]",y="[object Date]",_="[object Error]",b="[object Function]",k="[object GeneratorFunction]",N="[object Map]",P="[object Number]",j="[object Null]",F="[object Object]",me="[object Promise]",ce="[object Proxy]",xe="[object RegExp]",Ne="[object Set]",Me="[object String]",x="[object Symbol]",le="[object Undefined]",D="[object WeakMap]",Re="[object ArrayBuffer]",Ie="[object DataView]",ue="[object Float32Array]",ee="[object Float64Array]",se="[object Int8Array]",ne="[object Int16Array]",be="[object Int32Array]",O="[object Uint8Array]",je="[object Uint8ClampedArray]",ft="[object Uint16Array]",Je="[object Uint32Array]",fe=/[\\^$.*+?()[\]{}|]/g,G=/^\[object .+?Constructor\]$/,Y=/^(?:0|[1-9]\d*)$/,$={};$[ue]=$[ee]=$[se]=$[ne]=$[be]=$[O]=$[je]=$[ft]=$[Je]=!0,$[o]=$[u]=$[Re]=$[d]=$[Ie]=$[y]=$[_]=$[b]=$[N]=$[P]=$[F]=$[xe]=$[Ne]=$[Me]=$[D]=!1;var C=typeof kn=="object"&&kn&&kn.Object===Object&&kn,Z=typeof self=="object"&&self&&self.Object===Object&&self,te=C||Z||Function("return this")(),Ae=t&&!t.nodeType&&t,De=Ae&&!0&&e&&!e.nodeType&&e,de=De&&De.exports===Ae,$e=de&&C.process,E=function(){try{return $e&&$e.binding&&$e.binding("util")}catch{}}(),T=E&&E.isTypedArray;function V(R,J){for(var ve=-1,Be=R==null?0:R.length,Bt=0,ut=[];++ve<Be;){var Kt=R[ve];J(Kt,ve,R)&&(ut[Bt++]=Kt)}return ut}function re(R,J){for(var ve=-1,Be=J.length,Bt=R.length;++ve<Be;)R[Bt+ve]=J[ve];return R}function W(R,J){for(var ve=-1,Be=R==null?0:R.length;++ve<Be;)if(J(R[ve],ve,R))return!0;return!1}function ke(R,J){for(var ve=-1,Be=Array(R);++ve<R;)Be[ve]=J(ve);return Be}function he(R){return function(J){return R(J)}}function we(R,J){return R.has(J)}function Oe(R,J){return R==null?void 0:R[J]}function z(R){var J=-1,ve=Array(R.size);return R.forEach(function(Be,Bt){ve[++J]=[Bt,Be]}),ve}function Ue(R,J){return function(ve){return R(J(ve))}}function ae(R){var J=-1,ve=Array(R.size);return R.forEach(function(Be){ve[++J]=Be}),ve}var q=Array.prototype,Ce=Function.prototype,B=Object.prototype,Se=te["__core-js_shared__"],Ge=Ce.toString,tt=B.hasOwnProperty,tr=function(){var R=/[^.]+$/.exec(Se&&Se.keys&&Se.keys.IE_PROTO||"");return R?"Symbol(src)_1."+R:""}(),wr=B.toString,hn=RegExp("^"+Ge.call(tt).replace(fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ir=de?te.Buffer:void 0,mt=te.Symbol,Ut=te.Uint8Array,oe=B.propertyIsEnumerable,pe=q.splice,Q=mt?mt.toStringTag:void 0,ie=Object.getOwnPropertySymbols,X=Ir?Ir.isBuffer:void 0,ye=Ue(Object.keys,Object),Te=At(te,"DataView"),Le=At(te,"Map"),Xe=At(te,"Promise"),st=At(te,"Set"),rt=At(te,"WeakMap"),Fe=At(Object,"create"),_r=p(Te),Qe=p(Le),Ht=p(Xe),Dt=p(st),$i=p(rt),Kn=mt?mt.prototype:void 0,Pn=Kn?Kn.valueOf:void 0;function Ct(R){var J=-1,ve=R==null?0:R.length;for(this.clear();++J<ve;){var Be=R[J];this.set(Be[0],Be[1])}}function Ft(){this.__data__=Fe?Fe(null):{},this.size=0}function Lr(R){var J=this.has(R)&&delete this.__data__[R];return this.size-=J?1:0,J}function Rr(R){var J=this.__data__;if(Fe){var ve=J[R];return ve===n?void 0:ve}return tt.call(J,R)?J[R]:void 0}function ha(R){var J=this.__data__;return Fe?J[R]!==void 0:tt.call(J,R)}function ls(R,J){var ve=this.__data__;return this.size+=this.has(R)?0:1,ve[R]=Fe&&J===void 0?n:J,this}Ct.prototype.clear=Ft,Ct.prototype.delete=Lr,Ct.prototype.get=Rr,Ct.prototype.has=ha,Ct.prototype.set=ls;function jr(R){var J=-1,ve=R==null?0:R.length;for(this.clear();++J<ve;){var Be=R[J];this.set(Be[0],Be[1])}}function cs(){this.__data__=[],this.size=0}function So(R){var J=this.__data__,ve=Ti(J,R);if(ve<0)return!1;var Be=J.length-1;return ve==Be?J.pop():pe.call(J,ve,1),--this.size,!0}function $o(R){var J=this.__data__,ve=Ti(J,R);return ve<0?void 0:J[ve][1]}function dr(R){return Ti(this.__data__,R)>-1}function vn(R,J){var ve=this.__data__,Be=Ti(ve,R);return Be<0?(++this.size,ve.push([R,J])):ve[Be][1]=J,this}jr.prototype.clear=cs,jr.prototype.delete=So,jr.prototype.get=$o,jr.prototype.has=dr,jr.prototype.set=vn;function Kr(R){var J=-1,ve=R==null?0:R.length;for(this.clear();++J<ve;){var Be=R[J];this.set(Be[0],Be[1])}}function St(){this.size=0,this.__data__={hash:new Ct,map:new(Le||jr),string:new Ct}}function ko(R){var J=Yn(this,R).delete(R);return this.size-=J?1:0,J}function To(R){return Yn(this,R).get(R)}function Eo(R){return Yn(this,R).has(R)}function fs(R,J){var ve=Yn(this,R),Be=ve.size;return ve.set(R,J),this.size+=ve.size==Be?0:1,this}Kr.prototype.clear=St,Kr.prototype.delete=ko,Kr.prototype.get=To,Kr.prototype.has=Eo,Kr.prototype.set=fs;function Jn(R){var J=-1,ve=R==null?0:R.length;for(this.__data__=new Kr;++J<ve;)this.add(R[J])}function Co(R){return this.__data__.set(R,n),this}function Io(R){return this.__data__.has(R)}Jn.prototype.add=Jn.prototype.push=Co,Jn.prototype.has=Io;function Jr(R){var J=this.__data__=new jr(R);this.size=J.size}function Sr(){this.__data__=new jr,this.size=0}function Ro(R){var J=this.__data__,ve=J.delete(R);return this.size=J.size,ve}function Oo(R){return this.__data__.get(R)}function Ao(R){return this.__data__.has(R)}function Po(R,J){var ve=this.__data__;if(ve instanceof jr){var Be=ve.__data__;if(!Le||Be.length<r-1)return Be.push([R,J]),this.size=++ve.size,this;ve=this.__data__=new Kr(Be)}return ve.set(R,J),this.size=ve.size,this}Jr.prototype.clear=Sr,Jr.prototype.delete=Ro,Jr.prototype.get=Oo,Jr.prototype.has=Ao,Jr.prototype.set=Po;function ki(R,J){var ve=h(R),Be=!ve&&g(R),Bt=!ve&&!Be&&S(R),ut=!ve&&!Be&&!Bt&&at(R),Kt=ve||Be||Bt||ut,ar=Kt?ke(R.length,String):[],cr=ar.length;for(var Gt in R)(J||tt.call(R,Gt))&&!(Kt&&(Gt=="length"||Bt&&(Gt=="offset"||Gt=="parent")||ut&&(Gt=="buffer"||Gt=="byteLength"||Gt=="byteOffset")||I(Gt,cr)))&&ar.push(Gt);return ar}function Ti(R,J){for(var ve=R.length;ve--;)if(f(R[ve][0],J))return ve;return-1}function Ei(R,J,ve){var Be=J(R);return h(R)?Be:re(Be,ve(R))}function gn(R){return R==null?R===void 0?le:j:Q&&Q in Object(R)?Yr(R):l(R)}function va(R){return We(R)&&gn(R)==o}function ds(R,J,ve,Be,Bt){return R===J?!0:R==null||J==null||!We(R)&&!We(J)?R!==R&&J!==J:ps(R,J,ve,Be,ds,Bt)}function ps(R,J,ve,Be,Bt,ut){var Kt=h(R),ar=h(J),cr=Kt?u:Qr(R),Gt=ar?u:Qr(J);cr=cr==o?F:cr,Gt=Gt==o?F:Gt;var Ur=cr==F,yn=Gt==F,pr=cr==Gt;if(pr&&S(R)){if(!S(J))return!1;Kt=!0,Ur=!1}if(pr&&!Ur)return ut||(ut=new Jr),Kt||at(R)?ga(R,J,ve,Be,Bt,ut):hs(R,J,cr,ve,Be,Bt,ut);if(!(ve&i)){var Xr=Ur&&tt.call(R,"__wrapped__"),Zr=yn&&tt.call(J,"__wrapped__");if(Xr||Zr){var Ii=Xr?R.value():R,Qn=Zr?J.value():J;return ut||(ut=new Jr),Bt(Ii,Qn,ve,Be,ut)}}return pr?(ut||(ut=new Jr),Ci(R,J,ve,Be,Bt,ut)):!1}function Mo(R){if(!ge(R)||m(R))return!1;var J=U(R)?hn:G;return J.test(p(R))}function No(R){return We(R)&&K(R.length)&&!!$[gn(R)]}function $t(R){if(!v(R))return ye(R);var J=[];for(var ve in Object(R))tt.call(R,ve)&&ve!="constructor"&&J.push(ve);return J}function ga(R,J,ve,Be,Bt,ut){var Kt=ve&i,ar=R.length,cr=J.length;if(ar!=cr&&!(Kt&&cr>ar))return!1;var Gt=ut.get(R);if(Gt&&ut.get(J))return Gt==J;var Ur=-1,yn=!0,pr=ve&a?new Jn:void 0;for(ut.set(R,J),ut.set(J,R);++Ur<ar;){var Xr=R[Ur],Zr=J[Ur];if(Be)var Ii=Kt?Be(Zr,Xr,Ur,J,R,ut):Be(Xr,Zr,Ur,R,J,ut);if(Ii!==void 0){if(Ii)continue;yn=!1;break}if(pr){if(!W(J,function(Qn,ba){if(!we(pr,ba)&&(Xr===Qn||Bt(Xr,Qn,ve,Be,ut)))return pr.push(ba)})){yn=!1;break}}else if(!(Xr===Zr||Bt(Xr,Zr,ve,Be,ut))){yn=!1;break}}return ut.delete(R),ut.delete(J),yn}function hs(R,J,ve,Be,Bt,ut,Kt){switch(ve){case Ie:if(R.byteLength!=J.byteLength||R.byteOffset!=J.byteOffset)return!1;R=R.buffer,J=J.buffer;case Re:return!(R.byteLength!=J.byteLength||!ut(new Ut(R),new Ut(J)));case d:case y:case P:return f(+R,+J);case _:return R.name==J.name&&R.message==J.message;case xe:case Me:return R==J+"";case N:var ar=z;case Ne:var cr=Be&i;if(ar||(ar=ae),R.size!=J.size&&!cr)return!1;var Gt=Kt.get(R);if(Gt)return Gt==J;Be|=a,Kt.set(R,J);var Ur=ga(ar(R),ar(J),Be,Bt,ut,Kt);return Kt.delete(R),Ur;case x:if(Pn)return Pn.call(R)==Pn.call(J)}return!1}function Ci(R,J,ve,Be,Bt,ut){var Kt=ve&i,ar=ya(R),cr=ar.length,Gt=ya(J),Ur=Gt.length;if(cr!=Ur&&!Kt)return!1;for(var yn=cr;yn--;){var pr=ar[yn];if(!(Kt?pr in J:tt.call(J,pr)))return!1}var Xr=ut.get(R);if(Xr&&ut.get(J))return Xr==J;var Zr=!0;ut.set(R,J),ut.set(J,R);for(var Ii=Kt;++yn<cr;){pr=ar[yn];var Qn=R[pr],ba=J[pr];if(Be)var ry=Kt?Be(ba,Qn,pr,J,R,ut):Be(Qn,ba,pr,R,J,ut);if(!(ry===void 0?Qn===ba||Bt(Qn,ba,ve,Be,ut):ry)){Zr=!1;break}Ii||(Ii=pr=="constructor")}if(Zr&&!Ii){var hl=R.constructor,vl=J.constructor;hl!=vl&&"constructor"in R&&"constructor"in J&&!(typeof hl=="function"&&hl instanceof hl&&typeof vl=="function"&&vl instanceof vl)&&(Zr=!1)}return ut.delete(R),ut.delete(J),Zr}function ya(R){return Ei(R,Ve,ma)}function Yn(R,J){var ve=R.__data__;return A(J)?ve[typeof J=="string"?"string":"hash"]:ve.map}function At(R,J){var ve=Oe(R,J);return Mo(ve)?ve:void 0}function Yr(R){var J=tt.call(R,Q),ve=R[Q];try{R[Q]=void 0;var Be=!0}catch{}var Bt=wr.call(R);return Be&&(J?R[Q]=ve:delete R[Q]),Bt}var ma=ie?function(R){return R==null?[]:(R=Object(R),V(ie(R),function(J){return oe.call(R,J)}))}:ot,Qr=gn;(Te&&Qr(new Te(new ArrayBuffer(1)))!=Ie||Le&&Qr(new Le)!=N||Xe&&Qr(Xe.resolve())!=me||st&&Qr(new st)!=Ne||rt&&Qr(new rt)!=D)&&(Qr=function(R){var J=gn(R),ve=J==F?R.constructor:void 0,Be=ve?p(ve):"";if(Be)switch(Be){case _r:return Ie;case Qe:return N;case Ht:return me;case Dt:return Ne;case $i:return D}return J});function I(R,J){return J=J==null?s:J,!!J&&(typeof R=="number"||Y.test(R))&&R>-1&&R%1==0&&R<J}function A(R){var J=typeof R;return J=="string"||J=="number"||J=="symbol"||J=="boolean"?R!=="__proto__":R===null}function m(R){return!!tr&&tr in R}function v(R){var J=R&&R.constructor,ve=typeof J=="function"&&J.prototype||B;return R===ve}function l(R){return wr.call(R)}function p(R){if(R!=null){try{return Ge.call(R)}catch{}try{return R+""}catch{}}return""}function f(R,J){return R===J||R!==R&&J!==J}var g=va(function(){return arguments}())?va:function(R){return We(R)&&tt.call(R,"callee")&&!oe.call(R,"callee")},h=Array.isArray;function w(R){return R!=null&&K(R.length)&&!U(R)}var S=X||Or;function L(R,J){return ds(R,J)}function U(R){if(!ge(R))return!1;var J=gn(R);return J==b||J==k||J==c||J==ce}function K(R){return typeof R=="number"&&R>-1&&R%1==0&&R<=s}function ge(R){var J=typeof R;return R!=null&&(J=="object"||J=="function")}function We(R){return R!=null&&typeof R=="object"}var at=T?he(T):No;function Ve(R){return w(R)?ki(R):$t(R)}function ot(){return[]}function Or(){return!1}e.exports=L})(_h,_h.exports);var vg={exports:{}},R8=nt,O8=R8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),A8=nt,P8=Vt,M8=ta,hw=O8,lc=Object.isExtensible,N8=A8(function(){lc(1)}),x8=N8||hw?function(t){return!P8(t)||hw&&M8(t)=="ArrayBuffer"?!1:lc?lc(t):!0}:lc,L8=nt,j8=!L8(function(){return Object.isExtensible(Object.preventExtensions({}))}),U8=ct,D8=et,F8=Wu,B8=Vt,gg=zt,q8=Zt.f,vw=ra,W8=Av,yg=x8,H8=Fu,G8=j8,c1=!1,ci=H8("meta"),V8=0,mg=function(e){q8(e,ci,{value:{objectID:"O"+V8++,weakData:{}}})},z8=function(e,t){if(!B8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!gg(e,ci)){if(!yg(e))return"F";if(!t)return"E";mg(e)}return e[ci].objectID},K8=function(e,t){if(!gg(e,ci)){if(!yg(e))return!0;if(!t)return!1;mg(e)}return e[ci].weakData},J8=function(e){return G8&&c1&&yg(e)&&!gg(e,ci)&&mg(e),e},Y8=function(){Q8.enable=function(){},c1=!0;var e=vw.f,t=D8([].splice),r={};r[ci]=1,e(r).length&&(vw.f=function(n){for(var i=e(n),a=0,s=i.length;a<s;a++)if(i[a]===ci){t(i,a,1);break}return i},U8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:W8.f}))},Q8=vg.exports={enable:Y8,fastKey:z8,getWeakData:K8,onFreeze:J8};F8[ci]=!0;var X8=ct,Z8=dt,eq=et,gw=sf,tq=mr,rq=vg.exports,nq=mf,iq=as,aq=Nt,sq=Gn,Hd=Vt,Gd=nt,oq=bf,uq=aa,lq=Kv,f1=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,a=n?"set":"add",s=Z8[e],o=s&&s.prototype,u=s,c={},d=function(j){var F=eq(o[j]);tq(o,j,j=="add"?function(ce){return F(this,ce===0?0:ce),this}:j=="delete"?function(me){return i&&!Hd(me)?!1:F(this,me===0?0:me)}:j=="get"?function(ce){return i&&!Hd(ce)?void 0:F(this,ce===0?0:ce)}:j=="has"?function(ce){return i&&!Hd(ce)?!1:F(this,ce===0?0:ce)}:function(ce,xe){return F(this,ce===0?0:ce,xe),this})},y=gw(e,!aq(s)||!(i||o.forEach&&!Gd(function(){new s().entries().next()})));if(y)u=r.getConstructor(t,e,n,a),rq.enable();else if(gw(e,!0)){var _=new u,b=_[a](i?{}:-0,1)!=_,k=Gd(function(){_.has(1)}),N=oq(function(j){new s(j)}),P=!i&&Gd(function(){for(var j=new s,F=5;F--;)j[a](F,F);return!j.has(-0)});N||(u=t(function(j,F){iq(j,o);var me=lq(new s,j,u);return sq(F)||nq(F,me[a],{that:me,AS_ENTRIES:n}),me}),u.prototype=o,o.constructor=u),(k||P)&&(d("delete"),d("has"),n&&d("get")),(P||b)&&d(a),i&&o.clear&&delete o.clear}return c[e]=u,X8({global:!0,constructor:!0,forced:u!=s},c),uq(u,e),i||r.setStrong(u,e,n),u},cq=mr,bg=function(e,t,r){for(var n in t)cq(e,n,t[n],r);return e},fq=Zt.f,dq=ia,yw=bg,pq=wi,hq=as,vq=Gn,gq=mf,yq=Xv,jl=Zv,mq=hf,Bo=Wt,mw=vg.exports.fastKey,d1=dn,bw=d1.set,Vd=d1.getterFor,p1={getConstructor:function(e,t,r,n){var i=e(function(c,d){hq(c,a),bw(c,{type:t,index:dq(null),first:void 0,last:void 0,size:0}),Bo||(c.size=0),vq(d)||gq(d,c[n],{that:c,AS_ENTRIES:r})}),a=i.prototype,s=Vd(t),o=function(c,d,y){var _=s(c),b=u(c,d),k,N;return b?b.value=y:(_.last=b={index:N=mw(d,!0),key:d,value:y,previous:k=_.last,next:void 0,removed:!1},_.first||(_.first=b),k&&(k.next=b),Bo?_.size++:c.size++,N!=="F"&&(_.index[N]=b)),c},u=function(c,d){var y=s(c),_=mw(d),b;if(_!=="F")return y.index[_];for(b=y.first;b;b=b.next)if(b.key==d)return b};return yw(a,{clear:function(){for(var d=this,y=s(d),_=y.index,b=y.first;b;)b.removed=!0,b.previous&&(b.previous=b.previous.next=void 0),delete _[b.index],b=b.next;y.first=y.last=void 0,Bo?y.size=0:d.size=0},delete:function(c){var d=this,y=s(d),_=u(d,c);if(_){var b=_.next,k=_.previous;delete y.index[_.index],_.removed=!0,k&&(k.next=b),b&&(b.previous=k),y.first==_&&(y.first=b),y.last==_&&(y.last=k),Bo?y.size--:d.size--}return!!_},forEach:function(d){for(var y=s(this),_=pq(d,arguments.length>1?arguments[1]:void 0),b;b=b?b.next:y.first;)for(_(b.value,b.key,this);b&&b.removed;)b=b.previous},has:function(d){return!!u(this,d)}}),yw(a,r?{get:function(d){var y=u(this,d);return y&&y.value},set:function(d,y){return o(this,d===0?0:d,y)}}:{add:function(d){return o(this,d=d===0?0:d,d)}}),Bo&&fq(a,"size",{get:function(){return s(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=Vd(t),a=Vd(n);yq(e,t,function(s,o){bw(this,{type:n,target:s,state:i(s),kind:o,last:void 0})},function(){for(var s=a(this),o=s.kind,u=s.last;u&&u.removed;)u=u.previous;return!s.target||!(s.last=u=u?u.next:s.state.first)?(s.target=void 0,jl(void 0,!0)):o=="keys"?jl(u.key,!1):o=="values"?jl(u.value,!1):jl([u.key,u.value],!1)},r?"entries":"values",!r,!0),mq(t)}},bq=f1,wq=p1;bq("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},wq);var Si={};/*
@license
Copyright (c) 2016, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/Object.defineProperty(Si,"__esModule",{value:!0});var _q=fa.exports,Sq=is.exports,$q=sa.exports,kq=oa.exports,Tq=ua.exports,Eq=zn.exports,Cq=ca.exports;function os(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var wg=os(_q),_g=os(Sq),ai=os($q),Sg=os(kq),h1=os(Tq),Ec=os(Eq),si=os(Cq),Iq;function Ji(){}Ji.prototype=Object.create(null);function Tt(){Tt.init.call(this)}Tt.EventEmitter=Tt;Tt.usingDomains=!1;Tt.prototype.domain=void 0;Tt.prototype._events=void 0;Tt.prototype._maxListeners=void 0;Tt.defaultMaxListeners=10;Tt.init=function(){this.domain=null,Tt.usingDomains&&Iq.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ji,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Tt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function v1(e){return e._maxListeners===void 0?Tt.defaultMaxListeners:e._maxListeners}Tt.prototype.getMaxListeners=function(){return v1(this)};function Rq(e,t,r){if(t)e.call(r);else for(var n=e.length,i=ol(e,n),a=0;a<n;++a)i[a].call(r)}function Oq(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=ol(e,i),s=0;s<i;++s)a[s].call(r,n)}function Aq(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=ol(e,a),o=0;o<a;++o)s[o].call(r,n,i)}function Pq(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,o=ol(e,s),u=0;u<s;++u)o[u].call(r,n,i,a)}function Mq(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=ol(e,i),s=0;s<i;++s)a[s].apply(r,n)}Tt.prototype.emit=function(t){var r,n,i,a,s,o,u,c=t==="error";if(o=this._events,o)c=c&&o.error==null;else if(!c)return!1;if(u=this.domain,c){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=o[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:Rq(n,y,this);break;case 2:Oq(n,y,this,arguments[1]);break;case 3:Aq(n,y,this,arguments[1],arguments[2]);break;case 4:Pq(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];Mq(n,y,this,a)}return!0};function g1(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Ji,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=v1(e),i&&i>0&&s.length>i)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,Nq(o)}return e}function Nq(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Tt.prototype.addListener=function(t,r){return g1(this,t,r,!1)};Tt.prototype.on=Tt.prototype.addListener;Tt.prototype.prependListener=function(t,r){return g1(this,t,r,!0)};function y1(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}Tt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,y1(this,t,r)),this};Tt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,y1(this,t,r)),this};Tt.prototype.removeListener=function(t,r){var n,i,a,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Ji:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Ji,this;delete i[t]}else xq(n,a);i.removeListener&&this.emit("removeListener",t,o||r)}return this};Tt.prototype.off=function(e,t){return this.removeListener(e,t)};Tt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Ji,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Ji:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Ji,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Tt.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=Lq(r):n=[]):n=[],n};Tt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):m1.call(e,t)};Tt.prototype.listenerCount=m1;function m1(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Tt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function xq(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function ol(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function Lq(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function b1(e){var t=jq();return function(){var n=Ec.default(e),i;if(t){var a=Ec.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return h1.default(this,i)}}function jq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var w1=function(e){Sg.default(r,e);var t=b1(r);function r(n){var i;return wg.default(this,r),i=t.call(this),si.default(ai.default(i),"timeout",null),si.default(ai.default(i),"startTimestamp",-1),i.minDelay=n.min,i.maxDelay=n.max,i.initialDelay=n.initial||0,i.maxAttemptsCount=n.maxAttemptsCount||0,i.maxAttemptsTime=n.maxAttemptsTime||0,i.randomness=n.randomness||0,i.inProgress=!1,i.attemptNum=0,i.prevDelay=0,i.currDelay=0,i}return _g.default(r,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(i){if(typeof i=="number")return this.prevDelay=0,this.currDelay=i,i;if(this.attemptNum==0)return this.initialDelay;if(this.attemptNum==1)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var a=this.currDelay+this.prevDelay;return this.maxDelay&&a>this.maxDelay&&(this.currDelay=this.maxDelay,a=this.maxDelay),this.currDelay=a,a}},{key:"randomize",value:function(i){var a=i*this.randomness,s=Math.round(Math.random()*a*2-a);return Math.max(0,i+s)}},{key:"scheduleAttempt",value:function(i){var a=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount){this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached"));return}var s=this.nextDelay(i);if(s=this.randomize(s),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+s){this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached"));return}this.timeout=setTimeout(function(){return a.attempt()},s)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(i){this.emit("succeeded",i)}},{key:"failed",value:function(i,a){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(a)}}]),r}(Tt),Uq=function(e){Sg.default(r,e);var t=b1(r);function r(n){var i;return wg.default(this,r),i=t.call(this),si.default(ai.default(i),"resolve",function(){}),si.default(ai.default(i),"reject",function(){}),i.retrier=new w1(n),i}return _g.default(r,[{key:"run",value:function(i){var a=this;return this.retrier.on("attempt",function(){i().then(function(s){return a.retrier.succeeded(s)}).catch(function(s){return a.retrier.failed(s)})}),this.retrier.on("succeeded",function(s){return a.resolve(s)}),this.retrier.on("cancelled",function(){return a.reject(new Error("Cancelled"))}),this.retrier.on("failed",function(s){return a.reject(s)}),new Promise(function(s,o){a.resolve=s,a.reject=o,a.retrier.start()})}},{key:"cancel",value:function(){this.retrier.cancel()}}]),r}(Tt);function Dq(e){var t=Fq();return function(){var n=Ec.default(e),i;if(t){var a=Ec.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return h1.default(this,i)}}function Fq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ul(e){return e!=null}var Bq=function(e){Sg.default(r,e);var t=Dq(r);function r(n){var i;wg.default(this,r),i=t.call(this),si.default(ai.default(i),"backoffDelay",0),si.default(ai.default(i),"nextBackoffDelay",0),si.default(ai.default(i),"backoffNumber",0),si.default(ai.default(i),"timeoutID",null),si.default(ai.default(i),"maxNumberOfRetry",-1),n=n||{};var a=n,s=a.initialDelay,o=a.maxDelay,u=a.randomisationFactor,c=a.factor;if(Ul(s)&&s<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(Ul(o)&&o<=1)throw new Error("The maximal timeout must be greater than 1.");if(Ul(u)&&(u<0||u>1))throw new Error("The randomisation factor must be between 0 and 1.");if(Ul(c)&&c<=1)throw new Error("Exponential factor should be greater than 1.");if(i.initialDelay=s||100,i.maxDelay=o||1e4,i.maxDelay<=i.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return i.randomisationFactor=u||0,i.factor=c||2,i.reset(),i}return _g.default(r,[{key:"backoff",value:function(i){this.timeoutID==null&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",i),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,i)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(i){if(i<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(i));this.maxNumberOfRetry=i}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var i=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*i))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(i){return new r(i)}}]),r}(Tt);Si.AsyncRetrier=Uq;Si.Backoff=Bq;Si.Retrier=w1;var If={},qq=Mt,Wq=zt,Hq=vi,Gq=q0,ww=RegExp.prototype,Vq=function(e){var t=e.flags;return t===void 0&&!("flags"in ww)&&!Wq(e,"flags")&&Hq(ww,e)?qq(Gq,e):t},zq=qu.PROPER,Kq=mr,Jq=er,_w=fr,Yq=nt,Qq=Vq,$g="toString",Xq=RegExp.prototype,_1=Xq[$g],Zq=Yq(function(){return _1.call({source:"a",flags:"b"})!="/a/b"}),eW=zq&&_1.name!=$g;(Zq||eW)&&Kq(RegExp.prototype,$g,function(){var t=Jq(this),r=_w(t.source),n=_w(Qq(t));return"/"+r+"/"+n},{unsafe:!0});var tW=f1,rW=p1;tW("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},rW);var S1={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(kn,function(){return function(r){var n={};function i(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return r[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=r,i.c=n,i.i=function(a){return a},i.d=function(a,s,o){i.o(a,s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!0,get:o})},i.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(s,"a",s),s},i.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},i.p="",i(i.s=5)}([function(r,n,i){r.exports=function(a,s){var o,u,c;for(o=1;o<arguments.length;o++){u=arguments[o];for(c in u)u.hasOwnProperty(c)&&(a[c]=u[c])}return a}},function(r,n,i){var a=i(0);r.exports={build:function(s,o){var u,c,d,y=o.plugins;for(u=0,c=y.length;u<c;u++)d=y[u],d.methods&&a(s,d.methods),d.properties&&Object.defineProperties(s,d.properties)},hook:function(s,o,u){var c,d,y,_,b=s.config.plugins,k=[s.context];for(u&&(k=k.concat(u)),c=0,d=b.length;c<d;c++)_=b[c],y=b[c][o],y&&y.apply(_,k)}}},function(r,n,i){function a(s){if(s.length===0)return s;var o,u,c=s.split(/[_-]/);if(c.length===1&&c[0][0].toLowerCase()===c[0][0])return s;for(u=c[0].toLowerCase(),o=1;o<c.length;o++)u=u+c[o].charAt(0).toUpperCase()+c[o].substring(1).toLowerCase();return u}a.prepended=function(s,o){return o=a(o),s+o[0].toUpperCase()+o.substring(1)},r.exports=a},function(r,n,i){var a=i(0),s=i(2);function o(u,c){u=u||{},this.options=u,this.defaults=c.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(u.init),this.data=this.configureData(u.data),this.methods=this.configureMethods(u.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(u.transitions||[]),this.plugins=this.configurePlugins(u.plugins,c.plugin)}a(o.prototype,{addState:function(u){this.map[u]||(this.states.push(u),this.addStateLifecycleNames(u),this.map[u]={})},addStateLifecycleNames:function(u){this.lifecycle.onEnter[u]=s.prepended("onEnter",u),this.lifecycle.onLeave[u]=s.prepended("onLeave",u),this.lifecycle.on[u]=s.prepended("on",u)},addTransition:function(u){this.transitions.indexOf(u)<0&&(this.transitions.push(u),this.addTransitionLifecycleNames(u))},addTransitionLifecycleNames:function(u){this.lifecycle.onBefore[u]=s.prepended("onBefore",u),this.lifecycle.onAfter[u]=s.prepended("onAfter",u),this.lifecycle.on[u]=s.prepended("on",u)},mapTransition:function(u){var c=u.name,d=u.from,y=u.to;return this.addState(d),typeof y!="function"&&this.addState(y),this.addTransition(c),this.map[d][c]=u,u},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(u){return typeof u=="string"?this.mapTransition(a({},this.defaults.init,{to:u,active:!0})):typeof u=="object"?this.mapTransition(a({},this.defaults.init,u,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(u){return typeof u=="function"?u:typeof u=="object"?function(){return u}:function(){return{}}},configureMethods:function(u){return u||{}},configurePlugins:function(u,c){u=u||[];var d,y,_;for(d=0,y=u.length;d<y;d++)_=u[d],typeof _=="function"&&(u[d]=_=_()),_.configure&&_.configure(this);return u},configureTransitions:function(u){var c,d,y,_,b,k=this.defaults.wildcard;for(d=0;d<u.length;d++)for(y=u[d],_=Array.isArray(y.from)?y.from:[y.from||k],b=y.to||k,c=0;c<_.length;c++)this.mapTransition({name:y.name,from:_[c],to:b})},transitionFor:function(u,c){var d=this.defaults.wildcard;return this.map[u][c]||this.map[d][c]},transitionsFor:function(u){var c=this.defaults.wildcard;return Object.keys(this.map[u]).concat(Object.keys(this.map[c]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),r.exports=o},function(r,n,i){var a=i(0),s=i(6),o=i(1),u=[null,[]];function c(d,y){this.context=d,this.config=y,this.state=y.init.from,this.observers=[d]}a(c.prototype,{init:function(d){if(a(this.context,this.config.data.apply(this.context,d)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(d){return Array.isArray(d)?d.indexOf(this.state)>=0:this.state===d},isPending:function(){return this.pending},can:function(d){return!this.isPending()&&!!this.seek(d)},cannot:function(d){return!this.can(d)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(d,y){var _=this.config.defaults.wildcard,b=this.config.transitionFor(this.state,d),k=b&&b.to;return typeof k=="function"?k.apply(this.context,y):k===_?this.state:k},fire:function(d,y){return this.transit(d,this.state,this.seek(d,y),y)},transit:function(d,y,_,b){var k=this.config.lifecycle,N=this.config.options.observeUnchangedState||y!==_;return _?this.isPending()?this.context.onPendingTransition(d,y,_):(this.config.addState(_),this.beginTransit(),b.unshift({transition:d,from:y,to:_,fsm:this.context}),this.observeEvents([this.observersForEvent(k.onBefore.transition),this.observersForEvent(k.onBefore[d]),N?this.observersForEvent(k.onLeave.state):u,N?this.observersForEvent(k.onLeave[y]):u,this.observersForEvent(k.on.transition),N?["doTransit",[this]]:u,N?this.observersForEvent(k.onEnter.state):u,N?this.observersForEvent(k.onEnter[_]):u,N?this.observersForEvent(k.on[_]):u,this.observersForEvent(k.onAfter.transition),this.observersForEvent(k.onAfter[d]),this.observersForEvent(k.on[d])],b)):this.context.onInvalidTransition(d,y,_)},beginTransit:function(){this.pending=!0},endTransit:function(d){return this.pending=!1,d},failTransit:function(d){throw this.pending=!1,d},doTransit:function(d){this.state=d.to},observe:function(d){if(d.length===2){var y={};y[d[0]]=d[1],this.observers.push(y)}else this.observers.push(d[0])},observersForEvent:function(d){for(var y=0,_=this.observers.length,b,k=[];y<_;y++)b=this.observers[y],b[d]&&k.push(b);return[d,k,!0]},observeEvents:function(d,y,_,b){if(d.length===0)return this.endTransit(b===void 0?!0:b);var k=d[0][0],N=d[0][1],P=d[0][2];if(y[0].event=k,k&&P&&k!==_&&o.hook(this,"lifecycle",y),N.length===0)return d.shift(),this.observeEvents(d,y,k,b);var j=N.shift(),F=j[k].apply(j,y);return F&&typeof F.then=="function"?F.then(this.observeEvents.bind(this,d,y,k)).catch(this.failTransit.bind(this)):F===!1?this.endTransit(!1):this.observeEvents(d,y,k,F)},onInvalidTransition:function(d,y,_){throw new s("transition is invalid in current state",d,y,_,this.state)},onPendingTransition:function(d,y,_){throw new s("transition is invalid while previous transition is still in progress",d,y,_,this.state)}}),r.exports=c},function(r,n,i){var a=i(0),s=i(2),o=i(1),u=i(3),c=i(4),d={is:function(P){return this._fsm.is(P)},can:function(P){return this._fsm.can(P)},cannot:function(P){return this._fsm.cannot(P)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(P,j,F){return this._fsm.onInvalidTransition(P,j,F)},onPendingTransition:function(P,j,F){return this._fsm.onPendingTransition(P,j,F)}},y={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(P){throw Error("use transitions to change state")}}};function _(P){return k(this||{},P)}function b(){var P,j;typeof arguments[0]=="function"?(P=arguments[0],j=arguments[1]||{}):(P=function(){this._fsm.apply(this,arguments)},j=arguments[0]||{});var F=new u(j,_);return N(P.prototype,F),P.prototype._fsm.config=F,P}function k(P,j){var F=new u(j,_);return N(P,F),P._fsm(),P}function N(P,j){if(typeof P!="object"||Array.isArray(P))throw Error("StateMachine can only be applied to objects");o.build(P,j),Object.defineProperties(P,y),a(P,d),a(P,j.methods),j.allTransitions().forEach(function(F){P[s(F)]=function(){return this._fsm.fire(F,[].slice.call(arguments))}}),P._fsm=function(){this._fsm=new c(this,j),this._fsm.init(arguments)}}_.version="3.0.1",_.factory=b,_.apply=k,_.defaults={wildcard:"*",init:{name:"init",from:"none"}},r.exports=_},function(r,n,i){r.exports=function(a,s,o,u,c){this.message=a,this.transition=s,this.from=o,this.to=u,this.current=c}}])})})(S1);var Cc={exports:{}},Sw=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Sw){var $w=new Uint8Array(16);Cc.exports=function(){return Sw($w),$w}}else{var kw=new Array(16);Cc.exports=function(){for(var t=0,r;t<16;t++)(t&3)===0&&(r=Math.random()*4294967296),kw[t]=r>>>((t&3)<<3)&255;return kw}}var $1=[];for(var Dl=0;Dl<256;++Dl)$1[Dl]=(Dl+256).toString(16).substr(1);function nW(e,t){var r=t||0,n=$1;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var k1=nW,iW=Cc.exports,aW=k1,Tw,zd,Kd=0,Jd=0;function sW(e,t,r){var n=t&&r||0,i=t||[];e=e||{};var a=e.node||Tw,s=e.clockseq!==void 0?e.clockseq:zd;if(a==null||s==null){var o=iW();a==null&&(a=Tw=[o[0]|1,o[1],o[2],o[3],o[4],o[5]]),s==null&&(s=zd=(o[6]<<8|o[7])&16383)}var u=e.msecs!==void 0?e.msecs:new Date().getTime(),c=e.nsecs!==void 0?e.nsecs:Jd+1,d=u-Kd+(c-Jd)/1e4;if(d<0&&e.clockseq===void 0&&(s=s+1&16383),(d<0||u>Kd)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Kd=u,Jd=c,zd=s,u+=122192928e5;var y=((u&268435455)*1e4+c)%4294967296;i[n++]=y>>>24&255,i[n++]=y>>>16&255,i[n++]=y>>>8&255,i[n++]=y&255;var _=u/4294967296*1e4&268435455;i[n++]=_>>>8&255,i[n++]=_&255,i[n++]=_>>>24&15|16,i[n++]=_>>>16&255,i[n++]=s>>>8|128,i[n++]=s&255;for(var b=0;b<6;++b)i[n+b]=a[b];return t||aW(i)}var oW=sW,uW=Cc.exports,lW=k1;function cW(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||uW)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var a=0;a<16;++a)t[n+a]=i[a];return t||lW(i)}var fW=cW,dW=oW,T1=fW,kg=T1;kg.v1=dW;kg.v4=T1;var Rf=kg,Sh={exports:{}},E1=typeof ArrayBuffer<"u"&&typeof DataView<"u",pW=E1,Tg=Wt,Er=dt,C1=Nt,Of=Vt,ea=zt,Eg=bi,hW=es,vW=gi,$h=mr,gW=Zt.f,yW=vi,Af=wf,wo=yo,mW=Ot,bW=Fu,I1=dn,R1=I1.enforce,wW=I1.get,Ic=Er.Int8Array,kh=Ic&&Ic.prototype,Ew=Er.Uint8ClampedArray,Cw=Ew&&Ew.prototype,Fn=Ic&&Af(Ic),Tn=kh&&Af(kh),_W=Object.prototype,Cg=Er.TypeError,Iw=mW("toStringTag"),Th=bW("TYPED_ARRAY_TAG"),Rc="TypedArrayConstructor",fi=pW&&!!wo&&Eg(Er.opera)!=="Opera",O1=!1,Mr,Bi,Hs,di={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ig={BigInt64Array:8,BigUint64Array:8},SW=function(t){if(!Of(t))return!1;var r=Eg(t);return r==="DataView"||ea(di,r)||ea(Ig,r)},A1=function(e){var t=Af(e);if(!!Of(t)){var r=wW(t);return r&&ea(r,Rc)?r[Rc]:A1(t)}},P1=function(e){if(!Of(e))return!1;var t=Eg(e);return ea(di,t)||ea(Ig,t)},$W=function(e){if(P1(e))return e;throw Cg("Target is not a typed array")},kW=function(e){if(C1(e)&&(!wo||yW(Fn,e)))return e;throw Cg(hW(e)+" is not a typed array constructor")},TW=function(e,t,r,n){if(!!Tg){if(r)for(var i in di){var a=Er[i];if(a&&ea(a.prototype,e))try{delete a.prototype[e]}catch{try{a.prototype[e]=t}catch{}}}(!Tn[e]||r)&&$h(Tn,e,r?t:fi&&kh[e]||t,n)}},EW=function(e,t,r){var n,i;if(!!Tg){if(wo){if(r){for(n in di)if(i=Er[n],i&&ea(i,e))try{delete i[e]}catch{}}if(!Fn[e]||r)try{return $h(Fn,e,r?t:fi&&Fn[e]||t)}catch{}else return}for(n in di)i=Er[n],i&&(!i[e]||r)&&$h(i,e,t)}};for(Mr in di)Bi=Er[Mr],Hs=Bi&&Bi.prototype,Hs?R1(Hs)[Rc]=Bi:fi=!1;for(Mr in Ig)Bi=Er[Mr],Hs=Bi&&Bi.prototype,Hs&&(R1(Hs)[Rc]=Bi);if((!fi||!C1(Fn)||Fn===Function.prototype)&&(Fn=function(){throw Cg("Incorrect invocation")},fi))for(Mr in di)Er[Mr]&&wo(Er[Mr],Fn);if((!fi||!Tn||Tn===_W)&&(Tn=Fn.prototype,fi))for(Mr in di)Er[Mr]&&wo(Er[Mr].prototype,Tn);fi&&Af(Cw)!==Tn&&wo(Cw,Tn);if(Tg&&!ea(Tn,Iw)){O1=!0,gW(Tn,Iw,{get:function(){return Of(this)?this[Th]:void 0}});for(Mr in di)Er[Mr]&&vW(Er[Mr],Th,Mr)}var Lt={NATIVE_ARRAY_BUFFER_VIEWS:fi,TYPED_ARRAY_TAG:O1&&Th,aTypedArray:$W,aTypedArrayConstructor:kW,exportTypedArrayMethod:TW,exportTypedArrayStaticMethod:EW,getTypedArrayConstructor:A1,isView:SW,isTypedArray:P1,TypedArray:Fn,TypedArrayPrototype:Tn},M1=dt,Yd=nt,CW=bf,IW=Lt.NATIVE_ARRAY_BUFFER_VIEWS,RW=M1.ArrayBuffer,Ea=M1.Int8Array,OW=!IW||!Yd(function(){Ea(1)})||!Yd(function(){new Ea(-1)})||!CW(function(e){new Ea,new Ea(null),new Ea(1.5),new Ea(e)},!0)||Yd(function(){return new Ea(new RW(2),1,void 0).length!==1}),AW=yi,PW=mi,MW=RangeError,N1=function(e){if(e===void 0)return 0;var t=AW(e),r=PW(t);if(t!==r)throw MW("Wrong length or index");return r},NW=Array,xW=Math.abs,ii=Math.pow,LW=Math.floor,jW=Math.log,UW=Math.LN2,DW=function(e,t,r){var n=NW(r),i=r*8-t-1,a=(1<<i)-1,s=a>>1,o=t===23?ii(2,-24)-ii(2,-77):0,u=e<0||e===0&&1/e<0?1:0,c=0,d,y,_;for(e=xW(e),e!=e||e===1/0?(y=e!=e?1:0,d=a):(d=LW(jW(e)/UW),_=ii(2,-d),e*_<1&&(d--,_*=2),d+s>=1?e+=o/_:e+=o*ii(2,1-s),e*_>=2&&(d++,_/=2),d+s>=a?(y=0,d=a):d+s>=1?(y=(e*_-1)*ii(2,t),d=d+s):(y=e*ii(2,s-1)*ii(2,t),d=0));t>=8;)n[c++]=y&255,y/=256,t-=8;for(d=d<<t|y,i+=t;i>0;)n[c++]=d&255,d/=256,i-=8;return n[--c]|=u*128,n},FW=function(e,t){var r=e.length,n=r*8-t-1,i=(1<<n)-1,a=i>>1,s=n-7,o=r-1,u=e[o--],c=u&127,d;for(u>>=7;s>0;)c=c*256+e[o--],s-=8;for(d=c&(1<<-s)-1,c>>=-s,s+=t;s>0;)d=d*256+e[o--],s-=8;if(c===0)c=1-a;else{if(c===i)return d?NaN:u?-1/0:1/0;d=d+ii(2,t),c=c-a}return(u?-1:1)*d*ii(2,c-t)},BW={pack:DW,unpack:FW},qW=yr,Rw=ns,WW=br,x1=function(t){for(var r=qW(this),n=WW(r),i=arguments.length,a=Rw(i>1?arguments[1]:void 0,n),s=i>2?arguments[2]:void 0,o=s===void 0?n:Rw(s,n);o>a;)r[a++]=t;return r},Pf=dt,Rg=et,Qd=Wt,HW=E1,L1=qu,Ow=gi,Aw=bg,Xd=nt,Fl=as,GW=yi,VW=mi,Oc=N1,j1=BW,zW=wf,Pw=yo,KW=ra.f,JW=Zt.f,YW=x1,QW=zu,U1=aa,D1=dn,XW=L1.PROPER,Mw=L1.CONFIGURABLE,ro=D1.get,Nw=D1.set,Ac="ArrayBuffer",F1="DataView",Gs="prototype",ZW="Wrong length",B1="Wrong index",an=Pf[Ac],Fr=an,Ss=Fr&&Fr[Gs],jn=Pf[F1],Ca=jn&&jn[Gs],xw=Object.prototype,eH=Pf.Array,Pc=Pf.RangeError,tH=Rg(YW),rH=Rg([].reverse),q1=j1.pack,Lw=j1.unpack,jw=function(e){return[e&255]},Uw=function(e){return[e&255,e>>8&255]},Dw=function(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]},Fw=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},nH=function(e){return q1(e,23,4)},iH=function(e){return q1(e,52,8)},Bl=function(e,t){JW(e[Gs],t,{get:function(){return ro(this)[t]}})},Pi=function(e,t,r,n){var i=Oc(r),a=ro(e);if(i+t>a.byteLength)throw Pc(B1);var s=ro(a.buffer).bytes,o=i+a.byteOffset,u=QW(s,o,o+t);return n?u:rH(u)},Mi=function(e,t,r,n,i,a){var s=Oc(r),o=ro(e);if(s+t>o.byteLength)throw Pc(B1);for(var u=ro(o.buffer).bytes,c=s+o.byteOffset,d=n(+i),y=0;y<t;y++)u[c+y]=d[a?y:t-y-1]};if(!HW)Fr=function(t){Fl(this,Ss);var r=Oc(t);Nw(this,{bytes:tH(eH(r),0),byteLength:r}),Qd||(this.byteLength=r)},Ss=Fr[Gs],jn=function(t,r,n){Fl(this,Ca),Fl(t,Ss);var i=ro(t).byteLength,a=GW(r);if(a<0||a>i)throw Pc("Wrong offset");if(n=n===void 0?i-a:VW(n),a+n>i)throw Pc(ZW);Nw(this,{buffer:t,byteLength:n,byteOffset:a}),Qd||(this.buffer=t,this.byteLength=n,this.byteOffset=a)},Ca=jn[Gs],Qd&&(Bl(Fr,"byteLength"),Bl(jn,"buffer"),Bl(jn,"byteLength"),Bl(jn,"byteOffset")),Aw(Ca,{getInt8:function(t){return Pi(this,1,t)[0]<<24>>24},getUint8:function(t){return Pi(this,1,t)[0]},getInt16:function(t){var r=Pi(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t){var r=Pi(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function(t){return Fw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Lw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Lw(Pi(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,r){Mi(this,1,t,jw,r)},setUint8:function(t,r){Mi(this,1,t,jw,r)},setInt16:function(t,r){Mi(this,2,t,Uw,r,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,r){Mi(this,2,t,Uw,r,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,r){Mi(this,4,t,Dw,r,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,r){Mi(this,4,t,Dw,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,r){Mi(this,4,t,nH,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,r){Mi(this,8,t,iH,r,arguments.length>2?arguments[2]:void 0)}});else{var Bw=XW&&an.name!==Ac;if(!Xd(function(){an(1)})||!Xd(function(){new an(-1)})||Xd(function(){return new an,new an(1.5),new an(NaN),an.length!=1||Bw&&!Mw})){Fr=function(t){return Fl(this,Ss),new an(Oc(t))},Fr[Gs]=Ss;for(var qw=KW(an),Ww=0,Zd;qw.length>Ww;)(Zd=qw[Ww++])in Fr||Ow(Fr,Zd,an[Zd]);Ss.constructor=Fr}else Bw&&Mw&&Ow(an,"name",Ac);Pw&&zW(Ca)!==xw&&Pw(Ca,xw);var ql=new jn(new Fr(2)),Hw=Rg(Ca.setInt8);ql.setInt8(0,2147483648),ql.setInt8(1,2147483649),(ql.getInt8(0)||!ql.getInt8(1))&&Aw(Ca,{setInt8:function(t,r){Hw(this,t,r<<24>>24)},setUint8:function(t,r){Hw(this,t,r<<24>>24)}},{unsafe:!0})}U1(Fr,Ac);U1(jn,F1);var W1={ArrayBuffer:Fr,DataView:jn},aH=yi,sH=RangeError,oH=function(e){var t=aH(e);if(t<0)throw sH("The argument can't be less than 0");return t},uH=oH,lH=RangeError,H1=function(e,t){var r=uH(e);if(r%t)throw lH("Wrong offset");return r},cH=bi,fH=et,dH=fH("".slice),pH=function(e){return dH(cH(e),0,3)==="Big"},hH=_v,vH=TypeError,G1=function(e){var t=hH(e,"number");if(typeof t=="number")throw vH("Can't convert number to bigint");return BigInt(t)},gH=wi,yH=Mt,mH=Iv,bH=yr,wH=br,_H=yf,SH=tl,$H=zv,kH=pH,TH=Lt.aTypedArrayConstructor,EH=G1,CH=function(t){var r=mH(this),n=bH(t),i=arguments.length,a=i>1?arguments[1]:void 0,s=a!==void 0,o=SH(n),u,c,d,y,_,b,k,N;if(o&&!$H(o))for(k=_H(n,o),N=k.next,n=[];!(b=yH(N,k)).done;)n.push(b.value);for(s&&i>2&&(a=gH(a,arguments[2])),c=wH(n),d=new(TH(r))(c),y=kH(d),u=0;c>u;u++)_=s?a(n[u],u):n[u],d[u]=y?EH(_):+_;return d},Gw=ct,V1=dt,Vw=Mt,IH=Wt,RH=OW,_o=Lt,z1=W1,zw=as,OH=Qa,qo=gi,AH=J0,PH=mi,Kw=N1,ep=H1,K1=Bu,Wo=zt,MH=bi,Eh=Vt,NH=po,xH=ia,LH=vi,Wl=yo,jH=ra.f,Jw=CH,UH=Gr.forEach,DH=hf,J1=Zt,Y1=Hn,Og=dn,FH=Kv,Ch=Og.get,BH=Og.set,qH=Og.enforce,Ag=J1.f,WH=Y1.f,HH=Math.round,tp=V1.RangeError,Q1=z1.ArrayBuffer,GH=Q1.prototype,VH=z1.DataView,Hl=_o.NATIVE_ARRAY_BUFFER_VIEWS,Yw=_o.TYPED_ARRAY_TAG,Qw=_o.TypedArray,Ho=_o.TypedArrayPrototype,zH=_o.aTypedArrayConstructor,Ih=_o.isTypedArray,Gl="BYTES_PER_ELEMENT",rp="Wrong length",Xw=function(e,t){zH(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},Vl=function(e,t){Ag(e,t,{get:function(){return Ch(this)[t]}})},Zw=function(e){var t;return LH(GH,e)||(t=MH(e))=="ArrayBuffer"||t=="SharedArrayBuffer"},X1=function(e,t){return Ih(e)&&!NH(t)&&t in e&&AH(+t)&&t>=0},e_=function(t,r){return r=K1(r),X1(t,r)?OH(2,t[r]):WH(t,r)},t_=function(t,r,n){return r=K1(r),X1(t,r)&&Eh(n)&&Wo(n,"value")&&!Wo(n,"get")&&!Wo(n,"set")&&!n.configurable&&(!Wo(n,"writable")||n.writable)&&(!Wo(n,"enumerable")||n.enumerable)?(t[r]=n.value,t):Ag(t,r,n)};IH?(Hl||(Y1.f=e_,J1.f=t_,Vl(Ho,"buffer"),Vl(Ho,"byteOffset"),Vl(Ho,"byteLength"),Vl(Ho,"length")),Gw({target:"Object",stat:!0,forced:!Hl},{getOwnPropertyDescriptor:e_,defineProperty:t_}),Sh.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",a="get"+e,s="set"+e,o=V1[i],u=o,c=u&&u.prototype,d={},y=function(N,P){var j=Ch(N);return j.view[a](P*n+j.byteOffset,!0)},_=function(N,P,j){var F=Ch(N);r&&(j=(j=HH(j))<0?0:j>255?255:j&255),F.view[s](P*n+F.byteOffset,j,!0)},b=function(N,P){Ag(N,P,{get:function(){return y(this,P)},set:function(j){return _(this,P,j)},enumerable:!0})};Hl?RH&&(u=t(function(N,P,j,F){return zw(N,c),FH(function(){return Eh(P)?Zw(P)?F!==void 0?new o(P,ep(j,n),F):j!==void 0?new o(P,ep(j,n)):new o(P):Ih(P)?Xw(u,P):Vw(Jw,u,P):new o(Kw(P))}(),N,u)}),Wl&&Wl(u,Qw),UH(jH(o),function(N){N in u||qo(u,N,o[N])}),u.prototype=c):(u=t(function(N,P,j,F){zw(N,c);var me=0,ce=0,xe,Ne,Me;if(!Eh(P))Me=Kw(P),Ne=Me*n,xe=new Q1(Ne);else if(Zw(P)){xe=P,ce=ep(j,n);var x=P.byteLength;if(F===void 0){if(x%n||(Ne=x-ce,Ne<0))throw tp(rp)}else if(Ne=PH(F)*n,Ne+ce>x)throw tp(rp);Me=Ne/n}else return Ih(P)?Xw(u,P):Vw(Jw,u,P);for(BH(N,{buffer:xe,byteOffset:ce,byteLength:Ne,length:Me,view:new VH(xe)});me<Me;)b(N,me++)}),Wl&&Wl(u,Qw),c=u.prototype=xH(Ho)),c.constructor!==u&&qo(c,"constructor",u),qH(c).TypedArrayConstructor=u,Yw&&qo(c,Yw,i);var k=u!=o;d[i]=u,Gw({global:!0,constructor:!0,forced:k,sham:!Hl},d),Gl in u||qo(u,Gl,n),Gl in c||qo(c,Gl,n),DH(i)}):Sh.exports=function(){};var KH=Sh.exports;KH("Uint8",function(e){return function(r,n,i){return e(this,r,n,i)}});var r_=es,JH=TypeError,Pg=function(e,t){if(!delete e[t])throw JH("Cannot delete property "+r_(t)+" of "+r_(e))},YH=yr,np=ns,QH=br,XH=Pg,ZH=Math.min,eG=[].copyWithin||function(t,r){var n=YH(this),i=QH(n),a=np(t,i),s=np(r,i),o=arguments.length>2?arguments[2]:void 0,u=ZH((o===void 0?i:np(o,i))-s,i-a),c=1;for(s<a&&a<s+u&&(c=-1,s+=u-1,a+=u-1);u-- >0;)s in n?n[a]=n[s]:XH(n,a),a+=c,s+=c;return n},tG=et,Z1=Lt,rG=eG,nG=tG(rG),iG=Z1.aTypedArray,aG=Z1.exportTypedArrayMethod;aG("copyWithin",function(t,r){return nG(iG(this),t,r,arguments.length>2?arguments[2]:void 0)});var eT=Lt,sG=Gr.every,oG=eT.aTypedArray,uG=eT.exportTypedArrayMethod;uG("every",function(t){return sG(oG(this),t,arguments.length>1?arguments[1]:void 0)});var tT=Lt,lG=x1,cG=G1,fG=bi,dG=Mt,pG=et,hG=nt,vG=tT.aTypedArray,gG=tT.exportTypedArrayMethod,yG=pG("".slice),mG=hG(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),e!==1});gG("fill",function(t){var r=arguments.length;vG(this);var n=yG(fG(this),0,3)==="Big"?cG(t):+t;return dG(lG,this,n,r>1?arguments[1]:void 0,r>2?arguments[2]:void 0)},mG);var bG=br,wG=function(e,t){for(var r=0,n=bG(t),i=new e(n);n>r;)i[r]=t[r++];return i},rT=Lt,_G=Dv,SG=rT.aTypedArrayConstructor,$G=rT.getTypedArrayConstructor,Mf=function(e){return SG(_G(e,$G(e)))},kG=wG,TG=Mf,EG=function(e,t){return kG(TG(e),t)},nT=Lt,CG=Gr.filter,IG=EG,RG=nT.aTypedArray,OG=nT.exportTypedArrayMethod;OG("filter",function(t){var r=CG(RG(this),t,arguments.length>1?arguments[1]:void 0);return IG(this,r)});var iT=Lt,AG=Gr.find,PG=iT.aTypedArray,MG=iT.exportTypedArrayMethod;MG("find",function(t){return AG(PG(this),t,arguments.length>1?arguments[1]:void 0)});var aT=Lt,NG=Gr.findIndex,xG=aT.aTypedArray,LG=aT.exportTypedArrayMethod;LG("findIndex",function(t){return NG(xG(this),t,arguments.length>1?arguments[1]:void 0)});var sT=Lt,jG=Gr.forEach,UG=sT.aTypedArray,DG=sT.exportTypedArrayMethod;DG("forEach",function(t){jG(UG(this),t,arguments.length>1?arguments[1]:void 0)});var oT=Lt,FG=af.includes,BG=oT.aTypedArray,qG=oT.exportTypedArrayMethod;qG("includes",function(t){return FG(BG(this),t,arguments.length>1?arguments[1]:void 0)});var uT=Lt,WG=af.indexOf,HG=uT.aTypedArray,GG=uT.exportTypedArrayMethod;GG("indexOf",function(t){return WG(HG(this),t,arguments.length>1?arguments[1]:void 0)});var VG=dt,zG=nt,Mg=et,lT=Lt,Ng=U0,KG=Ot,xg=KG("iterator"),n_=VG.Uint8Array,JG=Mg(Ng.values),YG=Mg(Ng.keys),QG=Mg(Ng.entries),Lg=lT.aTypedArray,Nf=lT.exportTypedArrayMethod,Ms=n_&&n_.prototype,xf=!zG(function(){Ms[xg].call([1])}),cT=!!Ms&&Ms.values&&Ms[xg]===Ms.values&&Ms.values.name==="values",fT=function(){return JG(Lg(this))};Nf("entries",function(){return QG(Lg(this))},xf);Nf("keys",function(){return YG(Lg(this))},xf);Nf("values",fT,xf||!cT,{name:"values"});Nf(xg,fT,xf||!cT,{name:"values"});var dT=Lt,XG=et,ZG=dT.aTypedArray,eV=dT.exportTypedArrayMethod,tV=XG([].join);eV("join",function(t){return tV(ZG(this),t)});var rV=na,nV=Hr,iV=yi,aV=br,sV=rl,oV=Math.min,Rh=[].lastIndexOf,pT=!!Rh&&1/[1].lastIndexOf(1,-0)<0,uV=sV("lastIndexOf"),lV=pT||!uV,cV=lV?function(t){if(pT)return rV(Rh,this,arguments)||0;var r=nV(this),n=aV(r),i=n-1;for(arguments.length>1&&(i=oV(i,iV(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:Rh,hT=Lt,fV=na,dV=cV,pV=hT.aTypedArray,hV=hT.exportTypedArrayMethod;hV("lastIndexOf",function(t){var r=arguments.length;return fV(dV,pV(this),r>1?[t,arguments[1]]:[t])});var vT=Lt,vV=Gr.map,gV=Mf,yV=vT.aTypedArray,mV=vT.exportTypedArrayMethod;mV("map",function(t){return vV(yV(this),t,arguments.length>1?arguments[1]:void 0,function(r,n){return new(gV(r))(n)})});var bV=An,wV=yr,_V=Du,SV=br,$V=TypeError,i_=function(e){return function(t,r,n,i){bV(r);var a=wV(t),s=_V(a),o=SV(a),u=e?o-1:0,c=e?-1:1;if(n<2)for(;;){if(u in s){i=s[u],u+=c;break}if(u+=c,e?u<0:o<=u)throw $V("Reduce of empty array with no initial value")}for(;e?u>=0:o>u;u+=c)u in s&&(i=r(i,s[u],u,a));return i}},jg={left:i_(!1),right:i_(!0)},gT=Lt,kV=jg.left,TV=gT.aTypedArray,EV=gT.exportTypedArrayMethod;EV("reduce",function(t){var r=arguments.length;return kV(TV(this),t,r,r>1?arguments[1]:void 0)});var yT=Lt,CV=jg.right,IV=yT.aTypedArray,RV=yT.exportTypedArrayMethod;RV("reduceRight",function(t){var r=arguments.length;return CV(IV(this),t,r,r>1?arguments[1]:void 0)});var mT=Lt,OV=mT.aTypedArray,AV=mT.exportTypedArrayMethod,PV=Math.floor;AV("reverse",function(){for(var t=this,r=OV(t).length,n=PV(r/2),i=0,a;i<n;)a=t[i],t[i++]=t[--r],t[r]=a;return t});var bT=dt,wT=Mt,Ug=Lt,MV=br,NV=H1,xV=yr,_T=nt,LV=bT.RangeError,Oh=bT.Int8Array,a_=Oh&&Oh.prototype,ST=a_&&a_.set,jV=Ug.aTypedArray,UV=Ug.exportTypedArrayMethod,Ah=!_T(function(){var e=new Uint8ClampedArray(2);return wT(ST,e,{length:1,0:3},1),e[1]!==3}),DV=Ah&&Ug.NATIVE_ARRAY_BUFFER_VIEWS&&_T(function(){var e=new Oh(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});UV("set",function(t){jV(this);var r=NV(arguments.length>1?arguments[1]:void 0,1),n=xV(t);if(Ah)return wT(ST,this,n,r);var i=this.length,a=MV(n),s=0;if(a+r>i)throw LV("Wrong length");for(;s<a;)this[r+s]=n[s++]},!Ah||DV);var $T=Lt,FV=Mf,BV=nt,qV=ho,WV=$T.aTypedArray,HV=$T.exportTypedArrayMethod,GV=BV(function(){new Int8Array(1).slice()});HV("slice",function(t,r){for(var n=qV(WV(this),t,r),i=FV(this),a=0,s=n.length,o=new i(s);s>a;)o[a]=n[a++];return o},GV);var kT=Lt,VV=Gr.some,zV=kT.aTypedArray,KV=kT.exportTypedArrayMethod;KV("some",function(t){return VV(zV(this),t,arguments.length>1?arguments[1]:void 0)});var s_=zu,JV=Math.floor,Ph=function(e,t){var r=e.length,n=JV(r/2);return r<8?YV(e,t):QV(e,Ph(s_(e,0,n),t),Ph(s_(e,n),t),t)},YV=function(e,t){for(var r=e.length,n=1,i,a;n<r;){for(a=n,i=e[n];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==n++&&(e[a]=i)}return e},QV=function(e,t,r,n){for(var i=t.length,a=r.length,s=0,o=0;s<i||o<a;)e[s+o]=s<i&&o<a?n(t[s],r[o])<=0?t[s++]:r[o++]:s<i?t[s++]:r[o++];return e},Dg=Ph,XV=Xa,o_=XV.match(/firefox\/(\d+)/i),TT=!!o_&&+o_[1],ZV=Xa,ET=/MSIE|Trident/.test(ZV),e7=Xa,u_=e7.match(/AppleWebKit\/(\d+)\./),CT=!!u_&&+u_[1],t7=dt,r7=et,Mh=nt,n7=An,i7=Dg,IT=Lt,l_=TT,a7=ET,c_=Za,f_=CT,s7=IT.aTypedArray,o7=IT.exportTypedArrayMethod,Au=t7.Uint16Array,Vs=Au&&r7(Au.prototype.sort),u7=!!Vs&&!(Mh(function(){Vs(new Au(2),null)})&&Mh(function(){Vs(new Au(2),{})})),d_=!!Vs&&!Mh(function(){if(c_)return c_<74;if(l_)return l_<67;if(a7)return!0;if(f_)return f_<602;var e=new Au(516),t=Array(516),r,n;for(r=0;r<516;r++)n=r%4,e[r]=515-r,t[r]=r-2*n+3;for(Vs(e,function(i,a){return(i/4|0)-(a/4|0)}),r=0;r<516;r++)if(e[r]!==t[r])return!0}),l7=function(e){return function(t,r){return e!==void 0?+e(t,r)||0:r!==r?-1:t!==t?1:t===0&&r===0?1/t>0&&1/r<0?1:-1:t>r}};o7("sort",function(t){return t!==void 0&&n7(t),d_?Vs(this,t):i7(s7(this),l7(t))},!d_||u7);var RT=Lt,c7=mi,p_=ns,f7=Mf,d7=RT.aTypedArray,p7=RT.exportTypedArrayMethod;p7("subarray",function(t,r){var n=d7(this),i=n.length,a=p_(t,i),s=f7(n);return new s(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,c7((r===void 0?i:p_(r,i))-a))});var h7=dt,v7=na,OT=Lt,Nh=nt,h_=ho,Mc=h7.Int8Array,v_=OT.aTypedArray,g7=OT.exportTypedArrayMethod,AT=[].toLocaleString,y7=!!Mc&&Nh(function(){AT.call(new Mc(1))}),m7=Nh(function(){return[1,2].toLocaleString()!=new Mc([1,2]).toLocaleString()})||!Nh(function(){Mc.prototype.toLocaleString.call([1,2])});g7("toLocaleString",function(){return v7(AT,y7?h_(v_(this)):v_(this),h_(arguments))},m7);var b7=Lt.exportTypedArrayMethod,w7=nt,_7=dt,S7=et,g_=_7.Uint8Array,$7=g_&&g_.prototype||{},Nc=[].toString,k7=S7([].join);w7(function(){Nc.call({})})&&(Nc=function(){return k7(this)});var T7=$7.toString!=Nc;b7("toString",Nc,T7);var E7=Vt,C7=ta,I7=Ot,R7=I7("match"),PT=function(e){var t;return E7(e)&&((t=e[R7])!==void 0?!!t:C7(e)=="RegExp")},O7=na,Go=Mt,Fg=et,A7=$f,P7=er,M7=Gn,N7=PT,y_=Vn,x7=Dv,L7=og,j7=mi,ip=fr,U7=ts,m_=zu,b_=kf,D7=Sf,F7=W0,B7=nt,$s=F7.UNSUPPORTED_Y,w_=4294967295,q7=Math.min,MT=[].push,W7=Fg(/./.exec),ks=Fg(MT),Vo=Fg("".slice),H7=!B7(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});A7("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var s=ip(y_(this)),o=a===void 0?w_:a>>>0;if(o===0)return[];if(i===void 0)return[s];if(!N7(i))return Go(t,s,i,o);for(var u=[],c=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),d=0,y=new RegExp(i.source,c+"g"),_,b,k;(_=Go(D7,y,s))&&(b=y.lastIndex,!(b>d&&(ks(u,Vo(s,d,_.index)),_.length>1&&_.index<s.length&&O7(MT,u,m_(_,1)),k=_[0].length,d=b,u.length>=o)));)y.lastIndex===_.index&&y.lastIndex++;return d===s.length?(k||!W7(y,""))&&ks(u,""):ks(u,Vo(s,d)),u.length>o?m_(u,0,o):u}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:Go(t,this,i,a)}:n=t,[function(a,s){var o=y_(this),u=M7(a)?void 0:U7(a,e);return u?Go(u,a,o,s):Go(n,ip(o),a,s)},function(i,a){var s=P7(this),o=ip(i),u=r(n,s,o,a,n!==t);if(u.done)return u.value;var c=x7(s,RegExp),d=s.unicode,y=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+($s?"g":"y"),_=new c($s?"^(?:"+s.source+")":s,y),b=a===void 0?w_:a>>>0;if(b===0)return[];if(o.length===0)return b_(_,o)===null?[o]:[];for(var k=0,N=0,P=[];N<o.length;){_.lastIndex=$s?0:N;var j=b_(_,$s?Vo(o,N):o),F;if(j===null||(F=q7(j7(_.lastIndex+($s?N:0)),o.length))===k)N=L7(o,N,d);else{if(ks(P,Vo(o,k,N)),P.length===b)return P;for(var me=1;me<=j.length-1;me++)if(ks(P,j[me]),P.length===b)return P;N=k=F}}return ks(P,Vo(o,k)),P}]},!H7,$s);var Bg={exports:{}},NT={exports:{}};(function(e){function t(r){return Function.toString.call(r).indexOf("[native code]")!==-1}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(NT);var xT={exports:{}},LT={exports:{}};(function(e){function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(LT);(function(e){var t=pf.exports,r=LT.exports;function n(i,a,s){return r()?(e.exports=n=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=n=function(u,c,d){var y=[null];y.push.apply(y,c);var _=Function.bind.apply(u,y),b=new _;return d&&t(b,d.prototype),b},e.exports.__esModule=!0,e.exports.default=e.exports),n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(xT);(function(e){var t=zn.exports,r=pf.exports,n=NT.exports,i=xT.exports;function a(s){var o=typeof Map=="function"?new Map:void 0;return e.exports=a=function(c){if(c===null||!n(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(c))return o.get(c);o.set(c,d)}function d(){return i(c,arguments,t(this).constructor)}return d.prototype=Object.create(c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),r(d,c)},e.exports.__esModule=!0,e.exports.default=e.exports,a(s)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(Bg);var xc={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(e,t){(function(){var r={function:!0,object:!0},n=r[typeof window]&&window||this,i=t,a=e&&!e.nodeType&&e,s=i&&a&&typeof kn=="object"&&kn;s&&(s.global===s||s.window===s||s.self===s)&&(n=s);var o=Math.pow(2,53)-1,u=/\bOpera/,c=Object.prototype,d=c.hasOwnProperty,y=c.toString;function _(x){return x=String(x),x.charAt(0).toUpperCase()+x.slice(1)}function b(x,le,D){var Re={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return le&&D&&/^Win/i.test(x)&&!/^Windows Phone /i.test(x)&&(Re=Re[/[\d.]+$/.exec(x)])&&(x="Windows "+Re),x=String(x),le&&D&&(x=x.replace(RegExp(le,"i"),D)),x=N(x.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),x}function k(x,le){var D=-1,Re=x?x.length:0;if(typeof Re=="number"&&Re>-1&&Re<=o)for(;++D<Re;)le(x[D],D,x);else P(x,le)}function N(x){return x=xe(x),/^(?:webOS|i(?:OS|P))/.test(x)?x:_(x)}function P(x,le){for(var D in x)d.call(x,D)&&le(x[D],D,x)}function j(x){return x==null?_(x):y.call(x).slice(8,-1)}function F(x,le){var D=x!=null?typeof x[le]:"number";return!/^(?:boolean|number|string|undefined)$/.test(D)&&(D=="object"?!!x[le]:!0)}function me(x){return String(x).replace(/([ -])(?!$)/g,"$1?")}function ce(x,le){var D=null;return k(x,function(Re,Ie){D=le(D,Re,Ie,x)}),D}function xe(x){return String(x).replace(/^ +| +$/g,"")}function Ne(x){var le=n,D=x&&typeof x=="object"&&j(x)!="String";D&&(le=x,x=null);var Re=le.navigator||{},Ie=Re.userAgent||"";x||(x=Ie);var ue=D?!!Re.likeChrome:/\bChrome\b/.test(x)&&!/internal|\n/i.test(y.toString()),ee="Object",se=D?ee:"ScriptBridgingProxyObject",ne=D?ee:"Environment",be=D&&le.java?"JavaPackage":j(le.java),O=D?ee:"RuntimeObject",je=/\bJava/.test(be)&&le.java,ft=je&&j(le.environment)==ne,Je=je?"a":"\u03B1",fe=je?"b":"\u03B2",G=le.document||{},Y=le.operamini||le.opera,$=u.test($=D&&Y?Y["[[Class]]"]:j(Y))?$:Y=null,C,Z=x,te=[],Ae=null,De=x==Ie,de=De&&Y&&typeof Y.version=="function"&&Y.version(),$e,E=ke([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),T=we(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),V=z([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),re=he({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),W=Oe(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function ke(Ce){return ce(Ce,function(B,Se){return B||RegExp("\\b"+(Se.pattern||me(Se))+"\\b","i").exec(x)&&(Se.label||Se)})}function he(Ce){return ce(Ce,function(B,Se,Ge){return B||(Se[V]||Se[/^[a-z]+(?: +[a-z]+\b)*/i.exec(V)]||RegExp("\\b"+me(Ge)+"(?:\\b|\\w*\\d)","i").exec(x))&&Ge})}function we(Ce){return ce(Ce,function(B,Se){return B||RegExp("\\b"+(Se.pattern||me(Se))+"\\b","i").exec(x)&&(Se.label||Se)})}function Oe(Ce){return ce(Ce,function(B,Se){var Ge=Se.pattern||me(Se);return!B&&(B=RegExp("\\b"+Ge+"(?:/[\\d.]+|[ \\w.]*)","i").exec(x))&&(B=b(B,Ge,Se.label||Se)),B})}function z(Ce){return ce(Ce,function(B,Se){var Ge=Se.pattern||me(Se);return!B&&(B=RegExp("\\b"+Ge+" *\\d+[.\\w_]*","i").exec(x)||RegExp("\\b"+Ge+" *\\w+-[\\w]*","i").exec(x)||RegExp("\\b"+Ge+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(x))&&((B=String(Se.label&&!RegExp(Ge,"i").test(Se.label)?Se.label:B).split("/"))[1]&&!/[\d.]+/.test(B[0])&&(B[0]+=" "+B[1]),Se=Se.label||Se,B=N(B[0].replace(RegExp(Ge,"i"),Se).replace(RegExp("; *(?:"+Se+"[_-])?","i")," ").replace(RegExp("("+Se+")[-_.]?(\\w)","i"),"$1 $2"))),B})}function Ue(Ce){return ce(Ce,function(B,Se){return B||(RegExp(Se+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(x)||0)[1]||null})}function ae(){return this.description||""}if(E&&(E=[E]),/\bAndroid\b/.test(W)&&!V&&(C=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(x))&&(V=xe(C[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),re&&!V?V=z([re]):re&&V&&(V=V.replace(RegExp("^("+me(re)+")[-_.\\s]","i"),re+" ").replace(RegExp("^("+me(re)+")[-_.]?(\\w)","i"),re+" $2")),(C=/\bGoogle TV\b/.exec(V))&&(V=C[0]),/\bSimulator\b/i.test(x)&&(V=(V?V+" ":"")+"Simulator"),T=="Opera Mini"&&/\bOPiOS\b/.test(x)&&te.push("running in Turbo/Uncompressed mode"),T=="IE"&&/\blike iPhone OS\b/.test(x)?(C=Ne(x.replace(/like iPhone OS/,"")),re=C.manufacturer,V=C.product):/^iP/.test(V)?(T||(T="Safari"),W="iOS"+((C=/ OS ([\d_]+)/i.exec(x))?" "+C[1].replace(/_/g,"."):"")):T=="Konqueror"&&/^Linux\b/i.test(W)?W="Kubuntu":re&&re!="Google"&&(/Chrome/.test(T)&&!/\bMobile Safari\b/i.test(x)||/\bVita\b/.test(V))||/\bAndroid\b/.test(W)&&/^Chrome/.test(T)&&/\bVersion\//i.test(x)?(T="Android Browser",W=/\bAndroid\b/.test(W)?W:"Android"):T=="Silk"?(/\bMobi/i.test(x)||(W="Android",te.unshift("desktop mode")),/Accelerated *= *true/i.test(x)&&te.unshift("accelerated")):T=="UC Browser"&&/\bUCWEB\b/.test(x)?te.push("speed mode"):T=="PaleMoon"&&(C=/\bFirefox\/([\d.]+)\b/.exec(x))?te.push("identifying as Firefox "+C[1]):T=="Firefox"&&(C=/\b(Mobile|Tablet|TV)\b/i.exec(x))?(W||(W="Firefox OS"),V||(V=C[1])):!T||(C=!/\bMinefield\b/i.test(x)&&/\b(?:Firefox|Safari)\b/.exec(T))?(T&&!V&&/[\/,]|^[^(]+?\)/.test(x.slice(x.indexOf(C+"/")+8))&&(T=null),(C=V||re||W)&&(V||re||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(W))&&(T=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(W)?W:C)+" Browser")):T=="Electron"&&(C=(/\bChrome\/([\d.]+)\b/.exec(x)||0)[1])&&te.push("Chromium "+C),de||(de=Ue(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",me(T),"(?:Firefox|Minefield|NetFront)"])),(C=E=="iCab"&&parseFloat(de)>3&&"WebKit"||/\bOpera\b/.test(T)&&(/\bOPR\b/.test(x)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(x)&&!/^(?:Trident|EdgeHTML)$/.test(E)&&"WebKit"||!E&&/\bMSIE\b/i.test(x)&&(W=="Mac OS"?"Tasman":"Trident")||E=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(T)&&"NetFront")&&(E=[C]),T=="IE"&&(C=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(x)||0)[1])?(T+=" Mobile",W="Windows Phone "+(/\+$/.test(C)?C:C+".x"),te.unshift("desktop mode")):/\bWPDesktop\b/i.test(x)?(T="IE Mobile",W="Windows Phone 8.x",te.unshift("desktop mode"),de||(de=(/\brv:([\d.]+)/.exec(x)||0)[1])):T!="IE"&&E=="Trident"&&(C=/\brv:([\d.]+)/.exec(x))&&(T&&te.push("identifying as "+T+(de?" "+de:"")),T="IE",de=C[1]),De){if(F(le,"global"))if(je&&(C=je.lang.System,Z=C.getProperty("os.arch"),W=W||C.getProperty("os.name")+" "+C.getProperty("os.version")),ft){try{de=le.require("ringo/engine").version.join("."),T="RingoJS"}catch{(C=le.system)&&C.global.system==le.system&&(T="Narwhal",W||(W=C[0].os||null))}T||(T="Rhino")}else typeof le.process=="object"&&!le.process.browser&&(C=le.process)&&(typeof C.versions=="object"&&(typeof C.versions.electron=="string"?(te.push("Node "+C.versions.node),T="Electron",de=C.versions.electron):typeof C.versions.nw=="string"&&(te.push("Chromium "+de,"Node "+C.versions.node),T="NW.js",de=C.versions.nw)),T||(T="Node.js",Z=C.arch,W=C.platform,de=/[\d.]+/.exec(C.version),de=de?de[0]:null));else j(C=le.runtime)==se?(T="Adobe AIR",W=C.flash.system.Capabilities.os):j(C=le.phantom)==O?(T="PhantomJS",de=(C=C.version||null)&&C.major+"."+C.minor+"."+C.patch):typeof G.documentMode=="number"&&(C=/\bTrident\/(\d+)/i.exec(x))?(de=[de,G.documentMode],(C=+C[1]+4)!=de[1]&&(te.push("IE "+de[1]+" mode"),E&&(E[1]=""),de[1]=C),de=T=="IE"?String(de[1].toFixed(1)):de[0]):typeof G.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(T)&&(te.push("masking as "+T+" "+de),T="IE",de="11.0",E=["Trident"],W="Windows");W=W&&N(W)}if(de&&(C=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(de)||/(?:alpha|beta)(?: ?\d)?/i.exec(x+";"+(De&&Re.appMinorVersion))||/\bMinefield\b/i.test(x)&&"a")&&(Ae=/b/i.test(C)?"beta":"alpha",de=de.replace(RegExp(C+"\\+?$"),"")+(Ae=="beta"?fe:Je)+(/\d+\+?/.exec(C)||"")),T=="Fennec"||T=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(W))T="Firefox Mobile";else if(T=="Maxthon"&&de)de=de.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(V))V=="Xbox 360"&&(W=null),V=="Xbox 360"&&/\bIEMobile\b/.test(x)&&te.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(T)||T&&!V&&!/Browser|Mobi/.test(T))&&(W=="Windows CE"||/Mobi/i.test(x)))T+=" Mobile";else if(T=="IE"&&De)try{le.external===null&&te.unshift("platform preview")}catch{te.unshift("embedded")}else(/\bBlackBerry\b/.test(V)||/\bBB10\b/.test(x))&&(C=(RegExp(V.replace(/ +/g," *")+"/([.\\d]+)","i").exec(x)||0)[1]||de)?(C=[C,/BB10/.test(x)],W=(C[1]?(V=null,re="BlackBerry"):"Device Software")+" "+C[0],de=null):this!=P&&V!="Wii"&&(De&&Y||/Opera/.test(T)&&/\b(?:MSIE|Firefox)\b/i.test(x)||T=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(W)||T=="IE"&&(W&&!/^Win/.test(W)&&de>5.5||/\bWindows XP\b/.test(W)&&de>8||de==8&&!/\bTrident\b/.test(x)))&&!u.test(C=Ne.call(P,x.replace(u,"")+";"))&&C.name&&(C="ing as "+C.name+((C=C.version)?" "+C:""),u.test(T)?(/\bIE\b/.test(C)&&W=="Mac OS"&&(W=null),C="identify"+C):(C="mask"+C,$?T=N($.replace(/([a-z])([A-Z])/g,"$1 $2")):T="Opera",/\bIE\b/.test(C)&&(W=null),De||(de=null)),E=["Presto"],te.push(C));(C=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(x)||0)[1])&&(C=[parseFloat(C.replace(/\.(\d)$/,".0$1")),C],T=="Safari"&&C[1].slice(-1)=="+"?(T="WebKit Nightly",Ae="alpha",de=C[1].slice(0,-1)):(de==C[1]||de==(C[2]=(/\bSafari\/([\d.]+\+?)/i.exec(x)||0)[1]))&&(de=null),C[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(x)||0)[1],C[0]==537.36&&C[2]==537.36&&parseFloat(C[1])>=28&&E=="WebKit"&&(E=["Blink"]),!De||!ue&&!C[1]?(E&&(E[1]="like Safari"),C=(C=C[0],C<400?1:C<500?2:C<526?3:C<533?4:C<534?"4+":C<535?5:C<537?6:C<538?7:C<601?8:C<602?9:C<604?10:C<606?11:C<608?12:"12")):(E&&(E[1]="like Chrome"),C=C[1]||(C=C[0],C<530?1:C<532?2:C<532.05?3:C<533?4:C<534.03?5:C<534.07?6:C<534.1?7:C<534.13?8:C<534.16?9:C<534.24?10:C<534.3?11:C<535.01?12:C<535.02?"13+":C<535.07?15:C<535.11?16:C<535.19?17:C<536.05?18:C<536.1?19:C<537.01?20:C<537.11?"21+":C<537.13?23:C<537.18?24:C<537.24?25:C<537.36?26:E!="Blink"?"27":"28")),E&&(E[1]+=" "+(C+=typeof C=="number"?".x":/[.+]/.test(C)?"":"+")),T=="Safari"&&(!de||parseInt(de)>45)?de=C:T=="Chrome"&&/\bHeadlessChrome/i.test(x)&&te.unshift("headless")),T=="Opera"&&(C=/\bzbov|zvav$/.exec(W))?(T+=" ",te.unshift("desktop mode"),C=="zvav"?(T+="Mini",de=null):T+="Mobile",W=W.replace(RegExp(" *"+C+"$"),"")):T=="Safari"&&/\bChrome\b/.exec(E&&E[1])?(te.unshift("desktop mode"),T="Chrome Mobile",de=null,/\bOS X\b/.test(W)?(re="Apple",W="iOS 4.3+"):W=null):/\bSRWare Iron\b/.test(T)&&!de&&(de=Ue("Chrome")),de&&de.indexOf(C=/[\d.]+$/.exec(W))==0&&x.indexOf("/"+C+"-")>-1&&(W=xe(W.replace(C,""))),W&&W.indexOf(T)!=-1&&!RegExp(T+" OS").test(W)&&(W=W.replace(RegExp(" *"+me(T)+" *"),"")),E&&!/\b(?:Avant|Nook)\b/.test(T)&&(/Browser|Lunascape|Maxthon/.test(T)||T!="Safari"&&/^iOS/.test(W)&&/\bSafari\b/.test(E[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(T)&&E[1])&&(C=E[E.length-1])&&te.push(C),te.length&&(te=["("+te.join("; ")+")"]),re&&V&&V.indexOf(re)<0&&te.push("on "+re),V&&te.push((/^on /.test(te[te.length-1])?"":"on ")+V),W&&(C=/ ([\d.+]+)$/.exec(W),$e=C&&W.charAt(W.length-C[0].length-1)=="/",W={architecture:32,family:C&&!$e?W.replace(C[0],""):W,version:C?C[1]:null,toString:function(){var Ce=this.version;return this.family+(Ce&&!$e?" "+Ce:"")+(this.architecture==64?" 64-bit":"")}}),(C=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Z))&&!/\bi686\b/i.test(Z)?(W&&(W.architecture=64,W.family=W.family.replace(RegExp(" *"+C),"")),T&&(/\bWOW64\b/i.test(x)||De&&/\w(?:86|32)$/.test(Re.cpuClass||Re.platform)&&!/\bWin64; x64\b/i.test(x))&&te.unshift("32-bit")):W&&/^OS X/.test(W.family)&&T=="Chrome"&&parseFloat(de)>=39&&(W.architecture=64),x||(x=null);var q={};return q.description=x,q.layout=E&&E[0],q.manufacturer=re,q.name=T,q.prerelease=Ae,q.product=V,q.ua=x,q.version=T&&de,q.os=W||{architecture:null,family:null,version:null,toString:function(){return"null"}},q.parse=Ne,q.toString=ae,q.version&&te.unshift(de),q.name&&te.unshift(T),W&&T&&!(W==String(W).split(" ")[0]&&(W==T.split(" ")[0]||V))&&te.push(V?"("+W+")":"on "+W),te.length&&(q.description=te.join(" ")),q}var Me=Ne();i&&a?P(Me,function(x,le){i[le]=x}):n.platform=Me}).call(kn)})(xc,xc.exports);var G7=Mt,V7=$f,z7=er,K7=Gn,J7=mi,ap=fr,Y7=Vn,Q7=ts,X7=og,__=kf;V7("match",function(e,t,r){return[function(i){var a=Y7(this),s=K7(i)?void 0:Q7(i,e);return s?G7(s,i,a):new RegExp(i)[e](ap(a))},function(n){var i=z7(this),a=ap(n),s=r(t,i,a);if(s.done)return s.value;if(!i.global)return __(i,a);var o=i.unicode;i.lastIndex=0;for(var u=[],c=0,d;(d=__(i,a))!==null;){var y=ap(d[0]);u[c]=y,y===""&&(i.lastIndex=X7(a,J7(i.lastIndex),o)),c++}return c===0?null:u}]});var Z7=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},ez=Mt,tz=$f,rz=er,nz=Gn,iz=Vn,S_=Z7,$_=fr,az=ts,sz=kf;tz("search",function(e,t,r){return[function(i){var a=iz(this),s=nz(i)?void 0:az(i,e);return s?ez(s,i,a):new RegExp(i)[e]($_(a))},function(n){var i=rz(this),a=$_(n),s=r(t,i,a);if(s.done)return s.value;var o=i.lastIndex;S_(o,0)||(i.lastIndex=0);var u=sz(i,a);return S_(i.lastIndex,o)||(i.lastIndex=o),u===null?-1:u.index}]});var oz=Wt,uz=Ku,lz=TypeError,cz=Object.getOwnPropertyDescriptor,fz=oz&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),dz=fz?function(e,t){if(uz(e)&&!cz(e,"length").writable)throw lz("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},pz=ct,hz=yr,vz=ns,gz=yi,yz=br,mz=dz,bz=k0,wz=Mv,_z=vo,sp=Pg,Sz=Qu,$z=Sz("splice"),kz=Math.max,Tz=Math.min;pz({target:"Array",proto:!0,forced:!$z},{splice:function(t,r){var n=hz(this),i=yz(n),a=vz(t,i),s=arguments.length,o,u,c,d,y,_;for(s===0?o=u=0:s===1?(o=0,u=i-a):(o=s-2,u=Tz(kz(gz(r),0),i-a)),bz(i+o-u),c=wz(n,u),d=0;d<u;d++)y=a+d,y in n&&_z(c,d,n[y]);if(c.length=u,o<u){for(d=a;d<i-u;d++)y=d+u,_=d+o,y in n?n[_]=n[y]:sp(n,_);for(d=i;d>i-u+o;d--)sp(n,d-1)}else if(o>u)for(d=i-u;d>a;d--)y=d+u-1,_=d+o-1,y in n?n[_]=n[y]:sp(n,_);for(d=0;d<o;d++)n[d+a]=arguments[d+2];return mz(n,i-u+o),c}});/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.


*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=go.exports,n=is.exports,i=sa.exports,a=Cf.exports,s=oa.exports,o=ua.exports,u=zn.exports,c=fa.exports,d=ca.exports,y=nl,_=la.exports,b=ir,k=bo.exports,N=S1.exports,P=Rf,j=Bg.exports,F=Si,me=xc.exports;function ce(m){return m&&typeof m=="object"&&"default"in m?m:{default:m}}function xe(m){if(m&&m.__esModule)return m;var v=Object.create(null);return m&&Object.keys(m).forEach(function(l){if(l!=="default"){var p=Object.getOwnPropertyDescriptor(m,l);Object.defineProperty(v,l,p.get?p:{enumerable:!0,get:function(){return m[l]}})}}),v.default=m,Object.freeze(v)}var Ne=ce(r),Me=ce(n),x=ce(i),le=ce(a),D=ce(s),Re=ce(o),Ie=ce(u),ue=ce(c),ee=ce(d),se=ce(y),ne=ce(_),be=xe(k),O=xe(N),je=ce(j),ft=xe(me);function Je(m,v,l,p){var f=arguments.length,g=f<3?v:p===null?p=Object.getOwnPropertyDescriptor(v,l):p,h;if((typeof Reflect>"u"?"undefined":ne.default(Reflect))==="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(m,v,l,p);else for(var w=m.length-1;w>=0;w--)(h=m[w])&&(g=(f<3?h(g):f>3?h(v,l,g):h(v,l))||g);return f>3&&g&&Object.defineProperty(v,l,g),g}function fe(m,v){if((typeof Reflect>"u"?"undefined":ne.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)}var G;function Y(){}Y.prototype=Object.create(null);function $(){$.init.call(this)}$.EventEmitter=$,$.usingDomains=!1,$.prototype.domain=void 0,$.prototype._events=void 0,$.prototype._maxListeners=void 0,$.defaultMaxListeners=10,$.init=function(){this.domain=null,$.usingDomains&&G.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Y,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||isNaN(v))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=v,this};function C(m){return m._maxListeners===void 0?$.defaultMaxListeners:m._maxListeners}$.prototype.getMaxListeners=function(){return C(this)};function Z(m,v,l){if(v)m.call(l);else for(var p=m.length,f=W(m,p),g=0;g<p;++g)f[g].call(l)}function te(m,v,l,p){if(v)m.call(l,p);else for(var f=m.length,g=W(m,f),h=0;h<f;++h)g[h].call(l,p)}function Ae(m,v,l,p,f){if(v)m.call(l,p,f);else for(var g=m.length,h=W(m,g),w=0;w<g;++w)h[w].call(l,p,f)}function De(m,v,l,p,f,g){if(v)m.call(l,p,f,g);else for(var h=m.length,w=W(m,h),S=0;S<h;++S)w[S].call(l,p,f,g)}function de(m,v,l,p){if(v)m.apply(l,p);else for(var f=m.length,g=W(m,f),h=0;h<f;++h)g[h].apply(l,p)}$.prototype.emit=function(v){var l,p,f,g,h,w,S,L=v==="error";if(w=this._events,w)L=L&&w.error==null;else if(!L)return!1;if(S=this.domain,L){if(l=arguments[1],S)l||(l=new Error('Uncaught, unspecified "error" event')),l.domainEmitter=this,l.domain=S,l.domainThrown=!1,S.emit("error",l);else{if(l instanceof Error)throw l;var U=new Error('Uncaught, unspecified "error" event. ('+l+")");throw U.context=l,U}return!1}if(p=w[v],!p)return!1;var K=typeof p=="function";switch(f=arguments.length,f){case 1:Z(p,K,this);break;case 2:te(p,K,this,arguments[1]);break;case 3:Ae(p,K,this,arguments[1],arguments[2]);break;case 4:De(p,K,this,arguments[1],arguments[2],arguments[3]);break;default:for(g=new Array(f-1),h=1;h<f;h++)g[h-1]=arguments[h];de(p,K,this,g)}return!0};function $e(m,v,l,p){var f,g,h;if(typeof l!="function")throw new TypeError('"listener" argument must be a function');if(g=m._events,g?(g.newListener&&(m.emit("newListener",v,l.listener?l.listener:l),g=m._events),h=g[v]):(g=m._events=new Y,m._eventsCount=0),!h)h=g[v]=l,++m._eventsCount;else if(typeof h=="function"?h=g[v]=p?[l,h]:[h,l]:p?h.unshift(l):h.push(l),!h.warned&&(f=C(m),f&&f>0&&h.length>f)){h.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+v+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=m,w.type=v,w.count=h.length,E(w)}return m}function E(m){typeof console.warn=="function"?console.warn(m):console.log(m)}$.prototype.addListener=function(v,l){return $e(this,v,l,!1)},$.prototype.on=$.prototype.addListener,$.prototype.prependListener=function(v,l){return $e(this,v,l,!0)};function T(m,v,l){var p=!1;function f(){m.removeListener(v,f),p||(p=!0,l.apply(m,arguments))}return f.listener=l,f}$.prototype.once=function(v,l){if(typeof l!="function")throw new TypeError('"listener" argument must be a function');return this.on(v,T(this,v,l)),this},$.prototype.prependOnceListener=function(v,l){if(typeof l!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(v,T(this,v,l)),this},$.prototype.removeListener=function(v,l){var p,f,g,h,w;if(typeof l!="function")throw new TypeError('"listener" argument must be a function');if(f=this._events,!f)return this;if(p=f[v],!p)return this;if(p===l||p.listener&&p.listener===l)--this._eventsCount===0?this._events=new Y:(delete f[v],f.removeListener&&this.emit("removeListener",v,p.listener||l));else if(typeof p!="function"){for(g=-1,h=p.length;h-- >0;)if(p[h]===l||p[h].listener&&p[h].listener===l){w=p[h].listener,g=h;break}if(g<0)return this;if(p.length===1){if(p[0]=void 0,--this._eventsCount===0)return this._events=new Y,this;delete f[v]}else re(p,g);f.removeListener&&this.emit("removeListener",v,w||l)}return this},$.prototype.off=function(m,v){return this.removeListener(m,v)},$.prototype.removeAllListeners=function(v){var l,p;if(p=this._events,!p)return this;if(!p.removeListener)return arguments.length===0?(this._events=new Y,this._eventsCount=0):p[v]&&(--this._eventsCount===0?this._events=new Y:delete p[v]),this;if(arguments.length===0){for(var f=Object.keys(p),g=0,h;g<f.length;++g)h=f[g],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=new Y,this._eventsCount=0,this}if(l=p[v],typeof l=="function")this.removeListener(v,l);else if(l)do this.removeListener(v,l[l.length-1]);while(l[0]);return this},$.prototype.listeners=function(v){var l,p,f=this._events;return f?(l=f[v],l?typeof l=="function"?p=[l.listener||l]:p=ke(l):p=[]):p=[],p},$.listenerCount=function(m,v){return typeof m.listenerCount=="function"?m.listenerCount(v):V.call(m,v)},$.prototype.listenerCount=V;function V(m){var v=this._events;if(v){var l=v[m];if(typeof l=="function")return 1;if(l)return l.length}return 0}$.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function re(m,v){for(var l=v,p=l+1,f=m.length;p<f;l+=1,p+=1)m[l]=m[p];m.pop()}function W(m,v){for(var l=new Array(v);v--;)l[v]=m[v];return l}function ke(m){for(var v=new Array(m.length),l=0;l<v.length;++l)v[l]=m[l].listener||m[l];return v}var he=be.getLogger("twilsock");function we(m,v){return["".concat(new Date().toISOString()," Twilsock ").concat(m,":")].concat(Array.from(v))}var Oe=function(){function m(v){ue.default(this,m),ee.default(this,"prefix",""),this.prefix=v!=null&&v.length>0?" "+v+":":""}return Me.default(m,[{key:"setLevel",value:function(l){he.setLevel(l)}},{key:"trace",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.trace.apply(null,we("T",p))}},{key:"debug",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.debug.apply(null,we("D",p))}},{key:"info",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.info.apply(null,we("I",p))}},{key:"warn",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.warn.apply(null,we("W",p))}},{key:"error",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.error.apply(null,we("E",p))}}],[{key:"setLevel",value:function(l){he.setLevel(l)}},{key:"trace",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.trace.apply(null,we("T",p))}},{key:"debug",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.debug.apply(null,we("D",p))}},{key:"info",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.info.apply(null,we("I",p))}},{key:"warn",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.warn.apply(null,we("W",p))}},{key:"error",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];he.error.apply(null,we("E",p))}}]),m}(),z=new Oe(""),Ue="0.12.2",ae=function(){function m(v,l,p){ue.default(this,m),ee.default(this,"confirmedCapabilities",new Set),this.activeGrant=l,this._token=v;var f=p.region||"us1",g="wss://tsock.".concat(f,".twilio.com/v3/wsconnect"),h=p.twilsock||p.Twilsock||{};this.url=h.uri||g,this._continuationToken=p.continuationToken?p.continuationToken:null,this.logLevel=p.logLevel?p.logLevel:"error",this.retryPolicy=p.retryPolicy?p.retryPolicy:{min:1*1e3,max:2*60*1e3,randomness:.2},this.clientMetadata=p.clientMetadata?p.clientMetadata:{},this.clientMetadata.ver=Ue,this.initRegistrations=p.initRegistrations?p.initRegistrations:null,this.tweaks=p.tweaks?p.tweaks:null}return Me.default(m,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(l){this._token=l}},{key:"updateContinuationToken",value:function(l){this._continuationToken=l}}]),m}(),q=function m(v){ue.default(this,m),this.id=v||"TM".concat(P.v4())};function Ce(m){var v=B();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function B(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Se=function(m){D.default(l,m);var v=Ce(l);function l(p,f,g,h,w){var S;return ue.default(this,l),S=v.call(this),ee.default(x.default(S),"method","init"),S.token=p,S.continuation_token=f,S.metadata=g,S.registrations=h,S.tweaks=w,S.capabilities=["client_update","offline_storage","telemetry.v1"],S}return l}(q);function Ge(m){var v=tt();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function tt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tr=function(m){D.default(l,m);var v=Ge(l);function l(p,f,g,h,w,S,L){var U;return ue.default(this,l),U=v.call(this,p),U.continuationToken=f,U.continuationTokenStatus=h,U.offlineStorage=w,U.initRegistrations=S,U.debugInfo=L,U.confirmedCapabilities=g,U}return l}(q);function wr(m){var v=hn();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function hn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ir=function(m){D.default(l,m);var v=wr(l);function l(p){var f;return ue.default(this,l),f=v.call(this),ee.default(x.default(f),"method","update"),f.token=p,f}return l}(q);function mt(m){var v=Ut();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Ut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oe=function(m){D.default(l,m);var v=mt(l);function l(p,f,g){var h;return ue.default(this,l),h=v.call(this),ee.default(x.default(h),"method","message"),h.active_grant=p,h.payload_type=f,h.http_request=g,h}return l}(q);function pe(m){var v=Q();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ie=function(m){D.default(l,m);var v=pe(l);function l(p){var f;return ue.default(this,l),f=v.call(this,p),ee.default(x.default(f),"method","reply"),ee.default(x.default(f),"payload_type","application/json"),ee.default(x.default(f),"status",{code:200,status:"OK"}),f}return l}(q);function X(m){var v=ye();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Te=function(m){D.default(l,m);var v=X(l);function l(){var p;return ue.default(this,l),p=v.call(this),ee.default(x.default(p),"method","close"),p}return l}(q);function Le(m){var v=Xe();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Xe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var st=function m(v,l,p,f,g,h){ue.default(this,m),this.start=v,this.end=l,this.title=p,this.details=f,this.id=g,this.type=h},rt=function(m){D.default(l,m);var v=Le(l);function l(p){var f;return ue.default(this,l),f=v.call(this),ee.default(x.default(f),"method","telemetry.v1"),f.events=p,f}return l}(q);function Fe(m){var v=encodeURIComponent(m),l=v.replace(/%([0-9A-F]{2})/g,function(p,f){return String.fromCharCode(Number("0x"+f))});return l.length}function _r(m){var v=encodeURIComponent(m),l=v.replace(/%([0-9A-F]{2})/g,function(f,g){return String.fromCharCode(Number("0x"+g))}),p=new Uint8Array(l.length);return Array.prototype.forEach.call(l,function(f,g){p[g]=f.charCodeAt(0)}),p}function Qe(m){var v=Array.prototype.map.call(m,function(p){return String.fromCharCode(p)}).join(""),l=v.replace(/(.)/g,function(p,f){var g=f.charCodeAt(0).toString(16).toUpperCase();return g.length<2&&(g="0"+g),"%"+g});return decodeURIComponent(l)}function Ht(m){return JSON.parse(Qe(m))}function Dt(m){for(var v="",l=0;l<m.length;++l){var p=String.fromCharCode(m[l]);if(v+=p,p==="\r"){l+=2;break}}var f=v.split(" ");return{size:l,protocol:f[0],version:f[1],headerSize:Number(f[2])}}var $i=function(){function m(){ue.default(this,m)}return Me.default(m,null,[{key:"parse",value:function(l){var p=2,f=new Uint8Array(l),g=Dt(f);if(g.protocol!=="TWILSOCK"||g.version!=="V3.0")return z.error("unsupported protocol: ".concat(g.protocol," ver ").concat(g.version)),null;var h;try{h=Ht(f.subarray(g.size,g.size+g.headerSize))}catch(U){return z.error("failed to parse message header",U,l),null}z.debug("message received: ",h.method),z.trace("message received: ",h);var w;if(h.payload_size>0){var S=p+g.size+g.headerSize,L=h.payload_size;if(!h.hasOwnProperty("payload_type")||h.payload_type.indexOf("application/json")===0)try{w=Ht(f.subarray(S,S+L))}catch(U){return z.error("failed to parse message body",U,l),null}else h.payload_type.indexOf("text/plain")===0&&(w=Qe(f.subarray(S,S+L)))}return{method:h.method,header:h,payload:w}}},{key:"createPacket",value:function(l){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";l.payload_size=Fe(p);var f=JSON.stringify(l),g="TWILSOCK V3.0 "+Fe(f);z.debug("send request:",g+f+p);var h=_r(g+`\r
`+f+`\r
`+p);return h.buffer}}]),m}();function Kn(m){var v=Pn();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Pn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ct=function(m){D.default(l,m);var v=Kn(l);function l(p){return ue.default(this,l),v.call(this,p)}return l}(je.default(Error));function Ft(m){var v=Lr();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Lr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rr=function(m){D.default(l,m);var v=Ft(l);function l(p,f){var g;return ue.default(this,l),g=v.call(this,p),g.reply=f,g}return l}(Ct);function ha(m,v){var l=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);v&&(p=p.filter(function(f){return Object.getOwnPropertyDescriptor(m,f).enumerable})),l.push.apply(l,p)}return l}function ls(m){for(var v=1;v<arguments.length;v++){var l=arguments[v]!=null?arguments[v]:{};v%2?ha(Object(l),!0).forEach(function(p){ee.default(m,p,l[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(l)):ha(Object(l)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(l,p))})}return m}function jr(m){var v=cs();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function cs(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var So=function(m){D.default(l,m);var v=jr(l);function l(p){var f;return ue.default(this,l),f=v.call(this),ee.default(x.default(f),"newBackoff",null),ee.default(x.default(f),"usedBackoff",null),ee.default(x.default(f),"retrier",null),f.options=p?ls({},p):{},f}return Me.default(l,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(f){this.newBackoff=f}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");if(this.newBackoff){var f=!this.usedBackoff||this.usedBackoff<this.newBackoff;if(f)this.createRetrier();else{var g;(g=this.retrier)===null||g===void 0||g.failed(new Error)}}else{var h;(h=this.retrier)===null||h===void 0||h.failed(new Error)}}},{key:"cancel",value:function(){var f;(f=this.retrier)===null||f===void 0||f.cancel()}},{key:"cleanRetrier",value:function(){var f,g;(f=this.retrier)===null||f===void 0||f.removeAllListeners(),(g=this.retrier)===null||g===void 0||g.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var f=ls({},this.options);return this.newBackoff&&(f.min=this.newBackoff,f.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),f.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,f}},{key:"createRetrier",value:function(){var f=this;this.cleanRetrier();var g=this.getRetryPolicy();this.retrier=new F.Retrier(g),this.retrier.once("attempt",function(){var h,w;(h=f.retrier)===null||h===void 0||h.on("attempt",function(){return f.emit("attempt")}),(w=f.retrier)===null||w===void 0||w.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",function(h){return f.emit("failed",h)}),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),l}($);function $o(m){var v=dr();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function dr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vn=3e3;function Kr(m){setTimeout(m,0)}var St=function(m){D.default(l,m);var v=$o(l);function l(p,f,g){var h;ue.default(this,l),h=v.call(this),ee.default(x.default(h),"disconnectingTimer",null),ee.default(x.default(h),"disconnectedPromiseResolve",null),ee.default(x.default(h),"terminalStates",["disconnected","rejected"]),ee.default(x.default(h),"tokenExpiredSasCode",20104),ee.default(x.default(h),"terminationReason","Connection is not initialized"),h.websocket=p,h.websocket.on("connected",function(){return h.fsm.socketConnected()}),h.websocket.on("disconnected",function(){return h.fsm.socketClosed()}),h.websocket.on("message",function(S){return h.onIncomingMessage(S)}),h.websocket.on("socketError",function(S){return h.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(S.message),httpStatusCode:null,errorCode:null})}),h.transport=f,h.config=g,h.retrier=new So(g.retryPolicy),h.retrier.on("attempt",function(){return h.retry()}),h.retrier.on("failed",function(S){z.warn("Retrying failed: ".concat(S.message)),h.disconnect()}),typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",function(){z.debug("Browser reported connectivity state: online"),h.resetBackoff(),h.fsm.systemOnline()}),window.addEventListener("offline",function(){z.debug("Browser reported connectivity state: offline"),h.websocket.close(),h.fsm.socketClosed()}));var w=O.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){h.setupSocket(),h.emit("connecting")},onEnterInitialising:function(){h.sendInit()},onLeaveInitialising:function(){h.cancelInit()},onEnterUpdating:function(){h.sendUpdate()},onLeaveUpdating:function(){h.cancelUpdate()},onEnterRetrying:function(){h.initRetry(),h.emit("connecting")},onEnterConnected:function(){h.resetBackoff(),h.onConnected()},onUserUpdateToken:function(){h.resetBackoff()},onTokenRejected:function(){h.resetBackoff(),h.closeSocket(!0),h.finalizeSocket()},onUserDisconnect:function(){h.closeSocket(!0)},onEnterDisconnecting:function(){h.startDisconnectTimer()},onLeaveDisconnecting:function(){h.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){h.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){h.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){h.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){h.cancelDisconnectTimer()},onDisconnected:function(){h.resetBackoff(),h.finalizeSocket()},onReceiveClose:function(){h.onCloseReceived()},onReceiveOffload:function(L,U){z.debug("onreceiveoffload: ",U),h.modifyBackoff(U.body),h.onCloseReceived()},onUnsupported:function(){h.closeSocket(!0),h.finalizeSocket()},onError:function(L,U){h.closeSocket(U),h.finalizeSocket()},onEnterState:function(L){L.from!=="none"&&h.changeState(L)},onInvalidTransition:function(L,U,K){z.warn("FSM: unexpected transition",U,K)}}});return h.fsm=new w,h}return Me.default(l,[{key:"changeState",value:function(f){z.debug("FSM: ".concat(f.transition,": ").concat(f.from," --> ").concat(f.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){z.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(f){z.trace("modifyBackoff",f);var g=f?f.backoff_policy:null;g&&typeof g.reconnect_min_ms=="number"&&this.retrier.modifyBackoff(g.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var f=this;z.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(function(){z.debug("disconnecting is timed out"),f.closeSocket(!0)},vn)}},{key:"cancelDisconnectTimer",value:function(){z.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return this.state==="connected"&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){z.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){this.fsm.state!="connecting"?(z.trace("retry"),this.websocket.close(),this.fsm.userRetry()):z.trace("can	 retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){z.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){z.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(f){var g=$i.parse(f);if(!!g){var h=g.method,w=g.header,S=g.payload;if(h!=="reply"&&this.confirmReceiving(w),h==="notification")this.emit("message",w.message_type,S);else if(w.method==="reply")this.transport.processReply({id:w.id,status:w.status,header:w,body:S});else if(w.method==="client_update")w.client_update_type==="token_about_to_expire"&&this.emit("tokenAboutToExpire");else if(w.method==="close")if(w.status.code===308)z.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:w.status.status,body:S});else if(w.status.code===406){var L="Server closed connection because can't parse protocol: ".concat(JSON.stringify(w.status));this.emitReplyConnectionError(L,w,!0),z.error(L),this.fsm.receiveFatalClose()}else w.status.code===417?(z.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(w.status))),this.fsm.receiveFatalClose(w.status.status)):w.status.code===410?(z.warn("Server closed connection: ".concat(JSON.stringify(w.status))),this.fsm.receiveClose(w.status.status),this.emit("tokenExpired")):w.status.code===401?(z.error("Server closed connection: ".concat(JSON.stringify(w.status))),this.fsm.receiveClose(w.status.status)):(z.warn("unexpected message: ",w.status),this.fsm.receiveOffload({status:w.status.status,body:null}))}}},{key:"sendInit",value:function(){var p=Ne.default(se.default.mark(function g(){var h,w;return se.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return z.trace("sendInit"),L.prev=1,this.emit("beforeSendInit"),L.next=5,this.transport.sendInit();case 5:h=L.sent,this.config.updateContinuationToken(h.continuationToken),this.config.confirmedCapabilities=h.confirmedCapabilities,this.fsm.initSuccess(h),this.emit("initialized",h),this.emit("tokenUpdated"),L.next=17;break;case 13:L.prev=13,L.t0=L.catch(1),L.t0 instanceof Rr?(w=!1,z.warn("Init rejected by server: ".concat(JSON.stringify(L.t0.reply.status))),this.emit("sendInitFailed"),L.t0.reply.status.code===401||L.t0.reply.status.code===403?(w=!0,this.fsm.tokenRejected(L.t0.reply.status),L.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):L.t0.reply.status.code===429?(this.modifyBackoff(L.t0.reply.body),this.fsm.initError(!0)):L.t0.reply.status.code===500?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(L.t0.message,L.t0.reply,w)):(this.terminationReason=L.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(L.t0.message,`
`).concat(JSON.stringify(L.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",L.t0);case 17:case"end":return L.stop()}},g,this,[[1,13]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"sendUpdate",value:function(){var p=Ne.default(se.default.mark(function g(){var h,w,S;return se.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return z.trace("sendUpdate"),h=new Ir(this.config.token),U.prev=2,U.next=5,this.transport.sendWithReply(h);case 5:w=U.sent,this.fsm.updateSuccess(w.body),this.emit("tokenUpdated"),U.next=14;break;case 10:U.prev=10,U.t0=U.catch(2),U.t0 instanceof Rr?(S=!1,z.warn("Token update rejected by server: ".concat(JSON.stringify(U.t0.reply.status))),U.t0.reply.status.code===401||U.t0.reply.status.code===403?(S=!0,this.fsm.tokenRejected(U.t0.reply.status),U.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):U.t0.reply.status.code===429?(this.modifyBackoff(U.t0.reply.body),this.fsm.updateError(U.t0.reply.status)):this.fsm.updateError(U.t0.reply.status),this.emitReplyConnectionError(U.t0.message,U.t0.reply,S)):(this.emit("error",!1,U.t0.message,null,null),this.fsm.updateError(U.t0)),this.emit("tokenUpdated",U.t0);case 14:case"end":return U.stop()}},g,this,[[2,10]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"emitReplyConnectionError",value:function(f,g,h){var w=g.status&&g.status.description?g.status.description:f,S=g.status.code,L=g.status&&g.status.errorCode?g.status.errorCode:null;h&&(this.terminationReason=w),this.emit("connectionError",{terminal:h,message:"Connection error: ".concat(w),httpStatusCode:S,errorCode:L})}},{key:"cancelInit",value:function(){z.trace("cancelInit")}},{key:"cancelUpdate",value:function(){z.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(f){z.trace("confirmReceiving");try{this.transport.send(new ie(f.id))}catch(g){z.debug("failed to confirm packet receiving",g)}}},{key:"closeSocket",value:function(f){var g=this;z.trace("closeSocket (graceful: ".concat(f,")")),f&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),Kr(function(){return g.fsm.socketClosed()})}},{key:"connect",value:function(){z.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var f=this;return z.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(function(g){f.disconnectedPromiseResolve=g,f.fsm.userDisconnect()})}},{key:"updateToken",value:function(f){var g=this;return z.trace("updateToken:",f),new Promise(function(h,w){g.once("tokenUpdated",function(S){S?w(S):h()}),g.fsm.userUpdateToken()})}},{key:"isTerminalState",get:function(){return this.terminalStates.indexOf(this.fsm.state)!==-1}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),l}($),ko=function(){function m(){ue.default(this,m)}return Me.default(m,null,[{key:"getMetadata",value:function(l){var p,f,g,h,w,S,L,U,K=l&&l.clientMetadata?l.clientMetadata:{},ge=["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"],We={env:(p=ft.name)!==null&&p!==void 0?p:"unknown",envv:(f=ft.version)!==null&&f!==void 0?f:"unknown",os:(g=(h=ft.os)===null||h===void 0?void 0:h.family)!==null&&g!==void 0?g:"unknown",osv:(w=(S=ft.os)===null||S===void 0?void 0:S.version)!==null&&w!==void 0?w:"unknown",osa:(L=(U=ft.os)===null||U===void 0?void 0:U.architecture)!==null&&L!==void 0?L:"unknown",sdk:"js-default"},at={};return ge.filter(function(Ve){return Ve in K||Ve in We}).forEach(function(Ve){return at[Ve]=Ve in K?K[Ve]:We[Ve]}),at}}]),m}(),To=3e4;function Eo(m){return m>=200&&m<300}function fs(m){switch(ne.default(m)){case"undefined":return"";case"object":return JSON.stringify(m);default:return m}}var Jn=function(){function m(v,l){var p=this;ue.default(this,m),this.config=l,this.activeRequests=new Map,this.channel=v,this.channel.on("reply",function(f){return p.processReply(f)}),this.channel.on("disconnected",function(){p.activeRequests.forEach(function(f){clearTimeout(f.timeout),f.reject(new Ct("disconnected"))}),p.activeRequests.clear()})}return Me.default(m,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(l){var p=this.activeRequests.get(l.id);p&&(clearTimeout(p.timeout),this.activeRequests.delete(l.id),Eo(l.status.code)?p.resolve(l):(p.reject(new Rr("Transport failure: "+l.status.status,l)),z.trace("message rejected")))}},{key:"storeRequest",value:function(l,p,f){var g={resolve:p,reject:f,timeout:setTimeout(function(){z.trace("request",l,"is timed out"),f(new Ct("Twilsock: request timeout: "+l))},To)};this.activeRequests.set(l,g)}},{key:"shutdown",value:function(){this.activeRequests.forEach(function(l){clearTimeout(l.timeout),l.reject(new Ct("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}},{key:"sendInit",value:function(){var v=Ne.default(se.default.mark(function p(){var f,g,h;return se.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return z.trace("sendInit"),f=ko.getMetadata(this.config),g=new Se(this.config.token,this.config.continuationToken,f,this.config.initRegistrations,this.config.tweaks),S.next=5,this.sendWithReply(g);case 5:return h=S.sent,S.abrupt("return",new tr(h.id,h.header.continuation_token,new Set(h.header.capabilities),h.header.continuation_token_status,h.header.offline_storage,h.header.init_registrations,h.header.debug_info));case 7:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"sendClose",value:function(){var l=new Te;this.send(l)}},{key:"sendWithReply",value:function(l,p){var f=this;return new Promise(function(g,h){var w=f.send(l,p);f.storeRequest(w,g,h)})}},{key:"send",value:function(l,p){l.id=l.id||"TM".concat(P.v4());var f=$i.createPacket(l,fs(p));try{return this.channel.send(f),l.id}catch(g){throw z.debug("failed to send ",l,g),z.trace(g.stack),g}}}]),m}();function Co(m){var v=Io();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Io(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Jr=function(m){D.default(l,m);var v=Co(l);function l(p){var f;return ue.default(this,l),f=v.call(this),ee.default(x.default(f),"socket",null),f.url=p,f.url=p,f.WebSocket=t.WebSocket||t.MozWebSocket||{},f}return Me.default(l,[{key:"isConnected",get:function(){return!!this.socket&&this.socket.readyState===1}},{key:"connect",value:function(){var f=this;z.trace("connecting to socket");var g;try{g=new this.WebSocket(this.url)}catch(h){z.debug("Socket error: ".concat(this.url)),this.emit("socketError",h);return}g.binaryType="arraybuffer",g.onopen=function(){z.debug("socket opened ".concat(f.url)),f.emit("connected")},g.onclose=function(h){z.debug("socket closed",h),f.emit("disconnected",h)},g.onerror=function(h){z.debug("Socket error:",h),f.emit("socketError",h)},g.onmessage=function(h){f.emit("message",h.data)},this.socket=g}},{key:"send",value:function(f){return this.socket&&this.socket.send(f)}},{key:"close",value:function(){if(z.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),l}($);function Sr(m){var v=Ro();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Ro(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Oo=function(m){D.default(l,m);var v=Sr(l);function l(p){var f;return ue.default(this,l),f=v.call(this),f.transport=p,f.registrations=new Map,f.registrationsInProgress=new Map,f}return Me.default(l,[{key:"putNotificationContext",value:function(){var p=Ne.default(se.default.mark(function g(h,w){var S;return se.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return S={method:"put_notification_ctx",notification_ctx_id:h},U.next=3,this.transport.sendWithReply(S,w);case 3:case"end":return U.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"deleteNotificationContext",value:function(){var p=Ne.default(se.default.mark(function g(h){var w;return se.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return w={method:"delete_notification_ctx",notification_ctx_id:h},L.next=3,this.transport.sendWithReply(w);case 3:case"end":return L.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"updateRegistration",value:function(){var p=Ne.default(se.default.mark(function g(h,w){var S,L;return se.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return z.debug("update registration for context",h),S=this.registrationsInProgress.get(h),S||(S=new Set,this.registrationsInProgress.set(h,S)),L=P.v4(),S.add(L),K.prev=5,K.next=8,this.putNotificationContext(h,w);case 8:z.debug("registration attempt succeeded for context",w),S.delete(L),S.size===0&&(this.registrationsInProgress.delete(h),this.emit("registered",h)),K.next=19;break;case 13:K.prev=13,K.t0=K.catch(5),z.warn("registration attempt failed for context",w),z.debug(K.t0),S.delete(L),S.size===0&&(this.registrationsInProgress.delete(h),this.emit("registrationFailed",h,K.t0));case 19:case"end":return K.stop()}},g,this,[[5,13]])}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"updateRegistrations",value:function(){var p=Ne.default(se.default.mark(function g(){var h=this,w;return se.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return z.trace("refreshing ".concat(this.registrations.size," registrations")),w=[],this.registrations.forEach(function(U,K){w.push(h.updateRegistration(K,U))}),L.next=5,Promise.all(w);case 5:case"end":return L.stop()}},g,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Ne.default(se.default.mark(function g(h,w){return se.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!(!h||!w)){L.next=2;break}throw new Ct("Invalid arguments provided");case 2:return this.registrations.set(h,w),L.next=5,this.updateRegistration(h,w);case 5:return L.abrupt("return",L.sent);case 6:case"end":return L.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Ne.default(se.default.mark(function g(h){return se.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(this.registrations.has(h)){S.next=2;break}return S.abrupt("return");case 2:return S.next=4,this.deleteNotificationContext(h);case 4:this.transport.isConnected&&this.registrations.delete(h);case 5:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()}]),l}($);function Ao(m){var v=Po();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Po(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ki=function(m){D.default(l,m);var v=Ao(l);function l(p,f,g){var h;return ue.default(this,l),h=v.call(this,f),h.status=p,h.description=f,h.body=g,h}return l}(Ct);function Ti(m){var v=Ei();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Ei(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gn=function(m){D.default(l,m);var v=Ti(l);function l(p){return ue.default(this,l),v.call(this,p)}return l}(Ct),va=2e4;function ds(m){return m>=200&&m<300}function ps(m){return m&&m.header&&m.header.http_status}function Mo(m){var v=m.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(v){var l={protocol:v[1],host:v[2],hostname:v[3],port:v[4],pathname:v[5],search:v[6],hash:v[7],params:{}};if(l.search.length>0){var p=l.search.substring(1);l.params=p.split("&").map(function(f){return f.split("=")}).reduce(function(f,g){return f.hasOwnProperty(g[0])?Array.isArray(f[g[0]])?f[g[0]].push(g[1]):f[g[0]]=[f[g[0]],g[1]]:f[g[0]]=g[1],f},{})}return l}throw new Ct("Incorrect URI: "+m)}function No(m,v){var l=Mo(v),p={method:m,host:l.host,path:l.pathname};return l.params&&(p.params=l.params),p}function $t(m,v,l,p,f){return{to:No(m,v),headers:l,body:p,grant:f}}var ga=function(){function m(v,l,p){ue.default(this,m),this.config=p,this.transport=v,this.pendingMessages=[],this.twilsock=l}return Me.default(m,[{key:"saveMessage",value:function(l){var p=this;return new Promise(function(f,g){var h={message:l,resolve:f,reject:g,alreadyRejected:!1,timeout:setTimeout(function(){z.debug("request is timed out"),g(new Ct("request '".concat(l.to.method,"' to '").concat(l.to.host,"' timed out"))),h.alreadyRejected=!0},va)};p.pendingMessages.push(h)})}},{key:"sendPendingMessages",value:function(){for(var l=this,p=function(){var h=l.pendingMessages[0];if(!h.alreadyRejected)try{var w=h.message;l.actualSend(w).then(function(S){return h.resolve(S)}).catch(function(S){return h.reject(S)}),clearTimeout(h.timeout)}catch(S){return z.debug("Failed to send pending message",S),"break"}l.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){var f=p();if(f==="break")break}}},{key:"rejectPendingMessages",value:function(){var l=this;this.pendingMessages.forEach(function(p){p.reject(new gn("Unable to connect: "+l.twilsock.getTerminationReason)),p.alreadyRejected=!0,clearTimeout(p.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:function(){var v=Ne.default(se.default.mark(function p(f){var g,h,w,S,L,U,K,ge;return se.default.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return h=f.to,w=f.headers,S=f.body,L=(g=f.grant)!==null&&g!==void 0?g:this.config.activeGrant,U={host:h.host,path:h.path,method:h.method,params:h.params,headers:w},K=new oe(L,w["Content-Type"]||"application/json",U),z.trace("Sending upstream message",K),at.next=9,this.transport.sendWithReply(K,S);case 9:if(ge=at.sent,z.trace("Received upstream message response",ge),!(ps(ge)&&!ds(ge.header.http_status.code))){at.next=13;break}throw new ki(ge.header.http_status.code,ge.header.http_status.status,ge.body);case 13:return at.abrupt("return",{status:ge.header.http_status,headers:ge.header.http_headers,body:ge.body});case 14:case"end":return at.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"send",value:function(l,p){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},g=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new gn("Unable to connect: "+this.twilsock.getTerminationReason));var w=$t(l,p,f,g,h);return this.twilsock.isConnected?this.actualSend(w):this.saveMessage(w)}}]),m}(),hs=function(){function m(){var v=this;ue.default(this,m),this._promise=new Promise(function(l,p){v._resolve=l,v._reject=p})}return Me.default(m,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(l){this._resolve(l)}},{key:"set",value:function(l){this._resolve(l)}},{key:"fail",value:function(l){this._reject(l)}}]),m}(),Ci=function(){function m(v){ue.default(this,m),this.id=v}return Me.default(m,null,[{key:"create",value:function(l){if(l instanceof Object&&"storage_id"in l)return new m(l.storage_id);throw new Ct('Field "storage_id" is missing')}}]),m}(),ya=function(){function m(){return ue.default(this,m),ee.default(this,"initializedFlag","twilio_twilsock_token_storage"),ee.default(this,"tokenStoragePrefix","twilio_continuation_token_"),m._instance||(this.initialize(),m._instance=this),m._instance}return Me.default(m,[{key:"sessionStorage",value:function(){try{return t.sessionStorage}catch{return null}}},{key:"window",value:function(){try{return t.window}catch{return null}}},{key:"storeToken",value:function(l,p){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(p),l)}},{key:"getStoredToken",value:function(l){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(l)):null}},{key:"initialize",value:function(){var l=this;if(this.canStore()){var p=this.sessionStorage.getItem(this.initializedFlag);p&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var f=this.sessionStorage.removeItem;this.window.addEventListener("unload",function(){f(l.initializedFlag)})}}},{key:"clear",value:function(){if(this.canStore()){for(var l=[],p=0;p<this.sessionStorage.length;p++){var f=this.sessionStorage.key(p);f&&f.indexOf(this.tokenStoragePrefix)===0&&l.push(f)}var g=this.sessionStorage.removeItem;l.forEach(function(h){return g(h)}),g(this.initializedFlag)}}},{key:"getKeyName",value:function(l){return"".concat(this.tokenStoragePrefix).concat(l)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),m}();ee.default(ya,"_instance",null);var Yn=new ya,At=function(){function m(v,l,p,f,g,h){ue.default(this,m),this.title=v,this.details=l,this.start=p,this.type=g,this.id=h,this.end=f}return Me.default(m,[{key:"toTelemetryEvent",value:function(){var l=new Date,p=this.start,f=this.end?this.end:l;if(f<p){var g=f;f=p,p=g}var h=p.getTime()-l.getTime(),w=f.getTime()-l.getTime(),S=new st(h,w,this.title,this.details,this.id,this.type);return S}}]),m}();e.TelemetryPoint=void 0,function(m){m[m.Start=0]="Start",m[m.End=1]="End"}(e.TelemetryPoint||(e.TelemetryPoint={})),e.EventSendingLimitation=void 0,function(m){m[m.MinEventsPortion=0]="MinEventsPortion",m[m.AnyEvents=1]="AnyEvents",m[m.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(e.EventSendingLimitation||(e.EventSendingLimitation={}));var Yr=function(){function m(v,l){ue.default(this,m),ee.default(this,"minEventsPortionToSend",50),ee.default(this,"maxEventsPortionToSend",100),ee.default(this,"pendingEvents",new Map),ee.default(this,"readyEvents",[]),ee.default(this,"hasInitializationFinished",!1),ee.default(this,"_canSendTelemetry",!1),this.config=v,this.packetInterface=l}return Me.default(m,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(l){z.debug("TelemetryTracker.canSendTelemetry: ".concat(l," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!l&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=l,l&&this.sendTelemetry(e.EventSendingLimitation.AnyEvents),l&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(l){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(l)}},{key:"addPartialEvent",value:function(l,p,f){z.debug("Adding ".concat(f===e.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(p,"' event"));var g=this.pendingEvents.has(p);if(f===e.TelemetryPoint.Start)g&&z.debug("Overwriting starting point for '".concat(p,"' event")),this.pendingEvents.set(p,l);else{if(!g){z.info("Could not find started event for '".concat(p,"' event"));return}this.addTelemetryEvent(this.merge(this.pendingEvents.get(p),l)),this.pendingEvents.delete(p)}}},{key:"getTelemetryToSend",value:function(l){return!this.canSendTelemetry||this.readyEvents.length==0?[]:l==e.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(l==e.EventSendingLimitation.AnyEventsIncludingUnfinished)}},{key:"getTelemetryPortion",value:function(l){var p=this,f=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),g=this.readyEvents.splice(0,f);return l&&g.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach(function(h,w){if(!(g.length>=p.maxEventsPortionToSend)){var S=p.pendingEvents.get(w);p.pendingEvents.delete(w),g.push(new At("[UNFINISHED] ".concat(S.title),S.details,S.start,null,S.type,S.id))}}),g}},{key:"merge",value:function(l,p){return new At(p.title?p.title:l.title,p.details?p.details:l.details,l.start,p.end,p.type?p.type:l.type,p.id?p.id:l.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(e.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(l){var p=this.getTelemetryToSend(l);if(p.length!==0)try{this.packetInterface.send(new rt(p.map(function(f){return f.toTelemetryEvent()})))}catch(f){z.debug("Error while sending ".concat(p.length," telemetry events due to ").concat(f,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(p)}}}]),m}();function ma(m){var v=Qr();return function(){var p=Ie.default(m),f;if(v){var g=Ie.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Re.default(this,f)}}function Qr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var I=function m(){ue.default(this,m)};ee.default(I,"TWILSOCK_CONNECT","twilsock.sdk.connect"),ee.default(I,"TWILSOCK_INIT","twilsock.sdk.init"),e.TwilsockClient=function(m){D.default(l,m);var v=ma(l);function l(p,f,g){var h;ue.default(this,l),h=v.call(this),ee.default(x.default(h),"version",Ue),ee.default(x.default(h),"offlineStorageDeferred",new hs),g.continuationToken=g.continuationToken?g.continuationToken:Yn.getStoredToken(f);var w=h.config=new ae(p,f,g);z.setLevel(w.logLevel);var S=new Jr(w.url),L=new Jn(S,w);return h.channel=new St(S,L,w),h.registrations=new Oo(L),h.upstream=new ga(L,h.channel,w),h.telemetryTracker=new Yr(w,L),h.channel.on("initialized",function(){return h.telemetryTracker.canSendTelemetry=!0}),S.on("disconnected",function(){return h.telemetryTracker.canSendTelemetry=!1}),h.registrations.on("registered",function(U){return h.emit("registered",U)}),h.channel.on("message",function(U,K){return setTimeout(function(){return h.emit("message",U,K)},0)}),h.channel.on("stateChanged",function(U){return setTimeout(function(){return h.emit("stateChanged",U)},0)}),h.channel.on("connectionError",function(U){return setTimeout(function(){return h.emit("connectionError",U)},0)}),h.channel.on("tokenAboutToExpire",function(){return setTimeout(function(){return h.emit("tokenAboutToExpire")},0)}),h.channel.on("tokenExpired",function(){return setTimeout(function(){return h.emit("tokenExpired")},0)}),h.channel.on("connected",function(){return h.registrations.updateRegistrations()}),h.channel.on("connected",function(){return h.upstream.sendPendingMessages()}),h.channel.on("connected",function(){return setTimeout(function(){return h.emit("connected")},0)}),h.channel.on("beforeConnect",function(){return h.telemetryTracker.addPartialEvent(new At("Establish WebSocket connection","",new Date),I.TWILSOCK_CONNECT,e.TelemetryPoint.Start)}),h.channel.on("connected",function(){return h.telemetryTracker.addPartialEvent(new At("Establish WebSocket connection","",new Date,new Date),I.TWILSOCK_CONNECT,e.TelemetryPoint.End)}),h.channel.on("beforeSendInit",function(){return h.telemetryTracker.addPartialEvent(new At("Send Twilsock init","",new Date),I.TWILSOCK_INIT,e.TelemetryPoint.Start)}),h.channel.on("initialized",function(){return h.telemetryTracker.addPartialEvent(new At("Send Twilsock init","Succeeded",new Date,new Date),I.TWILSOCK_INIT,e.TelemetryPoint.End)}),h.channel.on("sendInitFailed",function(){return h.telemetryTracker.addPartialEvent(new At("Send Twilsock init","Failed",new Date,new Date),I.TWILSOCK_INIT,e.TelemetryPoint.End)}),h.channel.on("initialized",function(U){h.handleStorageId(f,U),Yn.storeToken(U.continuationToken,f),setTimeout(function(){return h.emit("initialized",U)},0)}),h.channel.on("disconnected",function(){return setTimeout(function(){return h.emit("disconnected")},0)}),h.channel.on("disconnected",function(){return h.upstream.rejectPendingMessages()}),h.channel.on("disconnected",function(){return h.offlineStorageDeferred.fail(new Ct("Client disconnected"))}),h.offlineStorageDeferred.promise.catch(function(){}),h}return Me.default(l,[{key:"emit",value:function(f){for(var g,h=arguments.length,w=new Array(h>1?h-1:0),S=1;S<h;S++)w[S-1]=arguments[S];return z.debug("Emitting ".concat(f.toString(),"(").concat(w.map(function(L){return JSON.stringify(L)}).join(", "),")")),(g=le.default(Ie.default(l.prototype),"emit",this)).call.apply(g,[this,f].concat(w))}},{key:"handleStorageId",value:function(f,g){if(!g.offlineStorage)this.offlineStorageDeferred.fail(new Ct("No offline storage id"));else if(g.offlineStorage.hasOwnProperty(f))try{this.offlineStorageDeferred.set(Ci.create(g.offlineStorage[f])),z.debug("Offline storage for '".concat(f,"' product: ").concat(JSON.stringify(g.offlineStorage[f]),"."))}catch(h){this.offlineStorageDeferred.fail(new Ct("Failed to parse offline storage for ".concat(f," ").concat(JSON.stringify(g.offlineStorage[f]),". ").concat(h,".")))}else this.offlineStorageDeferred.fail(new Ct("No offline storage id for '".concat(f,"' product: ").concat(JSON.stringify(g.offlineStorage))))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:function(){var p=Ne.default(se.default.mark(function g(h){return se.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(z.trace("updating token '".concat(h,"'")),this.config.token!==h){S.next=3;break}return S.abrupt("return");case 3:return this.config.updateToken(h),S.next=6,this.channel.updateToken(h);case 6:return S.abrupt("return",S.sent);case 7:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Ne.default(se.default.mark(function g(h,w){return se.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.registrations.setNotificationsContext(h,w);case 2:case"end":return L.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Ne.default(se.default.mark(function g(h){return se.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.registrations.removeNotificationsContext(h);case 2:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){var p=Ne.default(se.default.mark(function g(){return se.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEventsIncludingUnfinished),w.next=3,this.channel.disconnect();case 3:return w.abrupt("return",w.sent);case 4:case"end":return w.stop()}},g,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"get",value:function(){var p=Ne.default(se.default.mark(function g(h,w,S){return se.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),U.next=3,this.upstream.send("GET",h,w,void 0,S);case 3:return U.abrupt("return",U.sent);case 4:case"end":return U.stop()}},g,this)}));function f(g,h,w){return p.apply(this,arguments)}return f}()},{key:"post",value:function(){var p=Ne.default(se.default.mark(function g(h,w,S,L){return se.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),K.next=3,this.upstream.send("POST",h,w,S,L);case 3:return K.abrupt("return",K.sent);case 4:case"end":return K.stop()}},g,this)}));function f(g,h,w,S){return p.apply(this,arguments)}return f}()},{key:"put",value:function(){var p=Ne.default(se.default.mark(function g(h,w,S,L){return se.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),K.next=3,this.upstream.send("PUT",h,w,S,L);case 3:return K.abrupt("return",K.sent);case 4:case"end":return K.stop()}},g,this)}));function f(g,h,w,S){return p.apply(this,arguments)}return f}()},{key:"delete",value:function(){var p=Ne.default(se.default.mark(function g(h,w,S,L){return se.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),K.next=3,this.upstream.send("DELETE",h,w,S,L);case 3:return K.abrupt("return",K.sent);case 4:case"end":return K.stop()}},g,this)}));function f(g,h,w,S){return p.apply(this,arguments)}return f}()},{key:"addTelemetryEvent",value:function(f){this.telemetryTracker.addTelemetryEvent(f),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(f,g,h){this.telemetryTracker.addPartialEvent(f,g,h),h===e.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),l}($),e.TwilsockClient=Je([b.validateConstructorTypes(b.nonEmptyString,b.nonEmptyString,[b.pureObject,"undefined",b.literal(null)]),fe("design:paramtypes",[String,String,Object])],e.TwilsockClient);var A=function(){function m(v){ue.default(this,m),this.product=v,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return Me.default(m,[{key:"populateInitRegistrations",value:function(l){var p=new Set(this.message_types);for(var f in l)p.add(l[f]);this.message_types=Array.from(p)}}]),m}();e.InitRegistration=A,e.TelemetryEventDescription=At,e.TelemetryTracker=Yr,e.TransportUnavailableError=gn,e.Twilsock=e.TwilsockClient,e.TwilsockError=Ct})(If);var jT={},k_=Wt,Ez=et,Cz=Mt,Iz=nt,op=Vu,Rz=Hu,Oz=Uu,Az=yr,Pz=Du,Ts=Object.assign,T_=Object.defineProperty,Mz=Ez([].concat),UT=!Ts||Iz(function(){if(k_&&Ts({b:1},Ts(T_({},"a",{enumerable:!0,get:function(){T_(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),Ts({},e)[r]!=7||op(Ts({},t)).join("")!=n})?function(t,r){for(var n=Az(t),i=arguments.length,a=1,s=Rz.f,o=Oz.f;i>a;)for(var u=Pz(arguments[a++]),c=s?Mz(op(u),s(u)):op(u),d=c.length,y=0,_;d>y;)_=c[y++],(!k_||Cz(o,u,_))&&(n[_]=u[_]);return n}:Ts,Nz=ct,E_=UT;Nz({target:"Object",stat:!0,arity:2,forced:Object.assign!==E_},{assign:E_});/*
@license
The MIT License (MIT)

Copyright (c) 2016 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=go.exports,r=fa.exports,n=is.exports,i=oa.exports,a=ua.exports,s=zn.exports,o=nl,u=la.exports,c=If,d=sa.exports,y=ca.exports,_=Si,b=il.exports,k=al.exports,N=bo.exports,P=Rf,j=ir;function F(oe){return oe&&typeof oe=="object"&&"default"in oe?oe:{default:oe}}function me(oe){if(oe&&oe.__esModule)return oe;var pe=Object.create(null);return oe&&Object.keys(oe).forEach(function(Q){if(Q!=="default"){var ie=Object.getOwnPropertyDescriptor(oe,Q);Object.defineProperty(pe,Q,ie.get?ie:{enumerable:!0,get:function(){return oe[Q]}})}}),pe.default=oe,Object.freeze(pe)}var ce=F(t),xe=F(r),Ne=F(n),Me=F(i),x=F(a),le=F(s),D=F(o),Re=F(u),Ie=F(d),ue=F(y),ee=F(b),se=F(k),ne=me(N),be=me(P);function O(oe,pe,Q,ie){var X=arguments.length,ye=X<3?pe:ie===null?ie=Object.getOwnPropertyDescriptor(pe,Q):ie,Te;if((typeof Reflect>"u"?"undefined":Re.default(Reflect))==="object"&&typeof Reflect.decorate=="function")ye=Reflect.decorate(oe,pe,Q,ie);else for(var Le=oe.length-1;Le>=0;Le--)(Te=oe[Le])&&(ye=(X<3?Te(ye):X>3?Te(pe,Q,ye):Te(pe,Q))||ye);return X>3&&ye&&Object.defineProperty(pe,Q,ye),ye}function je(oe,pe){if((typeof Reflect>"u"?"undefined":Re.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(oe,pe)}var ft;function Je(){}Je.prototype=Object.create(null);function fe(){fe.init.call(this)}fe.EventEmitter=fe,fe.usingDomains=!1,fe.prototype.domain=void 0,fe.prototype._events=void 0,fe.prototype._maxListeners=void 0,fe.defaultMaxListeners=10,fe.init=function(){this.domain=null,fe.usingDomains&&ft.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Je,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},fe.prototype.setMaxListeners=function(pe){if(typeof pe!="number"||pe<0||isNaN(pe))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=pe,this};function G(oe){return oe._maxListeners===void 0?fe.defaultMaxListeners:oe._maxListeners}fe.prototype.getMaxListeners=function(){return G(this)};function Y(oe,pe,Q){if(pe)oe.call(Q);else for(var ie=oe.length,X=T(oe,ie),ye=0;ye<ie;++ye)X[ye].call(Q)}function $(oe,pe,Q,ie){if(pe)oe.call(Q,ie);else for(var X=oe.length,ye=T(oe,X),Te=0;Te<X;++Te)ye[Te].call(Q,ie)}function C(oe,pe,Q,ie,X){if(pe)oe.call(Q,ie,X);else for(var ye=oe.length,Te=T(oe,ye),Le=0;Le<ye;++Le)Te[Le].call(Q,ie,X)}function Z(oe,pe,Q,ie,X,ye){if(pe)oe.call(Q,ie,X,ye);else for(var Te=oe.length,Le=T(oe,Te),Xe=0;Xe<Te;++Xe)Le[Xe].call(Q,ie,X,ye)}function te(oe,pe,Q,ie){if(pe)oe.apply(Q,ie);else for(var X=oe.length,ye=T(oe,X),Te=0;Te<X;++Te)ye[Te].apply(Q,ie)}fe.prototype.emit=function(pe){var Q,ie,X,ye,Te,Le,Xe,st=pe==="error";if(Le=this._events,Le)st=st&&Le.error==null;else if(!st)return!1;if(Xe=this.domain,st){if(Q=arguments[1],Xe)Q||(Q=new Error('Uncaught, unspecified "error" event')),Q.domainEmitter=this,Q.domain=Xe,Q.domainThrown=!1,Xe.emit("error",Q);else{if(Q instanceof Error)throw Q;var rt=new Error('Uncaught, unspecified "error" event. ('+Q+")");throw rt.context=Q,rt}return!1}if(ie=Le[pe],!ie)return!1;var Fe=typeof ie=="function";switch(X=arguments.length,X){case 1:Y(ie,Fe,this);break;case 2:$(ie,Fe,this,arguments[1]);break;case 3:C(ie,Fe,this,arguments[1],arguments[2]);break;case 4:Z(ie,Fe,this,arguments[1],arguments[2],arguments[3]);break;default:for(ye=new Array(X-1),Te=1;Te<X;Te++)ye[Te-1]=arguments[Te];te(ie,Fe,this,ye)}return!0};function Ae(oe,pe,Q,ie){var X,ye,Te;if(typeof Q!="function")throw new TypeError('"listener" argument must be a function');if(ye=oe._events,ye?(ye.newListener&&(oe.emit("newListener",pe,Q.listener?Q.listener:Q),ye=oe._events),Te=ye[pe]):(ye=oe._events=new Je,oe._eventsCount=0),!Te)Te=ye[pe]=Q,++oe._eventsCount;else if(typeof Te=="function"?Te=ye[pe]=ie?[Q,Te]:[Te,Q]:ie?Te.unshift(Q):Te.push(Q),!Te.warned&&(X=G(oe),X&&X>0&&Te.length>X)){Te.warned=!0;var Le=new Error("Possible EventEmitter memory leak detected. "+Te.length+" "+pe+" listeners added. Use emitter.setMaxListeners() to increase limit");Le.name="MaxListenersExceededWarning",Le.emitter=oe,Le.type=pe,Le.count=Te.length,De(Le)}return oe}function De(oe){typeof console.warn=="function"?console.warn(oe):console.log(oe)}fe.prototype.addListener=function(pe,Q){return Ae(this,pe,Q,!1)},fe.prototype.on=fe.prototype.addListener,fe.prototype.prependListener=function(pe,Q){return Ae(this,pe,Q,!0)};function de(oe,pe,Q){var ie=!1;function X(){oe.removeListener(pe,X),ie||(ie=!0,Q.apply(oe,arguments))}return X.listener=Q,X}fe.prototype.once=function(pe,Q){if(typeof Q!="function")throw new TypeError('"listener" argument must be a function');return this.on(pe,de(this,pe,Q)),this},fe.prototype.prependOnceListener=function(pe,Q){if(typeof Q!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(pe,de(this,pe,Q)),this},fe.prototype.removeListener=function(pe,Q){var ie,X,ye,Te,Le;if(typeof Q!="function")throw new TypeError('"listener" argument must be a function');if(X=this._events,!X)return this;if(ie=X[pe],!ie)return this;if(ie===Q||ie.listener&&ie.listener===Q)--this._eventsCount===0?this._events=new Je:(delete X[pe],X.removeListener&&this.emit("removeListener",pe,ie.listener||Q));else if(typeof ie!="function"){for(ye=-1,Te=ie.length;Te-- >0;)if(ie[Te]===Q||ie[Te].listener&&ie[Te].listener===Q){Le=ie[Te].listener,ye=Te;break}if(ye<0)return this;if(ie.length===1){if(ie[0]=void 0,--this._eventsCount===0)return this._events=new Je,this;delete X[pe]}else E(ie,ye);X.removeListener&&this.emit("removeListener",pe,Le||Q)}return this},fe.prototype.off=function(oe,pe){return this.removeListener(oe,pe)},fe.prototype.removeAllListeners=function(pe){var Q,ie;if(ie=this._events,!ie)return this;if(!ie.removeListener)return arguments.length===0?(this._events=new Je,this._eventsCount=0):ie[pe]&&(--this._eventsCount===0?this._events=new Je:delete ie[pe]),this;if(arguments.length===0){for(var X=Object.keys(ie),ye=0,Te;ye<X.length;++ye)Te=X[ye],Te!=="removeListener"&&this.removeAllListeners(Te);return this.removeAllListeners("removeListener"),this._events=new Je,this._eventsCount=0,this}if(Q=ie[pe],typeof Q=="function")this.removeListener(pe,Q);else if(Q)do this.removeListener(pe,Q[Q.length-1]);while(Q[0]);return this},fe.prototype.listeners=function(pe){var Q,ie,X=this._events;return X?(Q=X[pe],Q?typeof Q=="function"?ie=[Q.listener||Q]:ie=V(Q):ie=[]):ie=[],ie},fe.listenerCount=function(oe,pe){return typeof oe.listenerCount=="function"?oe.listenerCount(pe):$e.call(oe,pe)},fe.prototype.listenerCount=$e;function $e(oe){var pe=this._events;if(pe){var Q=pe[oe];if(typeof Q=="function")return 1;if(Q)return Q.length}return 0}fe.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function E(oe,pe){for(var Q=pe,ie=Q+1,X=oe.length;ie<X;Q+=1,ie+=1)oe[Q]=oe[ie];oe.pop()}function T(oe,pe){for(var Q=new Array(pe);pe--;)Q[pe]=oe[pe];return Q}function V(oe){for(var pe=new Array(oe.length),Q=0;Q<pe.length;++Q)pe[Q]=oe[Q].listener||oe[Q];return pe}var re=ne.getLogger("twilio-notificatiions");function W(oe,pe){return["".concat(new Date().toISOString()," Twilio.Notifications ").concat(oe,":")].concat(Array.from(pe))}var ke=function(){function oe(){xe.default(this,oe)}return Ne.default(oe,[{key:"setLevel",value:function(Q){re.setLevel(Q)}},{key:"trace",value:function(){for(var Q=arguments.length,ie=new Array(Q),X=0;X<Q;X++)ie[X]=arguments[X];re.trace.apply(null,W("T",ie))}},{key:"debug",value:function(){for(var Q=arguments.length,ie=new Array(Q),X=0;X<Q;X++)ie[X]=arguments[X];re.debug.apply(null,W("D",ie))}},{key:"info",value:function(){for(var Q=arguments.length,ie=new Array(Q),X=0;X<Q;X++)ie[X]=arguments[X];re.info.apply(null,W("I",ie))}},{key:"warn",value:function(){for(var Q=arguments.length,ie=new Array(Q),X=0;X<Q;X++)ie[X]=arguments[X];re.warn.apply(null,W("W",ie))}},{key:"error",value:function(){for(var Q=arguments.length,ie=new Array(Q),X=0;X<Q;X++)ie[X]=arguments[X];re.error.apply(null,W("E",ie))}}]),oe}(),he=new ke;function we(oe){var pe=Oe();return function(){var ie=le.default(oe),X;if(pe){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function Oe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var z=function oe(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;xe.default(this,oe),this.token=pe,this.notificationId=Q,this.messageTypes=ie};function Ue(oe,pe){return[].concat(se.default(se.default(oe).filter(function(Q){return!pe.has(Q)})),se.default(se.default(pe).filter(function(Q){return!oe.has(Q)})))}function ae(oe,pe){var Q=new Set;return oe.notificationId!==pe.notificationId&&Q.add("notificationId"),oe.token!==pe.token&&Q.add("token"),Ue(oe.messageTypes,pe.messageTypes).length>0&&Q.add("messageType"),[Q.size>0,Q]}var q=function(oe){Me.default(Q,oe);var pe=we(Q);function Q(ie){var X;return xe.default(this,Q),X=pe.call(this),ue.default(Ie.default(X),"desiredState",new z),ue.default(Ie.default(X),"currentState",new z),ue.default(Ie.default(X),"_hasActiveAttempt",!1),X.channelType=ie,X}return Ne.default(Q,[{key:"setNotificationId",value:function(X){this.desiredState.notificationId=X}},{key:"isActive",value:function(){return this.desiredState.notificationId!==""}},{key:"subscribe",value:function(X){if(this.desiredState.messageTypes.has(X)){he.debug("message type '".concat(X,"' for channel ").concat(this.channelType," is already registered"));return}this.desiredState.messageTypes.add(X)}},{key:"unsubscribe",value:function(X){!this.desiredState.messageTypes.has(X)||this.desiredState.messageTypes.delete(X)}},{key:"updateToken",value:function(X){this.desiredState.token=X}},{key:"commitChanges",value:function(){var ie=ce.default(D.default.mark(function ye(){var Te,Le,Xe,st,rt,Fe;return D.default.wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:if(!this._hasActiveAttempt){Qe.next=3;break}throw he.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(Te=ae(this.desiredState,this.currentState),Le=ee.default(Te,2),Xe=Le[0],st=Le[1],Xe){Qe.next=6;break}return Qe.abrupt("return");case 6:if(this.currentState.notificationId||st.delete("notificationId"),he.trace("Persisting ".concat(this.channelType," registration"),st,this.desiredState),Qe.prev=8,this._hasActiveAttempt=!0,rt=new z,rt.token=this.desiredState.token,rt.notificationId=this.desiredState.notificationId,rt.messageTypes=new Set(this.desiredState.messageTypes),!(rt.messageTypes.size>0)){Qe.next=24;break}return Qe.next=17,this.updateRegistration(rt,st);case 17:Fe=Qe.sent,this.currentState.token=Fe.token,this.currentState.notificationId=Fe.notificationId,this.currentState.messageTypes=new Set(Fe.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),Qe.next=30;break;case 24:return Qe.next=26,this.removeRegistration();case 26:this.currentState.token=rt.token,this.currentState.notificationId=rt.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:Qe.next=35;break;case 32:throw Qe.prev=32,Qe.t0=Qe.catch(8),Qe.t0;case 35:return Qe.prev=35,this._hasActiveAttempt=!1,Qe.finish(35);case 38:case"end":return Qe.stop()}},ye,this,[[8,32,35,38]])}));function X(){return ie.apply(this,arguments)}return X}()}]),Q}(fe);function Ce(oe){var pe=B();return function(){var ie=le.default(oe),X;if(pe){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function B(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Se={min:2e3,max:12e4,randomness:.2},Ge=function(oe){Me.default(Q,oe);var pe=Ce(Q);function Q(ie,X,ye,Te){var Le;return xe.default(this,Q),Le=pe.call(this,ie),ue.default(Ie.default(Le),"registrationId",null),Le.context=X,Le.twilsock=ye,Le.registrarUrl=Te,Le}return Ne.default(Q,[{key:"updateRegistration",value:function(){var ie=ce.default(D.default.mark(function ye(Te,Le){var Xe=this,st,rt,Fe,_r,Qe;return D.default.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(!Le.has("notificationId")){Dt.next=3;break}return Dt.next=3,this.removeRegistration();case 3:if(!(!Te.notificationId||!Te.notificationId.length)){Dt.next=6;break}throw he.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return he.trace("Registering",this.channelType,Te),st={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(Te.messageTypes),data:{registration_id:Te.notificationId}},rt=this.context.productId,Fe="".concat(this.registrarUrl,"?productId=").concat(rt),_r={"Content-Type":"application/json"},he.trace("Creating registration for channel ".concat(this.channelType)),Dt.prev=12,Dt.next=15,new _.AsyncRetrier(Se).run(function(){return Xe.twilsock.post(Fe,_r,st,rt)});case 15:Qe=Dt.sent,this.registrationId=Qe.body.id,he.debug("Registration created: ",Qe),Dt.next=24;break;case 20:throw Dt.prev=20,Dt.t0=Dt.catch(12),he.error("Registration failed: ",Dt.t0),Dt.t0;case 24:return Dt.abrupt("return",Te);case 25:case"end":return Dt.stop()}},ye,this,[[12,20]])}));function X(ye,Te){return ie.apply(this,arguments)}return X}()},{key:"removeRegistration",value:function(){var ie=ce.default(D.default.mark(function ye(){var Te=this,Le,Xe,st;return D.default.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(this.registrationId){Fe.next=2;break}return Fe.abrupt("return");case 2:return Le=this.context.productId,Xe="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(Le),st={"Content-Type":"application/json"},he.trace("Removing registration for ".concat(this.channelType)),Fe.prev=6,Fe.next=9,new _.AsyncRetrier(Object.assign(Se,{maxAttemptsCount:3})).run(function(){return Te.twilsock.delete(Xe,st,{},Le)});case 9:this.registrationId=null,this.currentState.notificationId="",he.debug("Registration removed for ".concat(this.channelType)),Fe.next=18;break;case 14:throw Fe.prev=14,Fe.t0=Fe.catch(6),he.error("Failed to remove registration ",this.channelType,Fe.t0),Fe.t0;case 18:case"end":return Fe.stop()}},ye,this,[[6,14]])}));function X(){return ie.apply(this,arguments)}return X}()},{key:"sendDeviceRemoveRequest",value:function(){var ie=ce.default(D.default.mark(function ye(Te){var Le=this,Xe,st,rt,Fe;return D.default.wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:if(Te!==""){Qe.next=2;break}throw new Error("Empty registration ID");case 2:return Xe=this.context.productId,st="".concat(this.registrarUrl,"?productId=").concat(Xe),rt={"Content-Type":"application/json"},Fe={binding_type:this.channelType,address:Te},Qe.prev=6,he.trace("Removing old registrations for ".concat(this.channelType)),Qe.next=10,new _.AsyncRetrier(Object.assign(Se,{maxAttemptsCount:3})).run(function(){return Le.twilsock.delete(st,rt,Fe,Xe)});case 10:this.registrationId=null,this.currentState.notificationId="",he.debug("Registration removed for ".concat(this.channelType)),Qe.next=19;break;case 15:throw Qe.prev=15,Qe.t0=Qe.catch(6),he.error("Failed to remove registration ",this.channelType,Qe.t0),Qe.t0;case 19:case"end":return Qe.stop()}},ye,this,[[6,15]])}));function X(ye){return ie.apply(this,arguments)}return X}()}]),Q}(q);function tt(oe){var pe=tr();return function(){var ie=le.default(oe),X;if(pe){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function tr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wr=function(oe){Me.default(Q,oe);var pe=tt(Q);function Q(ie,X,ye){var Te;return xe.default(this,Q),Te=pe.call(this,"twilsock"),ue.default(Ie.default(Te),"contextId",be.v4()),Te.productId=ie,Te.platform=X,Te.twilsock=ye,Te}return Ne.default(Q,[{key:"updateRegistration",value:function(){var ie=ce.default(D.default.mark(function ye(Te,Le){var Xe,st;return D.default.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Le.has("messageType")){Fe.next=2;break}return Fe.abrupt("return",Te);case 2:return Xe=Array.from(Te.messageTypes),st={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:Xe},Fe.prev=4,Fe.next=7,this.twilsock.setNotificationsContext(this.contextId,st);case 7:Fe.next=13;break;case 9:throw Fe.prev=9,Fe.t0=Fe.catch(4),he.error("Failed to update twilsock notification context: ".concat(Fe.t0)),Fe.t0;case 13:return Fe.abrupt("return",Te);case 14:case"end":return Fe.stop()}},ye,this,[[4,9]])}));function X(ye,Te){return ie.apply(this,arguments)}return X}()},{key:"removeRegistration",value:function(){var ie=ce.default(D.default.mark(function ye(){return D.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Le.prev=0,Le.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:Le.next=9;break;case 5:throw Le.prev=5,Le.t0=Le.catch(0),he.error("Failed to remove twilsock notification context: ".concat(Le.t0)),Le.t0;case 9:case"end":return Le.stop()}},ye,this,[[0,5]])}));function X(){return ie.apply(this,arguments)}return X}()},{key:"sendDeviceRemoveRequest",value:function(){var ie=ce.default(D.default.mark(function ye(Te){return D.default.wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:case"end":return Xe.stop()}},ye)}));function X(ye){return ie.apply(this,arguments)}return X}()}]),Q}(q);function hn(oe){var pe=Ir();return function(){var ie=le.default(oe),X;if(pe){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function Ir(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mt,Ut=j.literal("apn","fcm","twilsock");e.Notifications=mt=function(oe){Me.default(Q,oe);var pe=hn(Q);function Q(ie){var X,ye,Te,Le,Xe,st,rt,Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};xe.default(this,Q),rt=pe.call(this),Fe.logLevel=(X=Fe.logLevel)!==null&&X!==void 0?X:"error",he.setLevel(Fe.logLevel);var _r=(ye=Fe.productId)!==null&&ye!==void 0?ye:"notifications",Qe=!Fe.twilsockClient,Ht=Fe.twilsockClient=(Te=Fe.twilsockClient)!==null&&Te!==void 0?Te:new c.TwilsockClient(ie,_r,Fe),Dt=(Le=Fe.notifications)!==null&&Le!==void 0?Le:{},$i=(Xe=(st=Dt.region)!==null&&st!==void 0?st:Fe.region)!==null&&Xe!==void 0?Xe:"us1",Kn="https://ers.".concat($i,".twilio.com/v1/registrations"),Pn=Dt.ersUrl||Kn;rt.connectors=new Map;var Ct=mt._detectPlatform();return rt.connectors.set("apn",new Ge("apn",{protocolVersion:4,productId:_r,platform:Ct},Ht,Pn)),rt.connectors.set("fcm",new Ge("fcm",{protocolVersion:3,productId:_r,platform:Ct},Ht,Pn)),rt.connectors.set("twilsock",new wr(_r,Ct,Ht)),Ht.on("stateChanged",function(Ft){return rt.emit("transportState",Ft)}),rt._connector("twilsock").on("stateChanged",function(Ft,Lr,Rr){return rt.emit("stateChanged",Ft,Lr,Rr)}),rt._connector("apn").on("stateChanged",function(Ft,Lr,Rr){return rt.emit("stateChanged",Ft,Lr,Rr)}),rt._connector("fcm").on("stateChanged",function(Ft,Lr,Rr){return rt.emit("stateChanged",Ft,Lr,Rr)}),Ht.on("message",function(Ft,Lr){return rt._routeMessage(Ft,Lr)}),rt.updateToken(ie),Qe&&(Ht.connect(),rt.twilsock=Ht),rt}return Ne.default(Q,[{key:"shutdown",value:function(){var ie=ce.default(D.default.mark(function ye(){return D.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:if(this.connectors.clear(),!this.twilsock){Le.next=4;break}return Le.next=4,this.twilsock.disconnect();case 4:case"end":return Le.stop()}},ye,this)}));function X(){return ie.apply(this,arguments)}return X}()},{key:"setPushRegistrationId",value:function(X,ye){he.debug("Set ".concat(X," push registration id '").concat(ye,"'")),this._connector(X).setNotificationId(ye)}},{key:"subscribe",value:function(X,ye){he.debug("Add ".concat(X," subscriptions for message type ").concat(ye)),this._connector(X).subscribe(ye)}},{key:"unsubscribe",value:function(X,ye){he.debug("Remove ".concat(X," subscriptions for message type ").concat(ye)),this._connector(X).unsubscribe(ye)}},{key:"updateToken",value:function(X){this.connectors.forEach(function(ye){return ye.updateToken(X)})}},{key:"commitChanges",value:function(){var ie=ce.default(D.default.mark(function ye(){var Te;return D.default.wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return Te=[],this.connectors.forEach(function(st){st.isActive()&&Te.push(st.commitChanges())}),Xe.next=4,Promise.all(Te);case 4:case"end":return Xe.stop()}},ye,this)}));function X(){return ie.apply(this,arguments)}return X}()},{key:"removeRegistrations",value:function(){var ie=ce.default(D.default.mark(function ye(Te,Le){return D.default.wrap(function(st){for(;;)switch(st.prev=st.next){case 0:return st.next=2,this._connector(Te).sendDeviceRemoveRequest(Le);case 2:case"end":return st.stop()}},ye,this)}));function X(ye,Te){return ie.apply(this,arguments)}return X}()},{key:"handlePushNotification",value:function(X){return{messageType:X.twi_message_type,payload:X.payload}}},{key:"_routeMessage",value:function(X,ye){he.debug("Notification message arrived: ",X,ye),this.emit("message",X,ye)}},{key:"_connector",value:function(X){var ye=this.connectors.get(X);if(!ye)throw new Error("Unknown channel type: ".concat(X));return ye}}],[{key:"_detectPlatform",value:function(){var X="";return typeof navigator<"u"?(X="unknown",typeof navigator.product<"u"&&(X=navigator.product),typeof navigator.userAgent<"u"&&(X=navigator.userAgent)):X="web",X.substring(0,128)}}]),Q}(fe),O([j.validateTypes(Ut,j.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String,String]),je("design:returntype",void 0)],e.Notifications.prototype,"setPushRegistrationId",null),O([j.validateTypes(Ut,j.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String,String]),je("design:returntype",void 0)],e.Notifications.prototype,"subscribe",null),O([j.validateTypes(Ut,j.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String,String]),je("design:returntype",void 0)],e.Notifications.prototype,"unsubscribe",null),O([j.validateTypes(j.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String]),je("design:returntype",void 0)],e.Notifications.prototype,"updateToken",null),O([j.validateTypesAsync(Ut,j.nonEmptyString),je("design:type",Function),je("design:paramtypes",[String,String]),je("design:returntype",Promise)],e.Notifications.prototype,"removeRegistrations",null),e.Notifications=mt=O([j.validateConstructorTypes(j.nonEmptyString,[j.pureObject,"undefined",j.literal(null)]),je("design:paramtypes",[String,Object])],e.Notifications)})(jT);var xr={};/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes Backoff library under the following license

    Copyright (C) 2012 Mathieu Turcotte

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

This software includes Event-to-Promise library under the following license

    Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

    Permission to use, copy, modify, and/or distribute this software for any purpose
    with or without fee is hereby granted, provided that the above copyright notice
    and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
    OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
    THIS SOFTWARE.

*/Object.defineProperty(xr,"__esModule",{value:!0});var xz=go.exports,Lz=fa.exports,jz=is.exports,Uz=sa.exports,Dz=oa.exports,Fz=ua.exports,Bz=zn.exports,qz=ca.exports,Wz=nl,Hz=la.exports,_e=ir,Lc=If,Gz=Bg.exports,Vz=bo.exports,zz=il.exports,DT=Si,FT=Rf,Kz=Cf.exports,Jz=xc.exports;function Vr(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function qg(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var Pe=Vr(xz),pt=Vr(Lz),_t=Vr(jz),Bn=Vr(Uz),Cr=Vr(Dz),pa=Vr(Fz),Xt=Vr(Bz),kt=Vr(qz),H=Vr(Wz),BT=Vr(Hz),Yz=Vr(Gz),Qz=qg(Vz),qT=Vr(zz),Xz=qg(FT),ul=Vr(Kz),zl=qg(Jz);function vt(e,t,r,n){var i=arguments.length,a=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if((typeof Reflect>"u"?"undefined":BT.default(Reflect))==="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,r,a):s(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function Ee(e,t){if((typeof Reflect>"u"?"undefined":BT.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var Zz;function Yi(){}Yi.prototype=Object.create(null);function Et(){Et.init.call(this)}Et.EventEmitter=Et;Et.usingDomains=!1;Et.prototype.domain=void 0;Et.prototype._events=void 0;Et.prototype._maxListeners=void 0;Et.defaultMaxListeners=10;Et.init=function(){this.domain=null,Et.usingDomains&&Zz.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Yi,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Et.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function WT(e){return e._maxListeners===void 0?Et.defaultMaxListeners:e._maxListeners}Et.prototype.getMaxListeners=function(){return WT(this)};function eK(e,t,r){if(t)e.call(r);else for(var n=e.length,i=ll(e,n),a=0;a<n;++a)i[a].call(r)}function tK(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=ll(e,i),s=0;s<i;++s)a[s].call(r,n)}function rK(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=ll(e,a),o=0;o<a;++o)s[o].call(r,n,i)}function nK(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,o=ll(e,s),u=0;u<s;++u)o[u].call(r,n,i,a)}function iK(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=ll(e,i),s=0;s<i;++s)a[s].apply(r,n)}Et.prototype.emit=function(t){var r,n,i,a,s,o,u,c=t==="error";if(o=this._events,o)c=c&&o.error==null;else if(!c)return!1;if(u=this.domain,c){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=o[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:eK(n,y,this);break;case 2:tK(n,y,this,arguments[1]);break;case 3:rK(n,y,this,arguments[1],arguments[2]);break;case 4:nK(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];iK(n,y,this,a)}return!0};function HT(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Yi,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=WT(e),i&&i>0&&s.length>i)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,aK(o)}return e}function aK(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Et.prototype.addListener=function(t,r){return HT(this,t,r,!1)};Et.prototype.on=Et.prototype.addListener;Et.prototype.prependListener=function(t,r){return HT(this,t,r,!0)};function GT(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}Et.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,GT(this,t,r)),this};Et.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,GT(this,t,r)),this};Et.prototype.removeListener=function(t,r){var n,i,a,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Yi:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Yi,this;delete i[t]}else sK(n,a);i.removeListener&&this.emit("removeListener",t,o||r)}return this};Et.prototype.off=function(e,t){return this.removeListener(e,t)};Et.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Yi,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Yi:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Yi,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Et.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=oK(r):n=[]):n=[],n};Et.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):VT.call(e,t)};Et.prototype.listenerCount=VT;function VT(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Et.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function sK(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function ll(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function oK(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}var no=function(){function e(t){pt.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return _t.default(e,[{key:"pathSegment",value:function(r){return this.paths.push(encodeURIComponent(r)),this}},{key:"queryParam",value:function(r,n){return typeof n<"u"&&this.args.push(encodeURIComponent(r)+"="+encodeURIComponent(n)),this}},{key:"build",value:function(){var r=this.base;return this.paths.length&&(r+="/"+this.paths.join("/")),this.args.length&&(r+="?"+this.args.join("&")),r}}]),e}();function zT(e){var t=uK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function uK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nr=function(e){Cr.default(r,e);var t=zT(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return pt.default(this,r),i=t.call(this),i.name=i.constructor.name,i.message="".concat(n," (status: ").concat(a,", code: ").concat(s,")"),i.status=a,i.code=s,i}return r}(Yz.default(Error)),lK=function(e){Cr.default(r,e);var t=zT(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0;return pt.default(this,r),i=t.call(this,n,a,s),i.body=o,i}return r}(Nr);function En(e){return JSON.parse(JSON.stringify(e))}function KT(e){var t=e===void 0||Wg(e);if(!t)throw new Nr("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function cK(e){return!isNaN(parseInt(e))&&isFinite(e)}function Wg(e){return cK(e)&&e>0}var Es=Qz.getLogger("twilio-sync");function zo(e,t){return["".concat(new Date().toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var gt={setLevel:function(t){Es.setLevel(t)},trace:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.trace.apply(null,zo("T",r))},debug:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.debug.apply(null,zo("D",r))},info:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.info.apply(null,zo("I",r))},warn:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.warn.apply(null,zo("W",r))},error:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Es.error.apply(null,zo("E",r))}},fK="/v4/Subscriptions",dK="/v3/Maps",pK="/v3/Lists",hK="/v3/Documents",vK="/v3/Streams",gK="/v3/Insights";function yK(e,t,r){return e&&typeof e[t]<"u"?e[t]:r}var mK=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};pt.default(this,e);var r=t.region||"us1",n="https://cds.".concat(r,".twilio.com"),i=t.cdsUri||n;this.settings={subscriptionsUri:i+fK,documentsUri:i+hK,listsUri:i+pK,mapsUri:i+dK,streamsUri:i+vK,insightsUri:i+gK,sessionStorageEnabled:yK(t.Sync,"enableSessionStorage",!0),productId:t.productId}}return _t.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function Ko(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=bK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function bK(e,t){if(!!e){if(typeof e=="string")return C_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C_(e,t)}}function C_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wK=function(){function e(t){pt.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return _t.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(r,n){this.localObject._update(r,n)}},{key:"updatePending",value:function(r,n){this.pendingAction=r,this.pendingCorrelationId=n}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(r){this.rejectedWithError=r.error,this.updatePending(null,null),this.localObject.reportFailure(new Nr("Failed to subscribe on service events: ".concat(r.error.message),r.error.status,r.error.code))}},{key:"complete",value:function(r){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(r)}},{key:"setSubscriptionState",value:function(r){this.localObject._setSubscriptionState(r)}}]),e}(),_K=function(){function e(t){var r=this;pt.default(this,e),kt.default(this,"isConnected",!1),kt.default(this,"maxBatchSize",100),kt.default(this,"subscriptionTtlTimer",null),kt.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;var n={randomisationFactor:.2,initialDelay:100,maxDelay:2*60*1e3};this.backoff=DT.Backoff.exponential(Object.assign(n,this.services.config.backoffConfig)),this.backoff.on("ready",function(){var i=r.getSubscriptionUpdateBatch(),a=i.action,s=i.subscriptions;a?r.applyNewSubscriptionUpdateBatch(a,s):(r.backoff.reset(),gt.debug("All subscriptions resolved."))})}return _t.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function r(a,s,o,u){var c=[],d=Ko(a),y;try{for(d.s();!(y=d.n()).done;){var _=qT.default(y.value,2),b=_[0],k=_[1],N=s.get(b);if(!N&&o!==k.pendingAction&&!k.rejectedWithError&&(c.push(k),u&&c.length>=u))break}}catch(P){d.e(P)}finally{d.f()}return c}var n=r(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(n.length>0)return{action:"establish",subscriptions:n};var i=r(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return i.length>0?{action:"cancel",subscriptions:i}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:function(){var t=Pe.default(H.default.mark(function n(i,a){var s=this,o,u,c,d,y,_,b,k,N,P,j,F,me,ce,xe,Ne;return H.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.isConnected){x.next=4;break}return gt.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),this.backoff.reset(),x.abrupt("return");case 4:a=this.processLocalActions(i,a),o=new Date().getTime(),u=Ko(a);try{for(u.s();!(c=u.n()).done;)d=c.value,this.recordActionAttemptOn(d,i,o)}catch(le){u.e(le)}finally{u.f()}return y=this.pendingPokeReason,this.pendingPokeReason=null,x.prev=10,x.next=13,this.request(i,o,y,a);case 13:_=x.sent,b=_.body.max_batch_size,!isNaN(parseInt(b))&&isFinite(b)&&b>0&&(this.maxBatchSize=b),this.subscriptionTtlTimer||(k=_.body.ttl_in_s,N=!isNaN(parseFloat(k))&&isFinite(k),P=N&&k>0,P&&(this.subscriptionTtlTimer=setTimeout(function(){return s.onSubscriptionTtlElapsed()},k*1e3))),i==="establish"&&(j=_.body.estimated_delivery_in_ms,F=!isNaN(parseFloat(j))&&isFinite(j),me=F&&j>0,me?setTimeout(function(){return s.verifyPokeDelivery(o,j,a)},j):gt.error("Invalid timeout: ".concat(j)),a.filter(function(le){return le.pendingCorrelationId===o}).forEach(function(le){return le.setSubscriptionState("response_in_flight")})),this.backoff.reset(),x.next=26;break;case 21:x.prev=21,x.t0=x.catch(10),ce=Ko(a);try{for(ce.s();!(xe=ce.n()).done;)Ne=xe.value,this.recordActionFailureOn(Ne,i)}catch(le){ce.e(le)}finally{ce.f()}x.t0 instanceof Lc.TransportUnavailableError?(gt.debug("Twilsock connection (required for subscription) not ready (c:".concat(o,"); waiting\u2026")),this.backoff.reset()):(gt.debug("Failed an attempt to ".concat(i," subscriptions (c:").concat(o,"); retrying"),x.t0),this.persist());case 26:case"end":return x.stop()}},n,this,[[10,21]])}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"verifyPokeDelivery",value:function(r,n,i){var a=this,s=this.latestPokeResponseArrivalTimestampByCorrelationId.get(r),o=s?new Date().getTime()-s:n;if(o>=n)i.filter(function(c){return c.pendingCorrelationId===r}).forEach(function(c){c.updatePending(null,null),c.retryCount++,a.persisted.delete(c.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(r);else{var u=n-o;setTimeout(function(){return a.verifyPokeDelivery(r,n,i)},u)}}},{key:"processLocalActions",value:function(r,n){return r==="cancel"?n.filter(function(i){return!i.rejectedWithError}):n}},{key:"recordActionAttemptOn",value:function(r,n,i){if(r.setSubscriptionState("request_in_flight"),n==="establish")this.persisted.set(r.sid,r),r.updatePending(n,i);else{var a=this.persisted.get(r.sid);a&&a.updatePending(n,i)}}},{key:"recordActionFailureOn",value:function(r,n){r.setSubscriptionState("none"),r.updatePending(null,null),n==="establish"&&this.persisted.delete(r.sid)}},{key:"request",value:function(r,n,i,a){var s=a.map(function(c){return{object_sid:c.sid,object_type:c.type,last_event_id:r==="establish"?c.lastEventId:void 0,index_name:r==="establish"?c.indexName:void 0,query_string:r==="establish"?c.queryString:void 0}}),o=a.filter(function(c){return c.retryCount>0}).length;gt.debug("Attempting '".concat(r,"' request (c:").concat(n,"):"),s);var u={event_protocol_version:4,action:r,correlation_id:n,retried_requests:o,ttl_in_s:-1,requests:s};return i==="ttl"&&(u.reason=i),this.services.network.post(this.services.config.subscriptionsUri,u)}},{key:"add",value:function(r,n){gt.debug("Establishing intent to subscribe to ".concat(r));var i=this.subscriptions.get(r);i&&n&&i.lastEventId===n.lastEventId||(this.persisted.delete(r),this.subscriptions.set(r,new wK(n)),this.persist())}},{key:"remove",value:function(r){gt.debug("Establishing intent to unsubscribe from ".concat(r));var n=this.subscriptions.delete(r);n&&this.persist()}},{key:"acceptMessage",value:function(r,n){gt.trace("Subscriptions received",r);var i=r.event_type,a=typeof r.events<"u"?r.events:[r.event],s=r.correlation_id;s&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(s,new Date().getTime());var o=Ko(a),u;try{for(o.s();!(u=o.n()).done;){var c=u.value,d=void 0;switch(r.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(c,s);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(c,s);break;case"subscription_failed":this.applySubscriptionFailedMessage(c,s);break;case(d=i.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{var y=void 0;switch(d[0]){case"map_":y=c.map_sid;break;case"list_":y=c.list_sid;break;case"document_":y=c.document_sid;break;case"stream_":y=c.stream_sid;break;case"live_query_":y=c.query_id,n=!1,r.strictly_ordered===!0&&(n=!0);break;default:y=void 0}this.applyEventToSubscribedEntity(y,c,i,n);break}default:gt.debug("Dropping unknown message type ".concat(i));break}}}catch(_){o.e(_)}finally{o.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(r,n){var i=r.object_sid,a=this.persisted.get(r.object_sid);a&&a.pendingCorrelationId===n?r.replay_status==="interrupted"?(gt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") interrupted; continuing eagerly.")),a.updatePending(null,null),this.persisted.delete(a.sid),this.backoff.reset()):r.replay_status==="completed"&&(gt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") completed. Subscription is ready.")),a.complete(r.last_event_id),this.persisted.set(r.object_sid,a),a.setSubscriptionState("established"),this.backoff.reset()):gt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(r,n){var i=this.persisted.get(r.object_sid);i&&i.pendingCorrelationId===n?(i.updatePending(null,null),i.setSubscriptionState("none"),this.persisted.delete(r.object_sid)):gt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(r,n){var i=r.object_sid,a=this.subscriptions.get(i),s=this.persisted.get(i);a&&s?s.pendingCorrelationId===n&&(gt.error("Failed to subscribe on ".concat(s.sid),r.error),s.markAsFailed(r),s.setSubscriptionState("none")):!a&&s&&(this.persisted.delete(i),s.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(r,n,i,a){var s=this;if(!!r){a=a||function(){var u=s.persisted.get(r);return u&&u.isEstablished}();var o=this.subscriptions.get(r);o?(n.type=i,o.update(n,a)):gt.debug("Message dropped for SID '".concat(r,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(r){this.isConnected=r,r&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(r){gt.debug("Triggering event replay for all subscriptions, reason=".concat(r)),this.pendingPokeReason=r,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var n=[],i=Ko(this.persisted.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.reset(),s.rejectedWithError&&n.push(s)}}catch(d){i.e(d)}finally{i.f()}this.persisted.clear();for(var o=0,u=n;o<u.length;o++){var c=u[o];this.persisted.set(c.sid,c)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}(),SK=4e3,$K=6e4,kK=9e4,TK=.2;function I_(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function R_(e){return e.body?e.body.code:0}function Jo(e){return e.status===409?new lK(I_(e),e.status,R_(e),e.body):e.status?new Nr(I_(e),e.status,R_(e)):e instanceof Lc.TransportUnavailableError?e:new Nr(e.message,0,0)}var EK=function(){function e(t,r,n){pt.default(this,e),this.clientInfo=t,this.config=r,this.transport=n}return _t.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+Xz.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:SK,max:$K,maxAttemptsTime:kK,randomness:TK},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise(function(a,s){var o=[502,503,504];i&&o.push(429);var u=new DT.Retrier(n.backoffConfig());u.on("attempt",function(){r().then(function(c){return u.succeeded(c)}).catch(function(c){if(o.includes(c.status)){var d=parseInt(c.headers?c.headers["Retry-After"]:null);u.failed(Jo(c),isNaN(d)?null:d*1e3)}else c.message==="Twilsock disconnected"?u.failed(Jo(c)):(u.removeAllListeners(),u.cancel(),s(Jo(c)))})}),u.on("succeeded",function(c){a(c)}),u.on("cancelled",function(c){return s(Jo(c))}),u.on("failed",function(c){return s(Jo(c))}),u.start()})}},{key:"get",value:function(r){var n=this,i=this.createHeaders();return gt.debug("GET",r,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.get(r,i,n.config.productId)},!0)}},{key:"post",value:function(r,n,i){var a=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.createHeaders();return typeof i<"u"&&i!==null&&(o["If-Match"]=i),gt.debug("POST",r,"ID:",o["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.post(r,o,n,a.config.productId)},s)}},{key:"put",value:function(r,n,i){var a=this,s=this.createHeaders();return typeof i<"u"&&i!==null&&(s["If-Match"]=i),gt.debug("PUT",r,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.put(r,s,n,a.config.productId)},!1)}},{key:"delete",value:function(r){var n=this,i=this.createHeaders();return gt.debug("DELETE",r,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.delete(r,i,n.config.productId)},!1)}}]),e}(),CK=function(){function e(t,r){pt.default(this,e),this.config=t,this.storageId=null;try{this.storage=r||sessionStorage}catch{}}return _t.default(e,[{key:"storageKey",value:function(r,n){return"".concat(this.storageId,"::").concat(r,"::").concat(n)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(r){this.storageId=r}},{key:"store",value:function(r,n,i){return this.isReady?this._store(this.storageKey(r,n),i):null}},{key:"read",value:function(r,n){return this.isReady?this._read(this.storageKey(r,n)):null}},{key:"remove",value:function(r,n,i){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(r,n)),i&&this.storage.removeItem(this.storageKey(r,i))}catch{}}},{key:"update",value:function(r,n,i,a){if(!this.isReady)return null;this._apply(this.storageKey(r,n),a),i&&this._apply(this.storageKey(r,i),a)}},{key:"_store",value:function(r,n){try{this.storage.setItem(r,JSON.stringify(n))}catch{}}},{key:"_read",value:function(r){try{var n=this.storage.getItem(r);if(n)return JSON.parse(n)}catch{}return null}},{key:"_apply",value:function(r,n){var i=this._read(r);if(!i)return!1;this._store(r,Object.assign(i,n))}}]),e}();function IK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=RK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function RK(e,t){if(!!e){if(typeof e=="string")return O_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O_(e,t)}}function O_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var cl=function(){function e(t,r){pt.default(this,e),this.services=t,this.removalHandler=r,this.subscriptionState="none",this._attachedListeners=new Map}return _t.default(e,[{key:"_advanceLastEventId",value:function(r,n){}},{key:"reportFailure",value:function(r){r.status===404?this.onRemoved(!1):this.broadcastEventToListeners("failure",r)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(r){this.subscriptionState=r,this.broadcastEventToListeners("_subscriptionStateChanged",r)}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler!=null&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(r){var n=r.listenerUuid,i=this._attachedListeners.get(n);i||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(n,r))}},{key:"detach",value:function(r){this._attachedListeners.delete(r),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(r,n){var i=IK(this._attachedListeners.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.emit(r,n)}}catch(o){i.e(o)}finally{i.f()}}}]),e}(),JT=function(){function e(t){pt.default(this,e),kt.default(this,"queuedRequests",[]),kt.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return _t.default(e,[{key:"add",value:function(r,n){var i=this,a=new Promise(function(s,o){return i.queuedRequests.push({input:r,requestFunction:n,resolve:s,reject:o})});return this.wakeupQueue(),a}},{key:"squashAndAdd",value:function(r,n){var i=this.queuedRequests;this.queuedRequests=[];var a;i.length>0?(a=i.map(function(o){return o.input}).reduce(this.inputMergingFunction),a=this.inputMergingFunction(a,r)):a=r;var s=this.add(a,n);return i.forEach(function(o){return s.then(o.resolve,o.reject)}),s}},{key:"isEmpty",value:function(){return this.queuedRequests.length===0&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var r=this;if(!(this.queuedRequests.length===0||this.isRequestInFlight)){var n=this.queuedRequests.shift();this.isRequestInFlight=!0,n.requestFunction(n.input).then(n.resolve,n.reject).then(function(i){r.isRequestInFlight=!1,r.wakeupQueue()})}}}]),e}(),YT=function(){function e(t){pt.default(this,e),kt.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}return _t.default(e,[{key:"add",value:function(){var t=Pe.default(H.default.mark(function n(i,a,s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(i,function(c){return c.add(a,s)}));case 1:case"end":return u.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"squashAndAdd",value:function(){var t=Pe.default(H.default.mark(function n(i,a,s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(i,function(c){return c.squashAndAdd(a,s)}));case 1:case"end":return u.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"invokeQueueMethod",value:function(){var t=Pe.default(H.default.mark(function n(i,a){var s,o;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.queueByNamespaceKey.has(i)||this.queueByNamespaceKey.set(i,new JT(this.inputReducer)),s=this.queueByNamespaceKey.get(i),o=a(s),this.queueByNamespaceKey.get(i).isEmpty()&&this.queueByNamespaceKey.delete(i),c.abrupt("return",o);case 5:case"end":return c.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()}]),e}();function OK(e){var t=AK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function AK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fl=function(e){Cr.default(r,e);var t=OK(r);function r(){var n;return pt.default(this,r),n=t.call(this),n.closed=!1,n.uuid=FT.v4(),n}return _t.default(r,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),r}(Et);function QT(e){var t=PK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function PK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var xh=function(e){Cr.default(r,e);var t=QT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a),kt.default(Bn.default(s),"isDeleted",!1);var o=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new JT(o),s.descriptor=i,s.descriptor.data=s.descriptor.data||{},s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return _t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(i){switch(i.date_created=new Date(i.date_created),i.type){case"document_updated":if(i.id<=this.lastEventId){gt.trace("Document update skipped, current:",this.lastEventId,", remote:",i.id);break}var a=this.descriptor.data!==void 0?En(this.descriptor.data):null;this.descriptor.last_event_id=i.id,this.descriptor.revision=i.document_revision,this.descriptor.date_updated=i.date_created,this.descriptor.data=i.document_data,this.broadcastEventToListeners("updated",{data:i.document_data,isLocal:!1,previousData:a}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.id,revision:i.document_revision,date_updated:i.date_created,data:i.document_data});break;case"document_removed":this.onRemoved(!1);break}}},{key:"set",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u=this,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return c=o||{},y.abrupt("return",this.updateMergingQueue.squashAndAdd(c,function(_){return u._setUnconditionally(s,_.ttl)}));case 2:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u=this,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return c=o||{},y.abrupt("return",this.updateMergingQueue.add(c,function(_){return u._setWithIfMatch(s,_.ttl)}));case 2:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Pe.default(H.default.mark(function a(s,o){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(function(d){return Object.assign(d,s)},o));case 1:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){var o;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._postUpdateToServer({ttl:s});case 2:o=c.sent,this.descriptor.date_expires=o.date_expires;case 4:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_setUnconditionally",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this._postUpdateToServer({data:s,revision:void 0,ttl:o});case 2:return u=d.sent,this._handleSuccessfulUpdateResult(u),d.abrupt("return",this.descriptor.data);case 5:case"end":return d.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_setWithIfMatch",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(u=s(En(this.descriptor.data)),!u){_.next=22;break}return c=this.revision,_.prev=3,_.next=6,this._postUpdateToServer({data:u,revision:c,ttl:o});case 6:return d=_.sent,this._handleSuccessfulUpdateResult(d),_.abrupt("return",this.descriptor.data);case 11:if(_.prev=11,_.t0=_.catch(3),_.t0.status!==412){_.next=19;break}return _.next=16,this._softSync();case 16:return _.abrupt("return",this._setWithIfMatch(s));case 19:throw _.t0;case 20:_.next=23;break;case 22:return _.abrupt("return",this.descriptor.data);case 23:case"end":return _.stop()}},a,this,[[3,11]])}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_handleSuccessfulUpdateResult",value:function(i){if(!(i.last_event_id<=this.descriptor.last_event_id)){var a=this.descriptor.data!==void 0?En(this.descriptor.data):null;this.descriptor.revision=i.revision,this.descriptor.data=i.data,this.descriptor.last_event_id=i.last_event_id,this.descriptor.date_expires=i.date_expires,this.descriptor.date_updated=new Date(i.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.last_event_id,revision:i.revision,date_updated:i.date_updated,data:i.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:a})}}},{key:"_postUpdateToServer",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(this.isDeleted){y.next=17;break}return o={data:s.data},s.ttl!==void 0&&(o.ttl=s.ttl),u=s.revision,y.prev=4,y.next=7,this.services.network.post(this.uri,o,u);case 7:return c=y.sent,y.abrupt("return",{revision:c.body.revision,data:s.data,last_event_id:c.body.last_event_id,date_updated:c.body.date_updated,date_expires:c.body.date_expires});case 11:throw y.prev=11,y.t0=y.catch(4),y.t0.status===404&&this.onRemoved(!1),y.t0;case 15:y.next=18;break;case 17:return y.abrupt("return",Promise.reject(new Nr("The Document has been removed",404,54100)));case 18:case"end":return y.stop()}},a,this,[[4,11]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_softSync",value:function(){var n=Pe.default(H.default.mark(function a(){var s=this;return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.network.get(this.uri).then(function(c){var d={type:"document_updated",id:c.body.last_event_id,document_revision:c.body.revision,document_data:c.body.data,date_created:c.body.date_updated};return s._update(d),s}).catch(function(c){c.status===404?s.onRemoved(!1):gt.error("Can't get updates for ".concat(s.sid,":"),c)}));case 1:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){if(!this.isDeleted){var a=this.descriptor.data!==void 0?En(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i,previousData:a})}}},{key:"removeDocument",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.isDeleted){o.next=6;break}return o.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),o.next=7;break;case 6:return o.abrupt("return",Promise.reject(new Nr("The Document has been removed",404,54100)));case 7:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"document"}}]),r}(cl),on=function(e){Cr.default(r,e);var t=QT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncDocumentImpl=n,i.syncDocumentImpl.attach(Bn.default(i)),i}return _t.default(r,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return xh.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:function(){var n=Pe.default(H.default.mark(function a(s,o){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.set(s,o));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Pe.default(H.default.mark(function a(s,o){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.mutate(s,o));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Pe.default(H.default.mark(function a(s,o){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.update(s,o));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncDocumentImpl.setTtl(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeDocument",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ul.default(Xt.default(r.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return xh.type}}]),r}(fl);kt.default(on,"removed","removed");kt.default(on,"updated","updated");vt([_e.validateTypesAsync(_e.pureObject,["undefined",_e.objectSchema("document metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object,Object]),Ee("design:returntype",Promise)],on.prototype,"set",null);vt([_e.validateTypesAsync("function",["undefined",_e.objectSchema("document metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Function,Object]),Ee("design:returntype",Promise)],on.prototype,"mutate",null);vt([_e.validateTypesAsync(_e.pureObject,["undefined",_e.objectSchema("document metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object,Object]),Ee("design:returntype",Promise)],on.prototype,"update",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],on.prototype,"setTtl",null);var Lh=function(){function e(t){pt.default(this,e),this.descriptor=t}return _t.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(r,n,i,a){return this.descriptor.lastEventId=r,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.dateUpdated=a,this}},{key:"updateDateExpires",value:function(r){this.descriptor.dateExpires=r}}]),e}(),Hg=function(){function e(t,r,n,i){pt.default(this,e),this.prevToken=n,this.nextToken=i,this.items=t,this.source=r}return _t.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:function(){var t=Pe.default(H.default.mark(function n(){return H.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasNextPage){a.next=2;break}throw new Error("No next page");case 2:return a.abrupt("return",this.source(this.nextToken));case 3:case"end":return a.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"prevPage",value:function(){var t=Pe.default(H.default.mark(function n(){return H.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasPrevPage){a.next=2;break}throw new Error("No previous page");case 2:return a.abrupt("return",this.source(this.prevToken));case 3:case"end":return a.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()}]),e}();function MK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=NK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function NK(e,t){if(!!e){if(typeof e=="string")return A_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A_(e,t)}}function A_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xK=function(){function e(t,r){pt.default(this,e),this.balanceFactor=0,this.key=t,this.value=r,this.parent=null,this.left=null,this.right=null}return _t.default(e,[{key:"isRoot",get:function(){return this.parent===null}},{key:"isLeaf",get:function(){return this.left===null&&this.right===null}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(r){this.value=r}},{key:"replace",value:function(r,n){!r||(this.left===n?this.left=n:this.right===n&&(this.right=n))}}]),e}(),LK=function(){function e(t,r){pt.default(this,e),this.isLessThan=t||function(n,i){return n<i},this.isEqual=r||function(n,i){return n===i},this.root=null,this.count=null}return _t.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(r,n){var i=this.getNode(r);i?i.update(n):this.insert(r,n)}},{key:"insert",value:function(r,n){var i=new xK(r,n);if(this.count++,!this.root){this.root=i;return}for(var a=this.root;;)if(this.isLessThan(r,a.key))if(a.left)a=a.left;else{a.left=i;break}else if(a.right)a=a.right;else{a.right=i;break}for(i.parent=a,a=i;a.parent;){var s=a.parent,o=s.balanceFactor;if(a.isLeftChild?s.balanceFactor++:s.balanceFactor--,Math.abs(s.balanceFactor)<Math.abs(o))break;if(s.balanceFactor<-1||s.balanceFactor>1){this.rebalance(s);break}a=s}}},{key:"get",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n.value;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"delete",value:function(r){var n=this.getNode(r);if(!n||n.key!==r)return null;var i=n.parent,a=n.left,s=n.right;if(!!a!=!!s){var o=a||s;!i&&!o?this.root=null:i&&!o?this.root=o:(i.replace(n,null),this.rebalance(i))}else{for(var u=n.left;u.right;)u=u.right;if(n.left===u)n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.balanceFactor=n.balanceFactor,n={parent:u,isLeftChild:!0};else{var c=u.parent,d=u.left;c.right=d,d&&(d.parent=c),n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.left=n.left,u.left.parent=u,u.balanceFactor=n.balanceFactor,n={parent:c,isLeftChild:!1}}}for(this.count--;n.parent;){var y=n.parent,_=y.balanceFactor;if(n.isLeftChild?y.balanceFactor-=1:y.balanceFactor+=1,Math.abs(y.balanceFactor)>Math.abs(_))if(y.balanceFactor<-1||y.balanceFactor>1)if(this.rebalance(y),y.parent.balanceFactor===0)n=y.parent;else break;else break;else n=y}return null}},{key:"getNode",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"rebalance",value:function(r){r.balanceFactor<0?r.right.balanceFactor>0?(this.rotateRight(r.right),this.rotateLeft(r)):this.rotateLeft(r):r.balanceFactor>0&&(r.left.balanceFactor<0?(this.rotateLeft(r.left),this.rotateRight(r)):this.rotateRight(r))}},{key:"rotateLeft",value:function(r){var n=r.right;r.right=n.left,n.left!==null&&(n.left.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.left=r,r.parent=n,r.balanceFactor=r.balanceFactor+1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor+1-Math.max(r.balanceFactor,0)}},{key:"rotateRight",value:function(r){var n=r.left;r.left=n.right,n.right!==null&&(n.right.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.right=r,r.parent=n,r.balanceFactor=r.balanceFactor-1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor-1-Math.max(r.balanceFactor,0)}},{key:Symbol.iterator,value:H.default.mark(function t(){var r,n,i;return H.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=MK(this.getIterator()),s.prev=1,r.s();case 3:if((n=r.n()).done){s.next=9;break}return i=n.value,s.next=7,i;case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),r.e(s.t0);case 14:return s.prev=14,r.f(),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])})},{key:"getIterator",value:H.default.mark(function t(){var r,n,i,a=arguments;return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){o.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.left)){o.next=5;break}return o.abrupt("break",8);case 5:this.isLessThan(r,n.key)||r===null?n=n.left:n=n.right,o.next=2;break;case 8:if(n){o.next=10;break}return o.abrupt("return",null);case 10:i=!0;case 11:if(!i){o.next=29;break}return o.next=14,[n.key,n.value];case 14:if(i=!1,!n.right){o.next=21;break}for(n=n.right;n.left;)n=n.left;i=!0,o.next=27;break;case 21:if(!n.parent){o.next=26;break}i=n.parent.left===n,n=n.parent,o.next=27;break;case 26:return o.abrupt("break",37);case 27:o.next=35;break;case 29:if(!n.parent){o.next=34;break}i=n.parent.left===n,n=n.parent,o.next=35;break;case 34:return o.abrupt("break",37);case 35:o.next=11;break;case 37:return o.abrupt("return",null);case 38:case"end":return o.stop()}},t,this)})},{key:"getReverseIterator",value:H.default.mark(function t(){var r,n,i,a=arguments;return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){o.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.right)){o.next=5;break}return o.abrupt("break",8);case 5:!this.isLessThan(r,n.key)||r===null?n=n.right:n=n.left,o.next=2;break;case 8:if(n){o.next=10;break}return o.abrupt("return",null);case 10:i=!0;case 11:if(!i){o.next=29;break}return o.next=14,[n.key,n.value];case 14:if(i=!1,!n.left){o.next=21;break}for(n=n.left;n.right;)n=n.right;i=!0,o.next=27;break;case 21:if(!n.parent){o.next=26;break}i=n.parent.right===n,n=n.parent,o.next=27;break;case 26:return o.abrupt("break",37);case 27:o.next=35;break;case 29:if(!n.parent){o.next=34;break}i=n.parent.right===n,n=n.parent,o.next=35;break;case 34:return o.abrupt("break",37);case 35:o.next=11;break;case 37:return o.abrupt("return",null);case 38:case"end":return o.stop()}},t,this)})}]),e}();function jK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=UK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,o=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function UK(e,t){if(!!e){if(typeof e=="string")return P_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P_(e,t)}}function P_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DK=function(){function e(t,r){pt.default(this,e),this.value=t,this.revision=r||0}return _t.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),FK=function(){function e(t){pt.default(this,e),this.revision=t}return _t.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),Gg=function(){function e(){pt.default(this,e),this.items=new LK}return _t.default(e,[{key:"store",value:function(r,n,i){var a=this.items.get(r);return a&&a.revision>i?a.isValid?a.value:null:(this.items.set(r,new DK(n,i)),n)}},{key:"delete",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.items.get(r);(!a||a.revision<n||a&&i===!0)&&this.items.set(r,new FK(n))}},{key:"isKnown",value:function(r,n){var i=this.items.get(r);return i&&i.revision>=n}},{key:"get",value:function(r){var n=this.items.get(r);return n&&n.isValid?n.value:null}},{key:"has",value:function(r){var n=this.items.get(r);return n&&n.isValid}},{key:"forEach",value:function(r){if(this.items){var n=jK(this.items),i;try{for(n.s();!(i=n.n()).done;){var a=qT.default(i.value,2),s=a[0],o=a[1];o.isValid&&r(s,o.value)}}catch(u){n.e(u)}finally{n.f()}}}}]),e}();function XT(e){var t=BK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function BK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jh=function(e){Cr.default(r,e);var t=XT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a);var o=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new YT(o),s.cache=new Gg,s.descriptor=i,s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return _t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u,c){var d,y;return H.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return d={data:o},c!==void 0&&(d.ttl=c),b.next=4,this.services.network.post(s,d,u);case 4:return y=b.sent,y.body.data=o,y.body.date_updated=new Date(y.body.date_updated),b.abrupt("return",y.body);case 8:case"end":return b.stop()}},a,this)}));function i(a,s,o,u){return n.apply(this,arguments)}return i}()},{key:"push",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return u=(o||{}).ttl,_.next=3,this._addOrUpdateItemOnServer(this.links.items,s,void 0,u);case 3:return c=_.sent,d=Number(c.index),this._handleItemMutated(d,c.url,c.last_event_id,c.revision,s,c.date_updated,c.date_expires,!0,!1),_.abrupt("return",this.cache.get(d));case 7:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=u||{},_.abrupt("return",this.updateMergingQueue.squashAndAdd(s,d,function(b){return c._updateItemUnconditionally(s,o,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"_updateItemUnconditionally",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return c=_.sent,_.next=5,this._addOrUpdateItemOnServer(c.uri,o,void 0,u);case 5:return d=_.sent,this._handleItemMutated(s,d.url,d.last_event_id,d.revision,d.data,d.date_updated,d.date_expires,!1,!1),_.abrupt("return",this.cache.get(s));case 8:case"end":return _.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"_updateItemWithIfMatch",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c,d,y,_;return H.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this.get(s);case 2:if(c=k.sent,d=o(En(c.data)),!d){k.next=25;break}return y=c.revision,k.prev=6,k.next=9,this._addOrUpdateItemOnServer(c.uri,d,y,u);case 9:return _=k.sent,this._handleItemMutated(s,_.url,_.last_event_id,_.revision,_.data,_.date_updated,_.date_expires,!1,!1),k.abrupt("return",this.cache.get(s));case 14:if(k.prev=14,k.t0=k.catch(6),k.t0.status!==412){k.next=22;break}return k.next=19,this._getItemFromServer(s);case 19:return k.abrupt("return",this._updateItemWithIfMatch(s,o,u));case 22:throw k.t0;case 23:k.next=26;break;case 25:return k.abrupt("return",c);case 26:case"end":return k.stop()}},a,this,[[6,14]])}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=u||{},_.abrupt("return",this.updateMergingQueue.add(s,d,function(b){return c._updateItemWithIfMatch(s,o,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.mutate(s,function(y){return Object.assign(y,o)},u));case 1:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.get(s);case 2:return o=y.sent,u=En(o.data),y.next=6,this.services.network.delete(o.uri);case 6:c=y.sent,this._handleItemRemoved(s,c.body.last_event_id,u,new Date(c.body.date_updated),!1);case 8:case"end":return y.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Pe.default(H.default.mark(function a(s){var o;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(o=this.cache.get(s),!o){c.next=5;break}return c.abrupt("return",o);case 5:return c.abrupt("return",this._getItemFromServer(s));case 6:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=Pe.default(H.default.mark(function a(s){var o;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.queryItems({index:s});case 2:if(o=c.sent,!(o.items.length<1)){c.next=7;break}throw new Nr("No item with index ".concat(s," found"),404,54151);case 7:return c.abrupt("return",o.items[0]);case 8:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this,u,c,d,y;return H.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},u=new no(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Index",s.index).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(u);case 4:return c=b.sent,d=c.body.items.map(function(k){k.date_updated=new Date(k.date_updated);var N=o.cache.get(k.index);return N?o._handleItemMutated(k.index,k.url,k.last_event_id,k.revision,k.data,k.date_updated,k.date_expires,!1,!0):o.cache.store(Number(k.index),new Lh({index:Number(k.index),uri:k.url,revision:k.revision,lastEventId:k.last_event_id,dateUpdated:k.date_updated,dateExpires:k.date_expires,data:k.data}),k.last_event_id),o.cache.get(k.index)}),y=c.body.meta,b.abrupt("return",new Hg(d,function(k){return o.queryItems({pageToken:k})},y.previous_token,y.next_token));case 8:case"end":return b.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s=s||{},KT(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",u.abrupt("return",this.queryItems(s));case 5:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=Pe.default(H.default.mark(function a(){var s;return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.context){u.next=5;break}return u.next=3,this.services.network.get(this.links.context);case 3:s=u.sent,this._updateContextIfRequired(s.body.data,s.body.last_event_id);case 5:return u.abrupt("return",this.context);case 6:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,o={ttl:s},d.next=4,this.services.network.post(this.uri,o);case 4:u=d.sent,this.descriptor.date_expires=u.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return u=_.sent,c={ttl:o},_.next=6,this.services.network.post(u.uri,c);case 6:d=_.sent,u.updateDateExpires(d.body.date_expires);case 8:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){var s=Number(i.item_index);switch(i.date_created=new Date(i.date_created),i.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(s,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="list_item_added",!0);break;case"list_item_removed":this._handleItemRemoved(s,i.id,i.item_data,i.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(i.context_data,i.id,i.date_created);break;case"list_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.list_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,s,o,u,c,d,y,_){if(this.shouldIgnoreEvent(i,s)){gt.trace("Item ".concat(i," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(s));return}this._updateRootDateUpdated(c);var b=this.cache.get(i);if(!b){var k=new Lh({index:i,uri:a,lastEventId:s,revision:o,data:u,dateUpdated:c,dateExpires:d});this.cache.store(i,k,s),this.emitItemMutationEvent(k,_,y);return}var N=En(b.data);b.update(s,o,u,c),this.cache.store(i,b,s),d!==void 0&&b.updateDateExpires(d),this.emitItemMutationEvent(b,_,!1,N)}},{key:"emitItemMutationEvent",value:function(i,a,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=s?"itemAdded":"itemUpdated",c={item:i,isLocal:!a};s||(c.previousItemData=o),this.broadcastEventToListeners(u,c)}},{key:"_handleItemRemoved",value:function(i,a,s,o,u){this._updateRootDateUpdated(o),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{index:i,isLocal:!u,previousItemData:s})}},{key:"_handleContextUpdate",value:function(i,a,s){this._updateRootDateUpdated(s),this._updateContextIfRequired(i,a)&&this.broadcastEventToListeners("contextUpdated",{context:i,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(i,a){return!this.contextEventId||a>this.contextEventId?(this.context=i,this.contextEventId=a,!0):(gt.trace("Context update skipped, current:",this.lastEventId,", remote:",a),!1)}}],[{key:"type",get:function(){return"list"}}]),r}(cl),rr=function(e){Cr.default(r,e);var t=XT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncListImpl=n,i.syncListImpl.attach(Bn.default(i)),i}return _t.default(r,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return jh.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:function(){var n=Pe.default(H.default.mark(function a(s,o){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.push(s,o));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.set(s,o,u));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.mutate(s,o,u));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.update(s,o,u));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.remove(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.get(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.getItems(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.setTtl(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Pe.default(H.default.mark(function a(s,o){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.setItemTtl(s,o));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ul.default(Xt.default(r.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return jh.type}}]),r}(fl);kt.default(rr,"itemAdded","itemAdded");kt.default(rr,"itemUpdated","itemUpdated");kt.default(rr,"itemRemoved","itemRemoved");kt.default(rr,"removed","removed");vt([_e.validateTypesAsync(_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object,Object]),Ee("design:returntype",Promise)],rr.prototype,"push",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger,_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Number,Object,Object]),Ee("design:returntype",Promise)],rr.prototype,"set",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger,"function",["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Number,Function,Object]),Ee("design:returntype",Promise)],rr.prototype,"mutate",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger,_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Number,Object,Object]),Ee("design:returntype",Promise)],rr.prototype,"update",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],rr.prototype,"remove",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],rr.prototype,"get",null);vt([_e.validateTypesAsync(["undefined",_e.objectSchema("query options",{from:[_e.nonNegativeInteger,"undefined"],pageSize:[_e.custom(function(e){return[Wg(e),"a positive integer"]}),"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],rr.prototype,"getItems",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],rr.prototype,"setTtl",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger,_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number,Number]),Ee("design:returntype",Promise)],rr.prototype,"setItemTtl",null);var tu=function(){function e(t){pt.default(this,e),this.descriptor=t}return _t.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(r,n,i,a){return this.descriptor.last_event_id=r,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.date_updated=a,this}},{key:"updateDateExpires",value:function(r){this.descriptor.date_expires=r}}]),e}();function ZT(e){var t=qK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function qK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Uh=function(e){Cr.default(r,e);var t=ZT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a);var o=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new YT(o),s.cache=new Gg,s.descriptor=i,s.descriptor.date_updated=new Date(s.descriptor.date_updated),i.items&&i.items.forEach(function(u){u.date_updated=new Date(u.date_updated),s.cache.store(u.key,new tu(u),u.last_event_id)}),s}return _t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=u||{},_.abrupt("return",this.updateMergingQueue.squashAndAdd(s,d,function(b){return c._putItemUnconditionally(s,o,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(s!=null){u.next=2;break}throw new Nr("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(s)){u.next=6;break}return u.abrupt("return",this.cache.get(s));case 6:return u.abrupt("return",this._getItemFromServer(s));case 7:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=Pe.default(H.default.mark(function a(s){var o;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.queryItems({key:s});case 2:if(o=c.sent,!(o.items.length<1)){c.next=7;break}throw new Nr("The specified Map Item does not exist",404,54201);case 7:return c.abrupt("return",o.items[0]);case 8:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=u||{},_.abrupt("return",this.updateMergingQueue.add(s,d,function(b){return c._putItemWithIfMatch(s,o,b.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.mutate(s,function(y){return Object.assign(y,o)},u));case 1:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"_putItemUnconditionally",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._putItemToServer(s,o,void 0,u);case 2:return c=_.sent,d=c.item,this._handleItemMutated(d.key,d.url,d.last_event_id,d.revision,d.data,d.date_updated,d.date_expires,c.added,!1),_.abrupt("return",this.cache.get(d.key));case 6:case"end":return _.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"_putItemWithIfMatch",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){var c,d,y,_,b;return H.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this.get(s).catch(function(P){if(P.status===404)return new tu({key:s,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw P});case 2:if(c=N.sent,d=o(En(c.data)),!d){N.next=26;break}return y=c.revision,N.prev=6,N.next=9,this._putItemToServer(s,d,y,u);case 9:return _=N.sent,b=_.item,this._handleItemMutated(b.key,b.url,b.last_event_id,b.revision,b.data,b.date_updated,b.date_expires,_.added,!1),N.abrupt("return",this.cache.get(b.key));case 15:if(N.prev=15,N.t0=N.catch(6),N.t0.status!==412){N.next=23;break}return N.next=20,this._getItemFromServer(s);case 20:return N.abrupt("return",this._putItemWithIfMatch(s,o,u));case 23:throw N.t0;case 24:N.next=27;break;case 26:return N.abrupt("return",c);case 27:case"end":return N.stop()}},a,this,[[6,15]])}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"_putItemToServer",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u,c){var d,y,_,b,k;return H.default.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return d=new no(this.links.items).pathSegment(s).build(),y={data:o},c!==void 0&&(y.ttl=c),P.prev=3,P.next=6,this.services.network.put(d,y,u);case 6:return _=P.sent,b=_.body,b.data=o,b.date_updated=new Date(b.date_updated),k=_.status.code===201,P.abrupt("return",{added:k,item:b});case 14:throw P.prev=14,P.t0=P.catch(3),P.t0.status===404&&this.onRemoved(!1),P.t0;case 18:case"end":return P.stop()}},a,this,[[3,14]])}));function i(a,s,o,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.get(s);case 2:return o=y.sent,u=En(o.data),y.next=6,this.services.network.delete(o.uri);case 6:c=y.sent,this._handleItemRemoved(s,c.body.last_event_id,u,new Date(c.body.date_updated),!1);case 8:case"end":return y.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this,u,c,d,y;return H.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},u=new no(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Key",s.key).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(u);case 4:return c=b.sent,d=c.body.items.map(function(k){k.date_updated=new Date(k.date_updated);var N=o.cache.get(k.key);return N?o._handleItemMutated(k.key,k.url,k.last_event_id,k.revision,k.data,k.date_updated,k.date_expires,!1,!0):o.cache.store(k.key,new tu(k),k.last_event_id),o.cache.get(k.key)}),y=c.body.meta,b.abrupt("return",new Hg(d,function(k){return o.queryItems({pageToken:k})},y.previous_token,y.next_token));case 8:case"end":return b.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s=s||{},KT(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",u.abrupt("return",this.queryItems(s));case 5:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){switch(i.date_created=new Date(i.date_created),i.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(i.item_key,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="map_item_added",!0);break;case"map_item_removed":this._handleItemRemoved(i.item_key,i.id,i.item_data,i.date_created,!0);break;case"map_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.map_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,s,o,u,c,d,y,_){if(this.shouldIgnoreEvent(i,s)){gt.trace("SyncMapItem ",i," update skipped, current:",this.lastEventId,", remote:",s);return}this._updateRootDateUpdated(c);var b=this.cache.get(i);if(!b){var k=new tu({key:i,url:a,last_event_id:s,revision:o,data:u,date_updated:c,date_expires:d});this.cache.store(i,k,s),this.emitItemMutationEvent(k,_,y);return}var N=En(b.data);b.update(s,o,u,c),this.cache.store(i,b,s),d!==void 0&&b.updateDateExpires(d),this.emitItemMutationEvent(b,_,!1,N)}},{key:"emitItemMutationEvent",value:function(i,a,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=s?"itemAdded":"itemUpdated",c={item:i,isLocal:!a};s||(c.previousItemData=o),this.broadcastEventToListeners(u,c)}},{key:"_handleItemRemoved",value:function(i,a,s,o,u){this._updateRootDateUpdated(o),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{key:i,isLocal:!u,previousItemData:s})}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,o={ttl:s},d.next=4,this.services.network.post(this.uri,o);case 4:u=d.sent,this.descriptor.date_expires=u.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return u=_.sent,c={ttl:o},_.next=6,this.services.network.post(u.uri,c);case 6:d=_.sent,u.updateDateExpires(d.body.date_expires);case 8:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"map"}}]),r}(cl),nr=function(e){Cr.default(r,e);var t=ZT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncMapImpl=n,i.syncMapImpl.attach(Bn.default(i)),i}return _t.default(r,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return Uh.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.set(s,o,u));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.get(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.mutate(s,o,u));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Pe.default(H.default.mark(function a(s,o,u){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.update(s,o,u));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,o){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.remove(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.getItems(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.setTtl(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Pe.default(H.default.mark(function a(s,o){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.setItemTtl(s,o));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.next=3,this.syncMapImpl.removeMap();case 3:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ul.default(Xt.default(r.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Uh.type}}]),r}(fl);kt.default(nr,"itemAdded","itemAdded");kt.default(nr,"itemUpdated","itemUpdated");kt.default(nr,"itemRemoved","itemRemoved");kt.default(nr,"removed","removed");vt([_e.validateTypesAsync("string",_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[String,Object,Object]),Ee("design:returntype",Promise)],nr.prototype,"set",null);vt([_e.validateTypesAsync("string"),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],nr.prototype,"get",null);vt([_e.validateTypesAsync("string","function",["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[String,Function,Object]),Ee("design:returntype",Promise)],nr.prototype,"mutate",null);vt([_e.validateTypesAsync("string",_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[String,Object,Object]),Ee("design:returntype",Promise)],nr.prototype,"update",null);vt([_e.validateTypesAsync("string"),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],nr.prototype,"remove",null);vt([_e.validateTypesAsync(["undefined",_e.objectSchema("query options",{from:["string","undefined"],pageSize:[_e.custom(function(e){return[Wg(e),"a positive integer"]}),"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],nr.prototype,"getItems",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],nr.prototype,"setTtl",null);vt([_e.validateTypesAsync("string",_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[String,Number]),Ee("design:returntype",Promise)],nr.prototype,"setItemTtl",null);function eE(e){var t=WK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function WK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Pu=function(e){Cr.default(r,e);var t=eE(r);function r(n,i,a){var s;return pt.default(this,r),s=t.call(this,n,a),s.descriptor=i,s}return _t.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return o={data:s},_.next=3,this.services.network.post(this.links.messages,o);case 3:return u=_.sent,c=u.body,d=this._handleMessagePublished(c.sid,s,!1),_.abrupt("return",d);case 7:case"end":return _.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,o={ttl:s},d.next=4,this.services.network.post(this.uri,o);case 4:u=d.sent,this.descriptor.date_expires=u.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"_update",value:function(i){switch(i.type){case"stream_message_published":{this._handleMessagePublished(i.message_sid,i.message_data,!0);break}case"stream_removed":{this.onRemoved(!1);break}}}},{key:"_handleMessagePublished",value:function(i,a,s){var o={sid:i,data:a};return this.broadcastEventToListeners("messagePublished",{message:o,isLocal:!s}),o}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}}],[{key:"type",get:function(){return"stream"}}]),r}(cl);vt([_e.validateTypesAsync(_e.pureObject),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],Pu.prototype,"publishMessage",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],Pu.prototype,"setTtl",null);var Dn=function(e){Cr.default(r,e);var t=eE(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncStreamImpl=n,i.syncStreamImpl.attach(Bn.default(i)),i}return _t.default(r,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return Pu.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.publishMessage(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.setTtl(s));case 2:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ul.default(Xt.default(r.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Pu.type}}]),r}(fl);kt.default(Dn,"messagePublished","messagePublished");kt.default(Dn,"removed","removed");vt([_e.validateTypesAsync(_e.pureObject),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],Dn.prototype,"publishMessage",null);vt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],Dn.prototype,"setTtl",null);var HK=function e(t){pt.default(this,e),this.sdk="js",this.sdkVer=t,this.os=zl.os.family,this.osVer=zl.os.version,this.pl=zl.name,this.plVer=zl.version},GK=function(){function e(){pt.default(this,e),this.names=new Map,this.entities=new Map}return _t.default(e,[{key:"store",value:function(r){var n=this.entities.get(r.sid);return n||(this.entities.set(r.sid,r),r.uniqueName&&this.names.set(r.type+"::"+r.uniqueName,r.sid),r)}},{key:"getResolved",value:function(r,n){var i=this.names.get(n+"::"+r);return i?this.entities.get(i):null}},{key:"get",value:function(r,n){return this.entities.get(r)||this.getResolved(r,n)||null}},{key:"remove",value:function(r){var n=this.entities.get(r);n&&(this.entities.delete(r),n.uniqueName&&this.names.delete(n.type+"::"+n.uniqueName))}}]),e}();function Vg(e){var t=VK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function VK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var zK=function e(){pt.default(this,e)},Dh=function(e){Cr.default(r,e);var t=Vg(r);function r(n,i,a,s){var o;return pt.default(this,r),o=t.call(this,i,a),o.descriptor=n,o.cache=new Gg,s&&s.forEach(function(u){o.cache.store(u.key,{key:u.key,value:u.data},u.revision)}),o}return _t.default(r,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return r.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var i={};return this.cache.forEach(function(a,s){i[a]=s.value}),i}},{key:"_update",value:function(i,a){switch(i.type){case"live_query_item_updated":this.handleItemMutated(i.item_key,i.item_data,i.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(i.item_key,i.item_revision);break;case"live_query_updated":this.handleBatchUpdate(i.items);break}a&&this._advanceLastEventId(i.last_event_id)}},{key:"handleItemMutated",value:function(i,a,s){if(this.shouldIgnoreEvent(i,s))gt.trace("Item ".concat(i," update skipped, revision: ").concat(s));else{var o={key:i,value:a};this.cache.store(i,o,s),this.broadcastEventToListeners("itemUpdated",o)}}},{key:"handleItemRemoved",value:function(i,a){var s=a===null;this.shouldIgnoreEvent(i,a)?gt.trace("Item ".concat(i," delete skipped, revision: ").concat(a)):(this.cache.delete(i,a,s),this.broadcastEventToListeners("itemRemoved",{key:i}))}},{key:"handleBatchUpdate",value:function(i){var a=this,s={};i!=null&&i.forEach(function(u){s[u.key]={data:u.data,revision:u.revision}}),this.cache.forEach(function(u,c){var d=s[u];d!=null?a.handleItemMutated(u,d.data,d.revision):a.handleItemRemoved(u,null),delete s[u]});for(var o in s)this.handleItemMutated(o,s[o].data,s[o].revision)}},{key:"shouldIgnoreEvent",value:function(i,a){return i!=null&&a!=null&&this.cache.isKnown(i,a)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i)}}],[{key:"type",get:function(){return"live_query"}}]),r}(cl);function tE(e){return Fh.apply(this,arguments)}function Fh(){return Fh=Pe.default(H.default.mark(function e(t){var r,n,i,a,s,o;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(r=t.network,n=t.queryString,i=t.uri,a=t.type,n!=null){c.next=3;break}throw new Nr("Invalid query",400,54507);case 3:return s={query_string:n},a===oi.type&&(s.type=a),c.next=7,r.post(i,s,void 0,!0);case 7:return o=c.sent,c.abrupt("return",o.body);case 9:case"end":return c.stop()}},e)})),Fh.apply(this,arguments)}var oi=function(e){Cr.default(r,e);var t=Vg(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.liveQueryImpl=n,i.liveQueryImpl.attach(Bn.default(i)),i}return _t.default(r,[{key:"type",get:function(){return Dh.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){ul.default(Xt.default(r.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return Dh.type}}]),r}(fl);kt.default(oi,"itemUpdated","itemUpdated");kt.default(oi,"itemRemoved","itemRemoved");var dl=function(e){Cr.default(r,e);var t=Vg(r);function r(n){var i;return pt.default(this,r),i=t.call(this),kt.default(Bn.default(i),"queryExpression",null),kt.default(Bn.default(i),"items",{}),Object.assign(Bn.default(i),n),i.updateIndexName(n.indexName),i}return _t.default(r,[{key:"type",get:function(){return r.type}},{key:"search",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.items={},c.abrupt("return",tE({network:this.network,uri:this.queryUri,queryString:s}).then(function(d){o.queryExpression=s,d.items&&d.items.forEach(function(y){o.items[y.key]=y.data}),o.emit("searchResult",o.getItems())}).catch(function(d){throw gt.error("Error '".concat(d.message,"' while executing query '").concat(s,"'")),o.queryExpression=null,d}));case 2:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"subscribe",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.queryExpression!=null){o.next=2;break}return o.abrupt("return",Promise.reject(new Nr("Invalid query",400,54507)));case 2:return o.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(i){this.indexName=i,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(i){return new no(this.insightsUri).pathSegment(i).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),r}(Et);kt.default(dl,"searchResult","searchResult");vt([_e.validateTypesAsync("string"),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],dl.prototype,"search",null);vt([_e.validateTypes(_e.nonEmptyString),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",void 0)],dl.prototype,"updateIndexName",null);var KK="3.1.0";function JK(e){var t=YK();return function(){var n=Xt.default(e),i;if(t){var a=Xt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function YK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function N_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M_(Object(r),!0).forEach(function(n){kt.default(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var QK="data_sync",up=KK;function Kl(e){if(e){if(typeof e=="string")return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return N_(N_({},e),{},{mode:t})}else return{mode:"create_new"}}var x_="com.twilio.rtd.cds.document",L_="com.twilio.rtd.cds.list",j_="com.twilio.rtd.cds.map",U_="twilio.sync.event",zr=function(e){Cr.default(r,e);var t=JK(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pt.default(this,r),i=t.call(this),!n)throw new Error("Sync library needs a valid Twilio token to be passed");a.hasOwnProperty("logLevel")?gt.setLevel(a.logLevel):gt.setLevel("silent");var s=a.productId=a.productId||QK;a.clientMetadata=a.clientMetadata||{},a.clientMetadata.hasOwnProperty("type")||(a.clientMetadata.type="sync"),a.clientMetadata.hasOwnProperty("sdk")||(a.clientMetadata.sdk="JS",a.clientMetadata.sdkv=up);var o=!a.twilsockClient;if(!a.initRegistrations){var u=new Lc.InitRegistration(s);r.populateInitRegistrations(u),a.initRegistrations=[u]}var c=a.twilsockClient=a.twilsockClient||new Lc.Twilsock(n,s,a);c.on("tokenAboutToExpire",function(b){return i.emit("tokenAboutToExpire",b)}),c.on("tokenExpired",function(){return i.emit("tokenExpired")}),c.on("connectionError",function(b){return i.emit("connectionError",b)}),c.on("stateChanged",function(b){i.emit("connectionStateChanged",b),i.services.subscriptions.onConnectionStateChanged(b==="connected")}),c.on("message",function(b,k){return i._routeMessage(b,k)});var d=new mK(a),y=new EK(new HK(up),d,c),_=new CK(d);return i.services={config:d,twilsock:c,network:y,storage:_,router:Bn.default(i),subscriptions:null},i.services.subscriptions=new _K(i.services),i.entities=new GK,o&&c.connect(),i}return _t.default(r,[{key:"_routeMessage",value:function(i,a){switch(gt.trace("Notification type:",i,"content:",a),i){case x_:case L_:case j_:this.services.subscriptions.acceptMessage(a,!1);break;case U_:this.services.subscriptions.acceptMessage(a,!0);break}}},{key:"_subscribe",value:function(i,a){this.services.subscriptions.add(i,a)}},{key:"_unsubscribe",value:function(i){this.services.subscriptions.remove(i)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:function(){var n=Pe.default(H.default.mark(function a(){var s;return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.services.config.sessionStorageEnabled){u.next=2;break}return u.abrupt("return");case 2:return u.prev=2,u.next=5,this.services.twilsock.storageId();case 5:s=u.sent,this.services.storage.updateStorageId(s.id),u.next=12;break;case 9:u.prev=9,u.t0=u.catch(2),gt.warn("Failed to initialize storage",u.t0);case 12:case"end":return u.stop()}},a,this,[[2,9]])}));function i(){return n.apply(this,arguments)}return i}()},{key:"storeRootInSessionCache",value:function(i,a,s){if(!(!this.services.config.sessionStorageEnabled||!a)){var o=En(s);(i===rr.type||i===nr.type)&&(o.last_event_id=null,delete o.items),this.services.storage.store(i,a,o)}}},{key:"readRootFromSessionCache",value:function(i,a){return!this.services.config.sessionStorageEnabled||!a?null:this.services.storage.read(i,a)}},{key:"_get",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u,c,d,y=arguments;return H.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(u=y.length>2&&y[2]!==void 0?y[2]:!1,o){b.next=3;break}throw new Nr("Cannot get entity without id",404);case 3:return c=new no(s).pathSegment(o).queryParam("Include",u?"items":void 0).build(),b.next=6,this.services.network.get(c);case 6:return d=b.sent,b.abrupt("return",d.body);case 8:case"end":return b.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_createDocument",value:function(i,a,s){var o={unique_name:i,data:a||{}};return s!==void 0&&(o.ttl=s),this.services.network.post(this.services.config.documentsUri,o).then(function(u){return u.body.data=o.data,u.body})}},{key:"_getDocument",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(on.type,s)||this._get(this.services.config.documentsUri,s));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createList",value:function(i,a,s,o){var u={unique_name:i,purpose:a,context:s};return o!==void 0&&(u.ttl=o),this.services.network.post(this.services.config.listsUri,u).then(function(c){return c.body})}},{key:"_getList",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(rr.type,s)||this._get(this.services.config.listsUri,s));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createMap",value:function(i,a){var s={unique_name:i};return a!==void 0&&(s.ttl=a),this.services.network.post(this.services.config.mapsUri,s).then(function(o){return o.body})}},{key:"_getMap",value:function(){var n=Pe.default(H.default.mark(function a(s){var o,u=arguments;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return o=u.length>1&&u[1]!==void 0?u[1]:!1,d.abrupt("return",this.readRootFromSessionCache(nr.type,s)||this._get(this.services.config.mapsUri,s,o));case 2:case"end":return d.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getStream",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(Dn.type,s)||this._get(this.services.config.streamsUri,s,!1));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createStream",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return u={unique_name:s},o!==void 0&&(u.ttl=o),y.next=4,this.services.network.post(this.services.config.streamsUri,u);case 4:return c=y.sent,y.abrupt("return",c.body);case 6:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_getLiveQuery",value:function(i){return this.readRootFromSessionCache(oi.type,i)}},{key:"getCached",value:function(i,a){return i&&this.entities.get(i,a)||null}},{key:"removeFromCacheAndSession",value:function(i,a,s){this.entities.remove(a),this.services.config.sessionStorageEnabled&&this.services.storage.remove(i,a,s)}},{key:"document",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this,u,c,d,y;return H.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=Kl(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createDocument(u.id,u.data,u.ttl);case 6:c=b.sent,b.next=39;break;case 9:if(d=this.getCached(u.id,on.type),!d){b.next=14;break}return b.abrupt("return",new on(d));case 14:return b.prev=14,b.next=17,this._getDocument(u.id);case 17:c=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createDocument(u.id,u.data,u.ttl);case 29:c=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.document(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(on.type,u.id,c),y=new xh(this.services,c,function(k,N,P){return o.removeFromCacheAndSession(k,N,P)}),y=this.entities.store(y),b.abrupt("return",new on(y));case 43:case"end":return b.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"map",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this,u,c,d,y;return H.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=Kl(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createMap(u.id,u.ttl);case 6:c=b.sent,b.next=39;break;case 9:if(d=this.getCached(u.id,nr.type),!d){b.next=14;break}return b.abrupt("return",new nr(d));case 14:return b.prev=14,b.next=17,this._getMap(u.id,u.includeItems);case 17:c=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createMap(u.id,u.ttl);case 29:c=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.map(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(nr.type,u.id,c),y=new Uh(this.services,c,function(k,N,P){return o.removeFromCacheAndSession(k,N,P)}),y=this.entities.store(y),b.abrupt("return",new nr(y));case 43:case"end":return b.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"list",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this,u,c,d,y;return H.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=Kl(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createList(u.id,u.purpose,u.context,u.ttl);case 6:c=b.sent,b.next=39;break;case 9:if(d=this.getCached(u.id,rr.type),!d){b.next=14;break}return b.abrupt("return",new rr(d));case 14:return b.prev=14,b.next=17,this._getList(u.id);case 17:c=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createList(u.id,u.purpose,u.context,u.ttl);case 29:c=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.list(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(rr.type,u.id,c),y=new jh(this.services,c,function(k,N,P){return o.removeFromCacheAndSession(k,N,P)}),y=this.entities.store(y),b.abrupt("return",new rr(y));case 43:case"end":return b.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"stream",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this,u,c,d,y,_;return H.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this.ensureReady();case 2:if(u=Kl(s),u.mode!=="create_new"){k.next=9;break}return k.next=6,this._createStream(u.id,u.ttl);case 6:c=k.sent,k.next=39;break;case 9:if(d=this.getCached(u.id,Dn.type),!d){k.next=14;break}return k.abrupt("return",new Dn(d));case 14:return k.prev=14,k.next=17,this._getStream(u.id);case 17:c=k.sent,k.next=39;break;case 20:if(k.prev=20,k.t0=k.catch(14),!(k.t0.status!==404||u.mode==="open_existing")){k.next=26;break}throw k.t0;case 26:return k.prev=26,k.next=29,this._createStream(u.id,u.ttl);case 29:c=k.sent,k.next=39;break;case 32:if(k.prev=32,k.t1=k.catch(26),k.t1.status!==409){k.next=38;break}return k.abrupt("return",this.stream(s));case 38:throw k.t1;case 39:return this.storeRootInSessionCache(Dn.type,u.id,c),y=function(P,j,F){return o.removeFromCacheAndSession(P,j,F)},_=new Pu(this.services,c,y),_=this.entities.store(_),k.abrupt("return",new Dn(_));case 44:case"end":return k.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shutdown",value:function(){var n=Pe.default(H.default.mark(function a(){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.subscriptions.shutdown();case 2:return o.next=4,this.services.twilsock.disconnect();case 4:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"updateToken",value:function(){var n=Pe.default(H.default.mark(function a(s){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.twilsock.updateToken(s).catch(function(c){var d,y=c==null||(d=c.reply)===null||d===void 0?void 0:d.status;throw(y==null?void 0:y.code)===401&&(y==null?void 0:y.status)==="UNAUTHORIZED"?new Nr("Updated token was rejected by server",400,51130):c}));case 1:case"end":return u.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"liveQuery",value:function(){var n=Pe.default(H.default.mark(function a(s,o){var u=this,c,d,y,_,b;return H.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this.ensureReady();case 2:return c=new no(this.services.config.insightsUri).pathSegment(s).pathSegment("Items").build(),N.next=5,tE({network:this.services.network,uri:c,queryString:o,type:oi.type});case 5:return d=N.sent,y=this.getCached(d.query_id,oi.type),y||(_=this._getLiveQuery(d.query_id),_||(_={indexName:s,queryExpression:o,sid:d.query_id,queryUri:c,last_event_id:d.last_event_id}),b=function(j,F,me){return u.removeFromCacheAndSession(j,F,me)},y=new Dh(_,this.services,b,d.items)),this.storeRootInSessionCache(oi.type,d.query_id,y.liveQueryDescriptor),y=this.entities.store(y),N.abrupt("return",new oi(y));case 11:case"end":return N.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"instantQuery",value:function(){var n=Pe.default(H.default.mark(function a(s){var o=this,u;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.ensureReady();case 2:return u=function(_,b){return o.liveQuery(_,b)},d.abrupt("return",new dl({indexName:s,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:u}));case 4:case"end":return d.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()}],[{key:"populateInitRegistrations",value:function(i){i.populateInitRegistrations([U_,x_,L_,j_])}},{key:"version",get:function(){return up}}]),r}(Et);kt.default(zr,"connectionStateChanged","connectionStateChanged");kt.default(zr,"connectionError","connectionError");kt.default(zr,"tokenAboutToExpire","tokenAboutToExpire");kt.default(zr,"tokenExpired","tokenExpired");vt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open document options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],zr.prototype,"document",null);vt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open map options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)],includeItems:["boolean","undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],zr.prototype,"map",null);vt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open list options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)],purpose:["string","undefined"],context:[_e.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],zr.prototype,"list",null);vt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open stream options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],zr.prototype,"stream",null);vt([_e.validateTypesAsync(_e.nonEmptyString),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],zr.prototype,"updateToken",null);vt([_e.validateTypesAsync(_e.nonEmptyString,"string"),Ee("design:type",Function),Ee("design:paramtypes",[String,String]),Ee("design:returntype",Promise)],zr.prototype,"liveQuery",null);vt([_e.validateTypesAsync(_e.nonEmptyString),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],zr.prototype,"instantQuery",null);xr.Client=zr;xr.InsightsItem=zK;xr.InstantQuery=dl;xr.LiveQuery=oi;xr.Paginator=Hg;xr.SyncClient=zr;xr.SyncDocument=on;xr.SyncList=rr;xr.SyncListItem=Lh;xr.SyncMap=nr;xr.SyncMapItem=tu;xr.SyncStream=Dn;var rE={},XK=PT,ZK=TypeError,nE=function(e){if(XK(e))throw ZK("The method doesn't accept regular expressions");return e},e9=Ot,t9=e9("match"),iE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[t9]=!1,"/./"[e](t)}catch{}}return!1},r9=ct,aE=et,n9=Hn.f,i9=mi,D_=fr,a9=nE,s9=Vn,o9=iE,F_=aE("".startsWith),u9=aE("".slice),l9=Math.min,sE=o9("startsWith"),c9=!sE&&!!function(){var e=n9(String.prototype,"startsWith");return e&&!e.writable}();r9({target:"String",proto:!0,forced:!c9&&!sE},{startsWith:function(t){var r=D_(s9(this));a9(t);var n=i9(l9(arguments.length>1?arguments[1]:void 0,r.length)),i=D_(t);return F_?F_(r,i,n):u9(r,n,n+i.length)===i}});var f9=ct,d9=jg.left,p9=rl,B_=Za,h9=Xu,v9=p9("reduce"),g9=!h9&&B_>79&&B_<83;f9({target:"Array",proto:!0,forced:!v9||g9},{reduce:function(t){var r=arguments.length;return d9(this,t,r,r>1?arguments[1]:void 0)}});var y9=nt,m9=Ot,b9=MM,w9=m9("iterator"),oE=!y9(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(n,i){t.delete("b"),r+=i+n}),b9&&!e.toJSON||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[w9]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||r!=="a1c3"||new URL("http://x",void 0).host!=="x"}),q_=Sv.exports,_9=Zt,S9=function(e,t,r){return r.get&&q_(r.get,t,{getter:!0}),r.set&&q_(r.set,t,{setter:!0}),_9.f(e,t,r)},us=et,lp=2147483647,hu=36,uE=1,Bh=26,$9=38,k9=700,T9=72,E9=128,C9="-",I9=/[^\0-\u007E]/,lE=/[.\u3002\uFF0E\uFF61]/g,W_="Overflow: input needs wider integers to process",cp=hu-uE,H_=RangeError,R9=us(lE.exec),js=Math.floor,fp=String.fromCharCode,G_=us("".charCodeAt),cE=us([].join),qi=us([].push),O9=us("".replace),A9=us("".split),P9=us("".toLowerCase),M9=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=G_(e,r++);if(i>=55296&&i<=56319&&r<n){var a=G_(e,r++);(a&64512)==56320?qi(t,((i&1023)<<10)+(a&1023)+65536):(qi(t,i),r--)}else qi(t,i)}return t},V_=function(e){return e+22+75*(e<26)},N9=function(e,t,r){var n=0;for(e=r?js(e/k9):e>>1,e+=js(e/t);e>cp*Bh>>1;)e=js(e/cp),n+=hu;return js(n+(cp+1)*e/(e+$9))},x9=function(e){var t=[];e=M9(e);var r=e.length,n=E9,i=0,a=T9,s,o;for(s=0;s<e.length;s++)o=e[s],o<128&&qi(t,fp(o));var u=t.length,c=u;for(u&&qi(t,C9);c<r;){var d=lp;for(s=0;s<e.length;s++)o=e[s],o>=n&&o<d&&(d=o);var y=c+1;if(d-n>js((lp-i)/y))throw H_(W_);for(i+=(d-n)*y,n=d,s=0;s<e.length;s++){if(o=e[s],o<n&&++i>lp)throw H_(W_);if(o==n){for(var _=i,b=hu;;){var k=b<=a?uE:b>=a+Bh?Bh:b-a;if(_<k)break;var N=_-k,P=hu-k;qi(t,fp(V_(k+N%P))),_=js(N/P),b+=hu}qi(t,fp(V_(_))),a=N9(i,y,c==u),i=0,c++}}i++,n++}return cE(t,"")},L9=function(e){var t=[],r=A9(O9(P9(e),lE,"."),"."),n,i;for(n=0;n<r.length;n++)i=r[n],qi(t,R9(I9,i)?"xn--"+x9(i):i);return cE(t,".")},qh=ct,io=dt,Jl=Mt,Wn=et,j9=Wt,fE=oE,dE=mr,U9=bg,D9=aa,F9=R0,zg=dn,pE=as,dp=Nt,B9=zt,q9=wi,W9=bi,H9=er,hE=Vt,Br=fr,G9=ia,z_=Qa,Wh=yf,V9=tl,Cs=Fv,z9=Ot,K9=Dg,J9=z9("iterator"),pl="URLSearchParams",vE=pl+"Iterator",gE=zg.set,bn=zg.getterFor(pl),Y9=zg.getterFor(vE),Q9=Object.getOwnPropertyDescriptor,Kg=function(e){if(!j9)return io[e];var t=Q9(io,e);return t&&t.value},K_=Kg("fetch"),jc=Kg("Request"),vu=Kg("Headers"),pp=jc&&jc.prototype,J_=vu&&vu.prototype,X9=io.RegExp,Z9=io.TypeError,yE=io.decodeURIComponent,eJ=io.encodeURIComponent,tJ=Wn("".charAt),Y_=Wn([].join),Da=Wn([].push),Hh=Wn("".replace),rJ=Wn([].shift),Q_=Wn([].splice),X_=Wn("".split),nJ=Wn("".slice),iJ=/\+/g,Z_=Array(4),aJ=function(e){return Z_[e-1]||(Z_[e-1]=X9("((?:%[\\da-f]{2}){"+e+"})","gi"))},sJ=function(e){try{return yE(e)}catch{return e}},eS=function(e){var t=Hh(e,iJ," "),r=4;try{return yE(t)}catch{for(;r;)t=Hh(t,aJ(r--),sJ);return t}},oJ=/[!'()~]|%20/g,uJ={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},lJ=function(e){return uJ[e]},tS=function(e){return Hh(eJ(e),oJ,lJ)},hp=F9(function(t,r){gE(this,{type:vE,iterator:Wh(bn(t).entries),kind:r})},"Iterator",function(){var t=Y9(this),r=t.kind,n=t.iterator.next(),i=n.value;return n.done||(n.value=r==="keys"?i.key:r==="values"?i.value:[i.key,i.value]),n},!0),mE=function(e){this.entries=[],this.url=null,e!==void 0&&(hE(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?tJ(e,0)==="?"?nJ(e,1):e:Br(e)))};mE.prototype={type:pl,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t=V9(e),r,n,i,a,s,o,u;if(t)for(r=Wh(e,t),n=r.next;!(i=Jl(n,r)).done;){if(a=Wh(H9(i.value)),s=a.next,(o=Jl(s,a)).done||(u=Jl(s,a)).done||!Jl(s,a).done)throw Z9("Expected sequence with length 2");Da(this.entries,{key:Br(o.value),value:Br(u.value)})}else for(var c in e)B9(e,c)&&Da(this.entries,{key:c,value:Br(e[c])})},parseQuery:function(e){if(e)for(var t=X_(e,"&"),r=0,n,i;r<t.length;)n=t[r++],n.length&&(i=X_(n,"="),Da(this.entries,{key:eS(rJ(i)),value:eS(Y_(i,"="))}))},serialize:function(){for(var e=this.entries,t=[],r=0,n;r<e.length;)n=e[r++],Da(t,tS(n.key)+"="+tS(n.value));return Y_(t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Lf=function(){pE(this,Mu);var t=arguments.length>0?arguments[0]:void 0;gE(this,new mE(t))},Mu=Lf.prototype;U9(Mu,{append:function(t,r){Cs(arguments.length,2);var n=bn(this);Da(n.entries,{key:Br(t),value:Br(r)}),n.updateURL()},delete:function(e){Cs(arguments.length,1);for(var t=bn(this),r=t.entries,n=Br(e),i=0;i<r.length;)r[i].key===n?Q_(r,i,1):i++;t.updateURL()},get:function(t){Cs(arguments.length,1);for(var r=bn(this).entries,n=Br(t),i=0;i<r.length;i++)if(r[i].key===n)return r[i].value;return null},getAll:function(t){Cs(arguments.length,1);for(var r=bn(this).entries,n=Br(t),i=[],a=0;a<r.length;a++)r[a].key===n&&Da(i,r[a].value);return i},has:function(t){Cs(arguments.length,1);for(var r=bn(this).entries,n=Br(t),i=0;i<r.length;)if(r[i++].key===n)return!0;return!1},set:function(t,r){Cs(arguments.length,1);for(var n=bn(this),i=n.entries,a=!1,s=Br(t),o=Br(r),u=0,c;u<i.length;u++)c=i[u],c.key===s&&(a?Q_(i,u--,1):(a=!0,c.value=o));a||Da(i,{key:s,value:o}),n.updateURL()},sort:function(){var t=bn(this);K9(t.entries,function(r,n){return r.key>n.key?1:-1}),t.updateURL()},forEach:function(t){for(var r=bn(this).entries,n=q9(t,arguments.length>1?arguments[1]:void 0),i=0,a;i<r.length;)a=r[i++],n(a.value,a.key,this)},keys:function(){return new hp(this,"keys")},values:function(){return new hp(this,"values")},entries:function(){return new hp(this,"entries")}},{enumerable:!0});dE(Mu,J9,Mu.entries,{name:"entries"});dE(Mu,"toString",function(){return bn(this).serialize()},{enumerable:!0});D9(Lf,pl);qh({global:!0,constructor:!0,forced:!fE},{URLSearchParams:Lf});if(!fE&&dp(vu)){var cJ=Wn(J_.has),fJ=Wn(J_.set),rS=function(e){if(hE(e)){var t=e.body,r;if(W9(t)===pl)return r=e.headers?new vu(e.headers):new vu,cJ(r,"content-type")||fJ(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),G9(e,{body:z_(0,Br(t)),headers:z_(0,r)})}return e};if(dp(K_)&&qh({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return K_(t,arguments.length>1?rS(arguments[1]):{})}}),dp(jc)){var vp=function(t){return pE(this,pp),new jc(t,arguments.length>1?rS(arguments[1]):{})};pp.constructor=vp,vp.prototype=pp,qh({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:vp})}}var dJ={URLSearchParams:Lf,getState:bn},pJ=ct,Jg=Wt,hJ=oE,Yg=dt,nS=wi,pn=et,Uc=mr,tn=S9,vJ=as,Gh=zt,Qg=UT,Is=E0,mn=zu,gJ=Qv.codeAt,yJ=L9,ei=fr,mJ=aa,bJ=Fv,bE=dJ,wE=dn,wJ=wE.set,Dc=wE.getterFor("URL"),_J=bE.URLSearchParams,SJ=bE.getState,Yo=Yg.URL,Vh=Yg.TypeError,Fc=Yg.parseInt,$J=Math.floor,iS=Math.pow,sn=pn("".charAt),Sn=pn(/./.exec),ru=pn([].join),kJ=pn(1 .toString),TJ=pn([].pop),Ns=pn([].push),aS=pn("".replace),EJ=pn([].shift),CJ=pn("".split),gu=pn("".slice),Bc=pn("".toLowerCase),IJ=pn([].unshift),RJ="Invalid authority",gp="Invalid scheme",Ia="Invalid host",sS="Invalid port",_E=/[a-z]/i,OJ=/[\d+-.a-z]/i,zh=/\d/,AJ=/^0x/i,PJ=/^[0-7]+$/,MJ=/^\d+$/,SE=/^[\da-f]+$/i,NJ=/[\0\t\n\r #%/:<>?@[\\\]^|]/,xJ=/[\0\t\n\r #/:<>?@[\\\]^|]/,LJ=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,jJ=/[\t\n\r]/g,rn,UJ=function(e){var t=CJ(e,"."),r,n,i,a,s,o,u;if(t.length&&t[t.length-1]==""&&t.length--,r=t.length,r>4)return e;for(n=[],i=0;i<r;i++){if(a=t[i],a=="")return e;if(s=10,a.length>1&&sn(a,0)=="0"&&(s=Sn(AJ,a)?16:8,a=gu(a,s==8?1:2)),a==="")o=0;else{if(!Sn(s==10?MJ:s==8?PJ:SE,a))return e;o=Fc(a,s)}Ns(n,o)}for(i=0;i<r;i++)if(o=n[i],i==r-1){if(o>=iS(256,5-r))return null}else if(o>255)return null;for(u=TJ(n),i=0;i<n.length;i++)u+=n[i]*iS(256,3-i);return u},DJ=function(e){var t=[0,0,0,0,0,0,0,0],r=0,n=null,i=0,a,s,o,u,c,d,y,_=function(){return sn(e,i)};if(_()==":"){if(sn(e,1)!=":")return;i+=2,r++,n=r}for(;_();){if(r==8)return;if(_()==":"){if(n!==null)return;i++,r++,n=r;continue}for(a=s=0;s<4&&Sn(SE,_());)a=a*16+Fc(_(),16),i++,s++;if(_()=="."){if(s==0||(i-=s,r>6))return;for(o=0;_();){if(u=null,o>0)if(_()=="."&&o<4)i++;else return;if(!Sn(zh,_()))return;for(;Sn(zh,_());){if(c=Fc(_(),10),u===null)u=c;else{if(u==0)return;u=u*10+c}if(u>255)return;i++}t[r]=t[r]*256+u,o++,(o==2||o==4)&&r++}if(o!=4)return;break}else if(_()==":"){if(i++,!_())return}else if(_())return;t[r++]=a}if(n!==null)for(d=r-n,r=7;r!=0&&d>0;)y=t[r],t[r--]=t[n+d-1],t[n+--d]=y;else if(r!=8)return;return t},FJ=function(e){for(var t=null,r=1,n=null,i=0,a=0;a<8;a++)e[a]!==0?(i>r&&(t=n,r=i),n=null,i=0):(n===null&&(n=a),++i);return i>r&&(t=n,r=i),t},Qo=function(e){var t,r,n,i;if(typeof e=="number"){for(t=[],r=0;r<4;r++)IJ(t,e%256),e=$J(e/256);return ru(t,".")}else if(typeof e=="object"){for(t="",n=FJ(e),r=0;r<8;r++)i&&e[r]===0||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=kJ(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},cc={},$E=Qg({},cc,{" ":1,'"':1,"<":1,">":1,"`":1}),kE=Qg({},$E,{"#":1,"?":1,"{":1,"}":1}),yp=Qg({},kE,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ni=function(e,t){var r=gJ(e,0);return r>32&&r<127&&!Gh(t,e)?e:encodeURIComponent(e)},Yl={ftp:21,file:null,http:80,https:443,ws:80,wss:443},nu=function(e,t){var r;return e.length==2&&Sn(_E,sn(e,0))&&((r=sn(e,1))==":"||!t&&r=="|")},oS=function(e){var t;return e.length>1&&nu(gu(e,0,2))&&(e.length==2||(t=sn(e,2))==="/"||t==="\\"||t==="?"||t==="#")},BJ=function(e){return e==="."||Bc(e)==="%2e"},qJ=function(e){return e=Bc(e),e===".."||e==="%2e."||e===".%2e"||e==="%2e%2e"},mp={},uS={},bp={},lS={},cS={},wp={},fS={},dS={},Ql={},Xl={},_p={},Sp={},$p={},kp={},pS={},Tp={},Rs={},Nn={},hS={},Ra={},Zn={},Xg=function(e,t,r){var n=ei(e),i,a,s;if(t){if(a=this.parse(n),a)throw Vh(a);this.searchParams=null}else{if(r!==void 0&&(i=new Xg(r,!0)),a=this.parse(n,null,i),a)throw Vh(a);s=SJ(new _J),s.bindURL(this),this.searchParams=s}};Xg.prototype={type:"URL",parse:function(e,t,r){var n=this,i=t||mp,a=0,s="",o=!1,u=!1,c=!1,d,y,_,b;for(e=ei(e),t||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,e=aS(e,LJ,"")),e=aS(e,jJ,""),d=Is(e);a<=d.length;){switch(y=d[a],i){case mp:if(y&&Sn(_E,y))s+=Bc(y),i=uS;else{if(t)return gp;i=bp;continue}break;case uS:if(y&&(Sn(OJ,y)||y=="+"||y=="-"||y=="."))s+=Bc(y);else if(y==":"){if(t&&(n.isSpecial()!=Gh(Yl,s)||s=="file"&&(n.includesCredentials()||n.port!==null)||n.scheme=="file"&&!n.host))return;if(n.scheme=s,t){n.isSpecial()&&Yl[n.scheme]==n.port&&(n.port=null);return}s="",n.scheme=="file"?i=kp:n.isSpecial()&&r&&r.scheme==n.scheme?i=lS:n.isSpecial()?i=dS:d[a+1]=="/"?(i=cS,a++):(n.cannotBeABaseURL=!0,Ns(n.path,""),i=hS)}else{if(t)return gp;s="",i=bp,a=0;continue}break;case bp:if(!r||r.cannotBeABaseURL&&y!="#")return gp;if(r.cannotBeABaseURL&&y=="#"){n.scheme=r.scheme,n.path=mn(r.path),n.query=r.query,n.fragment="",n.cannotBeABaseURL=!0,i=Zn;break}i=r.scheme=="file"?kp:wp;continue;case lS:if(y=="/"&&d[a+1]=="/")i=Ql,a++;else{i=wp;continue}break;case cS:if(y=="/"){i=Xl;break}else{i=Nn;continue}case wp:if(n.scheme=r.scheme,y==rn)n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.query=r.query;else if(y=="/"||y=="\\"&&n.isSpecial())i=fS;else if(y=="?")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.query="",i=Ra;else if(y=="#")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.query=r.query,n.fragment="",i=Zn;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=mn(r.path),n.path.length--,i=Nn;continue}break;case fS:if(n.isSpecial()&&(y=="/"||y=="\\"))i=Ql;else if(y=="/")i=Xl;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,i=Nn;continue}break;case dS:if(i=Ql,y!="/"||sn(s,a+1)!="/")continue;a++;break;case Ql:if(y!="/"&&y!="\\"){i=Xl;continue}break;case Xl:if(y=="@"){o&&(s="%40"+s),o=!0,_=Is(s);for(var k=0;k<_.length;k++){var N=_[k];if(N==":"&&!c){c=!0;continue}var P=Ni(N,yp);c?n.password+=P:n.username+=P}s=""}else if(y==rn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()){if(o&&s=="")return RJ;a-=Is(s).length+1,s="",i=_p}else s+=y;break;case _p:case Sp:if(t&&n.scheme=="file"){i=Tp;continue}else if(y==":"&&!u){if(s=="")return Ia;if(b=n.parseHost(s),b)return b;if(s="",i=$p,t==Sp)return}else if(y==rn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()){if(n.isSpecial()&&s=="")return Ia;if(t&&s==""&&(n.includesCredentials()||n.port!==null))return;if(b=n.parseHost(s),b)return b;if(s="",i=Rs,t)return;continue}else y=="["?u=!0:y=="]"&&(u=!1),s+=y;break;case $p:if(Sn(zh,y))s+=y;else if(y==rn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()||t){if(s!=""){var j=Fc(s,10);if(j>65535)return sS;n.port=n.isSpecial()&&j===Yl[n.scheme]?null:j,s=""}if(t)return;i=Rs;continue}else return sS;break;case kp:if(n.scheme="file",y=="/"||y=="\\")i=pS;else if(r&&r.scheme=="file")if(y==rn)n.host=r.host,n.path=mn(r.path),n.query=r.query;else if(y=="?")n.host=r.host,n.path=mn(r.path),n.query="",i=Ra;else if(y=="#")n.host=r.host,n.path=mn(r.path),n.query=r.query,n.fragment="",i=Zn;else{oS(ru(mn(d,a),""))||(n.host=r.host,n.path=mn(r.path),n.shortenPath()),i=Nn;continue}else{i=Nn;continue}break;case pS:if(y=="/"||y=="\\"){i=Tp;break}r&&r.scheme=="file"&&!oS(ru(mn(d,a),""))&&(nu(r.path[0],!0)?Ns(n.path,r.path[0]):n.host=r.host),i=Nn;continue;case Tp:if(y==rn||y=="/"||y=="\\"||y=="?"||y=="#"){if(!t&&nu(s))i=Nn;else if(s==""){if(n.host="",t)return;i=Rs}else{if(b=n.parseHost(s),b)return b;if(n.host=="localhost"&&(n.host=""),t)return;s="",i=Rs}continue}else s+=y;break;case Rs:if(n.isSpecial()){if(i=Nn,y!="/"&&y!="\\")continue}else if(!t&&y=="?")n.query="",i=Ra;else if(!t&&y=="#")n.fragment="",i=Zn;else if(y!=rn&&(i=Nn,y!="/"))continue;break;case Nn:if(y==rn||y=="/"||y=="\\"&&n.isSpecial()||!t&&(y=="?"||y=="#")){if(qJ(s)?(n.shortenPath(),y!="/"&&!(y=="\\"&&n.isSpecial())&&Ns(n.path,"")):BJ(s)?y!="/"&&!(y=="\\"&&n.isSpecial())&&Ns(n.path,""):(n.scheme=="file"&&!n.path.length&&nu(s)&&(n.host&&(n.host=""),s=sn(s,0)+":"),Ns(n.path,s)),s="",n.scheme=="file"&&(y==rn||y=="?"||y=="#"))for(;n.path.length>1&&n.path[0]==="";)EJ(n.path);y=="?"?(n.query="",i=Ra):y=="#"&&(n.fragment="",i=Zn)}else s+=Ni(y,kE);break;case hS:y=="?"?(n.query="",i=Ra):y=="#"?(n.fragment="",i=Zn):y!=rn&&(n.path[0]+=Ni(y,cc));break;case Ra:!t&&y=="#"?(n.fragment="",i=Zn):y!=rn&&(y=="'"&&n.isSpecial()?n.query+="%27":y=="#"?n.query+="%23":n.query+=Ni(y,cc));break;case Zn:y!=rn&&(n.fragment+=Ni(y,$E));break}a++}},parseHost:function(e){var t,r,n;if(sn(e,0)=="["){if(sn(e,e.length-1)!="]"||(t=DJ(gu(e,1,-1)),!t))return Ia;this.host=t}else if(this.isSpecial()){if(e=yJ(e),Sn(NJ,e)||(t=UJ(e),t===null))return Ia;this.host=t}else{if(Sn(xJ,e))return Ia;for(t="",r=Is(e),n=0;n<r.length;n++)t+=Ni(r[n],cc);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return Gh(Yl,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;t&&(this.scheme!="file"||t!=1||!nu(e[0],!0))&&e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,a=e.port,s=e.path,o=e.query,u=e.fragment,c=t+":";return i!==null?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=Qo(i),a!==null&&(c+=":"+a)):t=="file"&&(c+="//"),c+=e.cannotBeABaseURL?s[0]:s.length?"/"+ru(s,"/"):"",o!==null&&(c+="?"+o),u!==null&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw Vh(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new ao(e.path[0]).origin}catch{return"null"}return e=="file"||!this.isSpecial()?"null":e+"://"+Qo(this.host)+(t!==null?":"+t:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(ei(e)+":",mp)},getUsername:function(){return this.username},setUsername:function(e){var t=Is(ei(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Ni(t[r],yp)}},getPassword:function(){return this.password},setPassword:function(e){var t=Is(ei(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Ni(t[r],yp)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?Qo(e):Qo(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,_p)},getHostname:function(){var e=this.host;return e===null?"":Qo(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Sp)},getPort:function(){var e=this.port;return e===null?"":ei(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=ei(e),e==""?this.port=null:this.parse(e,$p))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+ru(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Rs))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=ei(e),e==""?this.query=null:(sn(e,0)=="?"&&(e=gu(e,1)),this.query="",this.parse(e,Ra)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){if(e=ei(e),e==""){this.fragment=null;return}sn(e,0)=="#"&&(e=gu(e,1)),this.fragment="",this.parse(e,Zn)},update:function(){this.query=this.searchParams.serialize()||null}};var ao=function(t){var r=vJ(this,kr),n=bJ(arguments.length,1)>1?arguments[1]:void 0,i=wJ(r,new Xg(t,!1,n));Jg||(r.href=i.serialize(),r.origin=i.getOrigin(),r.protocol=i.getProtocol(),r.username=i.getUsername(),r.password=i.getPassword(),r.host=i.getHost(),r.hostname=i.getHostname(),r.port=i.getPort(),r.pathname=i.getPathname(),r.search=i.getSearch(),r.searchParams=i.getSearchParams(),r.hash=i.getHash())},kr=ao.prototype,nn=function(e,t){return{get:function(){return Dc(this)[e]()},set:t&&function(r){return Dc(this)[t](r)},configurable:!0,enumerable:!0}};Jg&&(tn(kr,"href",nn("serialize","setHref")),tn(kr,"origin",nn("getOrigin")),tn(kr,"protocol",nn("getProtocol","setProtocol")),tn(kr,"username",nn("getUsername","setUsername")),tn(kr,"password",nn("getPassword","setPassword")),tn(kr,"host",nn("getHost","setHost")),tn(kr,"hostname",nn("getHostname","setHostname")),tn(kr,"port",nn("getPort","setPort")),tn(kr,"pathname",nn("getPathname","setPathname")),tn(kr,"search",nn("getSearch","setSearch")),tn(kr,"searchParams",nn("getSearchParams")),tn(kr,"hash",nn("getHash","setHash")));Uc(kr,"toJSON",function(){return Dc(this).serialize()},{enumerable:!0});Uc(kr,"toString",function(){return Dc(this).serialize()},{enumerable:!0});if(Yo){var vS=Yo.createObjectURL,gS=Yo.revokeObjectURL;vS&&Uc(ao,"createObjectURL",nS(vS,Yo)),gS&&Uc(ao,"revokeObjectURL",nS(gS,Yo))}mJ(ao,"URL");pJ({global:!0,constructor:!0,forced:!hJ,sham:!Jg},{URL:ao});/*
@license
Copyright (c) 2018, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=go.exports,n=ca.exports,i=nl,a=bo.exports,s=Si,o=ir;function u(fe){return fe&&typeof fe=="object"&&"default"in fe?fe:{default:fe}}function c(fe){if(fe&&fe.__esModule)return fe;var G=Object.create(null);return fe&&Object.keys(fe).forEach(function(Y){if(Y!=="default"){var $=Object.getOwnPropertyDescriptor(fe,Y);Object.defineProperty(G,Y,$.get?$:{enumerable:!0,get:function(){return fe[Y]}})}}),G.default=fe,Object.freeze(G)}var d=u(r),y=u(n),_=u(i),b=c(a);/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function k(fe,G,Y,$){var C=arguments.length,Z=C<3?G:$===null?$=Object.getOwnPropertyDescriptor(G,Y):$,te;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Z=Reflect.decorate(fe,G,Y,$);else for(var Ae=fe.length-1;Ae>=0;Ae--)(te=fe[Ae])&&(Z=(C<3?te(Z):C>3?te(G,Y,Z):te(G,Y))||Z);return C>3&&Z&&Object.defineProperty(G,Y,Z),Z}function N(fe,G){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(fe,G)}function P(fe,G){return["".concat(new Date().toISOString()," MCS Client ").concat(fe,":")].concat(Array.from(G))}class j{constructor(G){y.default(this,"prefix",""),this.prefix=G!=null&&G.length>0?G+" ":""}static scope(G){return new j(G)}setLevel(G){b.setLevel(G)}static setLevel(G){b.setLevel(G)}trace(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.trace.apply(null,P(this.prefix+"T",Y))}debug(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.debug.apply(null,P(this.prefix+"D",Y))}info(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.info.apply(null,P(this.prefix+"I",Y))}warn(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.warn.apply(null,P(this.prefix+"W",Y))}error(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.error.apply(null,P(this.prefix+"E",Y))}static trace(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.trace.apply(null,P("T",Y))}static debug(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.debug.apply(null,P("D",Y))}static info(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.info.apply(null,P("I",Y))}static warn(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.warn.apply(null,P("W",Y))}static error(){for(var G=arguments.length,Y=new Array(G),$=0;$<G;$++)Y[$]=arguments[$];b.error.apply(null,P("E",Y))}}var F=1e3,me=4e3,ce=3,xe=!0,Ne=fe=>"https://mcs.".concat(fe!=null?fe:"us1",".twilio.com"),Me=fe=>fe.startsWith("http"),x=(fe,G)=>"".concat(Me(fe)?"":Ne(G)).concat(fe);class le{constructor(G,Y,$,C){var Z,te,Ae,De,de,$e,E=(Z=(te=C.MCS)!==null&&te!==void 0?te:C)!==null&&Z!==void 0?Z:{};this.region=(Ae=(De=E.region)!==null&&De!==void 0?De:C.region)!==null&&Ae!==void 0?Ae:"us1",this.mediaUrl=x(Y,this.region),this.mediaSetUrl=$?x($):"".concat(this.mediaUrl,"Set"),this.token=G,this.retryWhenThrottledOverride=(de=E.retryWhenThrottledOverride)!==null&&de!==void 0?de:xe,this.backoffConfigOverride=($e=E.backoffConfigOverride)!==null&&$e!==void 0?$e:le.backoffConfigDefault}static get backoffConfigDefault(){return{min:F,max:me,maxAttemptsCount:ce}}static get retryWhenThrottledDefault(){return xe}updateToken(G){this.token=G}}class D{constructor(G,Y,$){this.config=G,this.network=Y,this._update($)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var G=this;return d.default(_.default.mark(function Y(){var $;return _.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,G.network.get("".concat(G.config.mediaUrl,"/").concat(G.sid));case 2:return $=Z.sent,G._update($.body),Z.abrupt("return",Promise.resolve(G.state.contentDirectUrl));case 5:case"end":return Z.stop()}},Y)}))()}getCachedContentUrl(){var G=this;return d.default(_.default.mark(function Y(){return _.default.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(!G.state.contentDirectUrl){C.next=2;break}return C.abrupt("return",Promise.resolve(G.state.contentDirectUrl));case 2:return C.next=4,G.getContentUrl();case 4:return C.abrupt("return",C.sent);case 5:case"end":return C.stop()}},Y)}))()}_update(G){var Y,$,C,Z;this.state={sid:G.sid,serviceSid:G.service_sid,channelSid:G.channel_sid,messageSid:G.message_sid,dateCreated:G.date_created?new Date(G.date_created):null,dateUploadUpdated:G.date_upload_updated?new Date(G.date_upload_updated):null,dateUpdated:G.date_updated?new Date(G.date_updated):null,size:G.size,contentType:G.content_type,author:G.author,url:G.url,contentUrl:G.links.content,contentDirectUrl:(Y=G.links.content_direct_temporary)!==null&&Y!==void 0?Y:null,filename:($=G.filename)!==null&&$!==void 0?$:null,category:(C=G.category)!==null&&C!==void 0?C:"media",isMultipartUpstream:(Z=G.is_multipart_upstream)!==null&&Z!==void 0?Z:!1}}}class Re extends Error{constructor(G,Y,$,C,Z){super(G),this.code=Y,this.body=$,this.status=C,this.headers=Z}}var Ie=t.XMLHttpRequest||{};function ue(fe){return fe?fe.split(`\r
`).map(G=>G.split(": ")).filter(G=>G.length===2&&G[1].length>0).reduce((G,Y)=>(G[Y[0]]=Y[1],G),{}):{}}function ee(fe){var G=fe.getResponseHeader("Content-Type");if(!G||G.indexOf("application/json")!==0||fe.responseText.length===0)return fe.responseText;try{return JSON.parse(fe.responseText)}catch{return fe.responseText}}class se{static request(G,Y,$,C){return d.default(_.default.mark(function Z(){return _.default.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return Ae.abrupt("return",new Promise((De,de)=>{var $e=new Ie;$e.open(G,Y,!0),$e.onreadystatechange=function(){if($e.readyState===4){var V=ue($e.getAllResponseHeaders()),re=ee($e);if(200<=$e.status&&$e.status<300)De({status:$e.status,headers:V,body:re});else{var W,ke=(W=$e.statusText)!==null&&W!==void 0?W:"NONE",he;typeof re=="string"?he=re&&re.split(`
`,2).length===1?re:"":he=JSON.stringify(re);var we="".concat($e.status,": [").concat(ke,"] ").concat(he);de(new Re(we,$e.status,re,ke,V))}}};for(var E in $)$e.setRequestHeader(E,$[E]),E==="Content-Type"&&$[E]==="application/json"&&(C=JSON.stringify(C));$e.send(C)}));case 1:case"end":return Ae.stop()}},Z)}))()}get(G,Y){return d.default(_.default.mark(function $(){return _.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",se.request("GET",G,Y));case 1:case"end":return Z.stop()}},$)}))()}post(G,Y,$){return d.default(_.default.mark(function C(){return _.default.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.abrupt("return",se.request("POST",G,Y,$));case 1:case"end":return te.stop()}},C)}))()}}var ne=j.scope("Network");class be{constructor(G,Y){this.config=G,this.transport=Y}backoffConfig(){return Object.assign(le.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var G,Y;return(G=(Y=this.config.retryWhenThrottledOverride)!==null&&Y!==void 0?Y:le.retryWhenThrottledDefault)!==null&&G!==void 0?G:!1}executeWithRetry(G,Y){var $=this;return d.default(_.default.mark(function C(){return _.default.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.abrupt("return",new Promise((Ae,De)=>{var de=[502,503,504];Y&&de.push(429);var $e=new s.Retrier($.backoffConfig());$e.on("attempt",d.default(_.default.mark(function E(){var T;return _.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.prev=0,re.next=3,G();case 3:T=re.sent,$e.succeeded(T),re.next=10;break;case 7:re.prev=7,re.t0=re.catch(0),de.indexOf(re.t0.status)>-1||re.t0.message==="Twilsock disconnected"?$e.failed(re.t0):($e.removeAllListeners(),$e.cancel(),De(re.t0));case 10:case"end":return re.stop()}},E,null,[[0,7]])}))),$e.on("succeeded",E=>{Ae(E)}),$e.on("cancelled",E=>De(E)),$e.on("failed",E=>De(E)),$e.start()}));case 1:case"end":return te.stop()}},C)}))()}get(G){var Y=this;return d.default(_.default.mark(function $(){var C,Z;return _.default.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return C={"X-Twilio-Token":Y.config.token},ne.trace("sending GET request to ",G," headers ",C),Ae.prev=2,Ae.next=5,Y.executeWithRetry(()=>Y.transport.get(G,C),Y.retryWhenThrottled());case 5:return Z=Ae.sent,ne.trace("response",Z),Ae.abrupt("return",Z);case 10:throw Ae.prev=10,Ae.t0=Ae.catch(2),ne.debug("get() error ".concat(Ae.t0)),Ae.t0;case 14:case"end":return Ae.stop()}},$,null,[[2,10]])}))()}post(G,Y,$,C,Z){var te=this;return d.default(_.default.mark(function Ae(){var De,de,$e;return _.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return De={"X-Twilio-Token":te.config.token},(typeof FormData>"u"||!($ instanceof FormData))&&C&&Object.assign(De,{"Content-Type":C}),de=new URL(G),Y&&de.searchParams.append("Category",Y),Z&&de.searchParams.append("Filename",Z),ne.trace("sending POST request to ".concat(G," with headers ").concat(De)),T.prev=6,T.next=9,te.transport.post(de.href,De,$);case 9:$e=T.sent,T.next=18;break;case 12:if(T.prev=12,T.t0=T.catch(6),!(t.XMLHttpRequest===void 0&&$ instanceof FormData)){T.next=16;break}throw new TypeError("Posting FormData supported only with browser engine's FormData");case 16:throw ne.debug("post() error ".concat(T.t0)),T.t0;case 18:return ne.trace("response",$e),T.abrupt("return",$e);case 20:case"end":return T.stop()}},Ae,null,[[6,12]])}))()}}var O="0.5.3",je,ft,Je=j.scope("");e.default=(ft=je=class{constructor(G,Y,$){var C,Z,te=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.options=te,this.options.logLevel=(C=this.options.logLevel)!==null&&C!==void 0?C:"silent",this.config=new le(G,Y,$,this.options),Je.setLevel(this.options.logLevel),this.options.transport=(Z=this.options.transport)!==null&&Z!==void 0?Z:new se,this.transport=this.options.transport,this.network=new be(this.config,this.transport)}updateToken(G){Je.info("updateToken"),this.config.updateToken(G)}get(G){var Y=this;return d.default(_.default.mark(function $(){var C;return _.default.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,Y.network.get("".concat(Y.config.mediaUrl,"/").concat(G));case 2:return C=te.sent,te.abrupt("return",new D(Y.config,Y.network,C.body));case 4:case"end":return te.stop()}},$)}))()}post(G,Y,$,C){var Z=this;return d.default(_.default.mark(function te(){var Ae;return _.default.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,Z.network.post(Z.config.mediaUrl,$!=null?$:"media",Y,G,C);case 2:return Ae=de.sent,de.abrupt("return",new D(Z.config,Z.network,Ae.body));case 4:case"end":return de.stop()}},te)}))()}postFormData(G,Y){var $=this;return d.default(_.default.mark(function C(){var Z;return _.default.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return Ae.next=2,$.network.post($.config.mediaUrl,Y!=null?Y:"media",G);case 2:return Z=Ae.sent,Ae.abrupt("return",new D($.config,$.network,Z.body));case 4:case"end":return Ae.stop()}},C)}))()}mediaSetGet(G){var Y=this;return d.default(_.default.mark(function $(){var C,Z;return _.default.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return C={command:"get",list:G.map(De=>({media_sid:De}))},Ae.next=3,Y.network.post("".concat(Y.config.mediaSetUrl),null,C,"application/json");case 3:return Z=Ae.sent,Ae.abrupt("return",Z.body.map(De=>{if(De.code!==200)throw new Error("Failed to obtain detailed information about Media items (failed SID ".concat(De.media_record.sid,")"));return new D(Y.config,Y.network,De.media_record)}));case 5:case"end":return Ae.stop()}},$)}))()}},y.default(je,"version",O),ft),k([o.validateTypes(o.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String]),N("design:returntype",void 0)],e.default.prototype,"updateToken",null),k([o.validateTypesAsync(o.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String]),N("design:returntype",Promise)],e.default.prototype,"get",null),e.default=k([o.validateConstructorTypes(o.nonEmptyString,o.nonEmptyString,[o.nonEmptyString,o.literal(null)],[o.pureObject,"undefined"]),N("design:paramtypes",[String,String,Object,Object])],e.default),e.Client=e.default,e.McsClient=e.default,e.McsMedia=D,e.Media=D,e.default=e.default})(rE);var WJ=ct,HJ=dt,GJ=W1,VJ=hf,Zg="ArrayBuffer",yS=GJ[Zg],zJ=HJ[Zg];WJ({global:!0,constructor:!0,forced:zJ!==yS},{ArrayBuffer:yS});VJ(Zg);var KJ=ct,TE=et,JJ=An,YJ=yr,mS=br,QJ=Pg,bS=fr,ey=nt,XJ=Dg,ZJ=rl,wS=TT,eY=ET,_S=Za,SS=CT,Wi=[],$S=TE(Wi.sort),tY=TE(Wi.push),rY=ey(function(){Wi.sort(void 0)}),nY=ey(function(){Wi.sort(null)}),iY=ZJ("sort"),EE=!ey(function(){if(_S)return _S<70;if(!(wS&&wS>3)){if(eY)return!0;if(SS)return SS<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)Wi.push({k:r+i,v:n})}for(Wi.sort(function(a,s){return s.v-a.v}),i=0;i<Wi.length;i++)r=Wi[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),aY=rY||!nY||!iY||!EE,sY=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:bS(t)>bS(r)?1:-1}};KJ({target:"Array",proto:!0,forced:aY},{sort:function(t){t!==void 0&&JJ(t);var r=YJ(this);if(EE)return t===void 0?$S(r):$S(r,t);var n=[],i=mS(r),a,s;for(s=0;s<i;s++)s in r&&tY(n,r[s]);for(XJ(n,sY(t)),a=mS(n),s=0;s<a;)r[s]=n[s++];for(;s<i;)QJ(r,s++);return r}});var oY=ct,uY=et,lY=nE,cY=Vn,kS=fr,fY=iE,dY=uY("".indexOf);oY({target:"String",proto:!0,forced:!fY("includes")},{includes:function(t){return!!~dY(kS(cY(this)),kS(lY(t)),arguments.length>1?arguments[1]:void 0)}});var pY=ct,hY=Gr.find,vY=rg,Kh="find",CE=!0;Kh in[]&&Array(1)[Kh](function(){CE=!1});pY({target:"Array",proto:!0,forced:CE},{find:function(t){return hY(this,t,arguments.length>1?arguments[1]:void 0)}});vY(Kh);/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2019, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes q under the following license.

    Copyright 20092014 Kristopher Michael Kowal. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

This software includes platform.js under the following license.

    Copyright 2014 Benjamin Tan <https://d10.github.io/>
    Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=go.exports,r=is.exports,n=sa.exports,i=oa.exports,a=ua.exports,s=zn.exports,o=ca.exports,u=fa.exports,c=nl,d=la.exports,y=bo.exports,_=ZB,b=ir,k=hg,N=_h.exports,P=il.exports,j=Si,F=If,me=jT,ce=xr,xe=rE,Ne=al.exports,Me=Rf;function x(I){return I&&typeof I=="object"&&"default"in I?I:{default:I}}function le(I){if(I&&I.__esModule)return I;var A=Object.create(null);return I&&Object.keys(I).forEach(function(m){if(m!=="default"){var v=Object.getOwnPropertyDescriptor(I,m);Object.defineProperty(A,m,v.get?v:{enumerable:!0,get:function(){return I[m]}})}}),A.default=I,Object.freeze(A)}var D=x(t),Re=x(r),Ie=x(n),ue=x(i),ee=x(a),se=x(s),ne=x(o),be=x(u),O=x(c),je=x(d),ft=le(y),Je=x(N),fe=x(P),G=x(Ne);function Y(I,A,m,v){var l=arguments.length,p=l<3?A:v===null?v=Object.getOwnPropertyDescriptor(A,m):v,f;if((typeof Reflect>"u"?"undefined":je.default(Reflect))==="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(I,A,m,v);else for(var g=I.length-1;g>=0;g--)(f=I[g])&&(p=(l<3?f(p):l>3?f(A,m,p):f(A,m))||p);return l>3&&p&&Object.defineProperty(A,m,p),p}function $(I,A){if((typeof Reflect>"u"?"undefined":je.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,A)}function C(I,A){return["".concat(new Date().toISOString()," Conversations ").concat(I,":")].concat(Array.from(A))}var Z=ft.getLogger("twilio-conversations"),te=function(){function I(A){be.default(this,I),ne.default(this,"prefix",""),this.prefix=A!=null&&A.length>0?A+" ":""}return Re.default(I,[{key:"setLevel",value:function(m){Z.setLevel(m)}},{key:"trace",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.trace.apply(null,C(this.prefix+"T",v))}},{key:"debug",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.debug.apply(null,C(this.prefix+"D",v))}},{key:"info",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.info.apply(null,C(this.prefix+"I",v))}},{key:"warn",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.warn.apply(null,C(this.prefix+"W",v))}},{key:"error",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.error.apply(null,C(this.prefix+"E",v))}}],[{key:"scope",value:function(m){return new I(m)}},{key:"setLevel",value:function(m){Z.setLevel(m)}},{key:"trace",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.trace.apply(null,C("T",v))}},{key:"debug",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.debug.apply(null,C("D",v))}},{key:"info",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.info.apply(null,C("I",v))}},{key:"warn",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.warn.apply(null,C("W",v))}},{key:"error",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.error.apply(null,C("E",v))}}]),I}();function Ae(I,A){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);A&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function De(I){for(var A=1;A<arguments.length;A++){var m=arguments[A]!=null?arguments[A]:{};A%2?Ae(Object(m),!0).forEach(function(v){ne.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):Ae(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}var de=5,$e="PT5S",E="PT5S",T=100,V=1e3,re=4e3,W=3,ke=!0,he=function I(){var A,m,v,l,p,f,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=arguments.length>1?arguments[1]:void 0,w=arguments.length>2?arguments[2]:void 0;be.default(this,I),ne.default(this,"typingIndicatorTimeoutDefault",de*1e3);var S=g.Chat||g.IPMessaging||g||{};this.productId=S.productId,this.links={myConversations:h.links.my_conversations,conversations:h.links.conversations,users:h.links.users,currentUser:h.links.current_user,typing:h.links.typing,mediaService:h.links.media_service,mediaSetService:h.links.media_set_service,messagesReceipts:h.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:h.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:h.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:h.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedMimeTypes:h.options.email_histories_allowed_mime_types,emailBodiesAllowedMimeTypes:h.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=S.typingIndicatorTimeoutOverride,this.backoffConfiguration=De({min:V,max:re,maxAttemptsCount:W},S.backoffConfigOverride),this.retryWhenThrottled=S.retryWhenThrottledOverride!==void 0?S.retryWhenThrottledOverride:ke,this.userInfosToSubscribe=(A=(m=S.userInfosToSubscribeOverride)!==null&&m!==void 0?m:h.options.user_infos_to_subscribe)!==null&&A!==void 0?A:T,this.reachabilityEnabled=h.options.reachability_enabled,this.userIdentity=h.identity,this.userInfo=h.sync_objects.my_user_info,this.myConversations=h.sync_objects.my_conversations;var L=(v=(l=S.httpCacheIntervalOverride)!==null&&l!==void 0?l:h.options.http_cache_interval)!==null&&v!==void 0?v:$e;try{this.httpCacheInterval=_.toSeconds(_.parse(L))}catch{w.error("Failed to parse http cache interval ".concat(L,", using default value ").concat($e)),this.httpCacheInterval=_.toSeconds(_.parse($e))}var U=(p=(f=S.consumptionReportIntervalOverride)!==null&&f!==void 0?f:h.options.consumption_report_interval)!==null&&p!==void 0?p:E;try{this.consumptionReportInterval=_.toSeconds(_.parse(U))}catch{w.error("Failed to parse consumption report interval ".concat(U,", using default value ").concat(E)),this.consumptionReportInterval=_.toSeconds(_.parse(E))}};function we(I){return JSON.parse(JSON.stringify(I))}function Oe(I){return typeof I<"u"&&!isNaN(Number(I))?Number(I):null}function z(I){try{return new Date(I)}catch{return null}}function Ue(I,A,m){var v={};if(I)try{v=JSON.parse(I)}catch(l){m.warn(A,l)}return v}var ae=function(){function I(A){be.default(this,I),this.base=A.replace(/\/$/,""),this.args=[],this.paths=[]}return Re.default(I,[{key:"arg",value:function(m,v){return typeof v<"u"&&this.args.push(encodeURIComponent(m)+"="+encodeURIComponent(v)),this}},{key:"path",value:function(m){return this.paths.push(encodeURIComponent(m)),this}},{key:"build",value:function(){var m=this.base;return this.paths.length&&(m+="/"+this.paths.join("/")),this.args.length&&(m+="?"+this.args.join("&")),m}}]),I}(),q=b.custom(function(I){return[["string","number","boolean","object"].includes(je.default(I)),"a JSON type"]}),Ce=b.custom(function(I){return[["undefined","string","number","boolean","object"].includes(je.default(I)),"an optional JSON type"]});function B(I){var A=Se();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Se(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ge=te.scope("User"),tt=function(I){ue.default(m,I);var A=B(m);function m(v,l,p,f){var g;return be.default(this,m),g=A.call(this),ne.default(Ie.default(g),"promiseToFetch",null),ne.default(Ie.default(g),"updated","updated"),ne.default(Ie.default(g),"userSubscribed","userSubscribed"),ne.default(Ie.default(g),"userUnsubscribed","userUnsubscribed"),g.services=f,g.subscribed="initializing",g.setMaxListeners(0),g.state={identity:v,entityName:l,friendlyName:null,attributes:{},online:null,notifiable:null},g._initializationPromise=new Promise(function(h){g._resolveInitializationPromise=h}),p!==null&&g._resolveInitialization(p,v,l,!1),g}return Re.default(m,[{key:"identity",get:function(){return this.state.identity},set:function(l){this.state.identity=l}},{key:"entityName",set:function(l){this.state.entityName=l}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return this.subscribed=="subscribed"}},{key:"_update",value:function(){var v=D.default(O.default.mark(function p(f,g){var h,w;return O.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this._initializationPromise;case 2:h=[],Ge.debug("User for",this.state.identity,"updated:",f,g),L.t0=f,L.next=L.t0==="friendlyName"?7:L.t0==="attributes"?9:L.t0==="reachability"?12:15;break;case 7:return this.state.friendlyName!==g.value&&(h.push("friendlyName"),this.state.friendlyName=g.value),L.abrupt("break",16);case 9:return w=Ue(g.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),Ge),Je.default(this.state.attributes,w)||(this.state.attributes=w,h.push("attributes")),L.abrupt("break",16);case 12:return this.state.online!==g.online&&(this.state.online=g.online,h.push("reachabilityOnline")),this.state.notifiable!==g.notifiable&&(this.state.notifiable=g.notifiable,h.push("reachabilityNotifiable")),L.abrupt("break",16);case 15:return L.abrupt("return");case 16:h.length>0&&this.emit("updated",{user:this,updateReasons:h});case 17:case"end":return L.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_updateReachabilityInfo",value:function(){var v=D.default(O.default.mark(function p(f,g){var h=this;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){S.next=4;break}return S.abrupt("return",Promise.resolve());case 4:return S.abrupt("return",f.get("reachability").then(g).catch(function(L){Ge.warn("Failed to get reachability info for ",h.state.identity,L)}));case 5:case"end":return S.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_fetch",value:function(){var v=D.default(O.default.mark(function p(){var f=this;return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.state.entityName){h.next=4;break}return h.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then(function(w){return f.entity=w,w.on("itemUpdated",function(S){return Ge.debug(f.state.entityName+" ("+f.state.identity+") itemUpdated: "+S.item.key),f._update(S.item.key,S.item.data)}),Promise.all([w.get("friendlyName").then(function(S){return f._update(S.key,S.data)}),w.get("attributes").then(function(S){return f._update(S.key,S.data)}),f._updateReachabilityInfo(w,function(S){return f._update(S.key,S.data)})])}).then(function(){return Ge.debug("Fetched for",f.identity),f.subscribed="subscribed",f.emit("userSubscribed",f),f}).catch(function(w){throw f.promiseToFetch=null,w}),h.abrupt("return",this.promiseToFetch);case 6:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_ensureFetched",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._initializationPromise;case 2:return g.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){h.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return h.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(f)});case 6:return h.abrupt("return",this);case 7:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateFriendlyName",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){h.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return h.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:f});case 6:return h.abrupt("return",this);case 7:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"unsubscribe",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){g.next=9;break}return g.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_resolveInitialization",value:function(l,p,f,g){this.configuration=l,this.identity=p,this.entityName=f,this.links={self:"".concat(this.configuration.links.users,"/").concat(this.identity)},this._resolveInitializationPromise(),g&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),m}(k.ReplayEventEmitter);Y([b.validateTypesAsync(q),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],tt.prototype,"updateAttributes",null),Y([b.validateTypesAsync(["string"]),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],tt.prototype,"updateFriendlyName",null);function tr(I,A){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=wr(I))||A&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function wr(I,A){if(!!I){if(typeof I=="string")return hn(I,A);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return hn(I,A)}}function hn(I,A){(A==null||A>I.length)&&(A=I.length);for(var m=0,v=new Array(A);m<A;m++)v[m]=I[m];return v}var Ir=function(){function I(A,m){be.default(this,I),this.configuration=A,this.services=m,this.cache=new Map,this.cacheLifetime=this.configuration.httpCacheInterval*100,this.cleanupCache()}return Re.default(I,[{key:"isExpired",value:function(m){return!this.cacheLifetime||Date.now()-m>this.cacheLifetime}},{key:"cleanupCache",value:function(){var m=tr(this.cache),v;try{for(m.s();!(v=m.n()).done;){var l=fe.default(v.value,2),p=l[0],f=l[1];this.isExpired(f.timestamp)&&this.cache.delete(p)}}catch(g){m.e(g)}finally{m.f()}this.cache.size===0&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var m=this;this.timer=this.timer||setInterval(function(){return m.cleanupCache()},this.cacheLifetime*2)}},{key:"executeWithRetry",value:function(m){var v=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise(function(p,f){var g=[502,503,504];l&&g.push(429);var h=new j.Retrier(v.configuration.backoffConfiguration);h.on("attempt",function(){m().then(function(w){return h.succeeded(w)}).catch(function(w){g.indexOf(w.status)>-1||w.message==="Twilsock disconnected"?h.failed(w):(h.removeAllListeners(),h.cancel(),f(w))})}),h.on("succeeded",function(w){p(w)}),h.on("cancelled",function(w){return f(w)}),h.on("failed",function(w){return f(w)}),h.start()})}},{key:"get",value:function(){var A=D.default(O.default.mark(function v(l){var p=this,f,g,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=this.cache.get(l),!(f&&!this.isExpired(f.timestamp))){S.next=3;break}return S.abrupt("return",f.response);case 3:return g={},S.next=6,this.executeWithRetry(function(){return p.services.transport.get(l,g,p.configuration.productId)},this.configuration.retryWhenThrottled);case 6:return h=S.sent,this.cache.set(l,{response:h,timestamp:Date.now()}),this.pokeTimer(),S.abrupt("return",h);case 10:case"end":return S.stop()}},v,this)}));function m(v){return A.apply(this,arguments)}return m}()}]),I}(),mt=function I(){be.default(this,I)};ne.default(mt,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),ne.default(mt,"NEW_MESSAGE","twilio.conversations.new_message"),ne.default(mt,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),ne.default(mt,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),ne.default(mt,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");function Ut(I){var A=oe();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function oe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pe=te.scope("Participant"),Q=function(I){ue.default(m,I);var A=Ut(m);function m(v,l,p,f,g){var h,w,S;if(be.default(this,m),S=A.call(this),S.conversation=p,S.links=f,S.services=g,S.state={attributes:Ue(v.attributes,"Retrieved malformed attributes from the server for participant: "+l,pe),dateCreated:v.dateCreated?z(v.dateCreated):null,dateUpdated:v.dateCreated?z(v.dateUpdated):null,sid:l,typingTimeout:null,isTyping:!1,identity:v.identity,roleSid:(h=v.roleSid)!==null&&h!==void 0?h:"",lastReadMessageIndex:Number.isInteger(v.lastConsumedMessageIndex)?v.lastConsumedMessageIndex:null,lastReadTimestamp:v.lastConsumptionTimestamp?z(v.lastConsumptionTimestamp):null,type:v.type||"chat",userInfo:v.userInfo,bindings:(w=v.bindings)!==null&&w!==void 0?w:{}},!v.identity&&!v.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return S}return Re.default(m,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var l;return(l=this.state.bindings)!==null&&l!==void 0?l:{}}},{key:"_startTyping",value:function(l){var p=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout(function(){return p._endTyping()},l)),this}},{key:"_endTyping",value:function(){!this.state.typingTimeout||(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(l){var p=[],f=Ue(l.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,pe);l.attributes&&!Je.default(this.state.attributes,f)&&(this.state.attributes=f,p.push("attributes"));var g=z(l.dateUpdated);l.dateUpdated&&(g==null?void 0:g.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=g,p.push("dateUpdated"));var h=z(l.dateCreated);if(l.dateCreated&&(h==null?void 0:h.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=h,p.push("dateCreated")),l.roleSid&&this.state.roleSid!==l.roleSid&&(this.state.roleSid=l.roleSid,p.push("roleSid")),(Number.isInteger(l.lastConsumedMessageIndex)||l.lastConsumedMessageIndex===null)&&this.state.lastReadMessageIndex!==l.lastConsumedMessageIndex&&(this.state.lastReadMessageIndex=l.lastConsumedMessageIndex,p.push("lastReadMessageIndex")),l.lastConsumptionTimestamp){var w=new Date(l.lastConsumptionTimestamp);(!this.state.lastReadTimestamp||this.state.lastReadTimestamp.getTime()!==w.getTime())&&(this.state.lastReadTimestamp=w,p.push("lastReadTimestamp"))}return l.bindings&&!Je.default(this.state.bindings,l.bindings)&&(this.state.bindings=l.bindings,p.push("bindings")),p.length>0&&this.emit("updated",{participant:this,updateReasons:p}),this}},{key:"getUser",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.type=="chat"){g.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return g.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"remove",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(f)});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter);ne.default(Q,"typingStarted","typingStarted"),ne.default(Q,"typingEnded","typingEnded"),ne.default(Q,"updated","updated"),Y([b.validateTypesAsync(q),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],Q.prototype,"updateAttributes",null);function ie(I){var A=X();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ye=te.scope("Participants"),Te=function(I){ue.default(m,I);var A=ie(m);function m(v,l,p,f,g){var h;return be.default(this,m),h=A.call(this),ne.default(Ie.default(h),"rosterEntityPromise",null),h.conversation=v,h.participants=l,h.links=p,h.configuration=f,h.services=g,h}return Re.default(m,[{key:"unsubscribe",value:function(){var v=D.default(O.default.mark(function p(){var f;return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!this.rosterEntityPromise){h.next=6;break}return h.next=3,this.rosterEntityPromise;case 3:f=h.sent,f.close(),this.rosterEntityPromise=null;case 6:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"subscribe",value:function(l){var p=this;return this.rosterEntityPromise=this.rosterEntityPromise||this.services.syncClient.map({id:l,mode:"open_existing"}).then(function(f){f.on("itemAdded",function(w){ye.debug(p.conversation.sid+" itemAdded: "+w.item.key),p.upsertParticipant(w.item.key,w.item.data).then(function(S){p.emit("participantJoined",S)})}),f.on("itemRemoved",function(w){ye.debug(p.conversation.sid+" itemRemoved: "+w.key);var S=w.key;if(!!p.participants.has(S)){var L=p.participants.get(S);p.participants.delete(S),L&&p.emit("participantLeft",L)}}),f.on("itemUpdated",function(w){ye.debug(p.conversation.sid+" itemUpdated: "+w.item.key),p.upsertParticipant(w.item.key,w.item.data)});var g=[],h=function w(S){return S.items.forEach(function(L){g.push(p.upsertParticipant(L.key,L.data))}),S.hasNextPage?S.nextPage().then(w):null};return f.getItems().then(h).then(function(){return Promise.all(g)}).then(function(){return f})}).catch(function(f){throw p.rosterEntityPromise=null,p.services.syncClient.connectionState!="disconnected"&&ye.error("Failed to get roster object for conversation",p.conversation.sid,f),ye.debug("ERROR: Failed to get roster object for conversation",p.conversation.sid,f),f})}},{key:"upsertParticipant",value:function(){var v=D.default(O.default.mark(function p(f,g){var h=this,w,S;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(w=this.participants.get(f),!w){U.next=3;break}return U.abrupt("return",w._update(g));case 3:return S={self:"".concat(this.links.participants,"/").concat(f)},w=new Q(g,f,this.conversation,S,this.services),this.participants.set(f,w),w.on("updated",function(K){return h.emit("participantUpdated",K)}),U.abrupt("return",w);case 8:case"end":return U.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"getParticipants",value:function(){var v=D.default(O.default.mark(function p(){var f=this;return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var w=[];return f.participants.forEach(function(S){return w.push(S)}),w}):[]);case 1:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantBySid",value:function(){var v=D.default(O.default.mark(function p(f){var g=this;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var S=g.participants.get(f);if(!S)throw new Error("Participant with SID "+f+" was not found");return S}):null);case 1:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getParticipantByIdentity",value:function(){var v=D.default(O.default.mark(function p(f){var g=this,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return h=null,S.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){if(g.participants.forEach(function(L){L.identity===f&&(h=L)}),!h)throw new Error("Participant with identity "+f+" was not found");return h}):null);case 2:case"end":return S.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"add",value:function(){var v=D.default(O.default.mark(function p(f,g){return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:f,attributes:typeof g<"u"?JSON.stringify(g):void 0});case 2:return w.abrupt("return",w.sent);case 3:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"addNonChatParticipant",value:function(l,p){var f,g,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:typeof h<"u"?JSON.stringify(h):void 0,messaging_binding:{address:p,proxy_address:l,name:w==null||(f=w.email)===null||f===void 0?void 0:f.name,level:w==null||(g=w.email)===null||g===void 0?void 0:g.level}})}},{key:"remove",value:function(l){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(l))}}]),m}(k.ReplayEventEmitter),Le=function(){function I(A,m){be.default(this,I),ne.default(this,"mcsMedia",null),this.services=m,A instanceof xe.McsMedia&&(this.mcsMedia=A),this.state={sid:A.sid,category:A.category,filename:A.filename,contentType:A.contentType,size:A.size}}return Re.default(I,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:function(){var A=D.default(O.default.mark(function v(){var l,p;return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._fetchMcsMedia();case 2:return g.abrupt("return",(l=(p=this.mcsMedia)===null||p===void 0?void 0:p.getContentUrl())!==null&&l!==void 0?l:null);case 3:case"end":return g.stop()}},v,this)}));function m(){return A.apply(this,arguments)}return m}()},{key:"getCachedTemporaryUrl",value:function(){var A=D.default(O.default.mark(function v(){var l,p;return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._fetchMcsMedia();case 2:return g.abrupt("return",(l=(p=this.mcsMedia)===null||p===void 0?void 0:p.getCachedContentUrl())!==null&&l!==void 0?l:null);case 3:case"end":return g.stop()}},v,this)}));function m(){return A.apply(this,arguments)}return m}()},{key:"_fetchMcsMedia",value:function(){var A=D.default(O.default.mark(function v(){return O.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.mcsMedia){p.next=8;break}if(!this.services.mcsClient){p.next=7;break}return p.next=4,this.services.mcsClient.get(this.state.sid);case 4:this.mcsMedia=p.sent,p.next=8;break;case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return p.stop()}},v,this)}));function m(){return A.apply(this,arguments)}return m}()}]),I}(),Xe=function(){function I(A){be.default(this,I),this.state=A}return Re.default(I,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(m){this.state=m}},{key:"_isEquals",value:function(m){var v=this.total===m.total,l=this.sent===m.sent,p=this.delivered===m.delivered,f=this.read===m.read,g=this.undelivered===m.undelivered,h=this.failed===m.failed;return v&&l&&p&&f&&g&&h}}]),I}(),st=function(){function I(A,m,v,l){be.default(this,I),this.state={prevToken:v,nextToken:l,source:m,items:A}}return Re.default(I,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),I}(),rt=function I(A){be.default(this,I),this.sid=A.sid,this.messageSid=A.message_sid,this.conversationSid=A.conversation_sid,this.channelMessageSid=A.channel_message_sid,this.participantSid=A.participant_sid,this.status=A.status||"queued",this.errorCode=A.error_code||0,this.dateCreated=A.date_created,this.dateUpdated=A.date_updated};function Fe(I){var A=_r();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function _r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Qe=te.scope("Message"),Ht=function(I){ue.default(m,I);var A=Fe(m);function m(v,l,p,f,g,h){var w,S,L,U,K;return be.default(this,m),K=A.call(this),K.conversation=p,K.links=f,K.configuration=g,K.services=h,K.state={sid:l.sid,index:v,author:l.author,subject:l.subject,body:(w=l.text)!==null&&w!==void 0?w:null,timestamp:l.timestamp?new Date(l.timestamp):null,dateUpdated:l.dateUpdated?new Date(l.dateUpdated):null,lastUpdatedBy:(S=l.lastUpdatedBy)!==null&&S!==void 0?S:null,attributes:Ue(l.attributes,"Got malformed attributes for the message ".concat(l.sid),Qe),type:(L=l.type)!==null&&L!==void 0?L:"text",media:l.type&&l.type==="media"&&l.media?new Le(l.media,K.services):null,medias:l.type&&l.type==="media"&&l.medias?l.medias.map(function(ge){return new Le(ge,K.services)}):null,participantSid:(U=l.memberSid)!==null&&U!==void 0?U:null,aggregatedDeliveryReceipt:l.delivery?new Xe(l.delivery):null},K}return Re.default(m,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategory(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(l){var p;return((p=this.state.medias)!==null&&p!==void 0?p:[]).filter(function(f){return l.includes(f.category)})}},{key:"getEmailBody",value:function(){var l,p,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(l=(p=this.getMediaByCategory(["body"]))===null||p===void 0?void 0:p.filter(function(g){return g.contentType==f}).shift())!==null&&l!==void 0?l:null}},{key:"getEmailHistory",value:function(){var l,p,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(l=(p=this.getMediaByCategory(["history"]))===null||p===void 0?void 0:p.filter(function(g){return g.contentType==f}).shift())!==null&&l!==void 0?l:null}},{key:"_update",value:function(l){var p=[];(l.text||typeof l.text=="string")&&l.text!==this.state.body&&(this.state.body=l.text,p.push("body")),l.subject&&l.subject!==this.state.subject&&(this.state.subject=l.subject,p.push("subject")),l.lastUpdatedBy&&l.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=l.lastUpdatedBy,p.push("lastUpdatedBy")),l.author&&l.author!==this.state.author&&(this.state.author=l.author,p.push("author")),l.dateUpdated&&new Date(l.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(l.dateUpdated),p.push("dateUpdated")),l.timestamp&&new Date(l.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(l.timestamp),p.push("dateCreated"));var f=Ue(l.attributes,"Got malformed attributes for the message ".concat(this.sid),Qe);Je.default(this.state.attributes,f)||(this.state.attributes=f,p.push("attributes"));var g=l.delivery,h=this.state.aggregatedDeliveryReceipt,w=!!g&&!!g.total&&!!g.delivered&&!!g.failed&&!!g.read&&!!g.sent&&!!g.undelivered;w&&(h?h._isEquals(g)||(h._update(g),p.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new Xe(g),p.push("deliveryReceipt"))),p.length>0&&this.emit("updated",{message:this,updateReasons:p})}},{key:"getParticipant",value:function(){var v=D.default(O.default.mark(function p(){var f=this,g,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(g=null,!this.state.participantSid){S.next=5;break}return S.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch(function(){return Qe.debug('Participant with sid "'.concat(f.participantSid,'" not found for message ').concat(f.sid)),null});case 4:g=S.sent;case 5:if(!(!g&&this.state.author)){S.next=9;break}return S.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch(function(){return Qe.debug('Participant with identity "'.concat(f.author,'" not found for message ').concat(f.sid)),null});case 8:g=S.sent;case 9:if(!g){S.next=11;break}return S.abrupt("return",g);case 11:throw h="Participant with ",this.state.participantSid&&(h+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(h+="or "),h+="identity '"+this.state.author+"' "),h==="Participant with "&&(h="Participant "),h+="was not found",new Error(h);case 17:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getDetailedDeliveryReceipts",value:function(){var v=D.default(O.default.mark(function p(){var f,g;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:f=w.sent,g=[];case 4:if(g=[].concat(G.default(g),G.default(f.items)),f.hasNextPage){w.next=8;break}return w.abrupt("break",13);case 8:return w.next=10,f.nextPage();case 10:f=w.sent,w.next=4;break;case 13:return w.abrupt("return",g);case 14:case"end":return w.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"remove",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateBody",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:f});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:typeof f<"u"?JSON.stringify(f):void 0});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"attachTemporaryUrlsFor",value:function(){var v=D.default(O.default.mark(function p(f){var g=this,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(h=f==null?void 0:f.map(function(L){return L.sid}),!(this.services.mcsClient&&h)){S.next=7;break}return S.next=4,this.services.mcsClient.mediaSetGet(h);case 4:return S.abrupt("return",S.sent.map(function(L){return new Le(L,g.services)}));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return S.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"_getDetailedDeliveryReceiptsPaginator",value:function(){var v=D.default(O.default.mark(function p(f){var g=this,h,w,S;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return h=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),w=new ae(h).arg("PageToken",f==null?void 0:f.pageToken).arg("PageSize",f==null?void 0:f.pageSize).build(),U.next=4,this.services.network.get(w);case 4:return S=U.sent,U.abrupt("return",new st(S.body.delivery_receipts.map(function(K){return new rt(K)}),function(K,ge){return g._getDetailedDeliveryReceiptsPaginator({pageToken:K,pageSize:ge})},S.body.meta.previous_token,S.body.meta.next_token));case 6:case"end":return U.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter);ne.default(Ht,"updated","updated"),Y([b.validateTypes([b.nonEmptyString,"undefined"]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Le)],Ht.prototype,"getEmailBody",null),Y([b.validateTypes([b.nonEmptyString,"undefined"]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Le)],Ht.prototype,"getEmailHistory",null),Y([b.validateTypesAsync("string"),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],Ht.prototype,"updateBody",null),Y([b.validateTypesAsync(q),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],Ht.prototype,"updateAttributes",null),Y([b.validateTypesAsync(b.custom(function(I){return[I instanceof Array&&I.length>0&&I.reduce(function(A,m){return A&&m instanceof Le},!0),"a non-empty array of Media"]})),$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",Promise)],Ht.prototype,"attachTemporaryUrlsFor",null);function Dt(I,A){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=$i(I))||A&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function $i(I,A){if(!!I){if(typeof I=="string")return Kn(I,A);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Kn(I,A)}}function Kn(I,A){(A==null||A>I.length)&&(A=I.length);for(var m=0,v=new Array(A);m<A;m++)v[m]=I[m];return v}function Pn(I){var A=Ct();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Ct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ft=te.scope("Messages"),Lr=function(I){ue.default(m,I);var A=Pn(m);function m(v,l,p){var f;return be.default(this,m),f=A.call(this),f.conversation=v,f.configuration=l,f.services=p,f.messagesByIndex=new Map,f.messagesListPromise=null,f}return Re.default(m,[{key:"subscribe",value:function(){var v=D.default(O.default.mark(function p(f){var g=this,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!this.messagesListPromise){S.next=2;break}return S.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=this.services.syncClient.list({id:f,mode:"open_existing"}),S.prev=3,S.next=6,this.messagesListPromise;case 6:return h=S.sent,h.on("itemAdded",function(L){Ft.debug("".concat(g.conversation.sid," itemAdded: ").concat(L.item.index));var U={self:"".concat(g.conversation.links.messages,"/").concat(L.item.data.sid),conversation:g.conversation.links.self,messages_receipts:"".concat(g.conversation.links.messages,"/").concat(L.item.data.sid,"/Receipts")},K=new Ht(L.item.index,L.item.data,g.conversation,U,g.configuration,g.services);if(g.messagesByIndex.has(K.index)){Ft.debug("Message arrived, but is already known and ignored",g.conversation.sid,K.index);return}g.messagesByIndex.set(K.index,K),K.on("updated",function(ge){return g.emit("messageUpdated",ge)}),g.emit("messageAdded",K)}),h.on("itemRemoved",function(L){Ft.debug("#{this.conversation.sid} itemRemoved: ".concat(L.index));var U=L.index;if(g.messagesByIndex.has(U)){var K=g.messagesByIndex.get(U);if(!K)return;g.messagesByIndex.delete(K.index),K.removeAllListeners("updated"),g.emit("messageRemoved",K)}}),h.on("itemUpdated",function(L){Ft.debug("".concat(g.conversation.sid," itemUpdated: ").concat(L.item.index));var U=g.messagesByIndex.get(L.item.index);U&&U._update(L.item.data)}),S.abrupt("return",h);case 13:throw S.prev=13,S.t0=S.catch(3),this.messagesListPromise=null,this.services.syncClient.connectionState!=="disconnected"&&Ft.error("Failed to get messages object for conversation",this.conversation.sid,S.t0),Ft.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,S.t0),S.t0;case 19:case"end":return S.stop()}},p,this,[[3,13]])}));function l(p){return v.apply(this,arguments)}return l}()},{key:"unsubscribe",value:function(){var v=D.default(O.default.mark(function p(){var f;return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.messagesListPromise){h.next=2;break}return h.abrupt("return");case 2:return h.next=4,this.messagesListPromise;case 4:f=h.sent,f.close(),this.messagesListPromise=null;case 7:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"sendV2",value:function(){var v=D.default(O.default.mark(function p(f){var g,h,w,S,L,U,K,ge,We;return O.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:Ft.debug("Sending message V2",f.mediaContent,f.attributes,f.emailOptions),h=[],w=Dt(f.mediaContent),Ve.prev=3,w.s();case 5:if((S=w.n()).done){Ve.next=22;break}if(K=fe.default(S.value,2),ge=K[0],We=K[1],Ft.debug("Adding media to a message as ".concat(We instanceof FormData?"FormData":"SendMediaOptions"),We),Ve.t0=h,!(We instanceof FormData)){Ve.next=15;break}return Ve.next=12,this.services.mcsClient.postFormData(We,ge);case 12:Ve.t1=Ve.sent,Ve.next=18;break;case 15:return Ve.next=17,this.services.mcsClient.post((L=We.contentType)!==null&&L!==void 0?L:"",(U=We.media)!==null&&U!==void 0?U:"",ge,We.filename);case 17:Ve.t1=Ve.sent;case 18:Ve.t2=Ve.t1,Ve.t0.push.call(Ve.t0,Ve.t2);case 20:Ve.next=5;break;case 22:Ve.next=27;break;case 24:Ve.prev=24,Ve.t3=Ve.catch(3),w.e(Ve.t3);case 27:return Ve.prev=27,w.f(),Ve.finish(27);case 30:return Ve.next=32,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:f.text,subject:(g=f.emailOptions)===null||g===void 0?void 0:g.subject,media_sids:h.map(function(ot){return ot.sid}),attributes:typeof f.attributes<"u"?JSON.stringify(f.attributes):void 0});case 32:return Ve.abrupt("return",Ve.sent);case 33:case"end":return Ve.stop()}},p,this,[[3,24,27,30]])}));function l(p){return v.apply(this,arguments)}return l}()},{key:"send",value:function(){var v=D.default(O.default.mark(function p(f){var g,h,w=arguments;return O.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return g=w.length>1&&w[1]!==void 0?w[1]:{},h=w.length>2?w[2]:void 0,Ft.debug("Sending text message",f,g,h),L.next=5,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:f!=null?f:"",attributes:typeof g<"u"?JSON.stringify(g):void 0,subject:h==null?void 0:h.subject});case 5:return L.abrupt("return",L.sent);case 6:case"end":return L.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"sendMedia",value:function(){var v=D.default(O.default.mark(function p(f){var g,h,w,S,L,U=arguments;return O.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(w=U.length>1&&U[1]!==void 0?U[1]:{},S=U.length>2?U[2]:void 0,Ft.debug("Sending media message",f,w,S),Ft.debug("Sending media message as ".concat(f instanceof FormData?"FormData":"SendMediaOptions"),f,w),!(f instanceof FormData)){ge.next=10;break}return ge.next=7,this.services.mcsClient.postFormData(f);case 7:ge.t0=ge.sent,ge.next=13;break;case 10:return ge.next=12,this.services.mcsClient.post((g=f.contentType)!==null&&g!==void 0?g:"",(h=f.media)!==null&&h!==void 0?h:"","media",f.filename);case 12:ge.t0=ge.sent;case 13:return L=ge.t0,ge.next=16,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{media_sids:[L.sid],attributes:typeof w<"u"?JSON.stringify(w):void 0});case 16:return ge.abrupt("return",ge.sent);case 17:case"end":return ge.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getMessages",value:function(){var v=D.default(O.default.mark(function p(f,g){var h,w=arguments;return O.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return h=w.length>2&&w[2]!==void 0?w[2]:"backwards",L.abrupt("return",this._getMessages(f,g,h));case 2:case"end":return L.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_wrapPaginator",value:function(l,p,f){var g=this,h=l==="desc",w=function(){return p.nextPage().then(function(U){return g._wrapPaginator(l,U,f)})},S=function(){return p.prevPage().then(function(U){return g._wrapPaginator(l,U,f)})};return f(p.items).then(function(L){return{items:L.sort(function(U,K){return U.index-K.index}),hasPrevPage:h?p.hasNextPage:p.hasPrevPage,hasNextPage:h?p.hasPrevPage:p.hasNextPage,prevPage:h?w:S,nextPage:h?S:w}})}},{key:"_upsertMessage",value:function(l,p){var f=this,g=this.messagesByIndex.get(l);if(g)return g;var h={self:"".concat(this.conversation.links.messages,"/").concat(p.sid),conversation:this.conversation.links.self,messages_receipts:"".concat(this.conversation.links.messages,"/").concat(p.sid,"/Receipts")},w=new Ht(l,p,this.conversation,h,this.configuration,this.services);return this.messagesByIndex.set(w.index,w),w.on("updated",function(S){return f.emit("messageUpdated",S)}),w}},{key:"_getMessages",value:function(){var v=D.default(O.default.mark(function p(){var f=this,g,h,w,S,L,U,K=arguments;return O.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return g=K.length>0&&K[0]!==void 0?K[0]:30,h=K.length>1&&K[1]!==void 0?K[1]:"end",w=K.length>2&&K[2]!==void 0?K[2]:"forward",S=w==="backwards"?"desc":"asc",We.next=6,this.messagesListPromise;case 6:return L=We.sent,We.next=9,L==null?void 0:L.getItems({from:h!=="end"?h:void 0,pageSize:g,order:S,limit:g});case 9:return U=We.sent,We.next=12,this._wrapPaginator(S,U,function(at){return Promise.all(at.map(function(Ve){return f._upsertMessage(Ve.index,Ve.data)}))});case 12:return We.abrupt("return",We.sent);case 13:case"end":return We.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter),Rr=function(){function I(A){be.default(this,I),ne.default(this,"attributes",{}),ne.default(this,"mediaContent",[]),ne.default(this,"emailOptions",{}),this.messagesEntity=A}return Re.default(I,[{key:"send",value:function(){var A=D.default(O.default.mark(function v(){var l;return O.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.messagesEntity.sendV2(this);case 2:return l=f.sent,f.abrupt("return",Oe(l.index));case 4:case"end":return f.stop()}},v,this)}));function m(){return A.apply(this,arguments)}return m}()}]),I}(),ha=function(){function I(A,m){be.default(this,I),this.limits=A,this.message=new Rr(m),this.emailBodies=new Map,this.emailHistories=new Map}return Re.default(I,[{key:"setBody",value:function(m){return this.message.text=m,this}},{key:"setSubject",value:function(m){return this.message.emailOptions.subject=m,this}},{key:"setAttributes",value:function(m){return this.message.attributes=m,this}},{key:"setEmailBody",value:function(m,v){return this.emailBodies.set(m,v),this}},{key:"setEmailHistory",value:function(m,v){return this.emailHistories.set(m,v),this}},{key:"addMedia",value:function(m){if(typeof FormData>"u"&&m instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(m instanceof FormData)){var v=m;if(!v.contentType||!v.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",m]),this}},{key:"build",value:function(){var m=this;if(this.emailBodies.forEach(function(v,l){if(!m.limits.emailBodiesAllowedMimeTypes.includes(l))throw new Error("Unsupported email body MIME type ".concat(l))}),this.emailHistories.forEach(function(v,l){if(!m.limits.emailHistoriesAllowedMimeTypes.includes(l))throw new Error("Unsupported email history MIME type ".concat(l))}),this.emailBodies.size>this.limits.emailBodiesAllowedMimeTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedMimeTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedMimeTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedMimeTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach(function(v){m.message.mediaContent.push(["body",v])}),this.emailHistories.forEach(function(v){m.message.mediaContent.push(["history",v])}),this.message}},{key:"getPayloadContentType",value:function(m){return typeof FormData<"u"&&m instanceof FormData?m.get("Content-Type"):m.contentType}}]),I}();function ls(I,A){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=jr(I))||A&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function jr(I,A){if(!!I){if(typeof I=="string")return cs(I,A);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return cs(I,A)}}function cs(I,A){(A==null||A>I.length)&&(A=I.length);for(var m=0,v=new Array(A);m<A;m++)v[m]=I[m];return v}function So(I){var A=$o();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function $o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dr=te.scope("Conversation"),vn={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"};function Kr(I){try{return new Date(I)}catch{return null}}var St=function(I){ue.default(m,I);var A=So(m);function m(v,l,p,f,g){var h,w;be.default(this,m),w=A.call(this),w.sid=l,w.links=p,w.configuration=f,w.services=g;var S=v.attributes||{},L=v.createdBy,U=Kr(v.dateCreated),K=Kr(v.dateUpdated),ge=v.friendlyName||null,We=Number.isInteger(v.lastConsumedMessageIndex)?v.lastConsumedMessageIndex:null,at=v.uniqueName||null;try{JSON.stringify(S)}catch{throw new Error("Attributes must be a valid JSON object.")}w.entityName=v.channel,w.channelState={uniqueName:at,status:"notParticipating",attributes:S,createdBy:L,dateCreated:U,dateUpdated:K,friendlyName:ge,lastReadMessageIndex:We,bindings:(h=v.bindings)!==null&&h!==void 0?h:{}},v.notificationLevel&&(w.channelState.notificationLevel=v.notificationLevel);var Ve={participants:w.links.participants};return w.participants=new Map,w.participantsEntity=new Te(Ie.default(w),w.participants,Ve,w.configuration,w.services),w.participantsEntity.on("participantJoined",function(ot){return w.emit("participantJoined",ot)}),w.participantsEntity.on("participantLeft",function(ot){return w.emit("participantLeft",ot)}),w.participantsEntity.on("participantUpdated",function(ot){return w.emit("participantUpdated",ot)}),w.messagesEntity=new Lr(Ie.default(w),f,g),w.messagesEntity.on("messageAdded",function(ot){return w._onMessageAdded(ot)}),w.messagesEntity.on("messageUpdated",function(ot){return w.emit("messageUpdated",ot)}),w.messagesEntity.on("messageRemoved",function(ot){return w.emit("messageRemoved",ot)}),w}return Re.default(m,[{key:"uniqueName",get:function(){return this.channelState.uniqueName}},{key:"status",get:function(){return this.channelState.status}},{key:"friendlyName",get:function(){return this.channelState.friendlyName}},{key:"dateUpdated",get:function(){return this.channelState.dateUpdated}},{key:"dateCreated",get:function(){return this.channelState.dateCreated}},{key:"createdBy",get:function(){var l;return(l=this.channelState.createdBy)!==null&&l!==void 0?l:""}},{key:"attributes",get:function(){return this.channelState.attributes}},{key:"lastReadMessageIndex",get:function(){return this.channelState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var l;return(l=this.channelState.lastMessage)!==null&&l!==void 0?l:void 0}},{key:"notificationLevel",get:function(){var l;return(l=this.channelState.notificationLevel)!==null&&l!==void 0?l:"default"}},{key:"bindings",get:function(){return this.channelState.bindings}},{key:"limits",get:function(){return this.configuration.limits}},{key:"state",get:function(){return this.channelState.state}},{key:"_subscribe",value:function(){var l,p=this;return this.entityPromise=(l=this.entityPromise)!==null&&l!==void 0?l:this.services.syncClient.document({id:this.entityName,mode:"open_existing"}).then(function(f){return p.entity=f,p.entity.on("updated",function(g){p._update(g.data)}),p.entity.on("removed",function(){return p.emit("removed",p)}),p._update(p.entity.data),f}).catch(function(f){throw p.entity=null,p.entityPromise=null,p.services.syncClient.connectionState!="disconnected"&&dr.error("Failed to get conversation object",f),dr.debug("ERROR: Failed to get conversation object",f),f})}},{key:"_subscribeStreams",value:function(){var v=D.default(O.default.mark(function p(){var f,g,h,w,S;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.prev=0,U.next=3,this._subscribe();case 3:return dr.trace("_subscribeStreams, this.entity.data=",(f=this.entity)===null||f===void 0?void 0:f.data),w=(g=this.entity)===null||g===void 0?void 0:g.data.messages,S=(h=this.entity)===null||h===void 0?void 0:h.data.roster,U.next=8,Promise.all([this.messagesEntity.subscribe(w),this.participantsEntity.subscribe(S)]);case 8:U.next=15;break;case 10:throw U.prev=10,U.t0=U.catch(0),this.services.syncClient.connectionState!=="disconnected"&&dr.error("Failed to subscribe on conversation objects",this.sid,U.t0),dr.debug("ERROR: Failed to subscribe on conversation objects",this.sid,U.t0),U.t0;case 15:case"end":return U.stop()}},p,this,[[0,10]])}));function l(){return v.apply(this,arguments)}return l}()},{key:"_unsubscribe",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.entity){g.next=5;break}return g.next=3,this.entity.close();case 3:this.entity=null,this.entityPromise=null;case 5:return g.abrupt("return",Promise.all([this.participantsEntity.unsubscribe(),this.messagesEntity.unsubscribe()]));case 6:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_setStatus",value:function(l,p){var f=this;this.statusSource=p,this.channelState.status!==l&&(this.channelState.status=l,l==="joined"?this._subscribeStreams().catch(function(g){if(dr.debug("ERROR while setting conversation status "+l,g),f.services.syncClient.connectionState!=="disconnected")throw g}):this.entityPromise&&this._unsubscribe().catch(function(g){if(dr.debug("ERROR while setting conversation status "+l,g),f.services.syncClient.connectionState!=="disconnected")throw g}))}},{key:"_statusSource",value:function(){return this.statusSource}},{key:"_update",value:function(l){var p,f,g,h,w;dr.trace("_update",l),m.preprocessUpdate(l,this.sid);for(var S=new Set,L=0,U=Object.keys(l);L<U.length;L++){var K=U[L],ge=vn[K];if(!!ge)switch(ge){case vn.status:if(!l.status||l.status==="unknown"||this.channelState.status===l.status)break;this.channelState.status=l.status,S.add(ge);break;case vn.attributes:if(Je.default(this.channelState.attributes,l.attributes))break;this.channelState.attributes=l.attributes,S.add(ge);break;case vn.lastConsumedMessageIndex:if(l.lastConsumedMessageIndex===void 0||l.lastConsumedMessageIndex===this.channelState.lastReadMessageIndex)break;this.channelState.lastReadMessageIndex=l.lastConsumedMessageIndex,S.add("lastReadMessageIndex");break;case vn.lastMessage:if(this.channelState.lastMessage&&!l.lastMessage){delete this.channelState.lastMessage,S.add(ge);break}this.channelState.lastMessage=this.channelState.lastMessage||{},((p=l.lastMessage)===null||p===void 0?void 0:p.index)!==void 0&&l.lastMessage.index!==this.channelState.lastMessage.index&&(this.channelState.lastMessage.index=l.lastMessage.index,S.add(ge)),((f=l.lastMessage)===null||f===void 0?void 0:f.timestamp)!==void 0&&((g=this.channelState.lastMessage)===null||g===void 0||(h=g.dateCreated)===null||h===void 0?void 0:h.getTime())!==l.lastMessage.timestamp.getTime()&&(this.channelState.lastMessage.dateCreated=l.lastMessage.timestamp,S.add(ge)),Je.default(this.channelState.lastMessage,{})&&delete this.channelState.lastMessage;break;case vn.state:var We=l.state||void 0;if(We!==void 0&&(We.dateUpdated=new Date(We.dateUpdated)),Je.default(this.channelState.state,We))break;this.channelState.state=We,S.add(ge);break;case vn.bindings:if(Je.default(this.channelState.bindings,l.bindings))break;this.channelState.bindings=l.bindings,S.add(ge);break;default:var at=l[K]instanceof Date,Ve=at&&((w=this.channelState[ge])===null||w===void 0?void 0:w.getTime())===l[K].getTime(),ot=!at&&this[ge]===l[K];if(Ve||ot)break;this.channelState[ge]=l[K],S.add(ge)}}S.size>0&&this.emit("updated",{conversation:this,updateReasons:G.default(S)})}},{key:"_onMessageAdded",value:function(l){var p=ls(this.participants.values()),f;try{for(p.s();!(f=p.n()).done;){var g=f.value;if(g.identity===l.author){g._endTyping();break}}}catch(h){p.e(h)}finally{p.f()}this.emit("messageAdded",l)}},{key:"_setLastReadMessageIndex",value:function(){var v=D.default(O.default.mark(function p(f){var g;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:f});case 2:return g=w.sent,w.abrupt("return",g.unread_messages_count);case 4:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"add",value:function(){var v=D.default(O.default.mark(function p(f,g){return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",this.participantsEntity.add(f,g!=null?g:{}));case 1:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"addNonChatParticipant",value:function(){var v=D.default(O.default.mark(function p(f,g){var h,w,S=arguments;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return h=S.length>2&&S[2]!==void 0?S[2]:{},w=S.length>3&&S[3]!==void 0?S[3]:{},U.abrupt("return",this.participantsEntity.addNonChatParticipant(f,g,h!=null?h:{},w!=null?w:{}));case 3:case"end":return U.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"advanceLastReadMessageIndex",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:if(!(f<(this.lastReadMessageIndex||0))){h.next=6;break}return h.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return h.abrupt("return",h.sent);case 6:return h.next=8,this._setLastReadMessageIndex(f);case 8:return h.abrupt("return",h.sent);case 9:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"delete",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getAttributes",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribe();case 2:return g.abrupt("return",this.attributes);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getMessages",value:function(){var v=D.default(O.default.mark(function p(f,g,h){return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._subscribeStreams();case 2:return S.abrupt("return",this.messagesEntity.getMessages(f,g,h));case 3:case"end":return S.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"getParticipants",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribeStreams();case 2:return g.abrupt("return",this.participantsEntity.getParticipants());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantsCount",value:function(){var v=D.default(O.default.mark(function p(){var f,g,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=new ae(this.configuration.links.conversations).path(this.sid).build(),S.next=3,this.services.network.get(g);case 3:return h=S.sent,S.abrupt("return",(f=h.body.participants_count)!==null&&f!==void 0?f:0);case 5:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantBySid",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",this.participantsEntity.getParticipantBySid(f));case 1:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getParticipantByIdentity",value:function(){var v=D.default(O.default.mark(function p(){var f,g=arguments;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return f=g.length>0&&g[0]!==void 0?g[0]:"",w.abrupt("return",this.participantsEntity.getParticipantByIdentity(f!=null?f:""));case 2:case"end":return w.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getMessagesCount",value:function(){var v=D.default(O.default.mark(function p(){var f,g,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=new ae(this.configuration.links.conversations).path(this.sid).build(),S.next=3,this.services.network.get(g);case 3:return h=S.sent,S.abrupt("return",(f=h.body.messages_count)!==null&&f!==void 0?f:0);case 5:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getUnreadMessagesCount",value:function(){var v=D.default(O.default.mark(function p(){var f,g,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return f=new ae(this.configuration.links.myConversations).path(this.sid).build(),S.next=3,this.services.network.get(f);case 3:if(g=S.sent,g.body.conversation_sid===this.sid){S.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if(h=g.body.unread_messages_count,typeof h!="number"){S.next=9;break}return S.abrupt("return",h);case 9:return S.abrupt("return",null);case 10:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"join",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:this.configuration.userIdentity});case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"leave",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.channelState.status!=="joined"){g.next=3;break}return g.next=3,this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(this.configuration.userIdentity));case 3:return g.abrupt("return",this);case 4:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"removeParticipant",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.participantsEntity.remove(typeof f=="string"?f:f.sid);case 2:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"sendMessage",value:function(){var v=D.default(O.default.mark(function p(f,g,h){var w,S,L,U;return O.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!(typeof f=="string"||f===null)){ge.next=5;break}return ge.next=3,this.messagesEntity.send(f,g,h);case 3:return L=ge.sent,ge.abrupt("return",(S=Oe(L.index))!==null&&S!==void 0?S:0);case 5:return ge.next=7,this.messagesEntity.sendMedia(f,g,h);case 7:return U=ge.sent,ge.abrupt("return",(w=Oe(U.index))!==null&&w!==void 0?w:0);case 9:case"end":return ge.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"prepareMessage",value:function(){return new ha(this.limits,this.messagesEntity)}},{key:"setAllMessagesRead",value:function(){var v=D.default(O.default.mark(function p(){var f;return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:return h.next=4,this.getMessages(1);case 4:if(f=h.sent,!(f.items.length>0)){h.next=7;break}return h.abrupt("return",this.advanceLastReadMessageIndex(f.items[0].index));case 7:return h.abrupt("return",Promise.resolve(0));case 8:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"setAllMessagesUnread",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribeStreams();case 2:return g.next=4,this._setLastReadMessageIndex(null);case 4:return g.abrupt("return",g.sent);case 5:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"setUserNotificationLevel",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{notification_level:f});case 2:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"typing",value:function(){return this.services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:f!==void 0?JSON.stringify(f):void 0});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateFriendlyName",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.channelState.friendlyName===f){h.next=3;break}return h.next=3,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:f});case 3:return h.abrupt("return",this);case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateLastReadMessageIndex",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:return h.abrupt("return",this._setLastReadMessageIndex(f));case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateUniqueName",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.channelState.uniqueName===f){h.next=4;break}return f||(f=""),h.next=4,this.services.commandExecutor.mutateResource("post",this.links.self,{unique_name:f});case 4:return h.abrupt("return",this);case 5:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}],[{key:"preprocessUpdate",value:function(l,p){try{typeof l.attributes=="string"?l.attributes=JSON.parse(l.attributes):l.attributes&&JSON.stringify(l.attributes)}catch{dr.warn("Retrieved malformed attributes from the server for conversation: "+p),l.attributes={}}try{l.dateCreated&&(l.dateCreated=new Date(l.dateCreated))}catch{dr.warn("Retrieved malformed dateCreated from the server for conversation: "+p),delete l.dateCreated}try{l.dateUpdated&&(l.dateUpdated=new Date(l.dateUpdated))}catch{dr.warn("Retrieved malformed dateUpdated from the server for conversation: "+p),delete l.dateUpdated}try{l.lastMessage&&l.lastMessage.timestamp&&(l.lastMessage.timestamp=new Date(l.lastMessage.timestamp))}catch{dr.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+p),delete l.lastMessage.timestamp}}}]),m}(k.ReplayEventEmitter);ne.default(St,"participantJoined","participantJoined"),ne.default(St,"participantLeft","participantLeft"),ne.default(St,"participantUpdated","participantUpdated"),ne.default(St,"messageAdded","messageAdded"),ne.default(St,"messageRemoved","messageRemoved"),ne.default(St,"messageUpdated","messageUpdated"),ne.default(St,"typingEnded","typingEnded"),ne.default(St,"typingStarted","typingStarted"),ne.default(St,"updated","updated"),ne.default(St,"removed","removed"),Y([b.validateTypesAsync(b.nonEmptyString,Ce),$("design:type",Function),$("design:paramtypes",[String,Object]),$("design:returntype",Promise)],St.prototype,"add",null),Y([b.validateTypesAsync(b.nonEmptyString,b.nonEmptyString,Ce),$("design:type",Function),$("design:paramtypes",[String,String,Object,Object]),$("design:returntype",Promise)],St.prototype,"addNonChatParticipant",null),Y([b.validateTypesAsync(b.nonNegativeInteger),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",Promise)],St.prototype,"advanceLastReadMessageIndex",null),Y([b.validateTypesAsync(["undefined",b.nonNegativeInteger],["undefined",b.nonNegativeInteger],["undefined",b.literal("backwards","forward")]),$("design:type",Function),$("design:paramtypes",[Number,Number,String]),$("design:returntype",Promise)],St.prototype,"getMessages",null),Y([b.validateTypesAsync(b.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],St.prototype,"getParticipantBySid",null),Y([b.validateTypesAsync(b.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],St.prototype,"getParticipantByIdentity",null),Y([b.validateTypesAsync([b.nonEmptyString,Q]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],St.prototype,"removeParticipant",null),Y([b.validateTypesAsync(["string",b.literal(null),b.custom(function(I){return[I instanceof FormData,"an instance of FormData"]}),b.objectSchema("media options",{contentType:b.nonEmptyString,media:b.custom(function(I){var A=typeof I=="string"&&I.length>0||I instanceof Uint8Array||I instanceof ArrayBuffer;return typeof Blob=="function"&&(A=A||I instanceof Blob),[A,"a non-empty string, an instance of Buffer or an instance of Blob"]})})],Ce,["undefined",b.literal(null),b.objectSchema("email attributes",{subject:[b.nonEmptyString,"undefined"]})]),$("design:type",Function),$("design:paramtypes",[Object,Object,Object]),$("design:returntype",Promise)],St.prototype,"sendMessage",null),Y([b.validateTypesAsync(b.literal("default","muted")),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],St.prototype,"setUserNotificationLevel",null),Y([b.validateTypesAsync(q),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],St.prototype,"updateAttributes",null),Y([b.validateTypesAsync(["string"]),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],St.prototype,"updateFriendlyName",null),Y([b.validateTypesAsync([b.literal(null),b.nonNegativeInteger]),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",Promise)],St.prototype,"updateLastReadMessageIndex",null),Y([b.validateTypesAsync(["string",b.literal(null)]),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],St.prototype,"updateUniqueName",null);var ko=function(){function I(){var A=this;be.default(this,I),this._promise=new Promise(function(m,v){A._resolve=m,A._reject=v})}return Re.default(I,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(m){this._resolve(m)}},{key:"set",value:function(m){this.current=m,this._resolve(m)}},{key:"fail",value:function(m){this._reject(m)}}]),I}();function To(I,A){var m=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!m){if(Array.isArray(I)||(m=Eo(I))||A&&I&&typeof I.length=="number"){m&&(I=m);var v=0,l=function(){};return{s:l,n:function(){return v>=I.length?{done:!0}:{done:!1,value:I[v++]}},e:function(w){throw w},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(I)},n:function(){var w=m.next();return p=w.done,w},e:function(w){f=!0,g=w},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function Eo(I,A){if(!!I){if(typeof I=="string")return fs(I,A);var m=Object.prototype.toString.call(I).slice(8,-1);if(m==="Object"&&I.constructor&&(m=I.constructor.name),m==="Map"||m==="Set")return Array.from(I);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return fs(I,A)}}function fs(I,A){(A==null||A>I.length)&&(A=I.length);for(var m=0,v=new Array(A);m<A;m++)v[m]=I[m];return v}function Jn(I,A){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);A&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function Co(I){for(var A=1;A<arguments.length;A++){var m=arguments[A]!=null?arguments[A]:{};A%2?Jn(Object(m),!0).forEach(function(v){ne.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):Jn(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}function Io(I){var A=Jr();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Jr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Sr=te.scope("Conversations"),Ro=function(I){ue.default(m,I);var A=Io(m);function m(v,l){var p;return be.default(this,m),p=A.call(this),ne.default(Ie.default(p),"conversations",new Map),ne.default(Ie.default(p),"myConversationsRead",new ko),ne.default(Ie.default(p),"tombstones",new Set),ne.default(Ie.default(p),"myConversationsFetched",!1),p.configuration=v,p.services=l,p}return Re.default(m,[{key:"addConversation",value:function(){var v=D.default(O.default.mark(function p(f){var g,h,w,S,L,U,K,ge,We,at;return O.default.wrap(function(ot){for(;;)switch(ot.prev=ot.next){case 0:return S=typeof(f==null?void 0:f.attributes)<"u"?f.attributes:{},ot.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:f.friendlyName,unique_name:f.uniqueName,attributes:typeof S<"u"?JSON.stringify(S):void 0});case 3:if(L=ot.sent,U=(g=L.sid)!==null&&g!==void 0?g:null,K=(h=(w=L.sync_objects)===null||w===void 0?void 0:w.conversation)!==null&&h!==void 0?h:null,ge=Co({self:L.url},L.links),We=this.conversations.get(U),!We){ot.next=12;break}return ot.next=11,We._subscribe();case 11:return ot.abrupt("return",We);case 12:return at=new St({channel:K,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},U,ge,this.configuration,this.services),this.conversations.set(at.sid,at),this._registerForEvents(at),ot.next=17,at._subscribe();case 17:return this.emit("conversationAdded",at),ot.abrupt("return",at);case 19:case"end":return ot.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"fetchConversations",value:function(){var v=D.default(O.default.mark(function p(){var f=this,g,h,w,S,L,U,K;return O.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return We.prev=0,We.next=3,this._getMap();case 3:return g=We.sent,g.on("itemAdded",function(at){Sr.debug("itemAdded: ".concat(at.item.key)),f._upsertConversation("sync",at.item.key,at.item.data)}),g.on("itemRemoved",function(at){Sr.debug("itemRemoved: ".concat(at.key));var Ve=at.key;f.myConversationsFetched||f.tombstones.add(Ve);var ot=f.conversations.get(Ve);!ot||(ot.status==="joined"&&(ot._setStatus("notParticipating","sync"),f.emit("conversationLeft",ot)),f.conversations.delete(Ve),f.emit("conversationRemoved",ot),ot.emit("removed",ot))}),g.on("itemUpdated",function(at){Sr.debug("itemUpdated: ".concat(at.item.key)),f._upsertConversation("sync",at.item.key,at.item.data)}),We.next=9,this._fetchMyConversations();case 9:h=We.sent,w=[],S=To(h);try{for(S.s();!(L=S.n()).done;)U=L.value,w.push(this._upsertConversation("rest",U.channel_sid,U))}catch(at){S.e(at)}finally{S.f()}return this.myConversationsRead.set(!0),We.next=16,Promise.all(w);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),Sr.debug("The conversations list has been successfully fetched"),We.abrupt("return",this);case 22:throw We.prev=22,We.t0=We.catch(0),K="Failed to fetch the conversations list",this.services.syncClient.connectionState!=="disconnected"&&Sr.error(K,We.t0),Sr.debug("ERROR: ".concat(K),We.t0),We.t0;case 28:case"end":return We.stop()}},p,this,[[0,22]])}));function l(){return v.apply(this,arguments)}return l}()},{key:"getConversations",value:function(){var v=D.default(O.default.mark(function p(){var f=this,g,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._getMap();case 2:return g=S.sent,S.next=5,g.getItems();case 5:return h=S.sent,S.abrupt("return",this._wrapPaginator(h,function(L){return Promise.all(L.map(function(U){return f._upsertConversation("sync",U.key,U.data)}))}));case 7:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getConversation",value:function(){var v=D.default(O.default.mark(function p(f){var g=this,h,w,S;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,this._getMap();case 2:return h=U.sent,U.next=5,h.getItems({key:f});case 5:return w=U.sent,S=w.items.map(function(K){return g._upsertConversation("sync",K.key,K.data)}),U.abrupt("return",S.length>0?S[0]:null);case 8:case"end":return U.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationByUniqueName",value:function(){var v=D.default(O.default.mark(function p(f){var g,h,w,S,L;return O.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return g=new ae(this.configuration.links.myConversations).path(f).build(),K.next=3,this.services.network.get(g);case 3:return h=K.sent,w=h.body,S=w.conversation_sid,L={entityName:null,lastConsumedMessageIndex:w.last_read_message_index,status:(w==null?void 0:w.status)||"unknown",friendlyName:w.friendly_name,dateUpdated:w.date_updated,dateCreated:w.date_created,uniqueName:w.unique_name,createdBy:w.created_by,attributes:w.attributes,channel:w.sync_objects.conversation,notificationLevel:w==null?void 0:w.notification_level,sid:S},K.abrupt("return",S?this._upsertConversation("sync",S,L):null);case 8:case"end":return K.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"peekConversation",value:function(){var v=D.default(O.default.mark(function p(f){var g,h,w,S;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return g=new ae(this.configuration.links.conversations).path(f).build(),U.next=3,this.services.network.get(g);case 3:return h=U.sent,w=h.body,S={entityName:null,status:(w==null?void 0:w.status)||"unknown",friendlyName:w.friendly_name,dateUpdated:w.date_updated,dateCreated:w.date_created,uniqueName:w.unique_name,createdBy:w.created_by,attributes:w.attributes,channel:"".concat(f,".channel"),sid:f},U.abrupt("return",this._upsertConversation("sync",f,S));case 7:case"end":return U.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"_getMap",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return g.abrupt("return",g.sent);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_wrapPaginator",value:function(){var v=D.default(O.default.mark(function p(f,g){var h=this,w;return O.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,g(f.items);case 2:return w=L.sent,L.abrupt("return",{items:w,hasNextPage:f.hasNextPage,hasPrevPage:f.hasPrevPage,nextPage:function(){return f.nextPage().then(function(K){return h._wrapPaginator(K,g)})},prevPage:function(){return f.prevPage().then(function(K){return h._wrapPaginator(K,g)})}});case 4:case"end":return L.stop()}},p)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_updateConversation",value:function(){var v=D.default(O.default.mark(function p(f,g,h){var w=this,S,L,U;return O.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(S=g._statusSource()!==void 0&&f!==g._statusSource(),L=f!=="rest"||g._statusSource()==="sync",!(S&&L&&f!=="sync")){ge.next=5;break}return Sr.trace("upsertConversation: conversation is known from sync and came from chat, ignoring",{sid:g.sid,data:h.status,conversation:g.status}),ge.abrupt("return");case 5:if(!(h.status==="joined"&&g.status!=="joined")){ge.next=13;break}return g._setStatus("joined",f),U={},typeof h.notificationLevel<"u"&&(U.notificationLevel=h.notificationLevel),typeof h.lastConsumedMessageIndex<"u"&&(U.lastConsumedMessageIndex=h.lastConsumedMessageIndex),Je.default(U,{})||g._update(U),g._subscribe().then(function(){w.emit("conversationJoined",g)}),ge.abrupt("return");case 13:if(!(h.status==="notParticipating"&&g.status==="joined")){ge.next=20;break}return g._setStatus("notParticipating",f),g._update(h),ge.next=18,g._subscribe();case 18:return this.emit("conversationLeft",g),ge.abrupt("return");case 20:if(h.status!=="notParticipating"){ge.next=24;break}return ge.next=23,g._subscribe();case 23:return ge.abrupt("return");case 24:g._update(h);case 25:case"end":return ge.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"_upsertConversation",value:function(){var v=D.default(O.default.mark(function p(f,g,h){var w,S,L,U;return O.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(Sr.trace("upsertConversation called for ".concat(g),h),w=this.conversations.get(g),!w){ge.next=9;break}return Sr.trace("upsertConversation: the conversation ".concat(w.sid," is known;")+"its status is known from the source ".concat(w._statusSource()," ")+"and the update came from the source ".concat(f),w),ge.next=6,this._updateConversation(f,w,h);case 6:return ge.next=8,w._subscribe();case 8:return ge.abrupt("return",w);case 9:if(!(["chat","rest"].includes(f)&&this.tombstones.has(g))){ge.next=12;break}return Sr.trace("upsertChannel: the channel is deleted but reappeared again from chat, ignoring",g),ge.abrupt("return",null);case 12:return Sr.trace("upsertConversation: creating a local conversation object with sid "+g,h),S="".concat(this.configuration.links.conversations,"/").concat(g),L={self:S,messages:"".concat(S,"/Messages"),participants:"".concat(S,"/Participants")},U=new St(h,g,L,this.configuration,this.services),this.conversations.set(g,U),ge.next=19,U._subscribe();case 19:return this._registerForEvents(U),this.emit("conversationAdded",U),h.status==="joined"&&(U._setStatus("joined",f),this.emit("conversationJoined",U)),ge.abrupt("return",U);case 23:case"end":return ge.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"_fetchMyConversations",value:function(){var v=D.default(O.default.mark(function p(){var f,g,h,w,S,L;return O.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:f=[],g=null;case 2:return w=new ae(this.configuration.links.myConversations),g&&w.arg("PageToken",g),K.next=6,this.services.network.get(w.build());case 6:S=K.sent,L=(h=S.body)===null||h===void 0?void 0:h.conversations.map(function(ge){return{descriptor:ge,channel_sid:ge.conversation_sid,status:ge.status,channel:ge.sync_objects.conversation,messages:ge.sync_objects.messages,roster:"".concat(ge.conversation_sid,".roster"),lastConsumedMessageIndex:ge.last_read_message_index,notificationLevel:ge.notification_level}}),g=S.body.meta.next_token,f=[].concat(G.default(f),G.default(L));case 10:if(g){K.next=2;break}case 11:return K.abrupt("return",f);case 12:case"end":return K.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_onConversationRemoved",value:function(l){var p=this.conversations.get(l);p&&(this.conversations.delete(l),this.emit("conversationRemoved",p))}},{key:"_registerForEvents",value:function(l){var p=this;l.on("removed",function(){return p._onConversationRemoved(l.sid)}),l.on("updated",function(f){return p.emit("conversationUpdated",f)}),l.on("participantJoined",function(f){return p.emit("participantJoined",f)}),l.on("participantLeft",function(f){return p.emit("participantLeft",f)}),l.on("participantUpdated",function(f){return p.emit("participantUpdated",f)}),l.on("messageAdded",function(f){return p.emit("messageAdded",f)}),l.on("messageUpdated",function(f){return p.emit("messageUpdated",f)}),l.on("messageRemoved",function(f){return p.emit("messageRemoved",f)}),l.on("typingStarted",function(f){return p.emit("typingStarted",f)}),l.on("typingEnded",function(f){return p.emit("typingEnded",f)})}}]),m}(k.ReplayEventEmitter);function Oo(I){var A=Ao();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Ao(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Po=function(I){ue.default(m,I);var A=Oo(m);function m(v,l,p){var f;return be.default(this,m),f=A.call(this),f.configuration=l,f.services=p,f.fifoStack=[],f.myself=v,f.myself.on("updated",function(g){return f.emit("userUpdated",g)}),f.myself.on("userSubscribed",function(){return f.emit("userSubscribed",f.myself)}),f.myself.on("userUnsubscribed",function(){f.emit("userUnsubscribed",f.myself),f.myself._ensureFetched()}),f.subscribedUsers=new Map,f}return Re.default(m,[{key:"handleUnsubscribeUser",value:function(l){this.subscribedUsers.has(l.identity)&&this.subscribedUsers.delete(l.identity);var p=0,f=this.fifoStack.find(function(g,h){return g==l.identity?(p=h,!0):!1});f&&this.fifoStack.splice(p,1),this.emit("userUnsubscribed",l)}},{key:"handleSubscribeUser",value:function(l){if(!this.subscribedUsers.has(l.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var p,f,g=this.fifoStack.shift();(p=this.subscribedUsers)===null||p===void 0||(f=p.get(g))===null||f===void 0||f.unsubscribe()}this.fifoStack.push(l.identity),this.subscribedUsers.set(l.identity,l),this.emit("userSubscribed",l)}}},{key:"getUser",value:function(){var v=D.default(O.default.mark(function p(){var f=this,g,h,w,S,L=arguments;return O.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return g=L.length>0&&L[0]!==void 0?L[0]:"",h=L.length>1&&L[1]!==void 0?L[1]:"",K.next=4,this.myself._ensureFetched();case 4:if(g!=this.myself.identity){K.next=6;break}return K.abrupt("return",this.myself);case 6:if(w=this.subscribedUsers.get(g),!w){K.next=9;break}return K.abrupt("return",w);case 9:if(K.t0=h,K.t0){K.next=14;break}return K.next=13,this.getSyncUniqueName(g);case 13:K.t0=K.sent;case 14:return h=K.t0,S=new tt(g,h,this.configuration,this.services),S.on("updated",function(ge){return f.emit("userUpdated",ge)}),S.on("userSubscribed",function(){return f.handleSubscribeUser(S)}),S.on("userUnsubscribed",function(){return f.handleUnsubscribeUser(S)}),K.next=21,S._ensureFetched();case 21:return K.abrupt("return",S);case 22:case"end":return K.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getSubscribedUsers",value:function(){var v=D.default(O.default.mark(function p(){var f;return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.myself._ensureFetched();case 2:return f=[this.myself],this.subscribedUsers.forEach(function(w){return f.push(w)}),h.abrupt("return",f);case 5:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getSyncUniqueName",value:function(){var v=D.default(O.default.mark(function p(f){var g,h,w,S;return O.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return w=new ae(this.configuration.links.users).path(f).build(),U.next=3,this.services.network.get(w);case 3:return S=U.sent,U.abrupt("return",(g=(h=S.body)===null||h===void 0?void 0:h.sync_objects.user_info_map)!==null&&g!==void 0?g:"");case 5:case"end":return U.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter),ki=te.scope("TypingIndicator"),Ti=function(){function I(A,m,v){be.default(this,I),this.configuration=m,this.services=v,this.getConversation=A,this.serviceTypingTimeout=null,this.sentUpdates=new Map}return Re.default(I,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var m=this;this.services.notificationClient.on("message",function(){var v=D.default(O.default.mark(function l(p,f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(p!==mt.TYPING_INDICATOR){h.next=3;break}return h.next=3,m._handleRemoteTyping(f);case 3:case"end":return h.stop()}},l)}));return function(l,p){return v.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:function(){var A=D.default(O.default.mark(function v(l){var p=this;return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:ki.trace("Got new typing indicator ",l),this.getConversation(l.channel_sid).then(function(h){!h||h.participants.forEach(function(w){if(w.identity===l.identity){var S=p.configuration.typingIndicatorTimeoutOverride?p.configuration.typingIndicatorTimeoutOverride+1e3:l.typing_timeout*1e3;w._startTyping(S)}})}).catch(function(h){throw ki.error(h),h});case 2:case"end":return g.stop()}},v,this)}));function m(v){return A.apply(this,arguments)}return m}()},{key:"send",value:function(m){var v=this.sentUpdates.get(m);return v&&v>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(m,Date.now()),this._send(m))}},{key:"_send",value:function(m){var v=this;ki.trace("Sending typing indicator");var l=this.configuration.links.typing,p={"Content-Type":"application/x-www-form-urlencoded"},f="ChannelSid=".concat(m);return this.services.twilsockClient.post(l,p,f,this.configuration.productId).then(function(g){g.body.hasOwnProperty("typing_timeout")&&(v.serviceTypingTimeout=g.body.typing_timeout*1e3)}).catch(function(g){throw ki.error("Failed to send typing indicator:",g),g})}}]),I}(),Ei=function I(A){be.default(this,I),this.title=A.title||null,this.body=A.body||null,this.sound=A.sound||null,this.badge=A.badge||null,this.action=A.action||null,this.type=A.type||null,this.data=A.data||{}},gn="2.1.0";function va(I,A){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);A&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function ds(I){for(var A=1;A<arguments.length;A++){var m=arguments[A]!=null?arguments[A]:{};A%2?va(Object(m),!0).forEach(function(v){ne.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):va(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}var ps=function(A){return A.replace(/(^\/+|\/+$)/g,"")},Mo=function(A){return A.status.code===202},No=function(){function I(A,m,v){be.default(this,I),this._serviceUrl=A,this._services=m,this._productId=v}return Re.default(I,[{key:"_preProcessUrl",value:function(m){var v=ps(m);return/^https?:\/\//.test(m)?v:"".concat(ps(this._serviceUrl),"/").concat(v)}},{key:"_makeRequest",value:function(){var A=D.default(O.default.mark(function v(l,p,f,g){var h,w,S,L;return O.default.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:h=this._preProcessUrl(p),w=ds({"Content-Type":"application/json; charset=utf-8"},g||{}),K.t0=l,K.next=K.t0==="get"?5:K.t0==="post"?11:K.t0==="delete"?15:19;break;case 5:return L=h,f&&(L+="?"+Object.entries(f).map(function(ge){return ge.map(encodeURIComponent).join("=")}).join("&")),K.next=9,this._services.transport.get(L,w,this._productId);case 9:return S=K.sent,K.abrupt("break",19);case 11:return K.next=13,this._services.transport.post(h,w,JSON.stringify(f),this._productId);case 13:return S=K.sent,K.abrupt("break",19);case 15:return K.next=17,this._services.transport.delete(h,w,{},this._productId);case 17:return S=K.sent,K.abrupt("break",19);case 19:if(!(S.status.code<200||S.status.code>=300)){K.next=21;break}throw new Error("Request responded with a non-success code ".concat(S.status.code));case 21:return K.abrupt("return",S);case 22:case"end":return K.stop()}},v,this)}));function m(v,l,p,f){return A.apply(this,arguments)}return m}()},{key:"fetchResource",value:function(){var A=D.default(O.default.mark(function v(l,p){var f=this,g,h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=6,S.prev=1,S.next=4,new j.AsyncRetrier({min:50,max:1600,maxAttemptsCount:g}).run(function(){return f._makeRequest("get",l,p)});case 4:return h=S.sent,S.abrupt("return",h.body);case 8:throw S.prev=8,S.t0=S.catch(1),new Error('Fetch resource from "'.concat(l,'" failed.'));case 11:case"end":return S.stop()}},v,null,[[1,8]])}));function m(v,l){return A.apply(this,arguments)}return m}()},{key:"mutateResource",value:function(){var A=D.default(O.default.mark(function v(l,p,f){var g;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._makeRequest(l,p,f,{"X-Twilio-Mutation-Id":Me.v4()});case 2:if(g=w.sent,!Mo(g)){w.next=7;break}return w.next=6,this.fetchResource(g.body.resource_url);case 6:return w.abrupt("return",w.sent);case 7:return w.abrupt("return",g.body);case 8:case"end":return w.stop()}},v,this)}));function m(v,l,p){return A.apply(this,arguments)}return m}()}]),I}(),$t,ga;function hs(I,A){var m=Object.keys(I);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(I);A&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(I,l).enumerable})),m.push.apply(m,v)}return m}function Ci(I){for(var A=1;A<arguments.length;A++){var m=arguments[A]!=null?arguments[A]:{};A%2?hs(Object(m),!0).forEach(function(v){ne.default(I,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(m)):hs(Object(m)).forEach(function(v){Object.defineProperty(I,v,Object.getOwnPropertyDescriptor(m,v))})}return I}function ya(I){var A=Yn();return function(){var v=se.default(I),l;if(A){var p=se.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return ee.default(this,l)}}function Yn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var At,Yr=te.scope("Client"),ma=gn,Qr=function I(){be.default(this,I)};e.Client=At=(ga=$t=function(I){ue.default(m,I);var A=ya(m);function m(v){var l,p,f,g,h,w,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(be.default(this,m),w=A.call(this),ne.default(Ie.default(w),"connectionState","unknown"),ne.default(Ie.default(w),"version",ma),ne.default(Ie.default(w),"parsePushNotification",At.parsePushNotification),w.fpaToken=v!=null?v:"",w.options=S!=null?S:{},!w.options.disableDeepClone){var L=Ci(Ci({},w.options),{},{transport:void 0,twilsockClient:void 0});L=we(L),L.transport=w.options.transport,L.twilsockClient=w.options.twilsockClient,w.options=L}w.options.logLevel=(l=w.options.logLevel)!==null&&l!==void 0?l:"silent",Yr.setLevel(w.options.logLevel);var U=w.options.productId="ip_messaging";if(w.options.clientMetadata=w.options.clientMetadata||{},w.options.clientMetadata.hasOwnProperty("type")||(w.options.clientMetadata.type="conversations"),w.options.clientMetadata.hasOwnProperty("sdk")||(w.options.clientMetadata.sdk="JS",w.options.clientMetadata.sdkv=ma),w.options.Sync=w.options.Sync||{},typeof w.options.Sync.enableSessionStorage>"u"&&(w.options.Sync.enableSessionStorage=!0),w.options.region&&(w.options.Sync.region=w.options.region),!v)throw new Error("A valid Twilio token should be provided");w.services=new Qr,w._myself=new tt("","",null,w.services);var K=!w.options.twilsockClient;if(!w.options.initRegistrations){var ge=new F.InitRegistration(U);At.populateInitRegistrations(ge),w.options.initRegistrations=[ge]}w.services.twilsockClient=w.options.twilsockClient=(p=w.options.twilsockClient)!==null&&p!==void 0?p:new F.TwilsockClient(v,U,w.options),w.services.twilsockClient.on("tokenAboutToExpire",function(Or){return w.emit("tokenAboutToExpire",Or)}),w.services.twilsockClient.on("tokenExpired",function(){return w.emit("tokenExpired")}),w.services.twilsockClient.on("connectionError",function(Or){return w.emit("connectionError",Or)}),w.services.twilsockClient.on("stateChanged",function(Or){Yr.debug("Handling stateChanged for ConversationsClient: new state ".concat(Or)),Or!==w.connectionState&&(w.connectionState=Or,w.emit("connectionStateChanged",w.connectionState))}),w.services.transport=w.options.transport=(f=w.options.transport)!==null&&f!==void 0?f:w.options.twilsockClient,w.services.notificationClient=w.options.notificationsClient=(g=w.options.notificationsClient)!==null&&g!==void 0?g:new me.Notifications(v,w.options),w.services.syncClient=w.options.syncClient=(h=w.options.syncClient)!==null&&h!==void 0?h:new ce.SyncClient(v,w.options);var We=(S==null?void 0:S.Chat)||(S==null?void 0:S.IPMessaging)||S||{},at=We.region||(S==null?void 0:S.region),Ve=We.apiUri||We.typingUri||"https://aim.".concat(at||"us1",".twilio.com");w.services.commandExecutor=new No(Ve,{transport:w.options.transport},U);var ot=function(R){w._rejectEnsureReady(R),w.emit("stateChanged","failed")};return w.services.twilsockClient.once("connectionError",ot),w.services.twilsockClient.once("disconnected",ot),w.services.twilsockClient.once("connected",D.default(O.default.mark(function Or(){var R;return O.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return Yr.debug("ConversationsClient started INITIALIZING"),w.services.twilsockClient.off("connectionError",ot),w.services.twilsockClient.off("disconnected",ot),ve.prev=3,R="conversations.client.startup",w.services.twilsockClient.addPartialTelemetryEvent(new F.TelemetryEventDescription(R,"Conversations client startup",new Date),R,F.TelemetryPoint.Start),ve.next=8,w._initialize();case 8:w.services.twilsockClient.addPartialTelemetryEvent(new F.TelemetryEventDescription("","",new Date),R,F.TelemetryPoint.End),ve.next=15;break;case 11:ve.prev=11,ve.t0=ve.catch(3),w._rejectEnsureReady(ve.t0),w.emit("stateChanged","failed");case 15:case"end":return ve.stop()}},Or,null,[[3,11]])}))),w._ensureReady=new Promise(function(Or,R){w._resolveEnsureReady=Or,w._rejectEnsureReady=R}).catch(function(){}),K&&w.services.twilsockClient.connect(),w}return Re.default(m,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this.configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this.configuration.reachabilityEnabled}},{key:"token",get:function(){return this.fpaToken}},{key:"_subscribeToPushNotifications",value:function(l){var p=this;[mt.NEW_MESSAGE,mt.ADDED_TO_CONVERSATION,mt.REMOVED_FROM_CONVERSATION,mt.TYPING_INDICATOR,mt.CONSUMPTION_UPDATE].forEach(function(f){p.services.notificationClient.subscribe(l,f)})}},{key:"_unsubscribeFromPushNotifications",value:function(l){var p=this;[mt.NEW_MESSAGE,mt.ADDED_TO_CONVERSATION,mt.REMOVED_FROM_CONVERSATION,mt.TYPING_INDICATOR,mt.CONSUMPTION_UPDATE].forEach(function(f){p.services.notificationClient.unsubscribe(l,f)})}},{key:"_initialize",value:function(){var v=D.default(O.default.mark(function p(){var f=this,g;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return g=w.sent,this.configuration=new he(this.options,g,Yr),this._myself._resolveInitialization(this.configuration,this.configuration.userIdentity,this.configuration.userInfo,!0),this.services.typingIndicator=new Ti(this.getConversationBySid.bind(this),this.configuration,this.services),this.services.network=new Ir(this.configuration,this.services),this.services.users=new Po(this._myself,this.configuration,this.services),this.services.users.on("userSubscribed",function(S){f.emit("userSubscribed",S)}),this.services.users.on("userUpdated",function(S){return f.emit("userUpdated",S)}),this.services.users.on("userUnsubscribed",function(S){f.emit("userUnsubscribed",S)}),this.conversations=new Ro(this.configuration,this.services),this.conversations.on("conversationAdded",function(S){f.emit("conversationAdded",S)}),this.conversations.on("conversationRemoved",function(S){f.emit("conversationRemoved",S)}),this.conversations.on("conversationJoined",function(S){f.emit("conversationJoined",S)}),this.conversations.on("conversationLeft",function(S){f.emit("conversationLeft",S)}),this.conversations.on("conversationUpdated",function(S){return f.emit("conversationUpdated",S)}),this.conversations.on("participantJoined",function(S){f.emit("participantJoined",S)}),this.conversations.on("participantLeft",function(S){f.emit("participantLeft",S)}),this.conversations.on("participantUpdated",function(S){return f.emit("participantUpdated",S)}),this.conversations.on("messageAdded",function(S){return f.emit("messageAdded",S)}),this.conversations.on("messageUpdated",function(S){return f.emit("messageUpdated",S)}),this.conversations.on("messageRemoved",function(S){return f.emit("messageRemoved",S)}),this.conversations.on("typingStarted",function(S){return f.emit("typingStarted",S)}),this.conversations.on("typingEnded",function(S){return f.emit("typingEnded",S)}),this.conversationsPromise=this.conversations.fetchConversations().then(function(){return f.conversations}).catch(function(S){throw S}),w.next=28,this.services.users.myself._ensureFetched();case 28:At.supportedPushChannels.forEach(function(S){return f._subscribeToPushNotifications(S)}),this.services.typingIndicator.initialize(),this.services.mcsClient=new xe.McsClient(this.fpaToken,this.configuration.links.mediaService,this.configuration.links.mediaSetService,Ci(Ci({},this.options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized");case 33:case"end":return w.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"shutdown",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.next=4,this.services.twilsockClient.disconnect();case 4:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateToken",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:if(Yr.info("updateToken"),this.fpaToken!==f){h.next=5;break}return h.abrupt("return",this);case 5:return h.next=7,this.services.twilsockClient.updateToken(f);case 7:return h.next=9,this.services.notificationClient.updateToken(f);case 9:return h.next=11,this.services.mcsClient.updateToken(f);case 11:return this.fpaToken=f,h.abrupt("return",this);case 13:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationBySid",value:function(){var v=D.default(O.default.mark(function p(f){var g;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return w.next=4,this.conversations.myConversationsRead.promise;case 4:return w.next=6,this.conversations.getConversation(f);case 6:if(g=w.sent,g){w.next=11;break}return w.next=10,this.conversations.peekConversation(f);case 10:g=w.sent;case 11:if(g){w.next=13;break}throw new Error("Conversation with SID ".concat(f," is not found."));case 13:return w.abrupt("return",g);case 14:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationByUniqueName",value:function(){var v=D.default(O.default.mark(function p(f){var g;return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return w.next=4,this.conversations.myConversationsRead.promise;case 4:return w.next=6,this.conversations.getConversationByUniqueName(f);case 6:if(g=w.sent,g){w.next=9;break}throw new Error("Conversation with unique name ".concat(f," is not found."));case 9:return w.abrupt("return",g);case 10:case"end":return w.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getSubscribedConversations",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.abrupt("return",this.conversationsPromise.then(function(h){return h.getConversations()}));case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"createConversation",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return f=f||{},h.abrupt("return",this.conversationsPromise.then(function(w){return w.addConversation(f)}));case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"setPushRegistrationId",value:function(){var v=D.default(O.default.mark(function p(f,g){return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(f),this.services.notificationClient.setPushRegistrationId(f,g),w.next=6,this.services.notificationClient.commitChanges();case 6:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"unsetPushRegistrationId",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(f),h.next=5,this.services.notificationClient.commitChanges();case 5:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"removePushRegistrations",value:function(){var v=D.default(O.default.mark(function p(f,g){return O.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.services.notificationClient.removeRegistrations(f,g);case 2:case"end":return w.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"handlePushNotification",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:Yr.debug("handlePushNotification, notificationPayload=",f),this.emit("pushNotification",At.parsePushNotification(f));case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getUser",value:function(){var v=D.default(O.default.mark(function p(f){return O.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return h.abrupt("return",this.services.users.getUser(f));case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getSubscribedUsers",value:function(){var v=D.default(O.default.mark(function p(){return O.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.abrupt("return",this.services.users.getSubscribedUsers());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()}],[{key:"populateInitRegistrations",value:function(l){l.populateInitRegistrations([mt.TYPING_INDICATOR]),ce.SyncClient.populateInitRegistrations(l)}},{key:"create",value:function(){var v=D.default(O.default.mark(function p(f,g){var h;return O.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(g!=null&&g.twilsockClient)){S.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return h=new At(f,g),S.next=5,h._ensureReady;case 5:return S.abrupt("return",h);case 6:case"end":return S.stop()}},p)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"parsePushNotificationChatData",value:function(l){var p={};for(var f in At.supportedPushDataFields)if(!(typeof l[f]>"u"||l[f]===null)){if(f!=="message_index"){p[At.supportedPushDataFields[f]]=l[f];continue}Oe(l[f])!==null&&(p[At.supportedPushDataFields[f]]=Number(l[f]))}return p}},{key:"parsePushNotification",value:function(l){if(Yr.debug("parsePushNotification, notificationPayload=",l),typeof l.aps<"u"){if(!l.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var p=At.parsePushNotificationChatData(l),f=l.aps,g,h=null;return typeof f.alert=="string"?g=f.alert||null:(g=f.alert.body||null,h=f.alert.title||null),new Ei({title:h,body:g,sound:f.sound||null,badge:f.badge||null,action:f.category||null,type:l.twi_message_type,data:p})}if(typeof l.data<"u"){var w=l.data;if(!w.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var S=At.parsePushNotificationChatData(l.data);return new Ei({title:w.twi_title||null,body:w.twi_body||null,sound:w.twi_sound||null,badge:null,action:w.twi_action||null,type:w.twi_message_type,data:S})}throw new Error("Provided push notification payload is not Programmable Chat notification")}}]),m}(k.ReplayEventEmitter),ne.default($t,"version",ma),ne.default($t,"supportedPushChannels",["fcm","apn"]),ne.default($t,"supportedPushDataFields",{conversation_sid:"conversationSid",message_sid:"messageSid",message_index:"messageIndex"}),ne.default($t,"conversationAdded","conversationAdded"),ne.default($t,"conversationJoined","conversationJoined"),ne.default($t,"conversationLeft","conversationLeft"),ne.default($t,"conversationRemoved","conversationRemoved"),ne.default($t,"conversationUpdated","conversationUpdated"),ne.default($t,"participantJoined","participantJoined"),ne.default($t,"participantLeft","participantLeft"),ne.default($t,"participantUpdated","participantUpdated"),ne.default($t,"messageAdded","messageAdded"),ne.default($t,"messageRemoved","messageRemoved"),ne.default($t,"messageUpdated","messageUpdated"),ne.default($t,"tokenAboutToExpire","tokenAboutToExpire"),ne.default($t,"tokenExpired","tokenExpired"),ne.default($t,"typingEnded","typingEnded"),ne.default($t,"typingStarted","typingStarted"),ne.default($t,"pushNotification","pushNotification"),ne.default($t,"userSubscribed","userSubscribed"),ne.default($t,"userUnsubscribed","userUnsubscribed"),ne.default($t,"userUpdated","userUpdated"),ne.default($t,"stateChanged","stateChanged"),ne.default($t,"connectionStateChanged","connectionStateChanged"),ne.default($t,"connectionError","connectionError"),ga),Y([b.validateTypesAsync(b.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"updateToken",null),Y([b.validateTypesAsync(b.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"getConversationBySid",null),Y([b.validateTypesAsync(b.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"getConversationByUniqueName",null),Y([b.validateTypesAsync(["undefined",b.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],e.Client.prototype,"createConversation",null),Y([b.validateTypesAsync(b.literal("fcm","apn"),"string"),$("design:type",Function),$("design:paramtypes",[String,String]),$("design:returntype",Promise)],e.Client.prototype,"setPushRegistrationId",null),Y([b.validateTypesAsync(b.literal("fcm","apn")),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"unsetPushRegistrationId",null),Y([b.validateTypesAsync(b.literal("fcm","apn"),b.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String,String]),$("design:returntype",Promise)],e.Client.prototype,"removePushRegistrations",null),Y([b.validateTypesAsync(b.pureObject),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],e.Client.prototype,"handlePushNotification",null),Y([b.validateTypesAsync(b.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"getUser",null),Y([b.validateTypesAsync("string",["undefined",b.pureObject]),$("design:type",Function),$("design:paramtypes",[String,Object]),$("design:returntype",Promise)],e.Client,"create",null),Y([b.validateTypes(b.pureObject),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Ei)],e.Client,"parsePushNotification",null),e.Client=At=Y([b.validateConstructorTypes(b.nonEmptyString,[b.pureObject,"undefined"]),$("design:paramtypes",[String,Object])],e.Client),e.AggregatedDeliveryReceipt=Xe,e.Conversation=St,e.DetailedDeliveryReceipt=rt,e.Media=Le,e.Message=Ht,e.MessageBuilder=ha,e.NotificationTypes=mt,e.Participant=Q,e.PushNotification=Ei,e.RestPaginator=st,e.UnsentMessage=Rr,e.User=tt})(z$);async function gY(e){try{let t=`/conversations/conversation-message-media-url?mediaSid=${e}`;const r=await fetch(t,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(r.ok)return(await r.json()).contentUrl}catch(t){console.log("getMediaUrl error => ",t)}}const yY={props:["author","content","dateCreated","cSid","participant","mSid","pSid","media","mAttributes"],setup(e){const t=e.author,r=e.content,n=e.media,i=e.dateCreated,a=e.cSid,s=e.mSid,o=e.pSid,u=e.mAttributes,c=e.participant,d=Ye(!1),y=Ye("/placeholder.png"),_=Jt(()=>Object.keys(u).length===0?!1:!!(u.mType!==void 0&&u.mType.startsWith("chatButton"))),b=Jt(()=>!!(c!=null&&c.enduser!=null&&c.enduser||(t.startsWith("+")||t.startsWith("whatsapp"))&&!c.agent||u.mType!==void 0&&u.mType==="clientChat")),k=Jt(()=>!!(c!=null&&c.chat!=null&&c.chat||u.mType!==void 0&&u.mType==="agentChat"||u.mType!==void 0&&u.mType==="clientChat")),N=Jt(()=>t===a),P=Jt(()=>!!(c!=null&&c.agent!=null&&c.agent||u.mType!==void 0&&u.agentMessage===!0)),j=Jt(()=>!!(c!=null&&c.sms!=null&&c.sms||t.startsWith("+"))),F=Jt(()=>!!(c!=null&&c.whatsapp!=null&&c.whatsapp||t.startsWith("whatsapp"))),me=Jt(()=>r===null&&n!==null);return lo(async()=>{if(r===null&&n!==null){let ce=null,xe=yt(n);xe[0]!==void 0?ce=xe[0].sid:xe.state!==void 0&&(ce=xe.state.sid),ce!=null&&(y.value=await gY(ce))}}),{author:t,content:r,dateCreated:i,participant:c,mSid:s,pSid:o,isMedia:me,mAttributes:u,imageUrl:y,isChatButton:_,isSms:j,isChat:k,isCustomer:b,isBot:N,isWhatsapp:F,isAgent:P,formatDate:G$,formatAuthor:V$,confirmDelete:d}}},mY={key:0,class:"bi-phone"},bY={key:1,class:"bi-person-workspace"},wY={key:2,class:"bi-phone"},_Y={key:3,class:"bi-robot"},SY={key:4,class:"ms-2"},$Y={key:5},kY=["src"],TY={class:"mt-1"},EY={class:"fst-italic"},CY=M("i",{class:"bi-trash"},null,-1),IY=[CY],RY={key:1,class:"text-start mb-4"},OY={key:0},AY={class:"btn-group d-flex",role:"group","aria-label":"..."},PY=["onClick"],MY={key:1},NY={class:"fst-italic"};function xY(e,t,r,n,i,a){return qe(),ze("div",null,[n.isChatButton?Yt("",!0):(qe(),ze("div",{key:0,class:ja(["bg-info text-start mb-2",{"text-start":n.isCustomer,"text-end":!n.isCustomer}])},[M("span",{class:ja(["fs-4 fw-bold badge text-wrap",{"text-start":n.isCustomer,"text-end":!n.isCustomer,"bg-light":n.isCustomer,"text-dark":n.isCustomer,"bg-success":n.isAgent,"bg-secondary":n.isBot}])},[n.isSms?(qe(),ze("i",mY)):Yt("",!0),n.isChat?(qe(),ze("i",bY)):Yt("",!0),n.isWhatsapp?(qe(),ze("i",wY)):Yt("",!0),n.isBot?(qe(),ze("i",_Y)):Yt("",!0),n.isMedia?Yt("",!0):(qe(),ze("span",SY,bt(n.content),1)),n.isMedia?(qe(),ze("span",$Y,[M("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"ms-2 img-fluid rounded"},null,8,kY)])):Yt("",!0)],2),M("p",TY,[M("small",null,[M("span",EY,bt(n.author)+" - "+bt(n.formatDate(n.dateCreated)),1),He(M("button",{onClick:t[0]||(t[0]=s=>n.confirmDelete=!0),class:"btn btn-link"},IY,512),[[it,!n.confirmDelete]]),He(M("button",{onClick:t[1]||(t[1]=s=>e.$emit("removeMessage",n.mSid)),class:"btn btn-danger ms-2 me-2"},"Delete?",512),[[it,n.confirmDelete]]),He(M("button",{onClick:t[2]||(t[2]=s=>n.confirmDelete=!1),class:"btn btn-light"},"Cancel",512),[[it,n.confirmDelete]])])])],2)),n.isChatButton?(qe(),ze("div",RY,[n.mAttributes.mType==="chatButton"?(qe(),ze("div",OY,[M("h5",null,bt(n.mAttributes.question),1),M("div",AY,[(qe(!0),ze(qt,null,Dr(n.mAttributes.options,s=>(qe(),ze("button",{disabled:"",onClick:o=>e.answerQuestion(n.mAttributes.id,n.mAttributes.question,s.value,s.style),key:s.value,class:ja(["border btn",[s.style]])},bt(s.label),11,PY))),128))])])):Yt("",!0),n.mAttributes.mType==="chatButtonResponse"?(qe(),ze("div",MY,[M("h5",null,[M("span",NY,bt(n.mAttributes.title),1),Ze(" "+bt(n.mAttributes.person)+" replied: ",1),M("button",{disabled:"",class:ja(["btn",[n.mAttributes.style]])},bt(n.mAttributes.answer),3)])])):Yt("",!0)])):Yt("",!0)])}const LY=hi(yY,[["render",xY]]),jY={class:"container"},UY={class:"row row-height mt-2"},DY={class:"col-3"},FY={class:"alert alert-primary"},BY=M("i",{class:"bi-pencil"},null,-1),qY=[BY],WY={class:"input-group"},HY=M("i",{class:"bi-pencil"},null,-1),GY=[HY],VY={key:1,class:"alert-heading"},zY=M("span",{class:"fst-italic"},"no name...",-1),KY=[zY],JY={key:0},YY={class:"alert alert-info text-center"},QY=M("h5",{class:"alert-heading"},"Not in Conversation",-1),XY=M("p",null,"You are not a participant in this conversation",-1),ZY=M("hr",null,null,-1),eQ=M("i",{class:"bi-person-plus"},null,-1),tQ=Ze(" Join"),rQ=[eQ,tQ],nQ={class:"list-group mb-3"},iQ=M("li",{class:"list-group-item list-group-item-secondary"},[Ze("Chat Agents "),M("i",{class:"bi-people"})],-1),aQ=["onClick"],sQ=M("i",{class:"bi-trash"},null,-1),oQ=[sQ],uQ={class:"list-group-item"},lQ=M("i",{class:"bi-person-plus"},null,-1),cQ=[lQ],fQ={class:"input-group"},dQ=["value"],pQ=M("i",{class:"bi-person-plus"},null,-1),hQ=Ze(" Add"),vQ=[pQ,hQ],gQ={class:"list-group mb-3"},yQ=M("li",{class:"list-group-item list-group-item-secondary"},[Ze("Agent SMS "),M("i",{class:"bi-phone"})],-1),mQ=["onClick"],bQ=M("i",{class:"bi-trash"},null,-1),wQ=[bQ],_Q={class:"list-group-item"},SQ=M("i",{class:"bi-phone"},null,-1),$Q=[SQ],kQ={class:"input-group"},TQ=M("i",{class:"bi-phone"},null,-1),EQ=Ze(" Add"),CQ=[TQ,EQ],IQ={class:"list-group mb-3"},RQ=M("li",{class:"list-group-item list-group-item-success"},[Ze("End User Chat "),M("i",{class:"bi-person-workspace"})],-1),OQ=["onClick"],AQ=M("i",{class:"bi-trash"},null,-1),PQ=[AQ],MQ={class:"list-group-item text-center"},NQ={class:"input-group"},xQ=["value"],LQ=M("i",{class:"bi-input-cursor"},null,-1),jQ=Ze(" Inject"),UQ=[LQ,jQ],DQ=M("i",{class:"bi-x"},null,-1),FQ=[DQ],BQ={class:"list-group mb-3"},qQ=M("li",{class:"list-group-item list-group-item-success"},[Ze("End User SMS "),M("i",{class:"bi-phone"})],-1),WQ=["onClick"],HQ=M("i",{class:"bi-trash"},null,-1),GQ=[HQ],VQ={class:"list-group-item"},zQ=M("i",{class:"bi-phone"},null,-1),KQ=[zQ],JQ={class:"input-group"},YQ=M("i",{class:"bi-phone"},null,-1),QQ=Ze(" Add"),XQ=[YQ,QQ],ZQ={class:"list-group mb-3"},eX=M("li",{class:"list-group-item list-group-item-success"},[Ze("End User WhatsApp "),M("i",{class:"bi-whatsapp"})],-1),tX={class:"list-group-item"},rX=M("i",{class:"bi-whatsapp"},null,-1),nX=[rX],iX={class:"input-group"},aX=M("i",{class:"bi-whatsapp"},null,-1),sX=Ze(" Add"),oX=[aX,sX],uX={class:"list-group mb-3"},lX=M("li",{class:"list-group-item list-group-item-warning"},[Ze("Webhooks "),M("i",{class:"bi-robot"})],-1),cX=["onClick"],fX=M("i",{class:"bi-trash"},null,-1),dX=[fX],pX={class:"list-group-item"},hX=M("i",{class:"bi-robot"},null,-1),vX=[hX],gX={class:"input-group"},yX=["value"],mX=M("i",{class:"bi-robot"},null,-1),bX=Ze(" Add"),wX=[mX,bX],_X={class:"alert alert-info text-center"},SX=M("i",{class:"bi-trash"},null,-1),$X=Ze(" Delete Conversation"),kX=[SX,$X],TX={class:"col-9 pb-5"},EX={key:0},CX={key:0,class:"alert alert-danger"},IX=M("i",{class:"bi-plug"},null,-1),RX=Ze(" Connect"),OX=[IX,RX],AX=M("h5",{class:"alert-heading"},"Not Connected",-1),PX=M("p",null,"You are not connected to this conversation!",-1),MX=Ze(" Trouble connecting? "),NX=Ze("Refresh Token"),xX={key:1,class:"alert alert-success"},LX={class:"form-check"},jX=M("label",{class:"form-check-label",for:"flexCheckDefault"},[M("em",null,"Prepend Your Name")],-1),UX={class:"input-group"},DX=M("i",{class:"bi-lightning"},null,-1),FX=Ze(" SEND"),BX=[DX,FX],qX={class:"mt-1 text-end"},WX=M("i",{class:"bi-image"},null,-1),HX=Ze(" Send Image "),GX=[WX,HX],VX={class:"mt-3"},zX={class:"text-end"},KX={class:"bg-info rounded",style:{"min-height":"200px"}},JX={ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},YX={class:"float-end"},QX={__name:"Conversation",setup(e){Ya();const t=co(),r=W$(),n=H$(),i=q$(),a=B$(),s=i.params.sid?i.params.sid:"Not Found",o=Ye(!1),u=Ye(""),c=Ye([]),d=Ye([]),y=Ja({details:{}}),_=Ye(!1),b=Ye(!1),k=Ye([]),N=Ye(""),P=Ye(""),j=Ye(!1),F=Ye({}),me=async()=>{try{(await fetch("/conversations/conversation-delete",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s}})})).ok&&(console.log("Success! Conversation deleted..."),a.replace({name:"conversations"}))}catch(ae){console.log("deleteConversations error => ",ae)}},ce=async()=>{try{(await fetch("/conversations/conversation-change-name",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,friendlyName:u.value}})})).ok&&(o.value=!1,u.value="",$e())}catch(ae){console.log("changeConversationName error => ",ae)}},xe=async ae=>{try{if((await fetch("/conversations/conversation-delete-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,participant:ae}})})).ok){console.log("Success! Agent Removed from Conversation..."),_.value=!1;let B=null,Se=null;$e()}}catch(q){console.log("removeFromConversation error => ",q)}},Ne=async ae=>{try{(await fetch("/conversations/conversation-delete-message",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,messageSid:ae}})})).ok&&(console.log("Success! Message Removed from Conversation..."),await De())}catch(q){console.log("removeFromConversation error => ",q)}},Me=Ye(!1),x=Ye(""),le=async ae=>{try{let q=Sa("chat","agent",ae);(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,identity:ae,attributes:q}})})).ok?(console.log("Success! Added Agent to conversation..."),x.value="",Me.value=!1,$e()):console.log("Error! Unable to add Agent to conversation...")}catch(q){console.log("addAgentToConversation error => ",q)}},D=async()=>{try{let ae={configuration:{}};F.value.target!=null&&(ae.target=F.value.target),F.value.flowSid!=null&&(ae.configuration.flowSid=F.value.flowSid),F.value.replayAfter!=null&&(ae.configuration.replayAfter=F.value.replayAfter),F.value.method!=null&&(ae.configuration.method=F.value.method),F.value.filters!=null&&(ae.configuration.filters=F.value.filters),F.value.url!=null&&(ae.configuration.url=F.value.url),(await fetch("/conversations/conversation-add-webhook",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,createObject:ae}})})).ok?(console.log("Success! Added Webhook to conversation..."),F.value={},j.value=!1,$e()):console.log("Error! Unable to add Webhook to conversation...")}catch(ae){console.log("addWebhookToConversation error => ",ae)}},Re=async ae=>{try{if((await fetch("/conversations/conversation-delete-webhook",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,webhook:ae}})})).ok){console.log("Success! Webhook Agent Removed from Conversation..."),_.value=!1;let B=null,Se=null;$e()}}catch(q){console.log("removeFromConversation error => ",q)}},Ie=Ye(!1),ue=Ye(""),ee=Ye(!1),se=Ye(""),ne=async(ae,q)=>{try{ee.value=!1;let Ce=Sa("sms",ae,q);const Se=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,mobile_number:ue.value,attributes:Ce}})});Se.ok?(console.log("Success! Added Mobile to conversation..."),ue.value="",Ie.value=!1,$e()):(console.log("Error! Unable to add Mobile to conversation..."),ee.value=!0,se.value="We are not able to add that phone number.",Se.status==409&&(se.value="That phone number is in use in a different conversation."),Ie.value=!1,ue.value="")}catch(Ce){console.log("addMobileToConversation error => ",Ce)}},be=Ye(!1),O=Ye(""),je=Ye(!1),ft=Ye(""),Je=async(ae,q)=>{try{je.value=!1;let Ce=Sa("sms",ae,q);const Se=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,mobile_number:O.value,attributes:Ce}})});Se.ok?(console.log("Success! Added Agent Mobile to conversation..."),O.value="",be.value=!1,$e()):(console.log("Error! Unable to add Agent Mobile to conversation..."),je.value=!0,ft.value="We are not able to add that phone number.",Se.status==409&&(ft.value="That phone number is in use in a different conversation."),be.value=!1,O.value="")}catch(Ce){console.log("addAgentMobileToConversation error => ",Ce)}},fe=Ye(!1),G=Ye(""),Y=Ye(!1),$=Ye(""),C=async(ae,q)=>{try{Y.value=!1;let Ce=Sa("whatsapp",ae,q);const Se=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:s,mobile_number:G.value,attributes:Ce}})});Se.ok?(console.log("Success! Added WhatsApp to conversation..."),G.value="",fe.value=!1,$e()):(console.log("Error! Unable to add WhatsApp to conversation..."),Y.value=!0,$.value="We are not able to add that WhatsApp phone number.",Se.status==409&&($.value="That WhatsApp phone number is in use in a different conversation."),fe.value=!1,G.value="")}catch(Ce){console.log("addWhatsAppToConversation error => ",Ce)}},Z=async()=>{try{let ae=`/conversations/conversation-details?sid=${s}`;const q=await fetch(ae,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(q.ok){let Ce=await q.json();y.details=Ce}}catch(ae){console.log("getConversationDetails error => ",ae)}},te=Ye({}),Ae=async()=>{try{let ae=`/conversations/conversation-participants?sid=${s}`;const q=await fetch(ae,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(q.ok){let Ce=await q.json();c.value=Ce;for(let B=0;B<c.value.length;B++)typeof JSON.parse(c.value[B].attributes)=="object"?c.value[B].attributes=JSON.parse(c.value[B].attributes):c.value[B].attributes=JSON.parse(JSON.parse(c.value[B].attributes)),Object.keys(c.value[B].attributes).length===0&&c.value[B].messagingBinding.address!==void 0&&(c.value[B].attributes=JSON.parse(Sa("sms","enduser",c.value[B].messagingBinding.address))),te.value[c.value[B].sid]=c.value[B].attributes,c.value[B].identity===t.agent.identity&&(P.value=c.value[B].sid,_.value=!0)}}catch(ae){console.log("getConversationParticipants error => ",ae)}},De=async()=>{try{let ae=`/conversations/conversation-messages?sid=${s}`;const q=await fetch(ae,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(q.ok){let Ce=await q.json();d.value=Ce.reverse();for(let B=0;B<d.value.length;B++){Object.keys(d.value[B].attributes).length===0?d.value[B].attributes={attributes:"none"}:d.value[B].attributes=JSON.parse(d.value[B].attributes);let Se=te.value[d.value[B].participantSid];Se==null&&(Se=JSON.parse(Sa("bot","bot","Webhook"))),d.value[B].participantAttributes=Se}}}catch(ae){console.log("getConversationMessages error => ",ae)}},de=async()=>{try{let ae=`/conversations/conversation-webhooks?sid=${s}`;const q=await fetch(ae,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(q.ok){let Ce=await q.json();k.value=Ce;for(let B=0;B<k.value.length;B++)k.value[B].Name=r.webhooks.find(Se=>Se.data.flowSid===k.value[B].configuration.flow_sid).data.Name}}catch(ae){console.log("getConversationWebhooks error => ",ae)}},$e=async()=>{await Z(),await Ae(),await De(),await de()};let E=null,T=null;Ye(!0),Ye(""),Ye("");const V=async()=>{E=await new z$.Client(t.agent.accessToken),T=await E.getConversationBySid(s),b.value=!0,T.on("messageAdded",ae=>{let q=te.value[ae.participantSid];q==null&&(q=JSON.parse(Sa("bot","bot","Webhook"))),ae.participantAttributes=q,d.value.unshift(ae)}),T.on("tokenExpired",ae=>{console.log("Token Expired!")})},re=Ye(!0),W=async()=>{try{let ae=N.value;N.value="...",re.value&&(ae=t.agent.identity+": "+ae);let q={mType:"agentChat",agentMessage:!0,agentIdentity:t.agent.identity};await T.prepareMessage().setBody(ae).setAttributes(q).build().send(),N.value="",console.log("Sent Message...")}catch(ae){b.value=!1,console.log("sendMessage error => ",ae)}},ke=Ye(!1),he=Ye(null),we=async()=>{let ae={mType:"agentChat",agentMessage:!0,agentIdentity:t.agent.identity};const q={contentType:he.value.files[0].type,filename:he.value.files[0].name,media:he.value.files[0]};await T.prepareMessage().setAttributes(ae).addMedia(q).build().send(),ke.value=!1,he.value=null},Oe=Ye(!1),z=Ye({}),Ue=async()=>{try{let ae=[],q=z.value.Options.split(/\#/);for(let B=0;B<q.length;B++){let Se=q[B].split(/\|/),Ge={label:Se[0],value:Se[1],style:Se[2]};ae.push(Ge)}let Ce={mType:"chatButton",id:z.value.Id,question:z.value.Question,options:ae};await T.prepareMessage().setBody("<Chat Button>").setAttributes(Ce).build().send(),console.log("Injected Chat Button...")}catch(ae){b.value=!1,console.log("injectChatButton error => ",ae)}};return lo(()=>{$e()}),(ae,q)=>{const Ce=Tr("router-link");return qe(),ze("div",jY,[M("div",UY,[M("div",DY,[M("div",FY,[He(M("button",{type:"button",class:"btn btn-sm btn-link float-end",onClick:q[0]||(q[0]=B=>o.value=!0)},qY,512),[[it,!o.value]]),He(M("div",WY,[He(M("input",{type:"text","onUpdate:modelValue":q[1]||(q[1]=B=>u.value=B),class:"form-control"},null,512),[[Na,u.value]]),M("button",{type:"button",class:"btn btn-sm btn-success",onClick:q[2]||(q[2]=B=>ce())},GY)],512),[[it,o.value]]),y.details.friendlyName!==null?He((qe(),ze("h4",{key:0,class:"alert-heading"},bt(y.details.friendlyName),513)),[[it,!o.value]]):Yt("",!0),y.details.friendlyName===null?He((qe(),ze("h5",VY,KY,512)),[[it,!o.value]]):Yt("",!0)]),_.value?Yt("",!0):(qe(),ze("div",JY,[M("div",YY,[QY,XY,ZY,M("button",{type:"button",class:"btn btn-sm btn-info",onClick:q[3]||(q[3]=B=>le(Rt(t).agent.identity))},rQ)])])),M("ul",nQ,[iQ,(qe(!0),ze(qt,null,Dr(c.value,B=>He((qe(),ze("li",{class:"list-group-item",key:B.sid},[Ze(bt(B.identity)+" \xA0 ",1),M("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Se=>xe(B.sid)},oQ,8,aQ)])),[[it,B.identity!=null&&B.attributes.chat&&B.attributes.agent]])),128)),M("li",uQ,[He(M("span",null,"Add Agent",512),[[it,!Me.value]]),He(M("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:q[4]||(q[4]=B=>Me.value=!0)},cQ,512),[[it,!Me.value]]),He(M("div",fQ,[He(M("select",{class:"form-select","onUpdate:modelValue":q[5]||(q[5]=B=>x.value=B)},[(qe(!0),ze(qt,null,Dr(Rt(t).agents,B=>(qe(),ze("option",{key:B,value:B},bt(B),9,dQ))),128))],512),[[ou,x.value]]),M("button",{type:"button",class:"btn btn-sm btn-success",onClick:q[6]||(q[6]=B=>le(x.value))},vQ)],512),[[it,Me.value]])])]),M("ul",gQ,[yQ,(qe(!0),ze(qt,null,Dr(c.value,B=>{var Se;return He((qe(),ze("li",{class:"list-group-item",key:B.sid},[Ze(bt((Se=B.messagingBinding)==null?void 0:Se.address)+" ",1),M("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Ge=>xe(B.sid)},wQ,8,mQ)])),[[it,B.messagingBinding!=null&&B.attributes.agent]])}),128)),M("li",_Q,[He(M("span",null,"Add Agent SMS",512),[[it,!be.value]]),He(M("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:q[7]||(q[7]=B=>be.value=!0)},$Q,512),[[it,!be.value]]),He(M("div",kQ,[He(M("input",{type:"text","onUpdate:modelValue":q[8]||(q[8]=B=>O.value=B),class:"form-control"},null,512),[[Na,O.value]]),M("button",{type:"button",class:"btn btn-sm btn-success",onClick:q[9]||(q[9]=B=>Je("agent","Agent"))},CQ)],512),[[it,be.value]]),He(M("p",{class:"text-danger"},bt(ft.value),513),[[it,je.value]])])]),M("ul",IQ,[RQ,(qe(!0),ze(qt,null,Dr(c.value,B=>He((qe(),ze("li",{class:"list-group-item",key:B.sid},[Ze(bt(Rt(V$)(B.identity))+" \xA0 ",1),M("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Se=>xe(B.sid)},PQ,8,OQ)])),[[it,B.identity!==null&&B.attributes.chat&&B.attributes.enduser]])),128)),M("li",MQ,[He(M("button",{type:"button",onClick:q[10]||(q[10]=B=>Oe.value=!0),class:"btn btn-sm btn-info"}," Inject Chat Buttons ",512),[[it,!Oe.value]]),He(M("div",NQ,[He(M("select",{class:"form-select","onUpdate:modelValue":q[11]||(q[11]=B=>z.value=B)},[(qe(!0),ze(qt,null,Dr(Rt(n).chatbuttons,B=>(qe(),ze("option",{key:B.data.Id,value:B.data},bt(B.data.Label),9,xQ))),128))],512),[[ou,z.value]]),M("button",{type:"button",class:"btn btn-sm btn-success",onClick:q[12]||(q[12]=B=>Ue())},UQ),M("button",{type:"button",class:"btn btn-sm btn-light",onClick:q[13]||(q[13]=B=>Oe.value=!1)},FQ)],512),[[it,Oe.value]])])]),M("ul",BQ,[qQ,(qe(!0),ze(qt,null,Dr(c.value,B=>{var Se;return He((qe(),ze("li",{class:"list-group-item",key:B.sid},[Ze(bt((Se=B.messagingBinding)==null?void 0:Se.address)+" ",1),M("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Ge=>xe(B.sid)},GQ,8,WQ)])),[[it,B.messagingBinding!=null&&B.attributes.enduser]])}),128)),M("li",VQ,[He(M("span",null,"Add SMS Participant",512),[[it,!Ie.value]]),He(M("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:q[14]||(q[14]=B=>Ie.value=!0)},KQ,512),[[it,!Ie.value]]),He(M("div",JQ,[He(M("input",{type:"text","onUpdate:modelValue":q[15]||(q[15]=B=>ue.value=B),class:"form-control"},null,512),[[Na,ue.value]]),M("button",{type:"button",class:"btn btn-sm btn-success",onClick:q[16]||(q[16]=B=>ne("enduser","End User"))},XQ)],512),[[it,Ie.value]]),He(M("p",{class:"text-danger"},bt(se.value),513),[[it,ee.value]])])]),M("ul",ZQ,[eX,M("li",tX,[He(M("span",null,"Add WhatsApp Participant",512),[[it,!fe.value]]),He(M("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:q[17]||(q[17]=B=>fe.value=!0)},nX,512),[[it,!fe.value]]),He(M("div",iX,[He(M("input",{type:"text","onUpdate:modelValue":q[18]||(q[18]=B=>G.value=B),class:"form-control"},null,512),[[Na,G.value]]),M("button",{type:"button",class:"btn btn-sm btn-success",onClick:q[19]||(q[19]=B=>C("enduser","End User"))},oX)],512),[[it,fe.value]]),He(M("p",{class:"text-danger"},bt($.value),513),[[it,Y.value]])])]),M("ul",uX,[lX,(qe(!0),ze(qt,null,Dr(k.value,B=>(qe(),ze("li",{class:"list-group-item",key:B.sid},[Ze(bt(B.Name)+" ",1),M("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Se=>Re(B.sid)},dX,8,cX)]))),128)),M("li",pX,[He(M("span",null,"Add Webhook",512),[[it,!j.value]]),He(M("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:q[20]||(q[20]=B=>j.value=!0)},vX,512),[[it,!j.value]]),He(M("div",gX,[He(M("select",{class:"form-select","onUpdate:modelValue":q[21]||(q[21]=B=>F.value=B)},[(qe(!0),ze(qt,null,Dr(Rt(r).webhooks,B=>(qe(),ze("option",{key:B.index,value:B.data},bt(B.data.Name),9,yX))),128))],512),[[ou,F.value]]),M("button",{type:"button",class:"btn btn-sm btn-success",onClick:q[22]||(q[22]=B=>D())},wX)],512),[[it,j.value]])])]),M("div",_X,[M("button",{type:"button",class:"btn btn-sm btn-danger",onClick:q[23]||(q[23]=B=>me())},kX)])]),M("div",TX,[_.value?(qe(),ze("div",EX,[b.value?Yt("",!0):(qe(),ze("div",CX,[M("button",{type:"button",class:"btn btn-sm btn-danger float-end",onClick:q[24]||(q[24]=B=>V())},OX),AX,PX,M("p",null,[MX,wt(Ce,{to:"/agent"},{default:sr(()=>[NX]),_:1})])])),b.value?(qe(),ze("div",xX,[M("form",{onSubmit:q[29]||(q[29]=QI((...B)=>ae.submitForm&&ae.submitForm(...B),["prevent"]))},[M("div",LX,[He(M("input",{"onUpdate:modelValue":q[25]||(q[25]=B=>re.value=B),class:"form-check-input",type:"checkbox",id:"flexCheckDefault"},null,512),[[KI,re.value]]),jX]),M("div",UX,[He(M("input",{onKeyup:q[26]||(q[26]=ZI(B=>W(),["enter"])),type:"text",class:"form-control","onUpdate:modelValue":q[27]||(q[27]=B=>N.value=B),"aria-describedby":"btnGroupAddon"},null,544),[[Na,N.value]]),M("button",{type:"button",class:"btn btn-primary",onClick:q[28]||(q[28]=B=>W())},BX)])],32),He(M("div",qX,[M("button",{onClick:q[30]||(q[30]=B=>ke.value=!0),class:"btn btn-sm btn-link"},GX)],512),[[it,!ke.value]]),He(M("div",VX,[M("input",{ref_key:"file",ref:he,onChange:q[31]||(q[31]=B=>we()),class:"form-control form-control-sm",id:"formFileSm",type:"file"},null,544)],512),[[it,ke.value]]),He(M("div",zX,[M("button",{onClick:q[32]||(q[32]=B=>ke.value=!1),class:"btn btn-sm btn-link"}," Cancel ")],512),[[it,ke.value]])])):Yt("",!0)])):Yt("",!0),M("div",KX,[M("div",JX,[(qe(!0),ze(qt,null,Dr(d.value,B=>(qe(),Rn(LY,{onRemoveMessage:q[33]||(q[33]=Se=>Ne(Se)),participant:B.participantAttributes,mAttributes:B.attributes,key:B.sid,mSid:B.sid,pSid:B.participantSid,dateCreated:B.dateCreated,author:B.author,content:B.body,media:B.media,cSid:y.details.sid},null,8,["participant","mAttributes","mSid","pSid","dateCreated","author","content","media","cSid"]))),128))],512)]),M("p",YX,[M("em",null,bt(y.details.sid),1)])])])])}}},XX={name:"App",components:{Layout:Lu,Conversation:QX}};function ZX(e,t,r,n,i,a){const s=Tr("Conversation"),o=Tr("Layout");return qe(),Rn(o,null,{default:sr(()=>[wt(s)]),_:1})}const eZ=hi(XX,[["render",ZX]]),IE=cO({history:IR(),routes:[{name:"home",path:"/",component:tA},{name:"login",path:"/login",component:MA},{name:"agent",path:"/agent",component:oP},{name:"conversations",path:"/conversations",component:KP},{name:"conversation",path:"/conversation/:sid",component:eZ}]});IE.beforeEach(async(e,t)=>{if(Ya().lists.length===0&&e.name!=="home")return{name:"home"}});const ty=rR(dO);ty.use(aR());ty.use(IE);ty.mount("#app");
