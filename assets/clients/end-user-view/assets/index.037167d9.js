(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function $h(e,t){const r=Object.create(null),n=e.split(",");for(let a=0;a<n.length;a++)r[n[a]]=!0;return t?a=>!!r[a.toLowerCase()]:a=>!!r[a]}const JI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",YI=$h(JI);function A0(e){return!!e||e===""}function Th(e){if(st(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],a=ur(n)?ZI(n):Th(n);if(a)for(const i in a)t[i]=a[i]}return t}else{if(ur(e))return e;if(Gt(e))return e}}const QI=/;(?![^(]*\))/g,XI=/:(.+)/;function ZI(e){const t={};return e.split(QI).forEach(r=>{if(r){const n=r.split(XI);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function dn(e){let t="";if(ur(e))t=e;else if(st(e))for(let r=0;r<e.length;r++){const n=dn(e[r]);n&&(t+=n+" ")}else if(Gt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const Wt=e=>ur(e)?e:e==null?"":st(e)||Gt(e)&&(e.toString===x0||!lt(e.toString))?JSON.stringify(e,O0,2):String(e),O0=(e,t)=>t&&t.__v_isRef?O0(e,t.value):Ks(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,a])=>(r[`${n} =>`]=a,r),{})}:P0(t)?{[`Set(${t.size})`]:[...t.values()]}:Gt(t)&&!st(t)&&!N0(t)?String(t):t,jt={},Vs=[],Mn=()=>{},eC=()=>!1,tC=/^on[^a-z]/,Kc=e=>tC.test(e),kh=e=>e.startsWith("onUpdate:"),Sr=Object.assign,Eh=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},rC=Object.prototype.hasOwnProperty,mt=(e,t)=>rC.call(e,t),st=Array.isArray,Ks=e=>Jc(e)==="[object Map]",P0=e=>Jc(e)==="[object Set]",lt=e=>typeof e=="function",ur=e=>typeof e=="string",Ih=e=>typeof e=="symbol",Gt=e=>e!==null&&typeof e=="object",M0=e=>Gt(e)&&lt(e.then)&&lt(e.catch),x0=Object.prototype.toString,Jc=e=>x0.call(e),nC=e=>Jc(e).slice(8,-1),N0=e=>Jc(e)==="[object Object]",Ch=e=>ur(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ic=$h(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Yc=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},aC=/-(\w)/g,Yn=Yc(e=>e.replace(aC,(t,r)=>r?r.toUpperCase():"")),iC=/\B([A-Z])/g,rs=Yc(e=>e.replace(iC,"-$1").toLowerCase()),Qc=Yc(e=>e.charAt(0).toUpperCase()+e.slice(1)),td=Yc(e=>e?`on${Qc(e)}`:""),Tu=(e,t)=>!Object.is(e,t),sc=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},gc=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},Kp=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let xg;const sC=()=>xg||(xg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Gr;class L0{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Gr&&(this.parent=Gr,this.index=(Gr.scopes||(Gr.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Gr;try{return Gr=this,t()}finally{Gr=r}}}on(){Gr=this}off(){Gr=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}}}function j0(e){return new L0(e)}function oC(e,t=Gr){t&&t.active&&t.effects.push(e)}function uC(){return Gr}function lC(e){Gr&&Gr.cleanups.push(e)}const Rh=e=>{const t=new Set(e);return t.w=0,t.n=0,t},U0=e=>(e.w&si)>0,F0=e=>(e.n&si)>0,cC=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=si},fC=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const a=t[n];U0(a)&&!F0(a)?a.delete(e):t[r++]=a,a.w&=~si,a.n&=~si}t.length=r}},Jp=new WeakMap;let ou=0,si=1;const Yp=30;let In;const zi=Symbol(""),Qp=Symbol("");class Ah{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,oC(this,n)}run(){if(!this.active)return this.fn();let t=In,r=Za;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=In,In=this,Za=!0,si=1<<++ou,ou<=Yp?cC(this):Ng(this),this.fn()}finally{ou<=Yp&&fC(this),si=1<<--ou,In=this.parent,Za=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){In===this?this.deferStop=!0:this.active&&(Ng(this),this.onStop&&this.onStop(),this.active=!1)}}function Ng(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Za=!0;const D0=[];function go(){D0.push(Za),Za=!1}function mo(){const e=D0.pop();Za=e===void 0?!0:e}function Jr(e,t,r){if(Za&&In){let n=Jp.get(e);n||Jp.set(e,n=new Map);let a=n.get(r);a||n.set(r,a=Rh()),B0(a)}}function B0(e,t){let r=!1;ou<=Yp?F0(e)||(e.n|=si,r=!U0(e)):r=!e.has(In),r&&(e.add(In),In.deps.push(e))}function ga(e,t,r,n,a,i){const s=Jp.get(e);if(!s)return;let o=[];if(t==="clear")o=[...s.values()];else if(r==="length"&&st(e))s.forEach((u,l)=>{(l==="length"||l>=n)&&o.push(u)});else switch(r!==void 0&&o.push(s.get(r)),t){case"add":st(e)?Ch(r)&&o.push(s.get("length")):(o.push(s.get(zi)),Ks(e)&&o.push(s.get(Qp)));break;case"delete":st(e)||(o.push(s.get(zi)),Ks(e)&&o.push(s.get(Qp)));break;case"set":Ks(e)&&o.push(s.get(zi));break}if(o.length===1)o[0]&&Xp(o[0]);else{const u=[];for(const l of o)l&&u.push(...l);Xp(Rh(u))}}function Xp(e,t){const r=st(e)?e:[...e];for(const n of r)n.computed&&Lg(n);for(const n of r)n.computed||Lg(n)}function Lg(e,t){(e!==In||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const dC=$h("__proto__,__v_isRef,__isVue"),q0=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ih)),pC=Oh(),vC=Oh(!1,!0),hC=Oh(!0),jg=yC();function yC(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=bt(this);for(let i=0,s=this.length;i<s;i++)Jr(n,"get",i+"");const a=n[t](...r);return a===-1||a===!1?n[t](...r.map(bt)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){go();const n=bt(this)[t].apply(this,r);return mo(),n}}),e}function Oh(e=!1,t=!1){return function(n,a,i){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&i===(e?t?PC:V0:t?z0:G0).get(n))return n;const s=st(n);if(!e&&s&&mt(jg,a))return Reflect.get(jg,a,i);const o=Reflect.get(n,a,i);return(Ih(a)?q0.has(a):dC(a))||(e||Jr(n,"get",a),t)?o:Zt(o)?s&&Ch(a)?o:o.value:Gt(o)?e?K0(o):ns(o):o}}const gC=H0(),mC=H0(!0);function H0(e=!1){return function(r,n,a,i){let s=r[n];if(ao(s)&&Zt(s)&&!Zt(a))return!1;if(!e&&(!mc(a)&&!ao(a)&&(s=bt(s),a=bt(a)),!st(r)&&Zt(s)&&!Zt(a)))return s.value=a,!0;const o=st(r)&&Ch(n)?Number(n)<r.length:mt(r,n),u=Reflect.set(r,n,a,i);return r===bt(i)&&(o?Tu(a,s)&&ga(r,"set",n,a):ga(r,"add",n,a)),u}}function bC(e,t){const r=mt(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&ga(e,"delete",t,void 0),n}function wC(e,t){const r=Reflect.has(e,t);return(!Ih(t)||!q0.has(t))&&Jr(e,"has",t),r}function _C(e){return Jr(e,"iterate",st(e)?"length":zi),Reflect.ownKeys(e)}const W0={get:pC,set:gC,deleteProperty:bC,has:wC,ownKeys:_C},SC={get:hC,set(e,t){return!0},deleteProperty(e,t){return!0}},$C=Sr({},W0,{get:vC,set:mC}),Ph=e=>e,Xc=e=>Reflect.getPrototypeOf(e);function _l(e,t,r=!1,n=!1){e=e.__v_raw;const a=bt(e),i=bt(t);r||(t!==i&&Jr(a,"get",t),Jr(a,"get",i));const{has:s}=Xc(a),o=n?Ph:r?Nh:ku;if(s.call(a,t))return o(e.get(t));if(s.call(a,i))return o(e.get(i));e!==a&&e.get(t)}function Sl(e,t=!1){const r=this.__v_raw,n=bt(r),a=bt(e);return t||(e!==a&&Jr(n,"has",e),Jr(n,"has",a)),e===a?r.has(e):r.has(e)||r.has(a)}function $l(e,t=!1){return e=e.__v_raw,!t&&Jr(bt(e),"iterate",zi),Reflect.get(e,"size",e)}function Ug(e){e=bt(e);const t=bt(this);return Xc(t).has.call(t,e)||(t.add(e),ga(t,"add",e,e)),this}function Fg(e,t){t=bt(t);const r=bt(this),{has:n,get:a}=Xc(r);let i=n.call(r,e);i||(e=bt(e),i=n.call(r,e));const s=a.call(r,e);return r.set(e,t),i?Tu(t,s)&&ga(r,"set",e,t):ga(r,"add",e,t),this}function Dg(e){const t=bt(this),{has:r,get:n}=Xc(t);let a=r.call(t,e);a||(e=bt(e),a=r.call(t,e)),n&&n.call(t,e);const i=t.delete(e);return a&&ga(t,"delete",e,void 0),i}function Bg(){const e=bt(this),t=e.size!==0,r=e.clear();return t&&ga(e,"clear",void 0,void 0),r}function Tl(e,t){return function(n,a){const i=this,s=i.__v_raw,o=bt(s),u=t?Ph:e?Nh:ku;return!e&&Jr(o,"iterate",zi),s.forEach((l,c)=>n.call(a,u(l),u(c),i))}}function kl(e,t,r){return function(...n){const a=this.__v_raw,i=bt(a),s=Ks(i),o=e==="entries"||e===Symbol.iterator&&s,u=e==="keys"&&s,l=a[e](...n),c=r?Ph:t?Nh:ku;return!t&&Jr(i,"iterate",u?Qp:zi),{next(){const{value:h,done:w}=l.next();return w?{value:h,done:w}:{value:o?[c(h[0]),c(h[1])]:c(h),done:w}},[Symbol.iterator](){return this}}}}function Da(e){return function(...t){return e==="delete"?!1:this}}function TC(){const e={get(i){return _l(this,i)},get size(){return $l(this)},has:Sl,add:Ug,set:Fg,delete:Dg,clear:Bg,forEach:Tl(!1,!1)},t={get(i){return _l(this,i,!1,!0)},get size(){return $l(this)},has:Sl,add:Ug,set:Fg,delete:Dg,clear:Bg,forEach:Tl(!1,!0)},r={get(i){return _l(this,i,!0)},get size(){return $l(this,!0)},has(i){return Sl.call(this,i,!0)},add:Da("add"),set:Da("set"),delete:Da("delete"),clear:Da("clear"),forEach:Tl(!0,!1)},n={get(i){return _l(this,i,!0,!0)},get size(){return $l(this,!0)},has(i){return Sl.call(this,i,!0)},add:Da("add"),set:Da("set"),delete:Da("delete"),clear:Da("clear"),forEach:Tl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=kl(i,!1,!1),r[i]=kl(i,!0,!1),t[i]=kl(i,!1,!0),n[i]=kl(i,!0,!0)}),[e,r,t,n]}const[kC,EC,IC,CC]=TC();function Mh(e,t){const r=t?e?CC:IC:e?EC:kC;return(n,a,i)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?n:Reflect.get(mt(r,a)&&a in n?r:n,a,i)}const RC={get:Mh(!1,!1)},AC={get:Mh(!1,!0)},OC={get:Mh(!0,!1)},G0=new WeakMap,z0=new WeakMap,V0=new WeakMap,PC=new WeakMap;function MC(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function xC(e){return e.__v_skip||!Object.isExtensible(e)?0:MC(nC(e))}function ns(e){return ao(e)?e:xh(e,!1,W0,RC,G0)}function NC(e){return xh(e,!1,$C,AC,z0)}function K0(e){return xh(e,!0,SC,OC,V0)}function xh(e,t,r,n,a){if(!Gt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=a.get(e);if(i)return i;const s=xC(e);if(s===0)return e;const o=new Proxy(e,s===2?n:r);return a.set(e,o),o}function ei(e){return ao(e)?ei(e.__v_raw):!!(e&&e.__v_isReactive)}function ao(e){return!!(e&&e.__v_isReadonly)}function mc(e){return!!(e&&e.__v_isShallow)}function J0(e){return ei(e)||ao(e)}function bt(e){const t=e&&e.__v_raw;return t?bt(t):e}function io(e){return gc(e,"__v_skip",!0),e}const ku=e=>Gt(e)?ns(e):e,Nh=e=>Gt(e)?K0(e):e;function Y0(e){Za&&In&&(e=bt(e),B0(e.dep||(e.dep=Rh())))}function Q0(e,t){e=bt(e),e.dep&&Xp(e.dep)}function Zt(e){return!!(e&&e.__v_isRef===!0)}function ht(e){return Z0(e,!1)}function X0(e){return Z0(e,!0)}function Z0(e,t){return Zt(e)?e:new LC(e,t)}class LC{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:bt(t),this._value=r?t:ku(t)}get value(){return Y0(this),this._value}set value(t){const r=this.__v_isShallow||mc(t)||ao(t);t=r?t:bt(t),Tu(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:ku(t),Q0(this))}}function St(e){return Zt(e)?e.value:e}const jC={get:(e,t,r)=>St(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const a=e[t];return Zt(a)&&!Zt(r)?(a.value=r,!0):Reflect.set(e,t,r,n)}};function e$(e){return ei(e)?e:new Proxy(e,jC)}function UC(e){const t=st(e)?new Array(e.length):{};for(const r in e)t[r]=DC(e,r);return t}class FC{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function DC(e,t,r){const n=e[t];return Zt(n)?n:new FC(e,t,r)}var t$;class BC{constructor(t,r,n,a){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[t$]=!1,this._dirty=!0,this.effect=new Ah(t,()=>{this._dirty||(this._dirty=!0,Q0(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=n}get value(){const t=bt(this);return Y0(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}t$="__v_isReadonly";function qC(e,t,r=!1){let n,a;const i=lt(e);return i?(n=e,a=Mn):(n=e.get,a=e.set),new BC(n,a,i||!a,r)}function ti(e,t,r,n){let a;try{a=n?e(...n):e()}catch(i){Zc(i,t,r)}return a}function vn(e,t,r,n){if(lt(e)){const i=ti(e,t,r,n);return i&&M0(i)&&i.catch(s=>{Zc(s,t,r)}),i}const a=[];for(let i=0;i<e.length;i++)a.push(vn(e[i],t,r,n));return a}function Zc(e,t,r,n=!0){const a=t?t.vnode:null;if(t){let i=t.parent;const s=t.proxy,o=r;for(;i;){const l=i.ec;if(l){for(let c=0;c<l.length;c++)if(l[c](e,s,o)===!1)return}i=i.parent}const u=t.appContext.config.errorHandler;if(u){ti(u,null,10,[e,s,o]);return}}HC(e,r,a,n)}function HC(e,t,r,n=!0){console.error(e)}let Eu=!1,Zp=!1;const wr=[];let zn=0;const Js=[];let la=null,Fi=0;const r$=Promise.resolve();let Lh=null;function jh(e){const t=Lh||r$;return e?t.then(this?e.bind(this):e):t}function WC(e){let t=zn+1,r=wr.length;for(;t<r;){const n=t+r>>>1;Iu(wr[n])<e?t=n+1:r=n}return t}function Uh(e){(!wr.length||!wr.includes(e,Eu&&e.allowRecurse?zn+1:zn))&&(e.id==null?wr.push(e):wr.splice(WC(e.id),0,e),n$())}function n$(){!Eu&&!Zp&&(Zp=!0,Lh=r$.then(i$))}function GC(e){const t=wr.indexOf(e);t>zn&&wr.splice(t,1)}function zC(e){st(e)?Js.push(...e):(!la||!la.includes(e,e.allowRecurse?Fi+1:Fi))&&Js.push(e),n$()}function qg(e,t=Eu?zn+1:0){for(;t<wr.length;t++){const r=wr[t];r&&r.pre&&(wr.splice(t,1),t--,r())}}function a$(e){if(Js.length){const t=[...new Set(Js)];if(Js.length=0,la){la.push(...t);return}for(la=t,la.sort((r,n)=>Iu(r)-Iu(n)),Fi=0;Fi<la.length;Fi++)la[Fi]();la=null,Fi=0}}const Iu=e=>e.id==null?1/0:e.id,VC=(e,t)=>{const r=Iu(e)-Iu(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function i$(e){Zp=!1,Eu=!0,wr.sort(VC);const t=Mn;try{for(zn=0;zn<wr.length;zn++){const r=wr[zn];r&&r.active!==!1&&ti(r,null,14)}}finally{zn=0,wr.length=0,a$(),Eu=!1,Lh=null,(wr.length||Js.length)&&i$()}}function KC(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||jt;let a=r;const i=t.startsWith("update:"),s=i&&t.slice(7);if(s&&s in n){const c=`${s==="modelValue"?"model":s}Modifiers`,{number:h,trim:w}=n[c]||jt;w&&(a=r.map(b=>b.trim())),h&&(a=r.map(Kp))}let o,u=n[o=td(t)]||n[o=td(Yn(t))];!u&&i&&(u=n[o=td(rs(t))]),u&&vn(u,e,6,a);const l=n[o+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,vn(l,e,6,a)}}function s$(e,t,r=!1){const n=t.emitsCache,a=n.get(e);if(a!==void 0)return a;const i=e.emits;let s={},o=!1;if(!lt(e)){const u=l=>{const c=s$(l,t,!0);c&&(o=!0,Sr(s,c))};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!i&&!o?(Gt(e)&&n.set(e,null),null):(st(i)?i.forEach(u=>s[u]=null):Sr(s,i),Gt(e)&&n.set(e,s),s)}function ef(e,t){return!e||!Kc(t)?!1:(t=t.slice(2).replace(/Once$/,""),mt(e,t[0].toLowerCase()+t.slice(1))||mt(e,rs(t))||mt(e,t))}let _r=null,o$=null;function bc(e){const t=_r;return _r=e,o$=e&&e.type.__scopeId||null,t}function oi(e,t=_r,r){if(!t||e._n)return e;const n=(...a)=>{n._d&&Zg(-1);const i=bc(t),s=e(...a);return bc(i),n._d&&Zg(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function rd(e){const{type:t,vnode:r,proxy:n,withProxy:a,props:i,propsOptions:[s],slots:o,attrs:u,emit:l,render:c,renderCache:h,data:w,setupState:b,ctx:$,inheritAttrs:A}=e;let x,U;const D=bc(e);try{if(r.shapeFlag&4){const ue=a||n;x=Wn(c.call(ue,ue,h,i,b,w,$)),U=u}else{const ue=t;x=Wn(ue.length>1?ue(i,{attrs:u,slots:o,emit:l}):ue(i,null)),U=t.props?u:JC(u)}}catch(ue){vu.length=0,Zc(ue,e,1),x=Vt(hn)}let de=x;if(U&&A!==!1){const ue=Object.keys(U),{shapeFlag:Ae}=de;ue.length&&Ae&7&&(s&&ue.some(kh)&&(U=YC(U,s)),de=li(de,U))}return r.dirs&&(de=li(de),de.dirs=de.dirs?de.dirs.concat(r.dirs):r.dirs),r.transition&&(de.transition=r.transition),x=de,bc(D),x}const JC=e=>{let t;for(const r in e)(r==="class"||r==="style"||Kc(r))&&((t||(t={}))[r]=e[r]);return t},YC=(e,t)=>{const r={};for(const n in e)(!kh(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function QC(e,t,r){const{props:n,children:a,component:i}=e,{props:s,children:o,patchFlag:u}=t,l=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return n?Hg(n,s,l):!!s;if(u&8){const c=t.dynamicProps;for(let h=0;h<c.length;h++){const w=c[h];if(s[w]!==n[w]&&!ef(l,w))return!0}}}else return(a||o)&&(!o||!o.$stable)?!0:n===s?!1:n?s?Hg(n,s,l):!0:!!s;return!1}function Hg(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let a=0;a<n.length;a++){const i=n[a];if(t[i]!==e[i]&&!ef(r,i))return!0}return!1}function XC({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const ZC=e=>e.__isSuspense;function eR(e,t){t&&t.pendingBranch?st(e)?t.effects.push(...e):t.effects.push(e):zC(e)}function oc(e,t){if(sr){let r=sr.provides;const n=sr.parent&&sr.parent.provides;n===r&&(r=sr.provides=Object.create(n)),r[e]=t}}function xn(e,t,r=!1){const n=sr||_r;if(n){const a=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return r&&lt(t)?t.call(n.proxy):t}}const Wg={};function Vi(e,t,r){return u$(e,t,r)}function u$(e,t,{immediate:r,deep:n,flush:a,onTrack:i,onTrigger:s}=jt){const o=sr;let u,l=!1,c=!1;if(Zt(e)?(u=()=>e.value,l=mc(e)):ei(e)?(u=()=>e,n=!0):st(e)?(c=!0,l=e.some(U=>ei(U)||mc(U)),u=()=>e.map(U=>{if(Zt(U))return U.value;if(ei(U))return Wi(U);if(lt(U))return ti(U,o,2)})):lt(e)?t?u=()=>ti(e,o,2):u=()=>{if(!(o&&o.isUnmounted))return h&&h(),vn(e,o,3,[w])}:u=Mn,t&&n){const U=u;u=()=>Wi(U())}let h,w=U=>{h=x.onStop=()=>{ti(U,o,4)}};if(Au)return w=Mn,t?r&&vn(t,o,3,[u(),c?[]:void 0,w]):u(),Mn;let b=c?[]:Wg;const $=()=>{if(!!x.active)if(t){const U=x.run();(n||l||(c?U.some((D,de)=>Tu(D,b[de])):Tu(U,b)))&&(h&&h(),vn(t,o,3,[U,b===Wg?void 0:b,w]),b=U)}else x.run()};$.allowRecurse=!!t;let A;a==="sync"?A=$:a==="post"?A=()=>jr($,o&&o.suspense):($.pre=!0,o&&($.id=o.uid),A=()=>Uh($));const x=new Ah(u,A);return t?r?$():b=x.run():a==="post"?jr(x.run.bind(x),o&&o.suspense):x.run(),()=>{x.stop(),o&&o.scope&&Eh(o.scope.effects,x)}}function tR(e,t,r){const n=this.proxy,a=ur(e)?e.includes(".")?l$(n,e):()=>n[e]:e.bind(n,n);let i;lt(t)?i=t:(i=t.handler,r=t);const s=sr;so(this);const o=u$(a,i.bind(n),r);return s?so(s):Ki(),o}function l$(e,t){const r=t.split(".");return()=>{let n=e;for(let a=0;a<r.length&&n;a++)n=n[r[a]];return n}}function Wi(e,t){if(!Gt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Zt(e))Wi(e.value,t);else if(st(e))for(let r=0;r<e.length;r++)Wi(e[r],t);else if(P0(e)||Ks(e))e.forEach(r=>{Wi(r,t)});else if(N0(e))for(const r in e)Wi(e[r],t);return e}function rR(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return nf(()=>{e.isMounted=!0}),h$(()=>{e.isUnmounting=!0}),e}const an=[Function,Array],nR={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:an,onEnter:an,onAfterEnter:an,onEnterCancelled:an,onBeforeLeave:an,onLeave:an,onAfterLeave:an,onLeaveCancelled:an,onBeforeAppear:an,onAppear:an,onAfterAppear:an,onAppearCancelled:an},setup(e,{slots:t}){const r=Wh(),n=rR();let a;return()=>{const i=t.default&&f$(t.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const A of i)if(A.type!==hn){s=A;break}}const o=bt(e),{mode:u}=o;if(n.isLeaving)return nd(s);const l=Gg(s);if(!l)return nd(s);const c=ev(l,o,n,r);tv(l,c);const h=r.subTree,w=h&&Gg(h);let b=!1;const{getTransitionKey:$}=l.type;if($){const A=$();a===void 0?a=A:A!==a&&(a=A,b=!0)}if(w&&w.type!==hn&&(!Di(l,w)||b)){const A=ev(w,o,n,r);if(tv(w,A),u==="out-in")return n.isLeaving=!0,A.afterLeave=()=>{n.isLeaving=!1,r.update()},nd(s);u==="in-out"&&l.type!==hn&&(A.delayLeave=(x,U,D)=>{const de=c$(n,w);de[String(w.key)]=w,x._leaveCb=()=>{U(),x._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=D})}return s}}},aR=nR;function c$(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function ev(e,t,r,n){const{appear:a,mode:i,persisted:s=!1,onBeforeEnter:o,onEnter:u,onAfterEnter:l,onEnterCancelled:c,onBeforeLeave:h,onLeave:w,onAfterLeave:b,onLeaveCancelled:$,onBeforeAppear:A,onAppear:x,onAfterAppear:U,onAppearCancelled:D}=t,de=String(e.key),ue=c$(r,e),Ae=(P,Q)=>{P&&vn(P,n,9,Q)},we=(P,Q)=>{const ce=Q[1];Ae(P,Q),st(P)?P.every(W=>W.length<=1)&&ce():P.length<=1&&ce()},he={mode:i,persisted:s,beforeEnter(P){let Q=o;if(!r.isMounted)if(a)Q=A||o;else return;P._leaveCb&&P._leaveCb(!0);const ce=ue[de];ce&&Di(e,ce)&&ce.el._leaveCb&&ce.el._leaveCb(),Ae(Q,[P])},enter(P){let Q=u,ce=l,W=c;if(!r.isMounted)if(a)Q=x||u,ce=U||l,W=D||c;else return;let ve=!1;const te=P._enterCb=ae=>{ve||(ve=!0,ae?Ae(W,[P]):Ae(ce,[P]),he.delayedLeave&&he.delayedLeave(),P._enterCb=void 0)};Q?we(Q,[P,te]):te()},leave(P,Q){const ce=String(e.key);if(P._enterCb&&P._enterCb(!0),r.isUnmounting)return Q();Ae(h,[P]);let W=!1;const ve=P._leaveCb=te=>{W||(W=!0,Q(),te?Ae($,[P]):Ae(b,[P]),P._leaveCb=void 0,ue[ce]===e&&delete ue[ce])};ue[ce]=e,w?we(w,[P,ve]):ve()},clone(P){return ev(P,t,r,n)}};return he}function nd(e){if(tf(e))return e=li(e),e.children=null,e}function Gg(e){return tf(e)?e.children?e.children[0]:void 0:e}function tv(e,t){e.shapeFlag&6&&e.component?tv(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function f$(e,t=!1,r){let n=[],a=0;for(let i=0;i<e.length;i++){let s=e[i];const o=r==null?s.key:String(r)+String(s.key!=null?s.key:i);s.type===dr?(s.patchFlag&128&&a++,n=n.concat(f$(s.children,t,o))):(t||s.type!==hn)&&n.push(o!=null?li(s,{key:o}):s)}if(a>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function d$(e){return lt(e)?{setup:e,name:e.name}:e}const pu=e=>!!e.type.__asyncLoader,tf=e=>e.type.__isKeepAlive;function iR(e,t){p$(e,"a",t)}function sR(e,t){p$(e,"da",t)}function p$(e,t,r=sr){const n=e.__wdc||(e.__wdc=()=>{let a=r;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(rf(t,n,r),r){let a=r.parent;for(;a&&a.parent;)tf(a.parent.vnode)&&oR(n,t,r,a),a=a.parent}}function oR(e,t,r,n){const a=rf(t,e,n,!0);Fh(()=>{Eh(n[t],a)},r)}function rf(e,t,r=sr,n=!1){if(r){const a=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;go(),so(r);const o=vn(t,r,e,s);return Ki(),mo(),o});return n?a.unshift(i):a.push(i),i}}const ka=e=>(t,r=sr)=>(!Au||e==="sp")&&rf(e,t,r),v$=ka("bm"),nf=ka("m"),uR=ka("bu"),lR=ka("u"),h$=ka("bum"),Fh=ka("um"),cR=ka("sp"),fR=ka("rtg"),dR=ka("rtc");function pR(e,t=sr){rf("ec",e,t)}function kt(e,t){const r=_r;if(r===null)return e;const n=sf(r)||r.proxy,a=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,o,u,l=jt]=t[i];lt(s)&&(s={mounted:s,updated:s}),s.deep&&Wi(o),a.push({dir:s,instance:n,value:o,oldValue:void 0,arg:u,modifiers:l})}return e}function Ci(e,t,r,n){const a=e.dirs,i=t&&t.dirs;for(let s=0;s<a.length;s++){const o=a[s];i&&(o.oldValue=i[s].value);let u=o.dir[n];u&&(go(),vn(u,r,8,[e.el,o,e,t]),mo())}}const y$="components";function ui(e,t){return hR(y$,e,!0,t)||e}const vR=Symbol();function hR(e,t,r=!0,n=!1){const a=_r||sr;if(a){const i=a.type;if(e===y$){const o=GR(i,!1);if(o&&(o===t||o===Yn(t)||o===Qc(Yn(t))))return i}const s=zg(a[e]||i[e],t)||zg(a.appContext[e],t);return!s&&n?i:s}}function zg(e,t){return e&&(e[t]||e[Yn(t)]||e[Qc(Yn(t))])}function Cu(e,t,r,n){let a;const i=r&&r[n];if(st(e)||ur(e)){a=new Array(e.length);for(let s=0,o=e.length;s<o;s++)a[s]=t(e[s],s,void 0,i&&i[s])}else if(typeof e=="number"){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,i&&i[s])}else if(Gt(e))if(e[Symbol.iterator])a=Array.from(e,(s,o)=>t(s,o,void 0,i&&i[o]));else{const s=Object.keys(e);a=new Array(s.length);for(let o=0,u=s.length;o<u;o++){const l=s[o];a[o]=t(e[l],l,o,i&&i[o])}}else a=[];return r&&(r[n]=a),a}function yR(e,t,r={},n,a){if(_r.isCE||_r.parent&&pu(_r.parent)&&_r.parent.isCE)return Vt("slot",t==="default"?null:{name:t},n&&n());let i=e[t];i&&i._c&&(i._d=!1),et();const s=i&&g$(i(r)),o=Xi(dr,{key:r.key||s&&s.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!a&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),i&&i._c&&(i._d=!0),o}function g$(e){return e.some(t=>Sc(t)?!(t.type===hn||t.type===dr&&!g$(t.children)):!0)?e:null}const rv=e=>e?C$(e)?sf(e)||e.proxy:rv(e.parent):null,wc=Sr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>rv(e.parent),$root:e=>rv(e.root),$emit:e=>e.emit,$options:e=>Dh(e),$forceUpdate:e=>e.f||(e.f=()=>Uh(e.update)),$nextTick:e=>e.n||(e.n=jh.bind(e.proxy)),$watch:e=>tR.bind(e)}),gR={get({_:e},t){const{ctx:r,setupState:n,data:a,props:i,accessCache:s,type:o,appContext:u}=e;let l;if(t[0]!=="$"){const b=s[t];if(b!==void 0)switch(b){case 1:return n[t];case 2:return a[t];case 4:return r[t];case 3:return i[t]}else{if(n!==jt&&mt(n,t))return s[t]=1,n[t];if(a!==jt&&mt(a,t))return s[t]=2,a[t];if((l=e.propsOptions[0])&&mt(l,t))return s[t]=3,i[t];if(r!==jt&&mt(r,t))return s[t]=4,r[t];nv&&(s[t]=0)}}const c=wc[t];let h,w;if(c)return t==="$attrs"&&Jr(e,"get",t),c(e);if((h=o.__cssModules)&&(h=h[t]))return h;if(r!==jt&&mt(r,t))return s[t]=4,r[t];if(w=u.config.globalProperties,mt(w,t))return w[t]},set({_:e},t,r){const{data:n,setupState:a,ctx:i}=e;return a!==jt&&mt(a,t)?(a[t]=r,!0):n!==jt&&mt(n,t)?(n[t]=r,!0):mt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:a,propsOptions:i}},s){let o;return!!r[s]||e!==jt&&mt(e,s)||t!==jt&&mt(t,s)||(o=i[0])&&mt(o,s)||mt(n,s)||mt(wc,s)||mt(a.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:mt(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let nv=!0;function mR(e){const t=Dh(e),r=e.proxy,n=e.ctx;nv=!1,t.beforeCreate&&Vg(t.beforeCreate,e,"bc");const{data:a,computed:i,methods:s,watch:o,provide:u,inject:l,created:c,beforeMount:h,mounted:w,beforeUpdate:b,updated:$,activated:A,deactivated:x,beforeDestroy:U,beforeUnmount:D,destroyed:de,unmounted:ue,render:Ae,renderTracked:we,renderTriggered:he,errorCaptured:P,serverPrefetch:Q,expose:ce,inheritAttrs:W,components:ve,directives:te,filters:ae}=t;if(l&&bR(l,n,null,e.appContext.config.unwrapInjectedRef),s)for(const Re in s){const ke=s[Re];lt(ke)&&(n[Re]=ke.bind(r))}if(a){const Re=a.call(r,r);Gt(Re)&&(e.data=ns(Re))}if(nv=!0,i)for(const Re in i){const ke=i[Re],N=lt(ke)?ke.bind(r,r):lt(ke.get)?ke.get.bind(r,r):Mn,dt=!lt(ke)&&lt(ke.set)?ke.set.bind(r):Mn,pt=qt({get:N,set:dt});Object.defineProperty(n,Re,{enumerable:!0,configurable:!0,get:()=>pt.value,set:Ee=>pt.value=Ee})}if(o)for(const Re in o)m$(o[Re],n,r,Re);if(u){const Re=lt(u)?u.call(r):u;Reflect.ownKeys(Re).forEach(ke=>{oc(ke,Re[ke])})}c&&Vg(c,e,"c");function ie(Re,ke){st(ke)?ke.forEach(N=>Re(N.bind(r))):ke&&Re(ke.bind(r))}if(ie(v$,h),ie(nf,w),ie(uR,b),ie(lR,$),ie(iR,A),ie(sR,x),ie(pR,P),ie(dR,we),ie(fR,he),ie(h$,D),ie(Fh,ue),ie(cR,Q),st(ce))if(ce.length){const Re=e.exposed||(e.exposed={});ce.forEach(ke=>{Object.defineProperty(Re,ke,{get:()=>r[ke],set:N=>r[ke]=N})})}else e.exposed||(e.exposed={});Ae&&e.render===Mn&&(e.render=Ae),W!=null&&(e.inheritAttrs=W),ve&&(e.components=ve),te&&(e.directives=te)}function bR(e,t,r=Mn,n=!1){st(e)&&(e=av(e));for(const a in e){const i=e[a];let s;Gt(i)?"default"in i?s=xn(i.from||a,i.default,!0):s=xn(i.from||a):s=xn(i),Zt(s)&&n?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):t[a]=s}}function Vg(e,t,r){vn(st(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function m$(e,t,r,n){const a=n.includes(".")?l$(r,n):()=>r[n];if(ur(e)){const i=t[e];lt(i)&&Vi(a,i)}else if(lt(e))Vi(a,e.bind(r));else if(Gt(e))if(st(e))e.forEach(i=>m$(i,t,r,n));else{const i=lt(e.handler)?e.handler.bind(r):t[e.handler];lt(i)&&Vi(a,i,e)}}function Dh(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:a,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,o=i.get(t);let u;return o?u=o:!a.length&&!r&&!n?u=t:(u={},a.length&&a.forEach(l=>_c(u,l,s,!0)),_c(u,t,s)),Gt(t)&&i.set(t,u),u}function _c(e,t,r,n=!1){const{mixins:a,extends:i}=t;i&&_c(e,i,r,!0),a&&a.forEach(s=>_c(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const o=wR[s]||r&&r[s];e[s]=o?o(e[s],t[s]):t[s]}return e}const wR={data:Kg,props:Ui,emits:Ui,methods:Ui,computed:Ui,beforeCreate:Or,created:Or,beforeMount:Or,mounted:Or,beforeUpdate:Or,updated:Or,beforeDestroy:Or,beforeUnmount:Or,destroyed:Or,unmounted:Or,activated:Or,deactivated:Or,errorCaptured:Or,serverPrefetch:Or,components:Ui,directives:Ui,watch:SR,provide:Kg,inject:_R};function Kg(e,t){return t?e?function(){return Sr(lt(e)?e.call(this,this):e,lt(t)?t.call(this,this):t)}:t:e}function _R(e,t){return Ui(av(e),av(t))}function av(e){if(st(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Or(e,t){return e?[...new Set([].concat(e,t))]:t}function Ui(e,t){return e?Sr(Sr(Object.create(null),e),t):t}function SR(e,t){if(!e)return t;if(!t)return e;const r=Sr(Object.create(null),e);for(const n in t)r[n]=Or(e[n],t[n]);return r}function $R(e,t,r,n=!1){const a={},i={};gc(i,af,1),e.propsDefaults=Object.create(null),b$(e,t,a,i);for(const s in e.propsOptions[0])s in a||(a[s]=void 0);r?e.props=n?a:NC(a):e.type.props?e.props=a:e.props=i,e.attrs=i}function TR(e,t,r,n){const{props:a,attrs:i,vnode:{patchFlag:s}}=e,o=bt(a),[u]=e.propsOptions;let l=!1;if((n||s>0)&&!(s&16)){if(s&8){const c=e.vnode.dynamicProps;for(let h=0;h<c.length;h++){let w=c[h];if(ef(e.emitsOptions,w))continue;const b=t[w];if(u)if(mt(i,w))b!==i[w]&&(i[w]=b,l=!0);else{const $=Yn(w);a[$]=iv(u,o,$,b,e,!1)}else b!==i[w]&&(i[w]=b,l=!0)}}}else{b$(e,t,a,i)&&(l=!0);let c;for(const h in o)(!t||!mt(t,h)&&((c=rs(h))===h||!mt(t,c)))&&(u?r&&(r[h]!==void 0||r[c]!==void 0)&&(a[h]=iv(u,o,h,void 0,e,!0)):delete a[h]);if(i!==o)for(const h in i)(!t||!mt(t,h)&&!0)&&(delete i[h],l=!0)}l&&ga(e,"set","$attrs")}function b$(e,t,r,n){const[a,i]=e.propsOptions;let s=!1,o;if(t)for(let u in t){if(ic(u))continue;const l=t[u];let c;a&&mt(a,c=Yn(u))?!i||!i.includes(c)?r[c]=l:(o||(o={}))[c]=l:ef(e.emitsOptions,u)||(!(u in n)||l!==n[u])&&(n[u]=l,s=!0)}if(i){const u=bt(r),l=o||jt;for(let c=0;c<i.length;c++){const h=i[c];r[h]=iv(a,u,h,l[h],e,!mt(l,h))}}return s}function iv(e,t,r,n,a,i){const s=e[r];if(s!=null){const o=mt(s,"default");if(o&&n===void 0){const u=s.default;if(s.type!==Function&&lt(u)){const{propsDefaults:l}=a;r in l?n=l[r]:(so(a),n=l[r]=u.call(null,t),Ki())}else n=u}s[0]&&(i&&!o?n=!1:s[1]&&(n===""||n===rs(r))&&(n=!0))}return n}function w$(e,t,r=!1){const n=t.propsCache,a=n.get(e);if(a)return a;const i=e.props,s={},o=[];let u=!1;if(!lt(e)){const c=h=>{u=!0;const[w,b]=w$(h,t,!0);Sr(s,w),b&&o.push(...b)};!r&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!i&&!u)return Gt(e)&&n.set(e,Vs),Vs;if(st(i))for(let c=0;c<i.length;c++){const h=Yn(i[c]);Jg(h)&&(s[h]=jt)}else if(i)for(const c in i){const h=Yn(c);if(Jg(h)){const w=i[c],b=s[h]=st(w)||lt(w)?{type:w}:w;if(b){const $=Xg(Boolean,b.type),A=Xg(String,b.type);b[0]=$>-1,b[1]=A<0||$<A,($>-1||mt(b,"default"))&&o.push(h)}}}const l=[s,o];return Gt(e)&&n.set(e,l),l}function Jg(e){return e[0]!=="$"}function Yg(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function Qg(e,t){return Yg(e)===Yg(t)}function Xg(e,t){return st(t)?t.findIndex(r=>Qg(r,e)):lt(t)&&Qg(t,e)?0:-1}const _$=e=>e[0]==="_"||e==="$stable",Bh=e=>st(e)?e.map(Wn):[Wn(e)],kR=(e,t,r)=>{if(t._n)return t;const n=oi((...a)=>Bh(t(...a)),r);return n._c=!1,n},S$=(e,t,r)=>{const n=e._ctx;for(const a in e){if(_$(a))continue;const i=e[a];if(lt(i))t[a]=kR(a,i,n);else if(i!=null){const s=Bh(i);t[a]=()=>s}}},$$=(e,t)=>{const r=Bh(t);e.slots.default=()=>r},ER=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=bt(t),gc(t,"_",r)):S$(t,e.slots={})}else e.slots={},t&&$$(e,t);gc(e.slots,af,1)},IR=(e,t,r)=>{const{vnode:n,slots:a}=e;let i=!0,s=jt;if(n.shapeFlag&32){const o=t._;o?r&&o===1?i=!1:(Sr(a,t),!r&&o===1&&delete a._):(i=!t.$stable,S$(t,a)),s=t}else t&&($$(e,t),s={default:1});if(i)for(const o in a)!_$(o)&&!(o in s)&&delete a[o]};function T$(){return{app:null,config:{isNativeTag:eC,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let CR=0;function RR(e,t){return function(n,a=null){lt(n)||(n=Object.assign({},n)),a!=null&&!Gt(a)&&(a=null);const i=T$(),s=new Set;let o=!1;const u=i.app={_uid:CR++,_component:n,_props:a,_container:null,_context:i,_instance:null,version:VR,get config(){return i.config},set config(l){},use(l,...c){return s.has(l)||(l&&lt(l.install)?(s.add(l),l.install(u,...c)):lt(l)&&(s.add(l),l(u,...c))),u},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),u},component(l,c){return c?(i.components[l]=c,u):i.components[l]},directive(l,c){return c?(i.directives[l]=c,u):i.directives[l]},mount(l,c,h){if(!o){const w=Vt(n,a);return w.appContext=i,c&&t?t(w,l):e(w,l,h),o=!0,u._container=l,l.__vue_app__=u,sf(w.component)||w.component.proxy}},unmount(){o&&(e(null,u._container),delete u._container.__vue_app__)},provide(l,c){return i.provides[l]=c,u}};return u}}function sv(e,t,r,n,a=!1){if(st(e)){e.forEach((w,b)=>sv(w,t&&(st(t)?t[b]:t),r,n,a));return}if(pu(n)&&!a)return;const i=n.shapeFlag&4?sf(n.component)||n.component.proxy:n.el,s=a?null:i,{i:o,r:u}=e,l=t&&t.r,c=o.refs===jt?o.refs={}:o.refs,h=o.setupState;if(l!=null&&l!==u&&(ur(l)?(c[l]=null,mt(h,l)&&(h[l]=null)):Zt(l)&&(l.value=null)),lt(u))ti(u,o,12,[s,c]);else{const w=ur(u),b=Zt(u);if(w||b){const $=()=>{if(e.f){const A=w?c[u]:u.value;a?st(A)&&Eh(A,i):st(A)?A.includes(i)||A.push(i):w?(c[u]=[i],mt(h,u)&&(h[u]=c[u])):(u.value=[i],e.k&&(c[e.k]=u.value))}else w?(c[u]=s,mt(h,u)&&(h[u]=s)):b&&(u.value=s,e.k&&(c[e.k]=s))};s?($.id=-1,jr($,r)):$()}}}const jr=eR;function AR(e){return OR(e)}function OR(e,t){const r=sC();r.__VUE__=!0;const{insert:n,remove:a,patchProp:i,createElement:s,createText:o,createComment:u,setText:l,setElementText:c,parentNode:h,nextSibling:w,setScopeId:b=Mn,cloneNode:$,insertStaticContent:A}=e,x=(R,I,K,pe=null,G=null,Pe=null,be=!1,_e=null,Oe=!!I.dynamicChildren)=>{if(R===I)return;R&&!Di(R,I)&&(pe=ye(R),Xe(R,G,Pe,!0),R=null),I.patchFlag===-2&&(Oe=!1,I.dynamicChildren=null);const{type:ee,ref:Fe,shapeFlag:Ue}=I;switch(ee){case qh:U(R,I,K,pe);break;case hn:D(R,I,K,pe);break;case ad:R==null&&de(I,K,pe,be);break;case dr:te(R,I,K,pe,G,Pe,be,_e,Oe);break;default:Ue&1?we(R,I,K,pe,G,Pe,be,_e,Oe):Ue&6?ae(R,I,K,pe,G,Pe,be,_e,Oe):(Ue&64||Ue&128)&&ee.process(R,I,K,pe,G,Pe,be,_e,Oe,Qe)}Fe!=null&&G&&sv(Fe,R&&R.ref,Pe,I||R,!I)},U=(R,I,K,pe)=>{if(R==null)n(I.el=o(I.children),K,pe);else{const G=I.el=R.el;I.children!==R.children&&l(G,I.children)}},D=(R,I,K,pe)=>{R==null?n(I.el=u(I.children||""),K,pe):I.el=R.el},de=(R,I,K,pe)=>{[R.el,R.anchor]=A(R.children,I,K,pe,R.el,R.anchor)},ue=({el:R,anchor:I},K,pe)=>{let G;for(;R&&R!==I;)G=w(R),n(R,K,pe),R=G;n(I,K,pe)},Ae=({el:R,anchor:I})=>{let K;for(;R&&R!==I;)K=w(R),a(R),R=K;a(I)},we=(R,I,K,pe,G,Pe,be,_e,Oe)=>{be=be||I.type==="svg",R==null?he(I,K,pe,G,Pe,be,_e,Oe):ce(R,I,G,Pe,be,_e,Oe)},he=(R,I,K,pe,G,Pe,be,_e)=>{let Oe,ee;const{type:Fe,props:Ue,shapeFlag:Me,transition:oe,patchFlag:F,dirs:H}=R;if(R.el&&$!==void 0&&F===-1)Oe=R.el=$(R.el);else{if(Oe=R.el=s(R.type,Pe,Ue&&Ue.is,Ue),Me&8?c(Oe,R.children):Me&16&&Q(R.children,Oe,null,pe,G,Pe&&Fe!=="foreignObject",be,_e),H&&Ci(R,null,pe,"created"),Ue){for(const ge in Ue)ge!=="value"&&!ic(ge)&&i(Oe,ge,null,Ue[ge],Pe,R.children,pe,G,Te);"value"in Ue&&i(Oe,"value",null,Ue.value),(ee=Ue.onVnodeBeforeMount)&&qn(ee,pe,R)}P(Oe,R,R.scopeId,be,pe)}H&&Ci(R,null,pe,"beforeMount");const Y=(!G||G&&!G.pendingBranch)&&oe&&!oe.persisted;Y&&oe.beforeEnter(Oe),n(Oe,I,K),((ee=Ue&&Ue.onVnodeMounted)||Y||H)&&jr(()=>{ee&&qn(ee,pe,R),Y&&oe.enter(Oe),H&&Ci(R,null,pe,"mounted")},G)},P=(R,I,K,pe,G)=>{if(K&&b(R,K),pe)for(let Pe=0;Pe<pe.length;Pe++)b(R,pe[Pe]);if(G){let Pe=G.subTree;if(I===Pe){const be=G.vnode;P(R,be,be.scopeId,be.slotScopeIds,G.parent)}}},Q=(R,I,K,pe,G,Pe,be,_e,Oe=0)=>{for(let ee=Oe;ee<R.length;ee++){const Fe=R[ee]=_e?Va(R[ee]):Wn(R[ee]);x(null,Fe,I,K,pe,G,Pe,be,_e)}},ce=(R,I,K,pe,G,Pe,be)=>{const _e=I.el=R.el;let{patchFlag:Oe,dynamicChildren:ee,dirs:Fe}=I;Oe|=R.patchFlag&16;const Ue=R.props||jt,Me=I.props||jt;let oe;K&&Ri(K,!1),(oe=Me.onVnodeBeforeUpdate)&&qn(oe,K,I,R),Fe&&Ci(I,R,K,"beforeUpdate"),K&&Ri(K,!0);const F=G&&I.type!=="foreignObject";if(ee?W(R.dynamicChildren,ee,_e,K,pe,F,Pe):be||N(R,I,_e,null,K,pe,F,Pe,!1),Oe>0){if(Oe&16)ve(_e,I,Ue,Me,K,pe,G);else if(Oe&2&&Ue.class!==Me.class&&i(_e,"class",null,Me.class,G),Oe&4&&i(_e,"style",Ue.style,Me.style,G),Oe&8){const H=I.dynamicProps;for(let Y=0;Y<H.length;Y++){const ge=H[Y],Ne=Ue[ge],qe=Me[ge];(qe!==Ne||ge==="value")&&i(_e,ge,Ne,qe,G,R.children,K,pe,Te)}}Oe&1&&R.children!==I.children&&c(_e,I.children)}else!be&&ee==null&&ve(_e,I,Ue,Me,K,pe,G);((oe=Me.onVnodeUpdated)||Fe)&&jr(()=>{oe&&qn(oe,K,I,R),Fe&&Ci(I,R,K,"updated")},pe)},W=(R,I,K,pe,G,Pe,be)=>{for(let _e=0;_e<I.length;_e++){const Oe=R[_e],ee=I[_e],Fe=Oe.el&&(Oe.type===dr||!Di(Oe,ee)||Oe.shapeFlag&70)?h(Oe.el):K;x(Oe,ee,Fe,null,pe,G,Pe,be,!0)}},ve=(R,I,K,pe,G,Pe,be)=>{if(K!==pe){for(const _e in pe){if(ic(_e))continue;const Oe=pe[_e],ee=K[_e];Oe!==ee&&_e!=="value"&&i(R,_e,ee,Oe,be,I.children,G,Pe,Te)}if(K!==jt)for(const _e in K)!ic(_e)&&!(_e in pe)&&i(R,_e,K[_e],null,be,I.children,G,Pe,Te);"value"in pe&&i(R,"value",K.value,pe.value)}},te=(R,I,K,pe,G,Pe,be,_e,Oe)=>{const ee=I.el=R?R.el:o(""),Fe=I.anchor=R?R.anchor:o("");let{patchFlag:Ue,dynamicChildren:Me,slotScopeIds:oe}=I;oe&&(_e=_e?_e.concat(oe):oe),R==null?(n(ee,K,pe),n(Fe,K,pe),Q(I.children,K,Fe,G,Pe,be,_e,Oe)):Ue>0&&Ue&64&&Me&&R.dynamicChildren?(W(R.dynamicChildren,Me,K,G,Pe,be,_e),(I.key!=null||G&&I===G.subTree)&&k$(R,I,!0)):N(R,I,K,Fe,G,Pe,be,_e,Oe)},ae=(R,I,K,pe,G,Pe,be,_e,Oe)=>{I.slotScopeIds=_e,R==null?I.shapeFlag&512?G.ctx.activate(I,K,pe,be,Oe):J(I,K,pe,G,Pe,be,Oe):ie(R,I,Oe)},J=(R,I,K,pe,G,Pe,be)=>{const _e=R.component=DR(R,pe,G);if(tf(R)&&(_e.ctx.renderer=Qe),BR(_e),_e.asyncDep){if(G&&G.registerDep(_e,Re),!R.el){const Oe=_e.subTree=Vt(hn);D(null,Oe,I,K)}return}Re(_e,R,I,K,G,Pe,be)},ie=(R,I,K)=>{const pe=I.component=R.component;if(QC(R,I,K))if(pe.asyncDep&&!pe.asyncResolved){ke(pe,I,K);return}else pe.next=I,GC(pe.update),pe.update();else I.el=R.el,pe.vnode=I},Re=(R,I,K,pe,G,Pe,be)=>{const _e=()=>{if(R.isMounted){let{next:Fe,bu:Ue,u:Me,parent:oe,vnode:F}=R,H=Fe,Y;Ri(R,!1),Fe?(Fe.el=F.el,ke(R,Fe,be)):Fe=F,Ue&&sc(Ue),(Y=Fe.props&&Fe.props.onVnodeBeforeUpdate)&&qn(Y,oe,Fe,F),Ri(R,!0);const ge=rd(R),Ne=R.subTree;R.subTree=ge,x(Ne,ge,h(Ne.el),ye(Ne),R,G,Pe),Fe.el=ge.el,H===null&&XC(R,ge.el),Me&&jr(Me,G),(Y=Fe.props&&Fe.props.onVnodeUpdated)&&jr(()=>qn(Y,oe,Fe,F),G)}else{let Fe;const{el:Ue,props:Me}=I,{bm:oe,m:F,parent:H}=R,Y=pu(I);if(Ri(R,!1),oe&&sc(oe),!Y&&(Fe=Me&&Me.onVnodeBeforeMount)&&qn(Fe,H,I),Ri(R,!0),Ue&&Ge){const ge=()=>{R.subTree=rd(R),Ge(Ue,R.subTree,R,G,null)};Y?I.type.__asyncLoader().then(()=>!R.isUnmounted&&ge()):ge()}else{const ge=R.subTree=rd(R);x(null,ge,K,pe,R,G,Pe),I.el=ge.el}if(F&&jr(F,G),!Y&&(Fe=Me&&Me.onVnodeMounted)){const ge=I;jr(()=>qn(Fe,H,ge),G)}(I.shapeFlag&256||H&&pu(H.vnode)&&H.vnode.shapeFlag&256)&&R.a&&jr(R.a,G),R.isMounted=!0,I=K=pe=null}},Oe=R.effect=new Ah(_e,()=>Uh(ee),R.scope),ee=R.update=()=>Oe.run();ee.id=R.uid,Ri(R,!0),ee()},ke=(R,I,K)=>{I.component=R;const pe=R.vnode.props;R.vnode=I,R.next=null,TR(R,I.props,pe,K),IR(R,I.children,K),go(),qg(),mo()},N=(R,I,K,pe,G,Pe,be,_e,Oe=!1)=>{const ee=R&&R.children,Fe=R?R.shapeFlag:0,Ue=I.children,{patchFlag:Me,shapeFlag:oe}=I;if(Me>0){if(Me&128){pt(ee,Ue,K,pe,G,Pe,be,_e,Oe);return}else if(Me&256){dt(ee,Ue,K,pe,G,Pe,be,_e,Oe);return}}oe&8?(Fe&16&&Te(ee,G,Pe),Ue!==ee&&c(K,Ue)):Fe&16?oe&16?pt(ee,Ue,K,pe,G,Pe,be,_e,Oe):Te(ee,G,Pe,!0):(Fe&8&&c(K,""),oe&16&&Q(Ue,K,pe,G,Pe,be,_e,Oe))},dt=(R,I,K,pe,G,Pe,be,_e,Oe)=>{R=R||Vs,I=I||Vs;const ee=R.length,Fe=I.length,Ue=Math.min(ee,Fe);let Me;for(Me=0;Me<Ue;Me++){const oe=I[Me]=Oe?Va(I[Me]):Wn(I[Me]);x(R[Me],oe,K,null,G,Pe,be,_e,Oe)}ee>Fe?Te(R,G,Pe,!0,!1,Ue):Q(I,K,pe,G,Pe,be,_e,Oe,Ue)},pt=(R,I,K,pe,G,Pe,be,_e,Oe)=>{let ee=0;const Fe=I.length;let Ue=R.length-1,Me=Fe-1;for(;ee<=Ue&&ee<=Me;){const oe=R[ee],F=I[ee]=Oe?Va(I[ee]):Wn(I[ee]);if(Di(oe,F))x(oe,F,K,null,G,Pe,be,_e,Oe);else break;ee++}for(;ee<=Ue&&ee<=Me;){const oe=R[Ue],F=I[Me]=Oe?Va(I[Me]):Wn(I[Me]);if(Di(oe,F))x(oe,F,K,null,G,Pe,be,_e,Oe);else break;Ue--,Me--}if(ee>Ue){if(ee<=Me){const oe=Me+1,F=oe<Fe?I[oe].el:pe;for(;ee<=Me;)x(null,I[ee]=Oe?Va(I[ee]):Wn(I[ee]),K,F,G,Pe,be,_e,Oe),ee++}}else if(ee>Me)for(;ee<=Ue;)Xe(R[ee],G,Pe,!0),ee++;else{const oe=ee,F=ee,H=new Map;for(ee=F;ee<=Me;ee++){const Le=I[ee]=Oe?Va(I[ee]):Wn(I[ee]);Le.key!=null&&H.set(Le.key,ee)}let Y,ge=0;const Ne=Me-F+1;let qe=!1,ze=0;const De=new Array(Ne);for(ee=0;ee<Ne;ee++)De[ee]=0;for(ee=oe;ee<=Ue;ee++){const Le=R[ee];if(ge>=Ne){Xe(Le,G,Pe,!0);continue}let Z;if(Le.key!=null)Z=H.get(Le.key);else for(Y=F;Y<=Me;Y++)if(De[Y-F]===0&&Di(Le,I[Y])){Z=Y;break}Z===void 0?Xe(Le,G,Pe,!0):(De[Z-F]=ee+1,Z>=ze?ze=Z:qe=!0,x(Le,I[Z],K,null,G,Pe,be,_e,Oe),ge++)}const He=qe?PR(De):Vs;for(Y=He.length-1,ee=Ne-1;ee>=0;ee--){const Le=F+ee,Z=I[Le],ne=Le+1<Fe?I[Le+1].el:pe;De[ee]===0?x(null,Z,K,ne,G,Pe,be,_e,Oe):qe&&(Y<0||ee!==He[Y]?Ee(Z,K,ne,2):Y--)}}},Ee=(R,I,K,pe,G=null)=>{const{el:Pe,type:be,transition:_e,children:Oe,shapeFlag:ee}=R;if(ee&6){Ee(R.component.subTree,I,K,pe);return}if(ee&128){R.suspense.move(I,K,pe);return}if(ee&64){be.move(R,I,K,Qe);return}if(be===dr){n(Pe,I,K);for(let Ue=0;Ue<Oe.length;Ue++)Ee(Oe[Ue],I,K,pe);n(R.anchor,I,K);return}if(be===ad){ue(R,I,K);return}if(pe!==2&&ee&1&&_e)if(pe===0)_e.beforeEnter(Pe),n(Pe,I,K),jr(()=>_e.enter(Pe),G);else{const{leave:Ue,delayLeave:Me,afterLeave:oe}=_e,F=()=>n(Pe,I,K),H=()=>{Ue(Pe,()=>{F(),oe&&oe()})};Me?Me(Pe,F,H):H()}else n(Pe,I,K)},Xe=(R,I,K,pe=!1,G=!1)=>{const{type:Pe,props:be,ref:_e,children:Oe,dynamicChildren:ee,shapeFlag:Fe,patchFlag:Ue,dirs:Me}=R;if(_e!=null&&sv(_e,null,K,R,!0),Fe&256){I.ctx.deactivate(R);return}const oe=Fe&1&&Me,F=!pu(R);let H;if(F&&(H=be&&be.onVnodeBeforeUnmount)&&qn(H,I,R),Fe&6)T(R.component,K,pe);else{if(Fe&128){R.suspense.unmount(K,pe);return}oe&&Ci(R,null,I,"beforeUnmount"),Fe&64?R.type.remove(R,I,K,G,Qe,pe):ee&&(Pe!==dr||Ue>0&&Ue&64)?Te(ee,I,K,!1,!0):(Pe===dr&&Ue&384||!G&&Fe&16)&&Te(Oe,I,K),pe&&Ye(R)}(F&&(H=be&&be.onVnodeUnmounted)||oe)&&jr(()=>{H&&qn(H,I,R),oe&&Ci(R,null,I,"unmounted")},K)},Ye=R=>{const{type:I,el:K,anchor:pe,transition:G}=R;if(I===dr){B(K,pe);return}if(I===ad){Ae(R);return}const Pe=()=>{a(K),G&&!G.persisted&&G.afterLeave&&G.afterLeave()};if(R.shapeFlag&1&&G&&!G.persisted){const{leave:be,delayLeave:_e}=G,Oe=()=>be(K,Pe);_e?_e(R.el,Pe,Oe):Oe()}else Pe()},B=(R,I)=>{let K;for(;R!==I;)K=w(R),a(R),R=K;a(I)},T=(R,I,K)=>{const{bum:pe,scope:G,update:Pe,subTree:be,um:_e}=R;pe&&sc(pe),G.stop(),Pe&&(Pe.active=!1,Xe(be,R,I,K)),_e&&jr(_e,I),jr(()=>{R.isUnmounted=!0},I),I&&I.pendingBranch&&!I.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===I.pendingId&&(I.deps--,I.deps===0&&I.resolve())},Te=(R,I,K,pe=!1,G=!1,Pe=0)=>{for(let be=Pe;be<R.length;be++)Xe(R[be],I,K,pe,G)},ye=R=>R.shapeFlag&6?ye(R.component.subTree):R.shapeFlag&128?R.suspense.next():w(R.anchor||R.el),Ke=(R,I,K)=>{R==null?I._vnode&&Xe(I._vnode,null,null,!0):x(I._vnode||null,R,I,null,null,null,K),qg(),a$(),I._vnode=R},Qe={p:x,um:Xe,m:Ee,r:Ye,mt:J,mc:Q,pc:N,pbc:W,n:ye,o:e};let Se,Ge;return t&&([Se,Ge]=t(Qe)),{render:Ke,hydrate:Se,createApp:RR(Ke,Se)}}function Ri({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function k$(e,t,r=!1){const n=e.children,a=t.children;if(st(n)&&st(a))for(let i=0;i<n.length;i++){const s=n[i];let o=a[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=a[i]=Va(a[i]),o.el=s.el),r||k$(s,o))}}function PR(e){const t=e.slice(),r=[0];let n,a,i,s,o;const u=e.length;for(n=0;n<u;n++){const l=e[n];if(l!==0){if(a=r[r.length-1],e[a]<l){t[n]=a,r.push(n);continue}for(i=0,s=r.length-1;i<s;)o=i+s>>1,e[r[o]]<l?i=o+1:s=o;l<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,s=r[i-1];i-- >0;)r[i]=s,s=t[s];return r}const MR=e=>e.__isTeleport,dr=Symbol(void 0),qh=Symbol(void 0),hn=Symbol(void 0),ad=Symbol(void 0),vu=[];let Rn=null;function et(e=!1){vu.push(Rn=e?null:[])}function xR(){vu.pop(),Rn=vu[vu.length-1]||null}let Ru=1;function Zg(e){Ru+=e}function E$(e){return e.dynamicChildren=Ru>0?Rn||Vs:null,xR(),Ru>0&&Rn&&Rn.push(e),e}function ct(e,t,r,n,a,i){return E$(le(e,t,r,n,a,i,!0))}function Xi(e,t,r,n,a){return E$(Vt(e,t,r,n,a,!0))}function Sc(e){return e?e.__v_isVNode===!0:!1}function Di(e,t){return e.type===t.type&&e.key===t.key}const af="__vInternal",I$=({key:e})=>e!=null?e:null,uc=({ref:e,ref_key:t,ref_for:r})=>e!=null?ur(e)||Zt(e)||lt(e)?{i:_r,r:e,k:t,f:!!r}:e:null;function le(e,t=null,r=null,n=0,a=null,i=e===dr?0:1,s=!1,o=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&I$(t),ref:t&&uc(t),scopeId:o$,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:a,dynamicChildren:null,appContext:null};return o?(Hh(u,r),i&128&&e.normalize(u)):r&&(u.shapeFlag|=ur(r)?8:16),Ru>0&&!s&&Rn&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&Rn.push(u),u}const Vt=NR;function NR(e,t=null,r=null,n=0,a=null,i=!1){if((!e||e===vR)&&(e=hn),Sc(e)){const o=li(e,t,!0);return r&&Hh(o,r),Ru>0&&!i&&Rn&&(o.shapeFlag&6?Rn[Rn.indexOf(e)]=o:Rn.push(o)),o.patchFlag|=-2,o}if(zR(e)&&(e=e.__vccOpts),t){t=LR(t);let{class:o,style:u}=t;o&&!ur(o)&&(t.class=dn(o)),Gt(u)&&(J0(u)&&!st(u)&&(u=Sr({},u)),t.style=Th(u))}const s=ur(e)?1:ZC(e)?128:MR(e)?64:Gt(e)?4:lt(e)?2:0;return le(e,t,r,n,a,s,i,!0)}function LR(e){return e?J0(e)||af in e?Sr({},e):e:null}function li(e,t,r=!1){const{props:n,ref:a,patchFlag:i,children:s}=e,o=t?jR(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&I$(o),ref:t&&t.ref?r&&a?st(a)?a.concat(uc(t)):[a,uc(t)]:uc(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==dr?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&li(e.ssContent),ssFallback:e.ssFallback&&li(e.ssFallback),el:e.el,anchor:e.anchor}}function Ut(e=" ",t=0){return Vt(qh,null,e,t)}function Xt(e="",t=!1){return t?(et(),Xi(hn,null,e)):Vt(hn,null,e)}function Wn(e){return e==null||typeof e=="boolean"?Vt(hn):st(e)?Vt(dr,null,e.slice()):typeof e=="object"?Va(e):Vt(qh,null,String(e))}function Va(e){return e.el===null||e.memo?e:li(e)}function Hh(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(st(t))r=16;else if(typeof t=="object")if(n&65){const a=t.default;a&&(a._c&&(a._d=!1),Hh(e,a()),a._c&&(a._d=!0));return}else{r=32;const a=t._;!a&&!(af in t)?t._ctx=_r:a===3&&_r&&(_r.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else lt(t)?(t={default:t,_ctx:_r},r=32):(t=String(t),n&64?(r=16,t=[Ut(t)]):r=8);e.children=t,e.shapeFlag|=r}function jR(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const a in n)if(a==="class")t.class!==n.class&&(t.class=dn([t.class,n.class]));else if(a==="style")t.style=Th([t.style,n.style]);else if(Kc(a)){const i=t[a],s=n[a];s&&i!==s&&!(st(i)&&i.includes(s))&&(t[a]=i?[].concat(i,s):s)}else a!==""&&(t[a]=n[a])}return t}function qn(e,t,r,n=null){vn(e,t,7,[r,n])}const UR=T$();let FR=0;function DR(e,t,r){const n=e.type,a=(t?t.appContext:e.appContext)||UR,i={uid:FR++,vnode:e,type:n,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new L0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:w$(n,a),emitsOptions:s$(n,a),emit:null,emitted:null,propsDefaults:jt,inheritAttrs:n.inheritAttrs,ctx:jt,data:jt,props:jt,attrs:jt,slots:jt,refs:jt,setupState:jt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=KC.bind(null,i),e.ce&&e.ce(i),i}let sr=null;const Wh=()=>sr||_r,so=e=>{sr=e,e.scope.on()},Ki=()=>{sr&&sr.scope.off(),sr=null};function C$(e){return e.vnode.shapeFlag&4}let Au=!1;function BR(e,t=!1){Au=t;const{props:r,children:n}=e.vnode,a=C$(e);$R(e,r,a,t),ER(e,n);const i=a?qR(e,t):void 0;return Au=!1,i}function qR(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=io(new Proxy(e.ctx,gR));const{setup:n}=r;if(n){const a=e.setupContext=n.length>1?WR(e):null;so(e),go();const i=ti(n,e,0,[e.props,a]);if(mo(),Ki(),M0(i)){if(i.then(Ki,Ki),t)return i.then(s=>{em(e,s,t)}).catch(s=>{Zc(s,e,0)});e.asyncDep=i}else em(e,i,t)}else R$(e,t)}function em(e,t,r){lt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Gt(t)&&(e.setupState=e$(t)),R$(e,r)}let tm;function R$(e,t,r){const n=e.type;if(!e.render){if(!t&&tm&&!n.render){const a=n.template||Dh(e).template;if(a){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:o,compilerOptions:u}=n,l=Sr(Sr({isCustomElement:i,delimiters:o},s),u);n.render=tm(a,l)}}e.render=n.render||Mn}so(e),go(),mR(e),mo(),Ki()}function HR(e){return new Proxy(e.attrs,{get(t,r){return Jr(e,"get","$attrs"),t[r]}})}function WR(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=HR(e))},slots:e.slots,emit:e.emit,expose:t}}function sf(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(e$(io(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in wc)return wc[r](e)}}))}function GR(e,t=!0){return lt(e)?e.displayName||e.name:e.name||t&&e.__name}function zR(e){return lt(e)&&"__vccOpts"in e}const qt=(e,t)=>qC(e,t,Au);function A$(e,t,r){const n=arguments.length;return n===2?Gt(t)&&!st(t)?Sc(t)?Vt(e,null,[t]):Vt(e,t):Vt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Sc(r)&&(r=[r]),Vt(e,t,r))}const VR="3.2.39",KR="http://www.w3.org/2000/svg",Bi=typeof document<"u"?document:null,rm=Bi&&Bi.createElement("template"),JR={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const a=t?Bi.createElementNS(KR,e):Bi.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&a.setAttribute("multiple",n.multiple),a},createText:e=>Bi.createTextNode(e),createComment:e=>Bi.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Bi.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,a,i){const s=r?r.previousSibling:t.lastChild;if(a&&(a===i||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),r),!(a===i||!(a=a.nextSibling)););else{rm.innerHTML=n?`<svg>${e}</svg>`:e;const o=rm.content;if(n){const u=o.firstChild;for(;u.firstChild;)o.appendChild(u.firstChild);o.removeChild(u)}t.insertBefore(o,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function YR(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function QR(e,t,r){const n=e.style,a=ur(r);if(r&&!a){for(const i in r)ov(n,i,r[i]);if(t&&!ur(t))for(const i in t)r[i]==null&&ov(n,i,"")}else{const i=n.display;a?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=i)}}const nm=/\s*!important$/;function ov(e,t,r){if(st(r))r.forEach(n=>ov(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=XR(e,t);nm.test(r)?e.setProperty(rs(n),r.replace(nm,""),"important"):e[n]=r}}const am=["Webkit","Moz","ms"],id={};function XR(e,t){const r=id[t];if(r)return r;let n=Yn(t);if(n!=="filter"&&n in e)return id[t]=n;n=Qc(n);for(let a=0;a<am.length;a++){const i=am[a]+n;if(i in e)return id[t]=i}return t}const im="http://www.w3.org/1999/xlink";function ZR(e,t,r,n,a){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(im,t.slice(6,t.length)):e.setAttributeNS(im,t,r);else{const i=YI(t);r==null||i&&!A0(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function eA(e,t,r,n,a,i,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,a,i),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const u=r==null?"":r;(e.value!==u||e.tagName==="OPTION")&&(e.value=u),r==null&&e.removeAttribute(t);return}let o=!1;if(r===""||r==null){const u=typeof e[t];u==="boolean"?r=A0(r):r==null&&u==="string"?(r="",o=!0):u==="number"&&(r=0,o=!0)}try{e[t]=r}catch{}o&&e.removeAttribute(t)}const[O$,tA]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let uv=0;const rA=Promise.resolve(),nA=()=>{uv=0},aA=()=>uv||(rA.then(nA),uv=O$());function Us(e,t,r,n){e.addEventListener(t,r,n)}function iA(e,t,r,n){e.removeEventListener(t,r,n)}function sA(e,t,r,n,a=null){const i=e._vei||(e._vei={}),s=i[t];if(n&&s)s.value=n;else{const[o,u]=oA(t);if(n){const l=i[t]=uA(n,a);Us(e,o,l,u)}else s&&(iA(e,o,s,u),i[t]=void 0)}}const sm=/(?:Once|Passive|Capture)$/;function oA(e){let t;if(sm.test(e)){t={};let n;for(;n=e.match(sm);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):rs(e.slice(2)),t]}function uA(e,t){const r=n=>{const a=n.timeStamp||O$();(tA||a>=r.attached-1)&&vn(lA(n,r.value),t,5,[n])};return r.value=e,r.attached=aA(),r}function lA(e,t){if(st(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>a=>!a._stopped&&n&&n(a))}else return t}const om=/^on[a-z]/,cA=(e,t,r,n,a=!1,i,s,o,u)=>{t==="class"?YR(e,n,a):t==="style"?QR(e,r,n):Kc(t)?kh(t)||sA(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):fA(e,t,n,a))?eA(e,t,n,i,s,o,u):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),ZR(e,t,n,a))};function fA(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&om.test(t)&&lt(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||om.test(t)&&ur(r)?!1:t in e}const dA={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};aR.props;const um=e=>{const t=e.props["onUpdate:modelValue"]||!1;return st(t)?r=>sc(t,r):t};function pA(e){e.target.composing=!0}function lm(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const P$={created(e,{modifiers:{lazy:t,trim:r,number:n}},a){e._assign=um(a);const i=n||a.props&&a.props.type==="number";Us(e,t?"change":"input",s=>{if(s.target.composing)return;let o=e.value;r&&(o=o.trim()),i&&(o=Kp(o)),e._assign(o)}),r&&Us(e,"change",()=>{e.value=e.value.trim()}),t||(Us(e,"compositionstart",pA),Us(e,"compositionend",lm),Us(e,"change",lm))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:a}},i){if(e._assign=um(i),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(a||e.type==="number")&&Kp(e.value)===t))return;const s=t==null?"":t;e.value!==s&&(e.value=s)}},vA=["ctrl","shift","alt","meta"],hA={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>vA.some(r=>e[`${r}Key`]&&!t.includes(r))},yA=(e,t)=>(r,...n)=>{for(let a=0;a<t.length;a++){const i=hA[t[a]];if(i&&i(r,t))return}return e(r,...n)},gA={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},mA=(e,t)=>r=>{if(!("key"in r))return;const n=rs(r.key);if(t.some(a=>a===n||gA[a]===n))return e(r)},xt={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):Wo(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),Wo(e,!0),n.enter(e)):n.leave(e,()=>{Wo(e,!1)}):Wo(e,t))},beforeUnmount(e,{value:t}){Wo(e,t)}};function Wo(e,t){e.style.display=t?e._vod:"none"}const bA=Sr({patchProp:cA},JR);let cm;function wA(){return cm||(cm=AR(bA))}const _A=(...e)=>{const t=wA().createApp(...e),{mount:r}=t;return t.mount=n=>{const a=SA(n);if(!a)return;const i=t._component;!lt(i)&&!i.render&&!i.template&&(i.template=a.innerHTML),a.innerHTML="";const s=r(a,!1,a instanceof SVGElement);return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),s},t};function SA(e){return ur(e)?document.querySelector(e):e}var $A=!1;/*!
  * pinia v2.0.22
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let M$;const of=e=>M$=e,x$=Symbol();function lv(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var hu;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(hu||(hu={}));function TA(){const e=j0(!0),t=e.run(()=>ht({}));let r=[],n=[];const a=io({install(i){of(a),a._a=i,i.provide(x$,a),i.config.globalProperties.$pinia=a,n.forEach(s=>r.push(s)),n=[]},use(i){return!this._a&&!$A?n.push(i):r.push(i),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return a}const N$=()=>{};function fm(e,t,r,n=N$){e.push(t);const a=()=>{const i=e.indexOf(t);i>-1&&(e.splice(i,1),n())};return!r&&Wh()&&Fh(a),a}function Ts(e,...t){e.slice().forEach(r=>{r(...t)})}function cv(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,n)=>e.set(n,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const n=t[r],a=e[r];lv(a)&&lv(n)&&e.hasOwnProperty(r)&&!Zt(n)&&!ei(n)?e[r]=cv(a,n):e[r]=n}return e}const kA=Symbol();function EA(e){return!lv(e)||!e.hasOwnProperty(kA)}const{assign:ca}=Object;function IA(e){return!!(Zt(e)&&e.effect)}function CA(e,t,r,n){const{state:a,actions:i,getters:s}=t,o=r.state.value[e];let u;function l(){o||(r.state.value[e]=a?a():{});const c=UC(r.state.value[e]);return ca(c,i,Object.keys(s||{}).reduce((h,w)=>(h[w]=io(qt(()=>{of(r);const b=r._s.get(e);return s[w].call(b,b)})),h),{}))}return u=L$(e,l,t,r,n,!0),u.$reset=function(){const h=a?a():{};this.$patch(w=>{ca(w,h)})},u}function L$(e,t,r={},n,a,i){let s;const o=ca({actions:{}},r),u={deep:!0};let l,c,h=io([]),w=io([]),b;const $=n.state.value[e];!i&&!$&&(n.state.value[e]={}),ht({});let A;function x(he){let P;l=c=!1,typeof he=="function"?(he(n.state.value[e]),P={type:hu.patchFunction,storeId:e,events:b}):(cv(n.state.value[e],he),P={type:hu.patchObject,payload:he,storeId:e,events:b});const Q=A=Symbol();jh().then(()=>{A===Q&&(l=!0)}),c=!0,Ts(h,P,n.state.value[e])}const U=N$;function D(){s.stop(),h=[],w=[],n._s.delete(e)}function de(he,P){return function(){of(n);const Q=Array.from(arguments),ce=[],W=[];function ve(J){ce.push(J)}function te(J){W.push(J)}Ts(w,{args:Q,name:he,store:Ae,after:ve,onError:te});let ae;try{ae=P.apply(this&&this.$id===e?this:Ae,Q)}catch(J){throw Ts(W,J),J}return ae instanceof Promise?ae.then(J=>(Ts(ce,J),J)).catch(J=>(Ts(W,J),Promise.reject(J))):(Ts(ce,ae),ae)}}const ue={_p:n,$id:e,$onAction:fm.bind(null,w),$patch:x,$reset:U,$subscribe(he,P={}){const Q=fm(h,he,P.detached,()=>ce()),ce=s.run(()=>Vi(()=>n.state.value[e],W=>{(P.flush==="sync"?c:l)&&he({storeId:e,type:hu.direct,events:b},W)},ca({},u,P)));return Q},$dispose:D},Ae=ns(ca({},ue));n._s.set(e,Ae);const we=n._e.run(()=>(s=j0(),s.run(()=>t())));for(const he in we){const P=we[he];if(Zt(P)&&!IA(P)||ei(P))i||($&&EA(P)&&(Zt(P)?P.value=$[he]:cv(P,$[he])),n.state.value[e][he]=P);else if(typeof P=="function"){const Q=de(he,P);we[he]=Q,o.actions[he]=P}}return ca(Ae,we),ca(bt(Ae),we),Object.defineProperty(Ae,"$state",{get:()=>n.state.value[e],set:he=>{x(P=>{ca(P,he)})}}),n._p.forEach(he=>{ca(Ae,s.run(()=>he({store:Ae,app:n._a,pinia:n,options:o})))}),$&&i&&r.hydrate&&r.hydrate(Ae.$state,$),l=!0,c=!0,Ae}function RA(e,t,r){let n,a;const i=typeof t=="function";typeof e=="string"?(n=e,a=i?r:t):(a=e,n=e.id);function s(o,u){const l=Wh();return o=o||l&&xn(x$),o&&of(o),o=M$,o._s.has(n)||(i?L$(n,t,a,o):CA(n,a,o)),o._s.get(n)}return s.$id=n,s}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Fs=typeof window<"u";function AA(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const At=Object.assign;function sd(e,t){const r={};for(const n in t){const a=t[n];r[n]=Nn(a)?a.map(e):e(a)}return r}const yu=()=>{},Nn=Array.isArray,OA=/\/$/,PA=e=>e.replace(OA,"");function od(e,t,r="/"){let n,a={},i="",s="";const o=t.indexOf("#");let u=t.indexOf("?");return o<u&&o>=0&&(u=-1),u>-1&&(n=t.slice(0,u),i=t.slice(u+1,o>-1?o:t.length),a=e(i)),o>-1&&(n=n||t.slice(0,o),s=t.slice(o,t.length)),n=LA(n!=null?n:t,r),{fullPath:n+(i&&"?")+i+s,path:n,query:a,hash:s}}function MA(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function dm(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function xA(e,t,r){const n=t.matched.length-1,a=r.matched.length-1;return n>-1&&n===a&&oo(t.matched[n],r.matched[a])&&j$(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function oo(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function j$(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!NA(e[r],t[r]))return!1;return!0}function NA(e,t){return Nn(e)?pm(e,t):Nn(t)?pm(t,e):e===t}function pm(e,t){return Nn(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function LA(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let a=r.length-1,i,s;for(i=0;i<n.length;i++)if(s=n[i],s!==".")if(s==="..")a>1&&a--;else break;return r.slice(0,a).join("/")+"/"+n.slice(i-(i===n.length?1:0)).join("/")}var Ou;(function(e){e.pop="pop",e.push="push"})(Ou||(Ou={}));var gu;(function(e){e.back="back",e.forward="forward",e.unknown=""})(gu||(gu={}));function jA(e){if(!e)if(Fs){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),PA(e)}const UA=/^[^#]+#/;function FA(e,t){return e.replace(UA,"#")+t}function DA(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const uf=()=>({left:window.pageXOffset,top:window.pageYOffset});function BA(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),a=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!a)return;t=DA(a,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function vm(e,t){return(history.state?history.state.position-t:-1)+e}const fv=new Map;function qA(e,t){fv.set(e,t)}function HA(e){const t=fv.get(e);return fv.delete(e),t}let WA=()=>location.protocol+"//"+location.host;function U$(e,t){const{pathname:r,search:n,hash:a}=t,i=e.indexOf("#");if(i>-1){let o=a.includes(e.slice(i))?e.slice(i).length:1,u=a.slice(o);return u[0]!=="/"&&(u="/"+u),dm(u,"")}return dm(r,e)+n+a}function GA(e,t,r,n){let a=[],i=[],s=null;const o=({state:w})=>{const b=U$(e,location),$=r.value,A=t.value;let x=0;if(w){if(r.value=b,t.value=w,s&&s===$){s=null;return}x=A?w.position-A.position:0}else n(b);a.forEach(U=>{U(r.value,$,{delta:x,type:Ou.pop,direction:x?x>0?gu.forward:gu.back:gu.unknown})})};function u(){s=r.value}function l(w){a.push(w);const b=()=>{const $=a.indexOf(w);$>-1&&a.splice($,1)};return i.push(b),b}function c(){const{history:w}=window;!w.state||w.replaceState(At({},w.state,{scroll:uf()}),"")}function h(){for(const w of i)w();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",c),{pauseListeners:u,listen:l,destroy:h}}function hm(e,t,r,n=!1,a=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:a?uf():null}}function zA(e){const{history:t,location:r}=window,n={value:U$(e,r)},a={value:t.state};a.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(u,l,c){const h=e.indexOf("#"),w=h>-1?(r.host&&document.querySelector("base")?e:e.slice(h))+u:WA()+e+u;try{t[c?"replaceState":"pushState"](l,"",w),a.value=l}catch(b){console.error(b),r[c?"replace":"assign"](w)}}function s(u,l){const c=At({},t.state,hm(a.value.back,u,a.value.forward,!0),l,{position:a.value.position});i(u,c,!0),n.value=u}function o(u,l){const c=At({},a.value,t.state,{forward:u,scroll:uf()});i(c.current,c,!0);const h=At({},hm(n.value,u,null),{position:c.position+1},l);i(u,h,!1),n.value=u}return{location:n,state:a,push:o,replace:s}}function VA(e){e=jA(e);const t=zA(e),r=GA(e,t.state,t.location,t.replace);function n(i,s=!0){s||r.pauseListeners(),history.go(i)}const a=At({location:"",base:e,go:n,createHref:FA.bind(null,e)},t,r);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>t.state.value}),a}function KA(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),VA(e)}function JA(e){return typeof e=="string"||e&&typeof e=="object"}function F$(e){return typeof e=="string"||typeof e=="symbol"}const Ba={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},D$=Symbol("");var ym;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(ym||(ym={}));function uo(e,t){return At(new Error,{type:e,[D$]:!0},t)}function sa(e,t){return e instanceof Error&&D$ in e&&(t==null||!!(e.type&t))}const gm="[^/]+?",YA={sensitive:!1,strict:!1,start:!0,end:!0},QA=/[.+*?^${}()[\]/\\]/g;function XA(e,t){const r=At({},YA,t),n=[];let a=r.start?"^":"";const i=[];for(const l of e){const c=l.length?[]:[90];r.strict&&!l.length&&(a+="/");for(let h=0;h<l.length;h++){const w=l[h];let b=40+(r.sensitive?.25:0);if(w.type===0)h||(a+="/"),a+=w.value.replace(QA,"\\$&"),b+=40;else if(w.type===1){const{value:$,repeatable:A,optional:x,regexp:U}=w;i.push({name:$,repeatable:A,optional:x});const D=U||gm;if(D!==gm){b+=10;try{new RegExp(`(${D})`)}catch(ue){throw new Error(`Invalid custom RegExp for param "${$}" (${D}): `+ue.message)}}let de=A?`((?:${D})(?:/(?:${D}))*)`:`(${D})`;h||(de=x&&l.length<2?`(?:/${de})`:"/"+de),x&&(de+="?"),a+=de,b+=20,x&&(b+=-8),A&&(b+=-20),D===".*"&&(b+=-50)}c.push(b)}n.push(c)}if(r.strict&&r.end){const l=n.length-1;n[l][n[l].length-1]+=.7000000000000001}r.strict||(a+="/?"),r.end?a+="$":r.strict&&(a+="(?:/|$)");const s=new RegExp(a,r.sensitive?"":"i");function o(l){const c=l.match(s),h={};if(!c)return null;for(let w=1;w<c.length;w++){const b=c[w]||"",$=i[w-1];h[$.name]=b&&$.repeatable?b.split("/"):b}return h}function u(l){let c="",h=!1;for(const w of e){(!h||!c.endsWith("/"))&&(c+="/"),h=!1;for(const b of w)if(b.type===0)c+=b.value;else if(b.type===1){const{value:$,repeatable:A,optional:x}=b,U=$ in l?l[$]:"";if(Nn(U)&&!A)throw new Error(`Provided param "${$}" is an array but it is not repeatable (* or + modifiers)`);const D=Nn(U)?U.join("/"):U;if(!D)if(x)w.length<2&&(c.endsWith("/")?c=c.slice(0,-1):h=!0);else throw new Error(`Missing required param "${$}"`);c+=D}}return c||"/"}return{re:s,score:n,keys:i,parse:o,stringify:u}}function ZA(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function eO(e,t){let r=0;const n=e.score,a=t.score;for(;r<n.length&&r<a.length;){const i=ZA(n[r],a[r]);if(i)return i;r++}if(Math.abs(a.length-n.length)===1){if(mm(n))return 1;if(mm(a))return-1}return a.length-n.length}function mm(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const tO={type:0,value:""},rO=/[a-zA-Z0-9_]/;function nO(e){if(!e)return[[]];if(e==="/")return[[tO]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${r})/"${l}": ${b}`)}let r=0,n=r;const a=[];let i;function s(){i&&a.push(i),i=[]}let o=0,u,l="",c="";function h(){!l||(r===0?i.push({type:0,value:l}):r===1||r===2||r===3?(i.length>1&&(u==="*"||u==="+")&&t(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:c,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):t("Invalid state to consume buffer"),l="")}function w(){l+=u}for(;o<e.length;){if(u=e[o++],u==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:u==="/"?(l&&h(),s()):u===":"?(h(),r=1):w();break;case 4:w(),r=n;break;case 1:u==="("?r=2:rO.test(u)?w():(h(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&o--);break;case 2:u===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+u:r=3:c+=u;break;case 3:h(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&o--,c="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${l}"`),h(),s(),a}function aO(e,t,r){const n=XA(nO(e.path),r),a=At(n,{record:e,parent:t,children:[],alias:[]});return t&&!a.record.aliasOf==!t.record.aliasOf&&t.children.push(a),a}function iO(e,t){const r=[],n=new Map;t=_m({strict:!1,end:!0,sensitive:!1},t);function a(c){return n.get(c)}function i(c,h,w){const b=!w,$=sO(c);$.aliasOf=w&&w.record;const A=_m(t,c),x=[$];if("alias"in c){const de=typeof c.alias=="string"?[c.alias]:c.alias;for(const ue of de)x.push(At({},$,{components:w?w.record.components:$.components,path:ue,aliasOf:w?w.record:$}))}let U,D;for(const de of x){const{path:ue}=de;if(h&&ue[0]!=="/"){const Ae=h.record.path,we=Ae[Ae.length-1]==="/"?"":"/";de.path=h.record.path+(ue&&we+ue)}if(U=aO(de,h,A),w?w.alias.push(U):(D=D||U,D!==U&&D.alias.push(U),b&&c.name&&!wm(U)&&s(c.name)),$.children){const Ae=$.children;for(let we=0;we<Ae.length;we++)i(Ae[we],U,w&&w.children[we])}w=w||U,u(U)}return D?()=>{s(D)}:yu}function s(c){if(F$(c)){const h=n.get(c);h&&(n.delete(c),r.splice(r.indexOf(h),1),h.children.forEach(s),h.alias.forEach(s))}else{const h=r.indexOf(c);h>-1&&(r.splice(h,1),c.record.name&&n.delete(c.record.name),c.children.forEach(s),c.alias.forEach(s))}}function o(){return r}function u(c){let h=0;for(;h<r.length&&eO(c,r[h])>=0&&(c.record.path!==r[h].record.path||!B$(c,r[h]));)h++;r.splice(h,0,c),c.record.name&&!wm(c)&&n.set(c.record.name,c)}function l(c,h){let w,b={},$,A;if("name"in c&&c.name){if(w=n.get(c.name),!w)throw uo(1,{location:c});A=w.record.name,b=At(bm(h.params,w.keys.filter(D=>!D.optional).map(D=>D.name)),c.params&&bm(c.params,w.keys.map(D=>D.name))),$=w.stringify(b)}else if("path"in c)$=c.path,w=r.find(D=>D.re.test($)),w&&(b=w.parse($),A=w.record.name);else{if(w=h.name?n.get(h.name):r.find(D=>D.re.test(h.path)),!w)throw uo(1,{location:c,currentLocation:h});A=w.record.name,b=At({},h.params,c.params),$=w.stringify(b)}const x=[];let U=w;for(;U;)x.unshift(U.record),U=U.parent;return{name:A,path:$,params:b,matched:x,meta:uO(x)}}return e.forEach(c=>i(c)),{addRoute:i,resolve:l,removeRoute:s,getRoutes:o,getRecordMatcher:a}}function bm(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function sO(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:oO(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function oO(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function wm(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function uO(e){return e.reduce((t,r)=>At(t,r.meta),{})}function _m(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function B$(e,t){return t.children.some(r=>r===e||B$(e,r))}const q$=/#/g,lO=/&/g,cO=/\//g,fO=/=/g,dO=/\?/g,H$=/\+/g,pO=/%5B/g,vO=/%5D/g,W$=/%5E/g,hO=/%60/g,G$=/%7B/g,yO=/%7C/g,z$=/%7D/g,gO=/%20/g;function Gh(e){return encodeURI(""+e).replace(yO,"|").replace(pO,"[").replace(vO,"]")}function mO(e){return Gh(e).replace(G$,"{").replace(z$,"}").replace(W$,"^")}function dv(e){return Gh(e).replace(H$,"%2B").replace(gO,"+").replace(q$,"%23").replace(lO,"%26").replace(hO,"`").replace(G$,"{").replace(z$,"}").replace(W$,"^")}function bO(e){return dv(e).replace(fO,"%3D")}function wO(e){return Gh(e).replace(q$,"%23").replace(dO,"%3F")}function _O(e){return e==null?"":wO(e).replace(cO,"%2F")}function $c(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function SO(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const i=n[a].replace(H$," "),s=i.indexOf("="),o=$c(s<0?i:i.slice(0,s)),u=s<0?null:$c(i.slice(s+1));if(o in t){let l=t[o];Nn(l)||(l=t[o]=[l]),l.push(u)}else t[o]=u}return t}function Sm(e){let t="";for(let r in e){const n=e[r];if(r=bO(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Nn(n)?n.map(i=>i&&dv(i)):[n&&dv(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function $O(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Nn(n)?n.map(a=>a==null?null:""+a):n==null?n:""+n)}return t}const TO=Symbol(""),$m=Symbol(""),lf=Symbol(""),zh=Symbol(""),pv=Symbol("");function Go(){let e=[];function t(n){return e.push(n),()=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function Ka(e,t,r,n,a){const i=n&&(n.enterCallbacks[a]=n.enterCallbacks[a]||[]);return()=>new Promise((s,o)=>{const u=h=>{h===!1?o(uo(4,{from:r,to:t})):h instanceof Error?o(h):JA(h)?o(uo(2,{from:t,to:h})):(i&&n.enterCallbacks[a]===i&&typeof h=="function"&&i.push(h),s())},l=e.call(n&&n.instances[a],t,r,u);let c=Promise.resolve(l);e.length<3&&(c=c.then(u)),c.catch(h=>o(h))})}function ud(e,t,r,n){const a=[];for(const i of e)for(const s in i.components){let o=i.components[s];if(!(t!=="beforeRouteEnter"&&!i.instances[s]))if(kO(o)){const l=(o.__vccOpts||o)[t];l&&a.push(Ka(l,r,n,i,s))}else{let u=o();a.push(()=>u.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${i.path}"`));const c=AA(l)?l.default:l;i.components[s]=c;const w=(c.__vccOpts||c)[t];return w&&Ka(w,r,n,i,s)()}))}}return a}function kO(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Tm(e){const t=xn(lf),r=xn(zh),n=qt(()=>t.resolve(St(e.to))),a=qt(()=>{const{matched:u}=n.value,{length:l}=u,c=u[l-1],h=r.matched;if(!c||!h.length)return-1;const w=h.findIndex(oo.bind(null,c));if(w>-1)return w;const b=km(u[l-2]);return l>1&&km(c)===b&&h[h.length-1].path!==b?h.findIndex(oo.bind(null,u[l-2])):w}),i=qt(()=>a.value>-1&&CO(r.params,n.value.params)),s=qt(()=>a.value>-1&&a.value===r.matched.length-1&&j$(r.params,n.value.params));function o(u={}){return IO(u)?t[St(e.replace)?"replace":"push"](St(e.to)).catch(yu):Promise.resolve()}return{route:n,href:qt(()=>n.value.href),isActive:i,isExactActive:s,navigate:o}}const EO=d$({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Tm,setup(e,{slots:t}){const r=ns(Tm(e)),{options:n}=xn(lf),a=qt(()=>({[Em(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Em(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&t.default(r);return e.custom?i:A$("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:a.value},i)}}}),V$=EO;function IO(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function CO(e,t){for(const r in t){const n=t[r],a=e[r];if(typeof n=="string"){if(n!==a)return!1}else if(!Nn(a)||a.length!==n.length||n.some((i,s)=>i!==a[s]))return!1}return!0}function km(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Em=(e,t,r)=>e!=null?e:t!=null?t:r,RO=d$({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=xn(pv),a=qt(()=>e.route||n.value),i=xn($m,0),s=qt(()=>{let l=St(i);const{matched:c}=a.value;let h;for(;(h=c[l])&&!h.components;)l++;return l}),o=qt(()=>a.value.matched[s.value]);oc($m,qt(()=>s.value+1)),oc(TO,o),oc(pv,a);const u=ht();return Vi(()=>[u.value,o.value,e.name],([l,c,h],[w,b,$])=>{c&&(c.instances[h]=l,b&&b!==c&&l&&l===w&&(c.leaveGuards.size||(c.leaveGuards=b.leaveGuards),c.updateGuards.size||(c.updateGuards=b.updateGuards))),l&&c&&(!b||!oo(c,b)||!w)&&(c.enterCallbacks[h]||[]).forEach(A=>A(l))},{flush:"post"}),()=>{const l=a.value,c=e.name,h=o.value,w=h&&h.components[c];if(!w)return Im(r.default,{Component:w,route:l});const b=h.props[c],$=b?b===!0?l.params:typeof b=="function"?b(l):b:null,x=A$(w,At({},$,t,{onVnodeUnmounted:U=>{U.component.isUnmounted&&(h.instances[c]=null)},ref:u}));return Im(r.default,{Component:x,route:l})||x}}});function Im(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const K$=RO;function AO(e){const t=iO(e.routes,e),r=e.parseQuery||SO,n=e.stringifyQuery||Sm,a=e.history,i=Go(),s=Go(),o=Go(),u=X0(Ba);let l=Ba;Fs&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=sd.bind(null,B=>""+B),h=sd.bind(null,_O),w=sd.bind(null,$c);function b(B,T){let Te,ye;return F$(B)?(Te=t.getRecordMatcher(B),ye=T):ye=B,t.addRoute(ye,Te)}function $(B){const T=t.getRecordMatcher(B);T&&t.removeRoute(T)}function A(){return t.getRoutes().map(B=>B.record)}function x(B){return!!t.getRecordMatcher(B)}function U(B,T){if(T=At({},T||u.value),typeof B=="string"){const Ge=od(r,B,T.path),R=t.resolve({path:Ge.path},T),I=a.createHref(Ge.fullPath);return At(Ge,R,{params:w(R.params),hash:$c(Ge.hash),redirectedFrom:void 0,href:I})}let Te;if("path"in B)Te=At({},B,{path:od(r,B.path,T.path).path});else{const Ge=At({},B.params);for(const R in Ge)Ge[R]==null&&delete Ge[R];Te=At({},B,{params:h(B.params)}),T.params=h(T.params)}const ye=t.resolve(Te,T),Ke=B.hash||"";ye.params=c(w(ye.params));const Qe=MA(n,At({},B,{hash:mO(Ke),path:ye.path})),Se=a.createHref(Qe);return At({fullPath:Qe,hash:Ke,query:n===Sm?$O(B.query):B.query||{}},ye,{redirectedFrom:void 0,href:Se})}function D(B){return typeof B=="string"?od(r,B,u.value.path):At({},B)}function de(B,T){if(l!==B)return uo(8,{from:T,to:B})}function ue(B){return he(B)}function Ae(B){return ue(At(D(B),{replace:!0}))}function we(B){const T=B.matched[B.matched.length-1];if(T&&T.redirect){const{redirect:Te}=T;let ye=typeof Te=="function"?Te(B):Te;return typeof ye=="string"&&(ye=ye.includes("?")||ye.includes("#")?ye=D(ye):{path:ye},ye.params={}),At({query:B.query,hash:B.hash,params:"path"in ye?{}:B.params},ye)}}function he(B,T){const Te=l=U(B),ye=u.value,Ke=B.state,Qe=B.force,Se=B.replace===!0,Ge=we(Te);if(Ge)return he(At(D(Ge),{state:typeof Ge=="object"?At({},Ke,Ge.state):Ke,force:Qe,replace:Se}),T||Te);const R=Te;R.redirectedFrom=T;let I;return!Qe&&xA(n,ye,Te)&&(I=uo(16,{to:R,from:ye}),dt(ye,ye,!0,!1)),(I?Promise.resolve(I):Q(R,ye)).catch(K=>sa(K)?sa(K,2)?K:N(K):Re(K,R,ye)).then(K=>{if(K){if(sa(K,2))return he(At({replace:Se},D(K.to),{state:typeof K.to=="object"?At({},Ke,K.to.state):Ke,force:Qe}),T||R)}else K=W(R,ye,!0,Se,Ke);return ce(R,ye,K),K})}function P(B,T){const Te=de(B,T);return Te?Promise.reject(Te):Promise.resolve()}function Q(B,T){let Te;const[ye,Ke,Qe]=OO(B,T);Te=ud(ye.reverse(),"beforeRouteLeave",B,T);for(const Ge of ye)Ge.leaveGuards.forEach(R=>{Te.push(Ka(R,B,T))});const Se=P.bind(null,B,T);return Te.push(Se),ks(Te).then(()=>{Te=[];for(const Ge of i.list())Te.push(Ka(Ge,B,T));return Te.push(Se),ks(Te)}).then(()=>{Te=ud(Ke,"beforeRouteUpdate",B,T);for(const Ge of Ke)Ge.updateGuards.forEach(R=>{Te.push(Ka(R,B,T))});return Te.push(Se),ks(Te)}).then(()=>{Te=[];for(const Ge of B.matched)if(Ge.beforeEnter&&!T.matched.includes(Ge))if(Nn(Ge.beforeEnter))for(const R of Ge.beforeEnter)Te.push(Ka(R,B,T));else Te.push(Ka(Ge.beforeEnter,B,T));return Te.push(Se),ks(Te)}).then(()=>(B.matched.forEach(Ge=>Ge.enterCallbacks={}),Te=ud(Qe,"beforeRouteEnter",B,T),Te.push(Se),ks(Te))).then(()=>{Te=[];for(const Ge of s.list())Te.push(Ka(Ge,B,T));return Te.push(Se),ks(Te)}).catch(Ge=>sa(Ge,8)?Ge:Promise.reject(Ge))}function ce(B,T,Te){for(const ye of o.list())ye(B,T,Te)}function W(B,T,Te,ye,Ke){const Qe=de(B,T);if(Qe)return Qe;const Se=T===Ba,Ge=Fs?history.state:{};Te&&(ye||Se?a.replace(B.fullPath,At({scroll:Se&&Ge&&Ge.scroll},Ke)):a.push(B.fullPath,Ke)),u.value=B,dt(B,T,Te,Se),N()}let ve;function te(){ve||(ve=a.listen((B,T,Te)=>{if(!Ye.listening)return;const ye=U(B),Ke=we(ye);if(Ke){he(At(Ke,{replace:!0}),ye).catch(yu);return}l=ye;const Qe=u.value;Fs&&qA(vm(Qe.fullPath,Te.delta),uf()),Q(ye,Qe).catch(Se=>sa(Se,12)?Se:sa(Se,2)?(he(Se.to,ye).then(Ge=>{sa(Ge,20)&&!Te.delta&&Te.type===Ou.pop&&a.go(-1,!1)}).catch(yu),Promise.reject()):(Te.delta&&a.go(-Te.delta,!1),Re(Se,ye,Qe))).then(Se=>{Se=Se||W(ye,Qe,!1),Se&&(Te.delta&&!sa(Se,8)?a.go(-Te.delta,!1):Te.type===Ou.pop&&sa(Se,20)&&a.go(-1,!1)),ce(ye,Qe,Se)}).catch(yu)}))}let ae=Go(),J=Go(),ie;function Re(B,T,Te){N(B);const ye=J.list();return ye.length?ye.forEach(Ke=>Ke(B,T,Te)):console.error(B),Promise.reject(B)}function ke(){return ie&&u.value!==Ba?Promise.resolve():new Promise((B,T)=>{ae.add([B,T])})}function N(B){return ie||(ie=!B,te(),ae.list().forEach(([T,Te])=>B?Te(B):T()),ae.reset()),B}function dt(B,T,Te,ye){const{scrollBehavior:Ke}=e;if(!Fs||!Ke)return Promise.resolve();const Qe=!Te&&HA(vm(B.fullPath,0))||(ye||!Te)&&history.state&&history.state.scroll||null;return jh().then(()=>Ke(B,T,Qe)).then(Se=>Se&&BA(Se)).catch(Se=>Re(Se,B,T))}const pt=B=>a.go(B);let Ee;const Xe=new Set,Ye={currentRoute:u,listening:!0,addRoute:b,removeRoute:$,hasRoute:x,getRoutes:A,resolve:U,options:e,push:ue,replace:Ae,go:pt,back:()=>pt(-1),forward:()=>pt(1),beforeEach:i.add,beforeResolve:s.add,afterEach:o.add,onError:J.add,isReady:ke,install(B){const T=this;B.component("RouterLink",V$),B.component("RouterView",K$),B.config.globalProperties.$router=T,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>St(u)}),Fs&&!Ee&&u.value===Ba&&(Ee=!0,ue(a.location).catch(Ke=>{}));const Te={};for(const Ke in Ba)Te[Ke]=qt(()=>u.value[Ke]);B.provide(lf,T),B.provide(zh,ns(Te)),B.provide(pv,u);const ye=B.unmount;Xe.add(B),B.unmount=function(){Xe.delete(B),Xe.size<1&&(l=Ba,ve&&ve(),ve=null,u.value=Ba,Ee=!1,ie=!1),ye()}}};return Ye}function ks(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function OO(e,t){const r=[],n=[],a=[],i=Math.max(t.matched.length,e.matched.length);for(let s=0;s<i;s++){const o=t.matched[s];o&&(e.matched.find(l=>oo(l,o))?n.push(o):r.push(o));const u=e.matched[s];u&&(t.matched.find(l=>oo(l,u))||a.push(u))}return[r,n,a]}function PO(){return xn(lf)}function MO(){return xn(zh)}const xO={__name:"App",setup(e){return(t,r)=>(et(),Xi(St(K$)))}},as=(e,t)=>{const r=e.__vccOpts||e;for(const[n,a]of t)r[n]=a;return r},NO={name:"Header",setup(){return{}}},LO={class:"container-fluid"},jO={class:"d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom"},UO=le("img",{class:"me-4",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"},null,-1),FO=le("span",{class:"fs-4",style:{color:"#f22f46"}},"Conversations (End User)",-1),DO={class:"nav nav-pills"},BO={class:"nav-item"},qO=le("i",{class:"bi-house"},null,-1),HO=Ut(" Home");function WO(e,t,r,n,a,i){const s=ui("router-link");return et(),ct("div",LO,[le("header",jO,[Vt(s,{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",to:"/"},{default:oi(()=>[UO,FO]),_:1}),le("ul",DO,[le("li",BO,[Vt(s,{class:"btn btn-info btn-sm",to:"/"},{default:oi(()=>[qO,HO]),_:1})])])])])}const GO=as(NO,[["render",WO]]),zO={name:"Footer"},VO={class:"footer mt-auto py-3 bg-light pb-5"},KO=le("div",{class:"container text-center pb-5"},[le("img",{class:"",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"})],-1),JO=[KO];function YO(e,t,r,n,a,i){return et(),ct("footer",VO,JO)}const QO=as(zO,[["render",YO]]),XO={name:"Layout",components:{Header:GO,Footer:QO}};function ZO(e,t,r,n,a,i){const s=ui("Header"),o=ui("Footer");return et(),ct("div",null,[Vt(s),yR(e.$slots,"default"),Vt(o)])}const J$=as(XO,[["render",ZO]]);var Cm;const Hu=typeof window<"u",eP=e=>typeof e=="function",tP=e=>typeof e=="string",ld=()=>{};Hu&&((Cm=window==null?void 0:window.navigator)==null?void 0:Cm.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Y$(e){return typeof e=="function"?e():St(e)}function rP(e,t){function r(...n){e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})}return r}const Q$=e=>e();function nP(e=Q$){const t=ht(!0);function r(){t.value=!1}function n(){t.value=!0}return{isActive:t,pause:r,resume:n,eventFilter:(...i)=>{t.value&&e(...i)}}}function aP(e){return e}function iP(e){return uC()?(lC(e),!0):!1}var Rm=Object.getOwnPropertySymbols,sP=Object.prototype.hasOwnProperty,oP=Object.prototype.propertyIsEnumerable,uP=(e,t)=>{var r={};for(var n in e)sP.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Rm)for(var n of Rm(e))t.indexOf(n)<0&&oP.call(e,n)&&(r[n]=e[n]);return r};function lP(e,t,r={}){const n=r,{eventFilter:a=Q$}=n,i=uP(n,["eventFilter"]);return Vi(e,rP(a,t),i)}var cP=Object.defineProperty,fP=Object.defineProperties,dP=Object.getOwnPropertyDescriptors,Tc=Object.getOwnPropertySymbols,X$=Object.prototype.hasOwnProperty,Z$=Object.prototype.propertyIsEnumerable,Am=(e,t,r)=>t in e?cP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pP=(e,t)=>{for(var r in t||(t={}))X$.call(t,r)&&Am(e,r,t[r]);if(Tc)for(var r of Tc(t))Z$.call(t,r)&&Am(e,r,t[r]);return e},vP=(e,t)=>fP(e,dP(t)),hP=(e,t)=>{var r={};for(var n in e)X$.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Tc)for(var n of Tc(e))t.indexOf(n)<0&&Z$.call(e,n)&&(r[n]=e[n]);return r};function yP(e,t,r={}){const n=r,{eventFilter:a}=n,i=hP(n,["eventFilter"]),{eventFilter:s,pause:o,resume:u,isActive:l}=nP(a);return{stop:lP(e,t,vP(pP({},i),{eventFilter:s})),pause:o,resume:u,isActive:l}}function gP(e){var t;const r=Y$(e);return(t=r==null?void 0:r.$el)!=null?t:r}const vv=Hu?window:void 0;Hu&&window.document;Hu&&window.navigator;Hu&&window.location;function mP(...e){let t,r,n,a;if(tP(e[0])?([r,n,a]=e,t=vv):[t,r,n,a]=e,!t)return ld;let i=ld;const s=Vi(()=>gP(t),u=>{i(),u&&(u.addEventListener(r,n,a),i=()=>{u.removeEventListener(r,n,a),i=ld})},{immediate:!0,flush:"post"}),o=()=>{s(),i()};return iP(o),o}const hv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yv="__vueuse_ssr_handlers__";hv[yv]=hv[yv]||{};const bP=hv[yv];function wP(e,t){return bP[e]||t}function _P(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"||Array.isArray(e)?"object":Number.isNaN(e)?"any":"number"}var SP=Object.defineProperty,Om=Object.getOwnPropertySymbols,$P=Object.prototype.hasOwnProperty,TP=Object.prototype.propertyIsEnumerable,Pm=(e,t,r)=>t in e?SP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Mm=(e,t)=>{for(var r in t||(t={}))$P.call(t,r)&&Pm(e,r,t[r]);if(Om)for(var r of Om(t))TP.call(t,r)&&Pm(e,r,t[r]);return e};const kP={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}};function EP(e,t,r,n={}){var a;const{flush:i="pre",deep:s=!0,listenToStorageChanges:o=!0,writeDefaults:u=!0,mergeDefaults:l=!1,shallow:c,window:h=vv,eventFilter:w,onError:b=he=>{console.error(he)}}=n,$=(c?X0:ht)(t);if(!r)try{r=wP("getDefaultStorage",()=>{var he;return(he=vv)==null?void 0:he.localStorage})()}catch(he){b(he)}if(!r)return $;const A=Y$(t),x=_P(A),U=(a=n.serializer)!=null?a:kP[x],{pause:D,resume:de}=yP($,()=>ue($.value),{flush:i,deep:s,eventFilter:w});return h&&o&&mP(h,"storage",we),we(),$;function ue(he){try{he==null?r.removeItem(e):r.setItem(e,U.write(he))}catch(P){b(P)}}function Ae(he){if(!(he&&he.key!==e)){D();try{const P=he?he.newValue:r.getItem(e);if(P==null)return u&&A!==null&&r.setItem(e,U.write(A)),A;if(!he&&l){const Q=U.read(P);return eP(l)?l(Q,A):x==="object"&&!Array.isArray(Q)?Mm(Mm({},A),Q):Q}else return typeof P!="string"?P:U.read(P)}catch(P){b(P)}finally{de()}}}function we(he){he&&he.key!==e||($.value=Ae(he))}}var xm;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(xm||(xm={}));var IP=Object.defineProperty,Nm=Object.getOwnPropertySymbols,CP=Object.prototype.hasOwnProperty,RP=Object.prototype.propertyIsEnumerable,Lm=(e,t,r)=>t in e?IP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,AP=(e,t)=>{for(var r in t||(t={}))CP.call(t,r)&&Lm(e,r,t[r]);if(Nm)for(var r of Nm(t))RP.call(t,r)&&Lm(e,r,t[r]);return e};const OP={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};AP({linear:aP},OP);const cf=RA("end-user",{state:()=>({endUser:EP("endUser",{name:"",avatar:"",accessToken:"",supportConversation:""},localStorage,{mergeDefaults:!0})}),getters:{},actions:{async getToken(){try{let e=`/auth/token?identity=${this.endUser.name}`;const t=await fetch(e,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.endUser.accessToken=r.accessToken,console.log("token value set...")}}catch(e){console.log("getToken error => ",e)}},logout(){this.endUser.name="",this.endUser.avatar="",this.endUser.accessToken="",this.endUser.supportConversation="none"}}});function gv(e,t,r,n){let a={displayName:r,avatar:n,sms:!1,chat:!1,whatsapp:!1,enduser:!1,agent:!1};switch(e){case"sms":a.sms=!0;break;case"chat":a.chat=!0;break;case"whatsapp":a.whatsapp=!0;break}switch(t){case"enduser":a.enduser=!0;break;case"agent":a.agent=!0;break}return JSON.stringify(a)}function e1(e){let t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} @ ${t.getHours()}:${String(t.getMinutes()).padStart(2,"0")}`}const PP={class:"container-fluid"},MP={class:"row pb-5 mb-5"},xP={class:"col-8"},NP=le("h2",{class:"mb-5"},"Twilio Conversations Web Chat Demo!",-1),LP=le("div",{class:"alert alert-info mb-5 fs-5 fw-bold text-center"}," With this demo, you can experience a custom web chat client powered by Twilio Conversations. ",-1),jP=le("div",{class:"card-header fs-2"},[le("b",null,"Access Token")],-1),UP={class:"card-body"},FP={class:"card-title mb-5"},DP=["src"],BP={class:"card-text fs-4 mb-5"},qP={class:"mb-3"},HP=le("label",{for:"newname",class:"form-label"},[le("h4",null,"Enter Your Name")],-1),WP={class:"d-grid"},GP=le("i",{class:"bi-save"},null,-1),zP=Ut(" Save Name "),VP=[GP,zP],KP=le("p",{class:"card-text fs-4 mb-5"}," Great, now create an access token... ",-1),JP=le("i",{class:"bi-coin"},null,-1),YP=Ut(" Create Token "),QP=[JP,YP],XP={class:"spinner-border",role:"status"},ZP=le("span",{class:"visually-hidden"},"Loading...",-1),eM=[ZP],tM={class:"card-text fs-4 mb-5"},rM=le("i",{class:"bi-recycle"},null,-1),nM=Ut(" Refresh Token "),aM=[rM,nM],iM={class:"spinner-border",role:"status"},sM=le("span",{class:"visually-hidden"},"Loading...",-1),oM=[sM],uM={disabled:"",class:"btn btn-info"},lM=le("i",{class:"bi-check"},null,-1),cM=Ut(" Token Refreshed "),fM=[lM,cM],dM=le("i",{class:"bi-eye"},null,-1),pM=Ut(" View Token "),vM=[dM,pM],hM={class:"mt-4 text-break"},yM=le("i",{class:"bi-box-arrow-left"},null,-1),gM=Ut(" Logout "),mM=[yM,gM],bM={class:"card mb-5 text-bg-warning"},wM=le("div",{class:"card-header fs-2"},[le("b",null,[le("i",{class:"bi-life-preserver"}),Ut(" Chat Support")])],-1),_M={class:"card-body"},SM=le("i",{class:"bi-life-preserver"},null,-1),$M=Ut(" Create Chat Support Session "),TM=[SM,$M],kM={key:0,class:"d-grid mt-5 mb-5"},EM=["onClick"],IM=le("i",{class:"bi-chat-left-dots-fill"},null,-1),CM=Ut(" Enter Chat Support "),RM=[IM,CM],AM={class:"card mb-5 text-bg-light"},OM=le("div",{class:"card-header fs-2"},[le("b",null,[le("i",{class:"bi-chat-left-dots-fill"}),Ut(" Chat Channels")])],-1),PM={class:"card-body"},MM=le("i",{class:"bi-recycle"},null,-1),xM=Ut(" Refresh Chat Channels "),NM=[MM,xM],LM={class:"table table-striped mt-4 mb-5 fs-4"},jM=le("thead",null,[le("tr",null,[le("th",{class:"text-center"},"Channel Name"),le("th",{class:"text-center"},"Date Created"),le("th",{class:"text-center"},"\xA0")])],-1),UM={class:"text-center"},FM={class:"text-center"},DM={class:"text-center"},BM=["onClick"],qM=le("i",{class:"bi-play-fill"},null,-1),HM=Ut(" Join and Enter "),WM=[qM,HM],GM=le("div",{class:"col pt-5"},[le("div",{class:"text-center"},[le("img",{class:"img-fluid",style:{"max-width":"450px"},src:"https://twilio-cms-prod.s3.amazonaws.com/images/diagram-conversat.width-1200.format-webp.webpquality-75.webp"})])],-1),zM={__name:"Home",setup(e){const t=cf(),r=PO();ht("");const n=ht(!1),a=ht(!1);ht("notset");const i=ht(""),s=ht(!1),o=ht(!1),u=ht(!1),l=qt(()=>t.endUser!=null&&t.endUser.supportConversation!==""&&t.endUser.supportConversation!=="none"),c=qt(()=>t.endUser!=null&&t.endUser.accessToken!==""),h=qt(()=>t.endUser!=null&&t.endUser.name!=="");function w(P,Q){return Math.floor(Math.random()*(Q-P+1)+P)}const b=ht(""),$=async()=>{t.endUser.name=b.value;let P=w(1,700);t.endUser.avatar=`https://picsum.photos/id/${P}/50`},A=async()=>{o.value=!0,await t.getToken(),o.value=!1,u.value=!0,await Ae()},x=ht("Support");ht(["Support","ChatChannel"]);const U=async()=>{try{let P={conversationType:x.value,createdBy:t.endUser.name};const ce=await fetch("/conversations/conversation-create",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationName:t.endUser.name+" (inbound chat)",attributes:P}})});if(ce.ok){console.log("Success! Created a new conversation...");let W=await ce.json();i.value=W.sid,n.value=!1,await t.getToken(),await D(),a.value=!0,t.endUser.supportConversation=W.sid}else console.log("Error! Unable to create new conversation...")}catch(P){console.log("createNewConversation error => ",P)}},D=async()=>{try{let P=gv("chat","enduser",t.endUser.name,t.endUser.avatar);(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:i.value,identity:t.endUser.name,attributes:P}})})).ok?console.log("Success! Added End User to conversation..."):console.log("Error! Unable to add End User to conversation...")}catch(P){console.log("addEndUserToConversation error => ",P)}},de=ht([]),ue=ht([]),Ae=async()=>{try{ue.value=[];const Q=await fetch("/conversations/return-conversations",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(Q.ok){let ce=await Q.json();de.value=ce;for(let W=0;W<de.value.length;W++)Object.keys(de.value[W].attributes).length>0&&(de.value[W].attributes=JSON.parse(de.value[W].attributes)),(de.value[W].attributes.conversationType===void 0||de.value[W].attributes.conversationType==="")&&(de.value[W].attributes.conversationType="Support"),(de.value[W].friendlyName===null||de.value[W].friendlyName==="")&&(de.value[W].friendlyName="no name..."),de.value[W].attributes.conversationType==="ChatChannel"&&ue.value.push(de.value[W])}}catch(P){console.log("getConversations error => ",P)}},we=async function(P){i.value=P,await D(),r.push({name:"conversation",params:{sid:P}})};function he(){t.logout(),s.value=!1,o.value=!1,u.value=!1}return(P,Q)=>(et(),ct("div",PP,[le("div",MP,[le("div",xP,[NP,LP,le("div",{class:dn(["card mb-5",{"text-bg-success":St(c),"text-bg-warning":!St(c)}])},[jP,le("div",UP,[kt(le("h3",FP,[le("img",{src:St(t).endUser.avatar,class:"rounded float-start me-2"},null,8,DP),Ut(" "+Wt(St(t).endUser.name),1)],512),[[xt,St(h)]]),kt(le("p",BP," In order order to enter a conversation, you to enter a name and then create an access token. ",512),[[xt,!St(h)]]),kt(le("div",null,[le("div",qP,[HP,kt(le("input",{type:"text","onUpdate:modelValue":Q[0]||(Q[0]=ce=>b.value=ce),class:"form-control",id:"newname",placeholder:""},null,512),[[P$,b.value]])]),le("div",WP,[le("button",{onClick:Q[1]||(Q[1]=ce=>$()),class:"btn btn-primary btn-lg"},VP)])],512),[[xt,!St(h)]]),kt(le("div",null,[KP,le("button",{onClick:Q[2]||(Q[2]=ce=>A()),class:"btn btn-primary btn-lg"},[kt(le("span",null,QP,512),[[xt,!o.value]]),kt(le("div",XP,eM,512),[[xt,o.value]])])],512),[[xt,St(h)&&!St(c)]]),le("div",null,[kt(le("p",tM," Excellent! You can now join conversations. ",512),[[xt,u.value]]),kt(le("button",{onClick:Q[3]||(Q[3]=ce=>A()),class:"btn btn-secondary"},[kt(le("span",null,aM,512),[[xt,!o.value]]),kt(le("div",iM,oM,512),[[xt,o.value]])],512),[[xt,St(c)&&!u.value]]),kt(le("button",uM,fM,512),[[xt,u.value]]),kt(le("button",{onClick:Q[4]||(Q[4]=ce=>s.value=!s.value),class:"btn btn-light ms-2"},vM,512),[[xt,St(t).endUser.accessToken!=""]])]),kt(le("p",hM,[le("i",null,Wt(St(t).endUser.accessToken),1)],512),[[xt,s.value]]),le("p",null,[kt(le("button",{onClick:Q[5]||(Q[5]=ce=>he()),class:"btn btn-danger float-end"},mM,512),[[xt,St(c)]])])])],2),kt(le("div",bM,[wM,le("div",_M,[kt(le("button",{onClick:Q[6]||(Q[6]=ce=>U()),class:"btn btn-secondary btn-lg"},TM,512),[[xt,!St(l)]]),St(l)?(et(),ct("div",kM,[Vt(St(V$),{to:{name:"conversation",params:{sid:St(t).endUser.supportConversation}},custom:""},{default:oi(({navigate:ce})=>[le("button",{class:"btn btn-lg btn-primary",onClick:ce},RM,8,EM)]),_:1},8,["to"])])):Xt("",!0)])],512),[[xt,St(c)]]),kt(le("div",AM,[OM,le("div",PM,[le("p",null,[le("button",{onClick:Q[7]||(Q[7]=ce=>Ae()),class:"btn btn-info float-end mb-4"},NM)]),le("table",LM,[jM,le("tbody",null,[(et(!0),ct(dr,null,Cu(ue.value,ce=>(et(),ct("tr",{key:ce.sid},[le("td",UM,Wt(ce.friendlyName),1),le("td",FM,Wt(St(e1)(ce.dateCreated)),1),le("td",DM,[le("button",{class:"btn btn-primary",onClick:W=>we(ce.sid)},WM,8,BM)])]))),128))])])])],512),[[xt,St(c)]])]),GM])]))}},VM={name:"App",components:{Layout:J$,Home:zM}};function KM(e,t,r,n,a,i){const s=ui("Home"),o=ui("Layout");return et(),Xi(o,null,{default:oi(()=>[Vt(s)]),_:1})}const JM=as(VM,[["render",KM]]);var An=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function YM(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var t1={},El=function(e){return e&&e.Math==Math&&e},ft=El(typeof globalThis=="object"&&globalThis)||El(typeof window=="object"&&window)||El(typeof self=="object"&&self)||El(typeof An=="object"&&An)||function(){return this}()||Function("return this")(),Xn={},at=function(e){try{return!!e()}catch{return!0}},QM=at,Ht=!QM(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),XM=at,Wu=!XM(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),ZM=Wu,Il=Function.prototype.call,Ot=ZM?Il.bind(Il):function(){return Il.apply(Il,arguments)},Gu={},r1={}.propertyIsEnumerable,n1=Object.getOwnPropertyDescriptor,ex=n1&&!r1.call({1:2},1);Gu.f=ex?function(t){var r=n1(this,t);return!!r&&r.enumerable}:r1;var is=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},a1=Wu,i1=Function.prototype,tx=i1.bind,mv=i1.call,rx=a1&&tx.bind(mv,mv),tt=a1?function(e){return e&&rx(e)}:function(e){return e&&function(){return mv.apply(e,arguments)}},s1=tt,nx=s1({}.toString),ax=s1("".slice),di=function(e){return ax(nx(e),8,-1)},ix=tt,sx=at,ox=di,cd=Object,ux=ix("".split),zu=sx(function(){return!cd("z").propertyIsEnumerable(0)})?function(e){return ox(e)=="String"?ux(e,""):cd(e)}:cd,Zn=function(e){return e==null},lx=Zn,cx=TypeError,ea=function(e){if(lx(e))throw cx("Can't call method on "+e);return e},fx=zu,dx=ea,Yr=function(e){return fx(dx(e))},bv=typeof document=="object"&&document.all,px=typeof bv>"u"&&bv!==void 0,o1={all:bv,IS_HTMLDDA:px},u1=o1,vx=u1.all,Pt=u1.IS_HTMLDDA?function(e){return typeof e=="function"||e===vx}:function(e){return typeof e=="function"},jm=Pt,l1=o1,hx=l1.all,Kt=l1.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:jm(e)||e===hx}:function(e){return typeof e=="object"?e!==null:jm(e)},fd=ft,yx=Pt,gx=function(e){return yx(e)?e:void 0},yn=function(e,t){return arguments.length<2?gx(fd[e]):fd[e]&&fd[e][t]},mx=tt,Ea=mx({}.isPrototypeOf),bx=yn,ss=bx("navigator","userAgent")||"",c1=ft,dd=ss,Um=c1.process,Fm=c1.Deno,Dm=Um&&Um.versions||Fm&&Fm.version,Bm=Dm&&Dm.v8,En,kc;Bm&&(En=Bm.split("."),kc=En[0]>0&&En[0]<4?1:+(En[0]+En[1]));!kc&&dd&&(En=dd.match(/Edge\/(\d+)/),(!En||En[1]>=74)&&(En=dd.match(/Chrome\/(\d+)/),En&&(kc=+En[1])));var os=kc,qm=os,wx=at,bo=!!Object.getOwnPropertySymbols&&!wx(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&qm&&qm<41}),_x=bo,f1=_x&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Sx=yn,$x=Pt,Tx=Ea,kx=f1,Ex=Object,wo=kx?function(e){return typeof e=="symbol"}:function(e){var t=Sx("Symbol");return $x(t)&&Tx(t.prototype,Ex(e))},Ix=String,us=function(e){try{return Ix(e)}catch{return"Object"}},Cx=Pt,Rx=us,Ax=TypeError,Ln=function(e){if(Cx(e))return e;throw Ax(Rx(e)+" is not a function")},Ox=Ln,Px=Zn,ls=function(e,t){var r=e[t];return Px(r)?void 0:Ox(r)},pd=Ot,vd=Pt,hd=Kt,Mx=TypeError,xx=function(e,t){var r,n;if(t==="string"&&vd(r=e.toString)&&!hd(n=pd(r,e))||vd(r=e.valueOf)&&!hd(n=pd(r,e))||t!=="string"&&vd(r=e.toString)&&!hd(n=pd(r,e)))return n;throw Mx("Can't convert object to primitive value")},cs={exports:{}},Nx=!1,Hm=ft,Lx=Object.defineProperty,Vh=function(e,t){try{Lx(Hm,e,{value:t,configurable:!0,writable:!0})}catch{Hm[e]=t}return t},jx=ft,Ux=Vh,Wm="__core-js_shared__",Fx=jx[Wm]||Ux(Wm,{}),Kh=Fx,Gm=Kh;(cs.exports=function(e,t){return Gm[e]||(Gm[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.25.2",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.2/LICENSE",source:"https://github.com/zloirock/core-js"});var Dx=ea,Bx=Object,$r=function(e){return Bx(Dx(e))},qx=tt,Hx=$r,Wx=qx({}.hasOwnProperty),Jt=Object.hasOwn||function(t,r){return Wx(Hx(t),r)},Gx=tt,zx=0,Vx=Math.random(),Kx=Gx(1 .toString),Vu=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Kx(++zx+Vx,36)},Jx=ft,Yx=cs.exports,zm=Jt,Qx=Vu,Vm=bo,d1=f1,Es=Yx("wks"),Ji=Jx.Symbol,Km=Ji&&Ji.for,Xx=d1?Ji:Ji&&Ji.withoutSetter||Qx,Mt=function(e){if(!zm(Es,e)||!(Vm||typeof Es[e]=="string")){var t="Symbol."+e;Vm&&zm(Ji,e)?Es[e]=Ji[e]:d1&&Km?Es[e]=Km(t):Es[e]=Xx(t)}return Es[e]},Zx=Ot,Jm=Kt,Ym=wo,e2=ls,t2=xx,r2=Mt,n2=TypeError,a2=r2("toPrimitive"),Jh=function(e,t){if(!Jm(e)||Ym(e))return e;var r=e2(e,a2),n;if(r){if(t===void 0&&(t="default"),n=Zx(r,e,t),!Jm(n)||Ym(n))return n;throw n2("Can't convert object to primitive value")}return t===void 0&&(t="number"),t2(e,t)},i2=Jh,s2=wo,Ku=function(e){var t=i2(e,"string");return s2(t)?t:t+""},o2=ft,Qm=Kt,wv=o2.document,u2=Qm(wv)&&Qm(wv.createElement),ff=function(e){return u2?wv.createElement(e):{}},l2=Ht,c2=at,f2=ff,p1=!l2&&!c2(function(){return Object.defineProperty(f2("div"),"a",{get:function(){return 7}}).a!=7}),d2=Ht,p2=Ot,v2=Gu,h2=is,y2=Yr,g2=Ku,m2=Jt,b2=p1,Xm=Object.getOwnPropertyDescriptor;Xn.f=d2?Xm:function(t,r){if(t=y2(t),r=g2(r),b2)try{return Xm(t,r)}catch{}if(m2(t,r))return h2(!p2(v2.f,t,r),t[r])};var tr={},w2=Ht,_2=at,v1=w2&&_2(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),S2=Kt,$2=String,T2=TypeError,Qt=function(e){if(S2(e))return e;throw T2($2(e)+" is not an object")},k2=Ht,E2=p1,I2=v1,Cl=Qt,Zm=Ku,C2=TypeError,yd=Object.defineProperty,R2=Object.getOwnPropertyDescriptor,gd="enumerable",md="configurable",bd="writable";tr.f=k2?I2?function(t,r,n){if(Cl(t),r=Zm(r),Cl(n),typeof t=="function"&&r==="prototype"&&"value"in n&&bd in n&&!n[bd]){var a=R2(t,r);a&&a[bd]&&(t[r]=n.value,n={configurable:md in n?n[md]:a[md],enumerable:gd in n?n[gd]:a[gd],writable:!1})}return yd(t,r,n)}:yd:function(t,r,n){if(Cl(t),r=Zm(r),Cl(n),E2)try{return yd(t,r,n)}catch{}if("get"in n||"set"in n)throw C2("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var A2=Ht,O2=tr,P2=is,Ia=A2?function(e,t,r){return O2.f(e,t,P2(1,r))}:function(e,t,r){return e[t]=r,e},Yh={exports:{}},_v=Ht,M2=Jt,h1=Function.prototype,x2=_v&&Object.getOwnPropertyDescriptor,Qh=M2(h1,"name"),N2=Qh&&function(){}.name==="something",L2=Qh&&(!_v||_v&&x2(h1,"name").configurable),Ju={EXISTS:Qh,PROPER:N2,CONFIGURABLE:L2},j2=tt,U2=Pt,Sv=Kh,F2=j2(Function.toString);U2(Sv.inspectSource)||(Sv.inspectSource=function(e){return F2(e)});var Xh=Sv.inspectSource,D2=ft,B2=Pt,eb=D2.WeakMap,q2=B2(eb)&&/native code/.test(String(eb)),H2=cs.exports,W2=Vu,tb=H2("keys"),df=function(e){return tb[e]||(tb[e]=W2(e))},Yu={},G2=q2,y1=ft,wd=tt,z2=Kt,V2=Ia,_d=Jt,Sd=Kh,K2=df,J2=Yu,rb="Object already initialized",$v=y1.TypeError,Y2=y1.WeakMap,Ec,Pu,Ic,Q2=function(e){return Ic(e)?Pu(e):Ec(e,{})},X2=function(e){return function(t){var r;if(!z2(t)||(r=Pu(t)).type!==e)throw $v("Incompatible receiver, "+e+" required");return r}};if(G2||Sd.state){var Ai=Sd.state||(Sd.state=new Y2),Z2=wd(Ai.get),nb=wd(Ai.has),eN=wd(Ai.set);Ec=function(e,t){if(nb(Ai,e))throw $v(rb);return t.facade=e,eN(Ai,e,t),t},Pu=function(e){return Z2(Ai,e)||{}},Ic=function(e){return nb(Ai,e)}}else{var Is=K2("state");J2[Is]=!0,Ec=function(e,t){if(_d(e,Is))throw $v(rb);return t.facade=e,V2(e,Is,t),t},Pu=function(e){return _d(e,Is)?e[Is]:{}},Ic=function(e){return _d(e,Is)}}var gn={set:Ec,get:Pu,has:Ic,enforce:Q2,getterFor:X2},tN=at,rN=Pt,Rl=Jt,Tv=Ht,nN=Ju.CONFIGURABLE,aN=Xh,g1=gn,iN=g1.enforce,sN=g1.get,lc=Object.defineProperty,oN=Tv&&!tN(function(){return lc(function(){},"length",{value:8}).length!==8}),uN=String(String).split("String"),lN=Yh.exports=function(e,t,r){String(t).slice(0,7)==="Symbol("&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Rl(e,"name")||nN&&e.name!==t)&&(Tv?lc(e,"name",{value:t,configurable:!0}):e.name=t),oN&&r&&Rl(r,"arity")&&e.length!==r.arity&&lc(e,"length",{value:r.arity});try{r&&Rl(r,"constructor")&&r.constructor?Tv&&lc(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=iN(e);return Rl(n,"source")||(n.source=uN.join(typeof t=="string"?t:"")),e};Function.prototype.toString=lN(function(){return rN(this)&&sN(this).source||aN(this)},"toString");var cN=Pt,fN=tr,dN=Yh.exports,pN=Vh,Tr=function(e,t,r,n){n||(n={});var a=n.enumerable,i=n.name!==void 0?n.name:t;if(cN(r)&&dN(r,i,n),n.global)a?e[t]=r:pN(t,r);else{try{n.unsafe?e[t]&&(a=!0):delete e[t]}catch{}a?e[t]=r:fN.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},pi={},vN=Math.ceil,hN=Math.floor,yN=Math.trunc||function(t){var r=+t;return(r>0?hN:vN)(r)},gN=yN,ta=function(e){var t=+e;return t!==t||t===0?0:gN(t)},mN=ta,bN=Math.max,wN=Math.min,fs=function(e,t){var r=mN(e);return r<0?bN(r+t,0):wN(r,t)},_N=ta,SN=Math.min,Ca=function(e){return e>0?SN(_N(e),9007199254740991):0},$N=Ca,pr=function(e){return $N(e.length)},TN=Yr,kN=fs,EN=pr,ab=function(e){return function(t,r,n){var a=TN(t),i=EN(a),s=kN(n,i),o;if(e&&r!=r){for(;i>s;)if(o=a[s++],o!=o)return!0}else for(;i>s;s++)if((e||s in a)&&a[s]===r)return e||s||0;return!e&&-1}},pf={includes:ab(!0),indexOf:ab(!1)},IN=tt,$d=Jt,CN=Yr,RN=pf.indexOf,AN=Yu,ib=IN([].push),m1=function(e,t){var r=CN(e),n=0,a=[],i;for(i in r)!$d(AN,i)&&$d(r,i)&&ib(a,i);for(;t.length>n;)$d(r,i=t[n++])&&(~RN(a,i)||ib(a,i));return a},Zh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ON=m1,PN=Zh,MN=PN.concat("length","prototype");pi.f=Object.getOwnPropertyNames||function(t){return ON(t,MN)};var Qu={};Qu.f=Object.getOwnPropertySymbols;var xN=yn,NN=tt,LN=pi,jN=Qu,UN=Qt,FN=NN([].concat),b1=xN("Reflect","ownKeys")||function(t){var r=LN.f(UN(t)),n=jN.f;return n?FN(r,n(t)):r},sb=Jt,DN=b1,BN=Xn,qN=tr,w1=function(e,t,r){for(var n=DN(t),a=qN.f,i=BN.f,s=0;s<n.length;s++){var o=n[s];!sb(e,o)&&!(r&&sb(r,o))&&a(e,o,i(t,o))}},HN=at,WN=Pt,GN=/#|\.prototype\./,Xu=function(e,t){var r=VN[zN(e)];return r==JN?!0:r==KN?!1:WN(t)?HN(t):!!t},zN=Xu.normalize=function(e){return String(e).replace(GN,".").toLowerCase()},VN=Xu.data={},KN=Xu.NATIVE="N",JN=Xu.POLYFILL="P",vf=Xu,Td=ft,YN=Xn.f,QN=Ia,XN=Tr,ZN=Vh,eL=w1,tL=vf,ot=function(e,t){var r=e.target,n=e.global,a=e.stat,i,s,o,u,l,c;if(n?s=Td:a?s=Td[r]||ZN(r,{}):s=(Td[r]||{}).prototype,s)for(o in t){if(l=t[o],e.dontCallGetSet?(c=YN(s,o),u=c&&c.value):u=s[o],i=tL(n?o:r+(a?".":"#")+o,e.forced),!i&&u!==void 0){if(typeof l==typeof u)continue;eL(l,u)}(e.sham||u&&u.sham)&&QN(l,"sham",!0),XN(s,o,l,e)}},rL=tr.f,nL=Jt,aL=Mt,ob=aL("toStringTag"),Ra=function(e,t,r){e&&!r&&(e=e.prototype),e&&!nL(e,ob)&&rL(e,ob,{configurable:!0,value:t})},iL=ot,sL=ft,oL=Ra;iL({global:!0},{Reflect:{}});oL(sL.Reflect,"Reflect",!0);var uL=Wu,_1=Function.prototype,ub=_1.apply,lb=_1.call,vi=typeof Reflect=="object"&&Reflect.apply||(uL?lb.bind(ub):function(){return lb.apply(ub,arguments)}),lL=tt,_o=lL([].slice),S1=tt,cL=Ln,fL=Kt,dL=Jt,cb=_o,pL=Wu,$1=Function,vL=S1([].concat),hL=S1([].join),kd={},yL=function(e,t,r){if(!dL(kd,t)){for(var n=[],a=0;a<t;a++)n[a]="a["+a+"]";kd[t]=$1("C,a","return new C("+hL(n,",")+")")}return kd[t](e,r)},gL=pL?$1.bind:function(t){var r=cL(this),n=r.prototype,a=cb(arguments,1),i=function(){var o=vL(a,cb(arguments));return this instanceof i?yL(r,o.length,o):r.apply(t,o)};return fL(n)&&(i.prototype=n),i},mL=Mt,bL=mL("toStringTag"),T1={};T1[bL]="z";var ey=String(T1)==="[object z]",wL=ey,_L=Pt,cc=di,SL=Mt,$L=SL("toStringTag"),TL=Object,kL=cc(function(){return arguments}())=="Arguments",EL=function(e,t){try{return e[t]}catch{}},Aa=wL?cc:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=EL(t=TL(e),$L))=="string"?r:kL?cc(t):(n=cc(t))=="Object"&&_L(t.callee)?"Arguments":n},IL=tt,CL=at,k1=Pt,RL=Aa,AL=yn,OL=Xh,E1=function(){},PL=[],I1=AL("Reflect","construct"),ty=/^\s*(?:class|function)\b/,ML=IL(ty.exec),xL=!ty.exec(E1),zo=function(t){if(!k1(t))return!1;try{return I1(E1,PL,t),!0}catch{return!1}},C1=function(t){if(!k1(t))return!1;switch(RL(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return xL||!!ML(ty,OL(t))}catch{return!0}};C1.sham=!0;var hf=!I1||CL(function(){var e;return zo(zo.call)||!zo(Object)||!zo(function(){e=!0})||e})?C1:zo,NL=hf,LL=us,jL=TypeError,ry=function(e){if(NL(e))return e;throw jL(LL(e)+" is not a constructor")},ny={},UL=m1,FL=Zh,Zu=Object.keys||function(t){return UL(t,FL)},DL=Ht,BL=v1,qL=tr,HL=Qt,WL=Yr,GL=Zu;ny.f=DL&&!BL?Object.defineProperties:function(t,r){HL(t);for(var n=WL(r),a=GL(r),i=a.length,s=0,o;i>s;)qL.f(t,o=a[s++],n[o]);return t};var zL=yn,R1=zL("document","documentElement"),VL=Qt,KL=ny,fb=Zh,JL=Yu,YL=R1,QL=ff,XL=df,db=">",pb="<",kv="prototype",Ev="script",A1=XL("IE_PROTO"),Ed=function(){},O1=function(e){return pb+Ev+db+e+pb+"/"+Ev+db},vb=function(e){e.write(O1("")),e.close();var t=e.parentWindow.Object;return e=null,t},ZL=function(){var e=QL("iframe"),t="java"+Ev+":",r;return e.style.display="none",YL.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(O1("document.F=Object")),r.close(),r.F},Al,fc=function(){try{Al=new ActiveXObject("htmlfile")}catch{}fc=typeof document<"u"?document.domain&&Al?vb(Al):ZL():vb(Al);for(var e=fb.length;e--;)delete fc[kv][fb[e]];return fc()};JL[A1]=!0;var hi=Object.create||function(t,r){var n;return t!==null?(Ed[kv]=VL(t),n=new Ed,Ed[kv]=null,n[A1]=t):n=fc(),r===void 0?n:KL.f(n,r)},ej=ot,tj=yn,Id=vi,rj=gL,hb=ry,nj=Qt,yb=Kt,aj=hi,P1=at,ay=tj("Reflect","construct"),ij=Object.prototype,sj=[].push,M1=P1(function(){function e(){}return!(ay(function(){},[],e)instanceof e)}),x1=!P1(function(){ay(function(){})}),gb=M1||x1;ej({target:"Reflect",stat:!0,forced:gb,sham:gb},{construct:function(t,r){hb(t),nj(r);var n=arguments.length<3?t:hb(arguments[2]);if(x1&&!M1)return ay(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var a=[null];return Id(sj,a,r),new(Id(rj,t,a))}var i=n.prototype,s=aj(yb(i)?i:ij),o=Id(t,s,r);return yb(o)?o:s}});var oj=ot,uj=$r,N1=Zu,lj=at,cj=lj(function(){N1(1)});oj({target:"Object",stat:!0,forced:cj},{keys:function(t){return N1(uj(t))}});var fj=Aa,dj=String,lr=function(e){if(fj(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return dj(e)},iy={},pj=Ku,vj=tr,hj=is,So=function(e,t,r){var n=pj(t);n in e?vj.f(e,n,hj(0,r)):e[n]=r},mb=fs,yj=pr,gj=So,mj=Array,bj=Math.max,el=function(e,t,r){for(var n=yj(e),a=mb(t,n),i=mb(r===void 0?n:r,n),s=mj(bj(i-a,0)),o=0;a<i;a++,o++)gj(s,o,e[a]);return s.length=o,s},wj=di,_j=Yr,L1=pi.f,Sj=el,j1=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],$j=function(e){try{return L1(e)}catch{return Sj(j1)}};iy.f=function(t){return j1&&wj(t)=="Window"?$j(t):L1(_j(t))};var sy={},Tj=Mt;sy.f=Tj;var kj=ft,Ej=kj,bb=Ej,Ij=Jt,Cj=sy,Rj=tr.f,U1=function(e){var t=bb.Symbol||(bb.Symbol={});Ij(t,e)||Rj(t,e,{value:Cj.f(e)})},Aj=Ot,Oj=yn,Pj=Mt,Mj=Tr,xj=function(){var e=Oj("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=Pj("toPrimitive");t&&!t[n]&&Mj(t,n,function(a){return Aj(r,this)},{arity:1})},wb=tt,Nj=Ln,Lj=Wu,jj=wb(wb.bind),Oa=function(e,t){return Nj(e),t===void 0?e:Lj?jj(e,t):function(){return e.apply(t,arguments)}},Uj=di,tl=Array.isArray||function(t){return Uj(t)=="Array"},_b=tl,Fj=hf,Dj=Kt,Bj=Mt,qj=Bj("species"),Sb=Array,Hj=function(e){var t;return _b(e)&&(t=e.constructor,Fj(t)&&(t===Sb||_b(t.prototype))?t=void 0:Dj(t)&&(t=t[qj],t===null&&(t=void 0))),t===void 0?Sb:t},Wj=Hj,oy=function(e,t){return new(Wj(e))(t===0?0:t)},Gj=Oa,zj=tt,Vj=zu,Kj=$r,Jj=pr,Yj=oy,$b=zj([].push),qa=function(e){var t=e==1,r=e==2,n=e==3,a=e==4,i=e==6,s=e==7,o=e==5||i;return function(u,l,c,h){for(var w=Kj(u),b=Vj(w),$=Gj(l,c),A=Jj(b),x=0,U=h||Yj,D=t?U(u,A):r||s?U(u,0):void 0,de,ue;A>x;x++)if((o||x in b)&&(de=b[x],ue=$(de,x,w),e))if(t)D[x]=ue;else if(ue)switch(e){case 3:return!0;case 5:return de;case 6:return x;case 2:$b(D,de)}else switch(e){case 4:return!1;case 7:$b(D,de)}return i?-1:n||a?a:D}},Qr={forEach:qa(0),map:qa(1),filter:qa(2),some:qa(3),every:qa(4),find:qa(5),findIndex:qa(6),filterReject:qa(7)},yf=ot,uy=ft,ly=Ot,Qj=tt,lo=Ht,co=bo,Xj=at,or=Jt,Zj=Ea,Iv=Qt,gf=Yr,cy=Ku,eU=lr,Cv=is,Mu=hi,F1=Zu,tU=pi,D1=iy,rU=Qu,B1=Xn,q1=tr,nU=ny,H1=Gu,Cd=Tr,fy=cs.exports,aU=df,W1=Yu,Tb=Vu,iU=Mt,sU=sy,oU=U1,uU=xj,lU=Ra,G1=gn,mf=Qr.forEach,Ur=aU("hidden"),bf="Symbol",xu="prototype",cU=G1.set,kb=G1.getterFor(bf),pn=Object[xu],Yi=uy.Symbol,uu=Yi&&Yi[xu],fU=uy.TypeError,Rd=uy.QObject,z1=B1.f,Ja=q1.f,V1=D1.f,dU=H1.f,K1=Qj([].push),ma=fy("symbols"),rl=fy("op-symbols"),pU=fy("wks"),Rv=!Rd||!Rd[xu]||!Rd[xu].findChild,Av=lo&&Xj(function(){return Mu(Ja({},"a",{get:function(){return Ja(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=z1(pn,t);n&&delete pn[t],Ja(e,t,r),n&&e!==pn&&Ja(pn,t,n)}:Ja,Ad=function(e,t){var r=ma[e]=Mu(uu);return cU(r,{type:bf,tag:e,description:t}),lo||(r.description=t),r},wf=function(t,r,n){t===pn&&wf(rl,r,n),Iv(t);var a=cy(r);return Iv(n),or(ma,a)?(n.enumerable?(or(t,Ur)&&t[Ur][a]&&(t[Ur][a]=!1),n=Mu(n,{enumerable:Cv(0,!1)})):(or(t,Ur)||Ja(t,Ur,Cv(1,{})),t[Ur][a]=!0),Av(t,a,n)):Ja(t,a,n)},dy=function(t,r){Iv(t);var n=gf(r),a=F1(n).concat(Q1(n));return mf(a,function(i){(!lo||ly(Ov,n,i))&&wf(t,i,n[i])}),t},vU=function(t,r){return r===void 0?Mu(t):dy(Mu(t),r)},Ov=function(t){var r=cy(t),n=ly(dU,this,r);return this===pn&&or(ma,r)&&!or(rl,r)?!1:n||!or(this,r)||!or(ma,r)||or(this,Ur)&&this[Ur][r]?n:!0},J1=function(t,r){var n=gf(t),a=cy(r);if(!(n===pn&&or(ma,a)&&!or(rl,a))){var i=z1(n,a);return i&&or(ma,a)&&!(or(n,Ur)&&n[Ur][a])&&(i.enumerable=!0),i}},Y1=function(t){var r=V1(gf(t)),n=[];return mf(r,function(a){!or(ma,a)&&!or(W1,a)&&K1(n,a)}),n},Q1=function(e){var t=e===pn,r=V1(t?rl:gf(e)),n=[];return mf(r,function(a){or(ma,a)&&(!t||or(pn,a))&&K1(n,ma[a])}),n};co||(Yi=function(){if(Zj(uu,this))throw fU("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:eU(arguments[0]),r=Tb(t),n=function(a){this===pn&&ly(n,rl,a),or(this,Ur)&&or(this[Ur],r)&&(this[Ur][r]=!1),Av(this,r,Cv(1,a))};return lo&&Rv&&Av(pn,r,{configurable:!0,set:n}),Ad(r,t)},uu=Yi[xu],Cd(uu,"toString",function(){return kb(this).tag}),Cd(Yi,"withoutSetter",function(e){return Ad(Tb(e),e)}),H1.f=Ov,q1.f=wf,nU.f=dy,B1.f=J1,tU.f=D1.f=Y1,rU.f=Q1,sU.f=function(e){return Ad(iU(e),e)},lo&&(Ja(uu,"description",{configurable:!0,get:function(){return kb(this).description}}),Cd(pn,"propertyIsEnumerable",Ov,{unsafe:!0})));yf({global:!0,constructor:!0,wrap:!0,forced:!co,sham:!co},{Symbol:Yi});mf(F1(pU),function(e){oU(e)});yf({target:bf,stat:!0,forced:!co},{useSetter:function(){Rv=!0},useSimple:function(){Rv=!1}});yf({target:"Object",stat:!0,forced:!co,sham:!lo},{create:vU,defineProperty:wf,defineProperties:dy,getOwnPropertyDescriptor:J1});yf({target:"Object",stat:!0,forced:!co},{getOwnPropertyNames:Y1});uU();lU(Yi,bf);W1[Ur]=!0;var hU=bo,X1=hU&&!!Symbol.for&&!!Symbol.keyFor,yU=ot,gU=yn,mU=Jt,bU=lr,Z1=cs.exports,wU=X1,Od=Z1("string-to-symbol-registry"),_U=Z1("symbol-to-string-registry");yU({target:"Symbol",stat:!0,forced:!wU},{for:function(e){var t=bU(e);if(mU(Od,t))return Od[t];var r=gU("Symbol")(t);return Od[t]=r,_U[r]=t,r}});var SU=ot,$U=Jt,TU=wo,kU=us,EU=cs.exports,IU=X1,Eb=EU("symbol-to-string-registry");SU({target:"Symbol",stat:!0,forced:!IU},{keyFor:function(t){if(!TU(t))throw TypeError(kU(t)+" is not a symbol");if($U(Eb,t))return Eb[t]}});var CU=ot,eT=yn,tT=vi,RU=Ot,nl=tt,rT=at,AU=tl,OU=Pt,PU=Kt,Ib=wo,nT=_o,MU=bo,ri=eT("JSON","stringify"),Ol=nl(/./.exec),Cb=nl("".charAt),xU=nl("".charCodeAt),NU=nl("".replace),LU=nl(1 .toString),jU=/[\uD800-\uDFFF]/g,Rb=/^[\uD800-\uDBFF]$/,Ab=/^[\uDC00-\uDFFF]$/,Ob=!MU||rT(function(){var e=eT("Symbol")();return ri([e])!="[null]"||ri({a:e})!="{}"||ri(Object(e))!="{}"}),Pb=rT(function(){return ri("\uDF06\uD834")!=='"\\udf06\\ud834"'||ri("\uDEAD")!=='"\\udead"'}),UU=function(e,t){var r=nT(arguments),n=t;if(!(!PU(t)&&e===void 0||Ib(e)))return AU(t)||(t=function(a,i){if(OU(n)&&(i=RU(n,this,a,i)),!Ib(i))return i}),r[1]=t,tT(ri,null,r)},FU=function(e,t,r){var n=Cb(r,t-1),a=Cb(r,t+1);return Ol(Rb,e)&&!Ol(Ab,a)||Ol(Ab,e)&&!Ol(Rb,n)?"\\u"+LU(xU(e,0),16):e};ri&&CU({target:"JSON",stat:!0,arity:3,forced:Ob||Pb},{stringify:function(t,r,n){var a=nT(arguments),i=tT(Ob?UU:ri,null,a);return Pb&&typeof i=="string"?NU(i,jU,FU):i}});var DU=ot,BU=bo,qU=at,aT=Qu,HU=$r,WU=!BU||qU(function(){aT.f(1)});DU({target:"Object",stat:!0,forced:WU},{getOwnPropertySymbols:function(t){var r=aT.f;return r?r(HU(t)):[]}});var GU=at,zU=Mt,VU=os,KU=zU("species"),al=function(e){return VU>=51||!GU(function(){var t=[],r=t.constructor={};return r[KU]=function(){return{foo:1}},t[e](Boolean).foo!==1})},JU=ot,YU=Qr.filter,QU=al,XU=QU("filter");JU({target:"Array",proto:!0,forced:!XU},{filter:function(t){return YU(this,t,arguments.length>1?arguments[1]:void 0)}});var ZU=ot,eF=at,tF=Yr,iT=Xn.f,sT=Ht,rF=eF(function(){iT(1)}),nF=!sT||rF;ZU({target:"Object",stat:!0,forced:nF,sham:!sT},{getOwnPropertyDescriptor:function(t,r){return iT(tF(t),r)}});var aF=ot,iF=Ht,sF=b1,oF=Yr,uF=Xn,lF=So;aF({target:"Object",stat:!0,sham:!iF},{getOwnPropertyDescriptors:function(t){for(var r=oF(t),n=uF.f,a=sF(r),i={},s=0,o,u;a.length>s;)u=n(r,o=a[s++]),u!==void 0&&lF(i,o,u);return i}});var $o={exports:{}};(function(e){function t(n,a,i,s,o,u,l){try{var c=n[u](l),h=c.value}catch(w){i(w);return}c.done?a(h):Promise.resolve(h).then(s,o)}function r(n){return function(){var a=this,i=arguments;return new Promise(function(s,o){var u=n.apply(a,i);function l(h){t(u,s,o,l,c,"next",h)}function c(h){t(u,s,o,l,c,"throw",h)}l(void 0)})}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})($o);var yi={exports:{}};(function(e){function t(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(yi);var jn={exports:{}},_f={exports:{}};(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(_f);(function(e){var t=_f.exports;function r(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(a&&a.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),a&&t(n,a)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(jn);var Un={exports:{}},Fn={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Fn);(function(e){var t=Fn.exports.default,r=yi.exports;function n(a,i){if(i&&(t(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(a)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(Un);var Xr={exports:{}};(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Xr);var gi={exports:{}};(function(e){function t(r,n,a){return n in r?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(gi);var ra={exports:{}};(function(e){function t(n,a){for(var i=0;i<a.length;i++){var s=a[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function r(n,a,i){return a&&t(n.prototype,a),i&&t(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(ra);var Dn={exports:{}};(function(e){function t(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Dn);var cF=ey,fF=Aa,dF=cF?{}.toString:function(){return"[object "+fF(this)+"]"},pF=ey,vF=Tr,hF=dF;pF||vF(Object.prototype,"toString",hF,{unsafe:!0});var yF=di,gF=ft,il=yF(gF.process)=="process",mF=Pt,bF=String,wF=TypeError,_F=function(e){if(typeof e=="object"||mF(e))return e;throw wF("Can't set "+bF(e)+" as a prototype")},SF=tt,$F=Qt,TF=_F,To=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=SF(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(a,i){return $F(a),TF(i),e?r(a,i):a.__proto__=i,a}}():void 0),kF=yn,EF=tr,IF=Mt,CF=Ht,Mb=IF("species"),Sf=function(e){var t=kF(e),r=EF.f;CF&&t&&!t[Mb]&&r(t,Mb,{configurable:!0,get:function(){return this}})},RF=Ea,AF=TypeError,ds=function(e,t){if(RF(t,e))return e;throw AF("Incorrect invocation")},xb=Qt,OF=ry,PF=Zn,MF=Mt,xF=MF("species"),py=function(e,t){var r=xb(e).constructor,n;return r===void 0||PF(n=xb(r)[xF])?t:OF(n)},NF=TypeError,vy=function(e,t){if(e<t)throw NF("Not enough arguments");return e},LF=ss,oT=/(?:ipad|iphone|ipod).*applewebkit/i.test(LF),Kr=ft,jF=vi,UF=Oa,Nb=Pt,FF=Jt,DF=at,Lb=R1,BF=_o,jb=ff,qF=vy,HF=oT,WF=il,Pv=Kr.setImmediate,Mv=Kr.clearImmediate,GF=Kr.process,Pd=Kr.Dispatch,zF=Kr.Function,Ub=Kr.MessageChannel,VF=Kr.String,Md=0,mu={},Fb="onreadystatechange",Nu,Oi,xd,Nd;try{Nu=Kr.location}catch{}var hy=function(e){if(FF(mu,e)){var t=mu[e];delete mu[e],t()}},Ld=function(e){return function(){hy(e)}},Db=function(e){hy(e.data)},Bb=function(e){Kr.postMessage(VF(e),Nu.protocol+"//"+Nu.host)};(!Pv||!Mv)&&(Pv=function(t){qF(arguments.length,1);var r=Nb(t)?t:zF(t),n=BF(arguments,1);return mu[++Md]=function(){jF(r,void 0,n)},Oi(Md),Md},Mv=function(t){delete mu[t]},WF?Oi=function(e){GF.nextTick(Ld(e))}:Pd&&Pd.now?Oi=function(e){Pd.now(Ld(e))}:Ub&&!HF?(xd=new Ub,Nd=xd.port2,xd.port1.onmessage=Db,Oi=UF(Nd.postMessage,Nd)):Kr.addEventListener&&Nb(Kr.postMessage)&&!Kr.importScripts&&Nu&&Nu.protocol!=="file:"&&!DF(Bb)?(Oi=Bb,Kr.addEventListener("message",Db,!1)):Fb in jb("script")?Oi=function(e){Lb.appendChild(jb("script"))[Fb]=function(){Lb.removeChild(this),hy(e)}}:Oi=function(e){setTimeout(Ld(e),0)});var uT={set:Pv,clear:Mv},KF=ss,JF=ft,YF=/ipad|iphone|ipod/i.test(KF)&&JF.Pebble!==void 0,QF=ss,XF=/web0s(?!.*chrome)/i.test(QF),Zi=ft,qb=Oa,ZF=Xn.f,jd=uT.set,eD=oT,tD=YF,rD=XF,Ud=il,Hb=Zi.MutationObserver||Zi.WebKitMutationObserver,Wb=Zi.document,Gb=Zi.process,Pl=Zi.Promise,zb=ZF(Zi,"queueMicrotask"),lT=zb&&zb.value,Vo,qi,bu,Ds,Fd,Dd,Ml,Vb;lT||(Vo=function(){var e,t;for(Ud&&(e=Gb.domain)&&e.exit();qi;){t=qi.fn,qi=qi.next;try{t()}catch(r){throw qi?Ds():bu=void 0,r}}bu=void 0,e&&e.enter()},!eD&&!Ud&&!rD&&Hb&&Wb?(Fd=!0,Dd=Wb.createTextNode(""),new Hb(Vo).observe(Dd,{characterData:!0}),Ds=function(){Dd.data=Fd=!Fd}):!tD&&Pl&&Pl.resolve?(Ml=Pl.resolve(void 0),Ml.constructor=Pl,Vb=qb(Ml.then,Ml),Ds=function(){Vb(Vo)}):Ud?Ds=function(){Gb.nextTick(Vo)}:(jd=qb(jd,Zi),Ds=function(){jd(Vo)}));var nD=lT||function(e){var t={fn:e,next:void 0};bu&&(bu.next=t),qi||(qi=t,Ds()),bu=t},aD=ft,iD=function(e,t){var r=aD.console;r&&r.error&&(arguments.length==1?r.error(e):r.error(e,t))},yy=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},cT=function(){this.head=null,this.tail=null};cT.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var sD=cT,oD=ft,$f=oD.Promise,fT=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",uD=fT,lD=il,cD=!uD&&!lD&&typeof window=="object"&&typeof document=="object",fD=ft,wu=$f,dD=Pt,pD=vf,vD=Xh,hD=Mt,yD=cD,gD=fT,Bd=os;wu&&wu.prototype;var mD=hD("species"),xv=!1,dT=dD(fD.PromiseRejectionEvent),bD=pD("Promise",function(){var e=vD(wu),t=e!==String(wu);if(!t&&Bd===66)return!0;if(!Bd||Bd<51||!/native code/.test(e)){var r=new wu(function(i){i(1)}),n=function(i){i(function(){},function(){})},a=r.constructor={};if(a[mD]=n,xv=r.then(function(){})instanceof n,!xv)return!0}return!t&&(yD||gD)&&!dT}),sl={CONSTRUCTOR:bD,REJECTION_EVENT:dT,SUBCLASSING:xv},ko={},Kb=Ln,wD=TypeError,_D=function(e){var t,r;this.promise=new e(function(n,a){if(t!==void 0||r!==void 0)throw wD("Bad Promise constructor");t=n,r=a}),this.resolve=Kb(t),this.reject=Kb(r)};ko.f=function(e){return new _D(e)};var SD=ot,Cc=il,ci=ft,fo=Ot,Jb=Tr,Yb=To,$D=Ra,TD=Sf,kD=Ln,dc=Pt,ED=Kt,ID=ds,CD=py,pT=uT.set,gy=nD,RD=iD,AD=yy,OD=sD,vT=gn,Rc=$f,my=sl,hT=ko,Tf="Promise",yT=my.CONSTRUCTOR,PD=my.REJECTION_EVENT,MD=my.SUBCLASSING,qd=vT.getterFor(Tf),xD=vT.set,Bs=Rc&&Rc.prototype,Hi=Rc,xl=Bs,gT=ci.TypeError,Nv=ci.document,by=ci.process,Lv=hT.f,ND=Lv,LD=!!(Nv&&Nv.createEvent&&ci.dispatchEvent),mT="unhandledrejection",jD="rejectionhandled",Qb=0,bT=1,UD=2,wy=1,wT=2,Nl,Xb,FD,Zb,_T=function(e){var t;return ED(e)&&dc(t=e.then)?t:!1},ST=function(e,t){var r=t.value,n=t.state==bT,a=n?e.ok:e.fail,i=e.resolve,s=e.reject,o=e.domain,u,l,c;try{a?(n||(t.rejection===wT&&BD(t),t.rejection=wy),a===!0?u=r:(o&&o.enter(),u=a(r),o&&(o.exit(),c=!0)),u===e.promise?s(gT("Promise-chain cycle")):(l=_T(u))?fo(l,u,i,s):i(u)):s(r)}catch(h){o&&!c&&o.exit(),s(h)}},$T=function(e,t){e.notified||(e.notified=!0,gy(function(){for(var r=e.reactions,n;n=r.get();)ST(n,e);e.notified=!1,t&&!e.rejection&&DD(e)}))},TT=function(e,t,r){var n,a;LD?(n=Nv.createEvent("Event"),n.promise=t,n.reason=r,n.initEvent(e,!1,!0),ci.dispatchEvent(n)):n={promise:t,reason:r},!PD&&(a=ci["on"+e])?a(n):e===mT&&RD("Unhandled promise rejection",r)},DD=function(e){fo(pT,ci,function(){var t=e.facade,r=e.value,n=ew(e),a;if(n&&(a=AD(function(){Cc?by.emit("unhandledRejection",r,t):TT(mT,t,r)}),e.rejection=Cc||ew(e)?wT:wy,a.error))throw a.value})},ew=function(e){return e.rejection!==wy&&!e.parent},BD=function(e){fo(pT,ci,function(){var t=e.facade;Cc?by.emit("rejectionHandled",t):TT(jD,t,e.value)})},Ws=function(e,t,r){return function(n){e(t,n,r)}},Ys=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=UD,$T(e,!0))},jv=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw gT("Promise can't be resolved itself");var n=_T(t);n?gy(function(){var a={done:!1};try{fo(n,t,Ws(jv,a,e),Ws(Ys,a,e))}catch(i){Ys(a,i,e)}}):(e.value=t,e.state=bT,$T(e,!1))}catch(a){Ys({done:!1},a,e)}}};if(yT&&(Hi=function(t){ID(this,xl),kD(t),fo(Nl,this);var r=qd(this);try{t(Ws(jv,r),Ws(Ys,r))}catch(n){Ys(r,n)}},xl=Hi.prototype,Nl=function(t){xD(this,{type:Tf,done:!1,notified:!1,parent:!1,reactions:new OD,rejection:!1,state:Qb,value:void 0})},Nl.prototype=Jb(xl,"then",function(t,r){var n=qd(this),a=Lv(CD(this,Hi));return n.parent=!0,a.ok=dc(t)?t:!0,a.fail=dc(r)&&r,a.domain=Cc?by.domain:void 0,n.state==Qb?n.reactions.add(a):gy(function(){ST(a,n)}),a.promise}),Xb=function(){var e=new Nl,t=qd(e);this.promise=e,this.resolve=Ws(jv,t),this.reject=Ws(Ys,t)},hT.f=Lv=function(e){return e===Hi||e===FD?new Xb(e):ND(e)},dc(Rc)&&Bs!==Object.prototype)){Zb=Bs.then,MD||Jb(Bs,"then",function(t,r){var n=this;return new Hi(function(a,i){fo(Zb,n,a,i)}).then(t,r)},{unsafe:!0});try{delete Bs.constructor}catch{}Yb&&Yb(Bs,xl)}SD({global:!0,constructor:!0,wrap:!0,forced:yT},{Promise:Hi});$D(Hi,Tf,!1);TD(Tf);var ol={},qD=Mt,HD=ol,WD=qD("iterator"),GD=Array.prototype,_y=function(e){return e!==void 0&&(HD.Array===e||GD[WD]===e)},zD=Aa,tw=ls,VD=Zn,KD=ol,JD=Mt,YD=JD("iterator"),ul=function(e){if(!VD(e))return tw(e,YD)||tw(e,"@@iterator")||KD[zD(e)]},QD=Ot,XD=Ln,ZD=Qt,e3=us,t3=ul,r3=TypeError,kf=function(e,t){var r=arguments.length<2?t3(e):t;if(XD(r))return ZD(QD(r,e));throw r3(e3(e)+" is not iterable")},n3=Ot,rw=Qt,a3=ls,kT=function(e,t,r){var n,a;rw(e);try{if(n=a3(e,"return"),!n){if(t==="throw")throw r;return r}n=n3(n,e)}catch(i){a=!0,n=i}if(t==="throw")throw r;if(a)throw n;return rw(n),r},i3=Oa,s3=Ot,o3=Qt,u3=us,l3=_y,c3=pr,nw=Ea,f3=kf,d3=ul,aw=kT,p3=TypeError,pc=function(e,t){this.stopped=e,this.result=t},iw=pc.prototype,Ef=function(e,t,r){var n=r&&r.that,a=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),o=!!(r&&r.INTERRUPTED),u=i3(t,n),l,c,h,w,b,$,A,x=function(D){return l&&aw(l,"normal",D),new pc(!0,D)},U=function(D){return a?(o3(D),o?u(D[0],D[1],x):u(D[0],D[1])):o?u(D,x):u(D)};if(i)l=e.iterator;else if(s)l=e;else{if(c=d3(e),!c)throw p3(u3(e)+" is not iterable");if(l3(c)){for(h=0,w=c3(e);w>h;h++)if(b=U(e[h]),b&&nw(iw,b))return b;return new pc(!1)}l=f3(e,c)}for($=i?e.next:l.next;!(A=s3($,l)).done;){try{b=U(A.value)}catch(D){aw(l,"throw",D)}if(typeof b=="object"&&b&&nw(iw,b))return b}return new pc(!1)},v3=Mt,ET=v3("iterator"),IT=!1;try{var h3=0,sw={next:function(){return{done:!!h3++}},return:function(){IT=!0}};sw[ET]=function(){return this},Array.from(sw,function(){throw 2})}catch{}var If=function(e,t){if(!t&&!IT)return!1;var r=!1;try{var n={};n[ET]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},y3=$f,g3=If,m3=sl.CONSTRUCTOR,CT=m3||!g3(function(e){y3.all(e).then(void 0,function(){})}),b3=ot,w3=Ot,_3=Ln,S3=ko,$3=yy,T3=Ef,k3=CT;b3({target:"Promise",stat:!0,forced:k3},{all:function(t){var r=this,n=S3.f(r),a=n.resolve,i=n.reject,s=$3(function(){var o=_3(r.resolve),u=[],l=0,c=1;T3(t,function(h){var w=l++,b=!1;c++,w3(o,r,h).then(function($){b||(b=!0,u[w]=$,--c||a(u))},i)}),--c||a(u)});return s.error&&i(s.value),n.promise}});var E3=ot,I3=sl.CONSTRUCTOR,Uv=$f,C3=yn,R3=Pt,A3=Tr,ow=Uv&&Uv.prototype;E3({target:"Promise",proto:!0,forced:I3,real:!0},{catch:function(e){return this.then(void 0,e)}});if(R3(Uv)){var uw=C3("Promise").prototype.catch;ow.catch!==uw&&A3(ow,"catch",uw,{unsafe:!0})}var O3=ot,P3=Ot,M3=Ln,x3=ko,N3=yy,L3=Ef,j3=CT;O3({target:"Promise",stat:!0,forced:j3},{race:function(t){var r=this,n=x3.f(r),a=n.reject,i=N3(function(){var s=M3(r.resolve);L3(t,function(o){P3(s,r,o).then(n.resolve,a)})});return i.error&&a(i.value),n.promise}});var U3=ot,F3=Ot,D3=ko,B3=sl.CONSTRUCTOR;U3({target:"Promise",stat:!0,forced:B3},{reject:function(t){var r=D3.f(this);return F3(r.reject,void 0,t),r.promise}});var q3=Qt,H3=Kt,W3=ko,G3=function(e,t){if(q3(e),H3(t)&&t.constructor===e)return t;var r=W3.f(e),n=r.resolve;return n(t),r.promise},z3=ot,V3=yn,K3=sl.CONSTRUCTOR,J3=G3;V3("Promise");z3({target:"Promise",stat:!0,forced:K3},{resolve:function(t){return J3(this,t)}});var Y3=ot,Q3=Qr.map,X3=al,Z3=X3("map");Y3({target:"Array",proto:!0,forced:!Z3},{map:function(t){return Q3(this,t,arguments.length>1?arguments[1]:void 0)}});var RT={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},eB=ff,Hd=eB("span").classList,lw=Hd&&Hd.constructor&&Hd.constructor.prototype,AT=lw===Object.prototype?void 0:lw,tB=at,ll=function(e,t){var r=[][e];return!!r&&tB(function(){r.call(null,t||function(){return 1},1)})},rB=Qr.forEach,nB=ll,aB=nB("forEach"),iB=aB?[].forEach:function(t){return rB(this,t,arguments.length>1?arguments[1]:void 0)},cw=ft,fw=RT,sB=AT,Wd=iB,oB=Ia,OT=function(e){if(e&&e.forEach!==Wd)try{oB(e,"forEach",Wd)}catch{e.forEach=Wd}};for(var Gd in fw)fw[Gd]&&OT(cw[Gd]&&cw[Gd].prototype);OT(sB);var PT={exports:{}};(function(e){var t=Fn.exports.default;function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},a=Object.prototype,i=a.hasOwnProperty,s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(te,ae,J){return Object.defineProperty(te,ae,{value:J,enumerable:!0,configurable:!0,writable:!0}),te[ae]}try{c({},"")}catch{c=function(J,ie,Re){return J[ie]=Re}}function h(te,ae,J,ie){var Re=ae&&ae.prototype instanceof $?ae:$,ke=Object.create(Re.prototype),N=new ce(ie||[]);return ke._invoke=function(dt,pt,Ee){var Xe="suspendedStart";return function(Ye,B){if(Xe==="executing")throw new Error("Generator is already running");if(Xe==="completed"){if(Ye==="throw")throw B;return ve()}for(Ee.method=Ye,Ee.arg=B;;){var T=Ee.delegate;if(T){var Te=he(T,Ee);if(Te){if(Te===b)continue;return Te}}if(Ee.method==="next")Ee.sent=Ee._sent=Ee.arg;else if(Ee.method==="throw"){if(Xe==="suspendedStart")throw Xe="completed",Ee.arg;Ee.dispatchException(Ee.arg)}else Ee.method==="return"&&Ee.abrupt("return",Ee.arg);Xe="executing";var ye=w(dt,pt,Ee);if(ye.type==="normal"){if(Xe=Ee.done?"completed":"suspendedYield",ye.arg===b)continue;return{value:ye.arg,done:Ee.done}}ye.type==="throw"&&(Xe="completed",Ee.method="throw",Ee.arg=ye.arg)}}}(te,J,N),ke}function w(te,ae,J){try{return{type:"normal",arg:te.call(ae,J)}}catch(ie){return{type:"throw",arg:ie}}}n.wrap=h;var b={};function $(){}function A(){}function x(){}var U={};c(U,o,function(){return this});var D=Object.getPrototypeOf,de=D&&D(D(W([])));de&&de!==a&&i.call(de,o)&&(U=de);var ue=x.prototype=$.prototype=Object.create(U);function Ae(te){["next","throw","return"].forEach(function(ae){c(te,ae,function(J){return this._invoke(ae,J)})})}function we(te,ae){function J(Re,ke,N,dt){var pt=w(te[Re],te,ke);if(pt.type!=="throw"){var Ee=pt.arg,Xe=Ee.value;return Xe&&t(Xe)=="object"&&i.call(Xe,"__await")?ae.resolve(Xe.__await).then(function(Ye){J("next",Ye,N,dt)},function(Ye){J("throw",Ye,N,dt)}):ae.resolve(Xe).then(function(Ye){Ee.value=Ye,N(Ee)},function(Ye){return J("throw",Ye,N,dt)})}dt(pt.arg)}var ie;this._invoke=function(Re,ke){function N(){return new ae(function(dt,pt){J(Re,ke,dt,pt)})}return ie=ie?ie.then(N,N):N()}}function he(te,ae){var J=te.iterator[ae.method];if(J===void 0){if(ae.delegate=null,ae.method==="throw"){if(te.iterator.return&&(ae.method="return",ae.arg=void 0,he(te,ae),ae.method==="throw"))return b;ae.method="throw",ae.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var ie=w(J,te.iterator,ae.arg);if(ie.type==="throw")return ae.method="throw",ae.arg=ie.arg,ae.delegate=null,b;var Re=ie.arg;return Re?Re.done?(ae[te.resultName]=Re.value,ae.next=te.nextLoc,ae.method!=="return"&&(ae.method="next",ae.arg=void 0),ae.delegate=null,b):Re:(ae.method="throw",ae.arg=new TypeError("iterator result is not an object"),ae.delegate=null,b)}function P(te){var ae={tryLoc:te[0]};1 in te&&(ae.catchLoc=te[1]),2 in te&&(ae.finallyLoc=te[2],ae.afterLoc=te[3]),this.tryEntries.push(ae)}function Q(te){var ae=te.completion||{};ae.type="normal",delete ae.arg,te.completion=ae}function ce(te){this.tryEntries=[{tryLoc:"root"}],te.forEach(P,this),this.reset(!0)}function W(te){if(te){var ae=te[o];if(ae)return ae.call(te);if(typeof te.next=="function")return te;if(!isNaN(te.length)){var J=-1,ie=function Re(){for(;++J<te.length;)if(i.call(te,J))return Re.value=te[J],Re.done=!1,Re;return Re.value=void 0,Re.done=!0,Re};return ie.next=ie}}return{next:ve}}function ve(){return{value:void 0,done:!0}}return A.prototype=x,c(ue,"constructor",x),c(x,"constructor",A),A.displayName=c(x,l,"GeneratorFunction"),n.isGeneratorFunction=function(te){var ae=typeof te=="function"&&te.constructor;return!!ae&&(ae===A||(ae.displayName||ae.name)==="GeneratorFunction")},n.mark=function(te){return Object.setPrototypeOf?Object.setPrototypeOf(te,x):(te.__proto__=x,c(te,l,"GeneratorFunction")),te.prototype=Object.create(ue),te},n.awrap=function(te){return{__await:te}},Ae(we.prototype),c(we.prototype,u,function(){return this}),n.AsyncIterator=we,n.async=function(te,ae,J,ie,Re){Re===void 0&&(Re=Promise);var ke=new we(h(te,ae,J,ie),Re);return n.isGeneratorFunction(ae)?ke:ke.next().then(function(N){return N.done?N.value:ke.next()})},Ae(ue),c(ue,l,"Generator"),c(ue,o,function(){return this}),c(ue,"toString",function(){return"[object Generator]"}),n.keys=function(te){var ae=[];for(var J in te)ae.push(J);return ae.reverse(),function ie(){for(;ae.length;){var Re=ae.pop();if(Re in te)return ie.value=Re,ie.done=!1,ie}return ie.done=!0,ie}},n.values=W,ce.prototype={constructor:ce,reset:function(ae){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Q),!ae)for(var J in this)J.charAt(0)==="t"&&i.call(this,J)&&!isNaN(+J.slice(1))&&(this[J]=void 0)},stop:function(){this.done=!0;var ae=this.tryEntries[0].completion;if(ae.type==="throw")throw ae.arg;return this.rval},dispatchException:function(ae){if(this.done)throw ae;var J=this;function ie(Ee,Xe){return N.type="throw",N.arg=ae,J.next=Ee,Xe&&(J.method="next",J.arg=void 0),!!Xe}for(var Re=this.tryEntries.length-1;Re>=0;--Re){var ke=this.tryEntries[Re],N=ke.completion;if(ke.tryLoc==="root")return ie("end");if(ke.tryLoc<=this.prev){var dt=i.call(ke,"catchLoc"),pt=i.call(ke,"finallyLoc");if(dt&&pt){if(this.prev<ke.catchLoc)return ie(ke.catchLoc,!0);if(this.prev<ke.finallyLoc)return ie(ke.finallyLoc)}else if(dt){if(this.prev<ke.catchLoc)return ie(ke.catchLoc,!0)}else{if(!pt)throw new Error("try statement without catch or finally");if(this.prev<ke.finallyLoc)return ie(ke.finallyLoc)}}}},abrupt:function(ae,J){for(var ie=this.tryEntries.length-1;ie>=0;--ie){var Re=this.tryEntries[ie];if(Re.tryLoc<=this.prev&&i.call(Re,"finallyLoc")&&this.prev<Re.finallyLoc){var ke=Re;break}}ke&&(ae==="break"||ae==="continue")&&ke.tryLoc<=J&&J<=ke.finallyLoc&&(ke=null);var N=ke?ke.completion:{};return N.type=ae,N.arg=J,ke?(this.method="next",this.next=ke.finallyLoc,b):this.complete(N)},complete:function(ae,J){if(ae.type==="throw")throw ae.arg;return ae.type==="break"||ae.type==="continue"?this.next=ae.arg:ae.type==="return"?(this.rval=this.arg=ae.arg,this.method="return",this.next="end"):ae.type==="normal"&&J&&(this.next=J),b},finish:function(ae){for(var J=this.tryEntries.length-1;J>=0;--J){var ie=this.tryEntries[J];if(ie.finallyLoc===ae)return this.complete(ie.completion,ie.afterLoc),Q(ie),b}},catch:function(ae){for(var J=this.tryEntries.length-1;J>=0;--J){var ie=this.tryEntries[J];if(ie.tryLoc===ae){var Re=ie.completion;if(Re.type==="throw"){var ke=Re.arg;Q(ie)}return ke}}throw new Error("illegal catch attempt")},delegateYield:function(ae,J,ie){return this.delegate={iterator:W(ae),resultName:J,nextLoc:ie},this.method==="next"&&(this.arg=void 0),b}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(PT);var vc=PT.exports(),cl=vc;try{regeneratorRuntime=vc}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=vc:Function("r","regeneratorRuntime = r")(vc)}var uB=TypeError,lB=9007199254740991,MT=function(e){if(e>lB)throw uB("Maximum allowed index exceeded");return e},cB=ot,fB=at,dB=tl,pB=Kt,vB=$r,hB=pr,dw=MT,pw=So,yB=oy,gB=al,mB=Mt,bB=os,xT=mB("isConcatSpreadable"),wB=bB>=51||!fB(function(){var e=[];return e[xT]=!1,e.concat()[0]!==e}),_B=gB("concat"),SB=function(e){if(!pB(e))return!1;var t=e[xT];return t!==void 0?!!t:dB(e)},$B=!wB||!_B;cB({target:"Array",proto:!0,arity:1,forced:$B},{concat:function(t){var r=vB(this),n=yB(r,0),a=0,i,s,o,u,l;for(i=-1,o=arguments.length;i<o;i++)if(l=i===-1?r:arguments[i],SB(l))for(u=hB(l),dw(a+u),s=0;s<u;s++,a++)s in l&&pw(n,a,l[s]);else dw(a+1),pw(n,a++,l);return n.length=a,n}});var TB=Qt,kB=kT,EB=function(e,t,r,n){try{return n?t(TB(r)[0],r[1]):t(r)}catch(a){kB(e,"throw",a)}},IB=Oa,CB=Ot,RB=$r,AB=EB,OB=_y,PB=hf,MB=pr,vw=So,xB=kf,NB=ul,hw=Array,NT=function(t){var r=RB(t),n=PB(this),a=arguments.length,i=a>1?arguments[1]:void 0,s=i!==void 0;s&&(i=IB(i,a>2?arguments[2]:void 0));var o=NB(r),u=0,l,c,h,w,b,$;if(o&&!(this===hw&&OB(o)))for(w=xB(r,o),b=w.next,c=n?new this:[];!(h=CB(b,w)).done;u++)$=s?AB(w,i,[h.value,u],!0):h.value,vw(c,u,$);else for(l=MB(r),c=n?new this(l):hw(l);l>u;u++)$=s?i(r[u],u):r[u],vw(c,u,$);return c.length=u,c},LB=ot,jB=NT,UB=If,FB=!UB(function(e){Array.from(e)});LB({target:"Array",stat:!0,forced:FB},{from:jB});var Sy=tt,DB=ta,BB=lr,qB=ea,HB=Sy("".charAt),yw=Sy("".charCodeAt),WB=Sy("".slice),gw=function(e){return function(t,r){var n=BB(qB(t)),a=DB(r),i=n.length,s,o;return a<0||a>=i?e?"":void 0:(s=yw(n,a),s<55296||s>56319||a+1===i||(o=yw(n,a+1))<56320||o>57343?e?HB(n,a):s:e?WB(n,a,a+2):(s-55296<<10)+(o-56320)+65536)}},$y={codeAt:gw(!1),charAt:gw(!0)},GB=at,zB=!GB(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),VB=Jt,KB=Pt,JB=$r,YB=df,QB=zB,mw=YB("IE_PROTO"),Fv=Object,XB=Fv.prototype,Cf=QB?Fv.getPrototypeOf:function(e){var t=JB(e);if(VB(t,mw))return t[mw];var r=t.constructor;return KB(r)&&t instanceof r?r.prototype:t instanceof Fv?XB:null},ZB=at,e4=Pt,t4=Kt,bw=Cf,r4=Tr,n4=Mt,Dv=n4("iterator"),LT=!1,es,zd,Vd;[].keys&&(Vd=[].keys(),"next"in Vd?(zd=bw(bw(Vd)),zd!==Object.prototype&&(es=zd)):LT=!0);var a4=!t4(es)||ZB(function(){var e={};return es[Dv].call(e)!==e});a4&&(es={});e4(es[Dv])||r4(es,Dv,function(){return this});var jT={IteratorPrototype:es,BUGGY_SAFARI_ITERATORS:LT},i4=jT.IteratorPrototype,s4=hi,o4=is,u4=Ra,l4=ol,c4=function(){return this},UT=function(e,t,r,n){var a=t+" Iterator";return e.prototype=s4(i4,{next:o4(+!n,r)}),u4(e,a,!1),l4[a]=c4,e},f4=ot,d4=Ot,FT=Ju,p4=Pt,v4=UT,ww=Cf,_w=To,h4=Ra,y4=Ia,Kd=Tr,g4=Mt,m4=ol,DT=jT,b4=FT.PROPER,w4=FT.CONFIGURABLE,Sw=DT.IteratorPrototype,Ll=DT.BUGGY_SAFARI_ITERATORS,Ko=g4("iterator"),$w="keys",Jo="values",Tw="entries",_4=function(){return this},Ty=function(e,t,r,n,a,i,s){v4(r,t,n);var o=function(U){if(U===a&&w)return w;if(!Ll&&U in c)return c[U];switch(U){case $w:return function(){return new r(this,U)};case Jo:return function(){return new r(this,U)};case Tw:return function(){return new r(this,U)}}return function(){return new r(this)}},u=t+" Iterator",l=!1,c=e.prototype,h=c[Ko]||c["@@iterator"]||a&&c[a],w=!Ll&&h||o(a),b=t=="Array"&&c.entries||h,$,A,x;if(b&&($=ww(b.call(new e)),$!==Object.prototype&&$.next&&(ww($)!==Sw&&(_w?_w($,Sw):p4($[Ko])||Kd($,Ko,_4)),h4($,u,!0))),b4&&a==Jo&&h&&h.name!==Jo&&(w4?y4(c,"name",Jo):(l=!0,w=function(){return d4(h,this)})),a)if(A={values:o(Jo),keys:i?w:o($w),entries:o(Tw)},s)for(x in A)(Ll||l||!(x in c))&&Kd(c,x,A[x]);else f4({target:t,proto:!0,forced:Ll||l},A);return c[Ko]!==w&&Kd(c,Ko,w,{name:a}),m4[t]=w,A},ky=function(e,t){return{value:e,done:t}},S4=$y.charAt,$4=lr,BT=gn,T4=Ty,kw=ky,qT="String Iterator",k4=BT.set,E4=BT.getterFor(qT);T4(String,"String",function(e){k4(this,{type:qT,string:$4(e),index:0})},function(){var t=E4(this),r=t.string,n=t.index,a;return n>=r.length?kw(void 0,!0):(a=S4(r,n),t.index+=a.length,kw(a,!1))});var ps={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})(An,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"];function i(A,x){var U=A[x];if(typeof U.bind=="function")return U.bind(A);try{return Function.prototype.bind.call(U,A)}catch{return function(){return Function.prototype.apply.apply(U,[A,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(A){return A==="debug"&&(A="log"),typeof console===r?!1:A==="trace"&&n?s:console[A]!==void 0?i(console,A):console.log!==void 0?i(console,"log"):t}function u(A,x){for(var U=0;U<a.length;U++){var D=a[U];this[D]=U<A?t:this.methodFactory(D,A,x)}this.log=this.debug}function l(A,x,U){return function(){typeof console!==r&&(u.call(this,x,U),this[A].apply(this,arguments))}}function c(A,x,U){return o(A)||l.apply(this,arguments)}function h(A,x,U){var D=this,de;x=x==null?"WARN":x;var ue="loglevel";typeof A=="string"?ue+=":"+A:typeof A=="symbol"&&(ue=void 0);function Ae(Q){var ce=(a[Q]||"silent").toUpperCase();if(!(typeof window===r||!ue)){try{window.localStorage[ue]=ce;return}catch{}try{window.document.cookie=encodeURIComponent(ue)+"="+ce+";"}catch{}}}function we(){var Q;if(!(typeof window===r||!ue)){try{Q=window.localStorage[ue]}catch{}if(typeof Q===r)try{var ce=window.document.cookie,W=ce.indexOf(encodeURIComponent(ue)+"=");W!==-1&&(Q=/^([^;]+)/.exec(ce.slice(W))[1])}catch{}return D.levels[Q]===void 0&&(Q=void 0),Q}}function he(){if(!(typeof window===r||!ue)){try{window.localStorage.removeItem(ue);return}catch{}try{window.document.cookie=encodeURIComponent(ue)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}D.name=A,D.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},D.methodFactory=U||c,D.getLevel=function(){return de},D.setLevel=function(Q,ce){if(typeof Q=="string"&&D.levels[Q.toUpperCase()]!==void 0&&(Q=D.levels[Q.toUpperCase()]),typeof Q=="number"&&Q>=0&&Q<=D.levels.SILENT){if(de=Q,ce!==!1&&Ae(Q),u.call(D,Q,A),typeof console===r&&Q<D.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+Q},D.setDefaultLevel=function(Q){x=Q,we()||D.setLevel(Q,!1)},D.resetLevel=function(){D.setLevel(x,!1),he()},D.enableAll=function(Q){D.setLevel(D.levels.TRACE,Q)},D.disableAll=function(Q){D.setLevel(D.levels.SILENT,Q)};var P=we();P==null&&(P=x),D.setLevel(P,!1)}var w=new h,b={};w.getLogger=function(x){if(typeof x!="symbol"&&typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var U=b[x];return U||(U=b[x]=new h(x,w.getLevel(),w.methodFactory)),U};var $=typeof window!==r?window.log:void 0;return w.noConflict=function(){return typeof window!==r&&window.log===w&&(window.log=$),w},w.getLoggers=function(){return b},w.default=w,w})})(ps);const Qi="\\d+(?:[\\.,]\\d+)?",I4=`(${Qi}W)`,C4=`(${Qi}Y)?(${Qi}M)?(${Qi}D)?`,R4=`T(${Qi}H)?(${Qi}M)?(${Qi}S)?`,A4=`P(?:${I4}|${C4}(?:${R4})?)`,O4=["weeks","years","months","days","hours","minutes","seconds"],Ey=new RegExp(A4),HT=e=>e.match(Ey).slice(1).reduce((t,r,n)=>(t[O4[n]]=parseFloat(r)||0,t),{}),Iy=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return n.setFullYear(n.getFullYear()+e.years),n.setMonth(n.getMonth()+e.months),n.setDate(n.getDate()+e.days),n.setHours(n.getHours()+e.hours),n.setMinutes(n.getMinutes()+e.minutes),n.setMilliseconds(n.getMilliseconds()+e.seconds*1e3),n.setDate(n.getDate()+e.weeks*7),n},WT=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return(Iy(e,n).getTime()-n.getTime())/1e3},P4={end:Iy,toSeconds:WT,pattern:Ey,parse:HT},M4=Object.freeze(Object.defineProperty({__proto__:null,pattern:Ey,parse:HT,end:Iy,toSeconds:WT,default:P4},Symbol.toStringTag,{value:"Module"})),x4=YM(M4);var N4=Mt,L4=hi,j4=tr.f,Bv=N4("unscopables"),qv=Array.prototype;qv[Bv]==null&&j4(qv,Bv,{configurable:!0,value:L4(null)});var Cy=function(e){qv[Bv][e]=!0},U4=Yr,Ry=Cy,Ew=ol,GT=gn,F4=tr.f,D4=Ty,jl=ky,B4=Ht,zT="Array Iterator",q4=GT.set,H4=GT.getterFor(zT),VT=D4(Array,"Array",function(e,t){q4(this,{type:zT,target:U4(e),index:0,kind:t})},function(){var e=H4(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,jl(void 0,!0)):r=="keys"?jl(n,!1):r=="values"?jl(t[n],!1):jl([n,t[n]],!1)},"values"),Iw=Ew.Arguments=Ew.Array;Ry("keys");Ry("values");Ry("entries");if(B4&&Iw.name!=="values")try{F4(Iw,"name",{value:"values"})}catch{}var Cw=ft,KT=RT,W4=AT,lu=VT,Jd=Ia,JT=Mt,Yd=JT("iterator"),Rw=JT("toStringTag"),Qd=lu.values,YT=function(e,t){if(e){if(e[Yd]!==Qd)try{Jd(e,Yd,Qd)}catch{e[Yd]=Qd}if(e[Rw]||Jd(e,Rw,t),KT[t]){for(var r in lu)if(e[r]!==lu[r])try{Jd(e,r,lu[r])}catch{e[r]=lu[r]}}}};for(var Xd in KT)YT(Cw[Xd]&&Cw[Xd].prototype,Xd);YT(W4,"DOMTokenList");var G4=Pt,z4=Kt,Aw=To,Ay=function(e,t,r){var n,a;return Aw&&G4(n=t.constructor)&&n!==r&&z4(a=n.prototype)&&a!==r.prototype&&Aw(e,a),e},V4=tt,K4=V4(1 .valueOf),J4=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,Y4=tt,Q4=ea,X4=lr,Z4=J4,Ow=Y4("".replace),Ac="["+Z4+"]",e6=RegExp("^"+Ac+Ac+"*"),t6=RegExp(Ac+Ac+"*$"),Zd=function(e){return function(t){var r=X4(Q4(t));return e&1&&(r=Ow(r,e6,"")),e&2&&(r=Ow(r,t6,"")),r}},r6={start:Zd(1),end:Zd(2),trim:Zd(3)},n6=Ht,Oy=ft,QT=tt,a6=vf,i6=Tr,Pw=Jt,s6=Ay,o6=Ea,u6=wo,XT=Jh,l6=at,c6=pi.f,f6=Xn.f,d6=tr.f,p6=K4,v6=r6.trim,Hv="Number",za=Oy[Hv],ep=za.prototype,h6=Oy.TypeError,y6=QT("".slice),Ul=QT("".charCodeAt),g6=function(e){var t=XT(e,"number");return typeof t=="bigint"?t:m6(t)},m6=function(e){var t=XT(e,"number"),r,n,a,i,s,o,u,l;if(u6(t))throw h6("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=v6(t),r=Ul(t,0),r===43||r===45){if(n=Ul(t,2),n===88||n===120)return NaN}else if(r===48){switch(Ul(t,1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+t}for(s=y6(t,2),o=s.length,u=0;u<o;u++)if(l=Ul(s,u),l<48||l>i)return NaN;return parseInt(s,a)}}return+t};if(a6(Hv,!za(" 0o1")||!za("0b1")||za("+0x1"))){for(var Cs=function(t){var r=arguments.length<1?0:za(g6(t)),n=this;return o6(ep,n)&&l6(function(){p6(n)})?s6(Object(r),n,Cs):r},Mw=n6?c6(za):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),tp=0,Fl;Mw.length>tp;tp++)Pw(za,Fl=Mw[tp])&&!Pw(Cs,Fl)&&d6(Cs,Fl,f6(za,Fl));Cs.prototype=ep,ep.constructor=Cs,i6(Oy,Hv,Cs,{constructor:!0})}var b6=Qt,ZT=function(){var e=b6(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Py=at,w6=ft,My=w6.RegExp,xy=Py(function(){var e=My("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),_6=xy||Py(function(){return!My("a","y").sticky}),S6=xy||Py(function(){var e=My("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),ek={BROKEN_CARET:S6,MISSED_STICKY:_6,UNSUPPORTED_Y:xy},$6=at,T6=ft,k6=T6.RegExp,E6=$6(function(){var e=k6(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),I6=at,C6=ft,R6=C6.RegExp,A6=I6(function(){var e=R6("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Gs=Ot,Rf=tt,O6=lr,P6=ZT,M6=ek,x6=cs.exports,N6=hi,L6=gn.get,j6=E6,U6=A6,F6=x6("native-string-replace",String.prototype.replace),Oc=RegExp.prototype.exec,Wv=Oc,D6=Rf("".charAt),B6=Rf("".indexOf),q6=Rf("".replace),rp=Rf("".slice),Gv=function(){var e=/a/,t=/b*/g;return Gs(Oc,e,"a"),Gs(Oc,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),tk=M6.BROKEN_CARET,zv=/()??/.exec("")[1]!==void 0,H6=Gv||zv||tk||j6||U6;H6&&(Wv=function(t){var r=this,n=L6(r),a=O6(t),i=n.raw,s,o,u,l,c,h,w;if(i)return i.lastIndex=r.lastIndex,s=Gs(Wv,i,a),r.lastIndex=i.lastIndex,s;var b=n.groups,$=tk&&r.sticky,A=Gs(P6,r),x=r.source,U=0,D=a;if($&&(A=q6(A,"y",""),B6(A,"g")===-1&&(A+="g"),D=rp(a,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&D6(a,r.lastIndex-1)!==`
`)&&(x="(?: "+x+")",D=" "+D,U++),o=new RegExp("^(?:"+x+")",A)),zv&&(o=new RegExp("^"+x+"$(?!\\s)",A)),Gv&&(u=r.lastIndex),l=Gs(Oc,$?o:r,D),$?l?(l.input=rp(l.input,U),l[0]=rp(l[0],U),l.index=r.lastIndex,r.lastIndex+=l[0].length):r.lastIndex=0:Gv&&l&&(r.lastIndex=r.global?l.index+l[0].length:u),zv&&l&&l.length>1&&Gs(F6,l[0],o,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(l[c]=void 0)}),l&&b)for(l.groups=h=N6(null),c=0;c<b.length;c++)w=b[c],h[w[0]]=l[w[1]];return l});var Af=Wv,W6=ot,xw=Af;W6({target:"RegExp",proto:!0,forced:/./.exec!==xw},{exec:xw});var Nw=tt,Lw=Tr,G6=Af,jw=at,rk=Mt,z6=Ia,V6=rk("species"),np=RegExp.prototype,Of=function(e,t,r,n){var a=rk(e),i=!jw(function(){var l={};return l[a]=function(){return 7},""[e](l)!=7}),s=i&&!jw(function(){var l=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[V6]=function(){return c},c.flags="",c[a]=/./[a]),c.exec=function(){return l=!0,null},c[a](""),!l});if(!i||!s||r){var o=Nw(/./[a]),u=t(a,""[e],function(l,c,h,w,b){var $=Nw(l),A=c.exec;return A===G6||A===np.exec?i&&!b?{done:!0,value:o(c,h,w)}:{done:!0,value:$(h,c,w)}:{done:!1}});Lw(String.prototype,e,u[0]),Lw(np,a,u[1])}n&&z6(np[a],"sham",!0)},K6=$y.charAt,Ny=function(e,t,r){return t+(r?K6(e,t).length:1)},Ly=tt,J6=$r,Y6=Math.floor,ap=Ly("".charAt),Q6=Ly("".replace),ip=Ly("".slice),X6=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Z6=/\$([$&'`]|\d{1,2})/g,e5=function(e,t,r,n,a,i){var s=r+e.length,o=n.length,u=Z6;return a!==void 0&&(a=J6(a),u=X6),Q6(i,u,function(l,c){var h;switch(ap(c,0)){case"$":return"$";case"&":return e;case"`":return ip(t,0,r);case"'":return ip(t,s);case"<":h=a[ip(c,1,-1)];break;default:var w=+c;if(w===0)return l;if(w>o){var b=Y6(w/10);return b===0?l:b<=o?n[b-1]===void 0?ap(c,1):n[b-1]+ap(c,1):l}h=n[w-1]}return h===void 0?"":h})},Uw=Ot,t5=Qt,r5=Pt,n5=di,a5=Af,i5=TypeError,Pf=function(e,t){var r=e.exec;if(r5(r)){var n=Uw(r,e,t);return n!==null&&t5(n),n}if(n5(e)==="RegExp")return Uw(a5,e,t);throw i5("RegExp#exec called on incompatible receiver")},s5=vi,Fw=Ot,Mf=tt,o5=Of,u5=at,l5=Qt,c5=Pt,f5=Zn,d5=ta,p5=Ca,Rs=lr,v5=ea,h5=Ny,y5=ls,g5=e5,m5=Pf,b5=Mt,Vv=b5("replace"),w5=Math.max,_5=Math.min,S5=Mf([].concat),sp=Mf([].push),Dw=Mf("".indexOf),Bw=Mf("".slice),$5=function(e){return e===void 0?e:String(e)},T5=function(){return"a".replace(/./,"$0")==="$0"}(),qw=function(){return/./[Vv]?/./[Vv]("a","$0")==="":!1}(),k5=!u5(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});o5("replace",function(e,t,r){var n=qw?"$":"$0";return[function(i,s){var o=v5(this),u=f5(i)?void 0:y5(i,Vv);return u?Fw(u,i,o,s):Fw(t,Rs(o),i,s)},function(a,i){var s=l5(this),o=Rs(a);if(typeof i=="string"&&Dw(i,n)===-1&&Dw(i,"$<")===-1){var u=r(t,s,o,i);if(u.done)return u.value}var l=c5(i);l||(i=Rs(i));var c=s.global;if(c){var h=s.unicode;s.lastIndex=0}for(var w=[];;){var b=m5(s,o);if(b===null||(sp(w,b),!c))break;var $=Rs(b[0]);$===""&&(s.lastIndex=h5(o,p5(s.lastIndex),h))}for(var A="",x=0,U=0;U<w.length;U++){b=w[U];for(var D=Rs(b[0]),de=w5(_5(d5(b.index),o.length),0),ue=[],Ae=1;Ae<b.length;Ae++)sp(ue,$5(b[Ae]));var we=b.groups;if(l){var he=S5([D],ue,de,o);we!==void 0&&sp(he,we);var P=Rs(s5(i,void 0,he))}else P=g5(D,o,de,ue,we,i);de>=x&&(A+=Bw(o,x,de)+P,x=de+D.length)}return A+Bw(o,x)}]},!k5||!T5||qw);var E5=ot,I5=tt,C5=zu,R5=Yr,A5=ll,O5=I5([].join),P5=C5!=Object,M5=A5("join",",");E5({target:"Array",proto:!0,forced:P5||!M5},{join:function(t){return O5(R5(this),t===void 0?",":t)}});var kr={},x5=ot,Hw=tl,N5=hf,L5=Kt,Ww=fs,j5=pr,U5=Yr,F5=So,D5=Mt,B5=al,q5=_o,H5=B5("slice"),W5=D5("species"),op=Array,G5=Math.max;x5({target:"Array",proto:!0,forced:!H5},{slice:function(t,r){var n=U5(this),a=j5(n),i=Ww(t,a),s=Ww(r===void 0?a:r,a),o,u,l;if(Hw(n)&&(o=n.constructor,N5(o)&&(o===op||Hw(o.prototype))?o=void 0:L5(o)&&(o=o[W5],o===null&&(o=void 0)),o===op||o===void 0))return q5(n,i,s);for(u=new(o===void 0?op:o)(G5(s-i,0)),l=0;i<s;i++,l++)i in n&&F5(u,l,n[i]);return u.length=l,u}});var z5=ot,Gw=Ot,V5=Pt,zw=Qt,K5=lr,J5=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},t.test("abc")===!0&&e}(),Y5=/./.test;z5({target:"RegExp",proto:!0,forced:!J5},{test:function(e){var t=zw(this),r=K5(e),n=t.exec;if(!V5(n))return Gw(Y5,t,r);var a=Gw(n,t,r);return a===null?!1:(zw(a),!0)}});var Q5=ot,X5=Ht,Z5=ft,Dl=tt,eq=Jt,tq=Pt,rq=Ea,nq=lr,aq=tr.f,iq=w1,fa=Z5.Symbol,Pi=fa&&fa.prototype;if(X5&&tq(fa)&&(!("description"in Pi)||fa().description!==void 0)){var Vw={},Bl=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:nq(arguments[0]),r=rq(Pi,this)?new fa(t):t===void 0?fa():fa(t);return t===""&&(Vw[r]=!0),r};iq(Bl,fa),Bl.prototype=Pi,Pi.constructor=Bl;var sq=String(fa("test"))=="Symbol(test)",oq=Dl(Pi.valueOf),uq=Dl(Pi.toString),lq=/^Symbol\((.*)\)[^)]+$/,cq=Dl("".replace),fq=Dl("".slice);aq(Pi,"description",{configurable:!0,get:function(){var t=oq(this);if(eq(Vw,t))return"";var r=uq(t),n=sq?fq(r,7,-1):cq(r,lq,"$1");return n===""?void 0:n}}),Q5({global:!0,constructor:!0,forced:!0},{Symbol:Bl})}var dq=U1;dq("iterator");var pq=Ht,vq=Ju.EXISTS,nk=tt,hq=tr.f,ak=Function.prototype,yq=nk(ak.toString),ik=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,gq=nk(ik.exec),mq="name";pq&&!vq&&hq(ak,mq,{configurable:!0,get:function(){try{return gq(ik,yq(this))[1]}catch{return""}}});var mi={exports:{}},sk={exports:{}};(function(e){function t(r){if(Array.isArray(r))return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(sk);var ok={exports:{}};(function(e){function t(r,n){var a=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(a!=null){var i=[],s=!0,o=!1,u,l;try{for(a=a.call(r);!(s=(u=a.next()).done)&&(i.push(u.value),!(n&&i.length===n));s=!0);}catch(c){o=!0,l=c}finally{try{!s&&a.return!=null&&a.return()}finally{if(o)throw l}}return i}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ok);var jy={exports:{}},Uy={exports:{}};(function(e){function t(r,n){(n==null||n>r.length)&&(n=r.length);for(var a=0,i=new Array(n);a<n;a++)i[a]=r[a];return i}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Uy);(function(e){var t=Uy.exports;function r(n,a){if(!!n){if(typeof n=="string")return t(n,a);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(n,a)}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(jy);var uk={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(uk);(function(e){var t=sk.exports,r=ok.exports,n=jy.exports,a=uk.exports;function i(s,o){return t(s)||r(s,o)||n(s,o)||a()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(mi);var bi={exports:{}},lk={exports:{}};(function(e){var t=Uy.exports;function r(n){if(Array.isArray(n))return t(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(lk);var ck={exports:{}};(function(e){function t(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ck);var fk={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(fk);(function(e){var t=lk.exports,r=ck.exports,n=jy.exports,a=fk.exports;function i(s){return t(s)||r(s)||n(s)||a()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(bi);var bq=ot,wq=pf.includes,_q=at,Sq=Cy,$q=_q(function(){return!Array(1).includes()});bq({target:"Array",proto:!0,forced:$q},{includes:function(t){return wq(this,t,arguments.length>1?arguments[1]:void 0)}});Sq("includes");var Tq=Kt,kq=Math.floor,dk=Number.isInteger||function(t){return!Tq(t)&&isFinite(t)&&kq(t)===t},Eq=ot,Iq=dk;Eq({target:"Number",stat:!0},{isInteger:Iq});var Cq=Ht,pk=tt,Rq=Zu,Aq=Yr,Oq=Gu.f,Pq=pk(Oq),Mq=pk([].push),Kw=function(e){return function(t){for(var r=Aq(t),n=Rq(r),a=n.length,i=0,s=[],o;a>i;)o=n[i++],(!Cq||Pq(r,o))&&Mq(s,e?[o,r[o]]:r[o]);return s}},xq={entries:Kw(!0),values:Kw(!1)},Nq=ot,Lq=xq.entries;Nq({target:"Object",stat:!0},{entries:function(t){return Lq(t)}});/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(kr,"__esModule",{value:!0});var jq=Fn.exports,Uq=mi.exports,Fq=bi.exports,Dq=ra.exports,Bq=Dn.exports,qq=jn.exports,Hq=Un.exports,Wq=Xr.exports;function wi(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Qs=wi(jq),ba=wi(Uq),up=wi(Fq),Gq=wi(Dq),zq=wi(Bq),Vq=wi(qq),Kq=wi(Hq),Jw=wi(Wq),Pa=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function Jq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Yq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function Yq(e,t){if(!!e){if(typeof e=="string")return Yw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yw(e,t)}}function Yw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var vk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Pa(function(a){var i=!1,s=[],o=Jq(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||Qs.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function Qq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Xq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function Xq(e,t){if(!!e){if(typeof e=="string")return Qw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qw(e,t)}}function Qw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Zq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Pa(function(a){var i=!1,s=[],o=Qq(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function e8(e){var t=t8();return function(){var n=Jw.default(e),a;if(t){var i=Jw.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Kq.default(this,a)}}function t8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=r8(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function r8(e,t){if(!!e){if(typeof e=="string")return Xw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xw(e,t)}}function Xw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Lu(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=ba.default(a.value,2),s=i[0],o=i[1],u=Lf(t[s],o),l=ba.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},hk=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(Qs.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Qs.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=Qs.default(t)),n},n8=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Fy(r);return function(i){return function(s){Vq.default(u,s);var o=e8(u);function u(){zq.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return xf(a,c),o.call.apply(o,[this].concat(c))}return Gq.default(u)}(i)}},a8=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Fy(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return xf(a,c),u.apply(this,c)}}},i8=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Fy(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{xf(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},Fy=function(t){var r=[],n=Lu(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Nf(i))}}catch(s){n.e(s)}finally{n.f()}return r},Nf=function(t){var r=[],n=Array.isArray(t)?t:[t],a=Lu(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(vk(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},Lf=function(t,r){var n=[],a,i=!1,s=Lu(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=Lu(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=ba.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(up.default(n),[A]):[].concat(up.default(n),up.default(A)))}}catch(ue){l.e(ue)}finally{l.f()}}}catch(ue){s.e(ue)}finally{s.f()}if(i)return[!0];var U=a||hk(r),D=n.length-1,de=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,U,de,D>1?";":","]};function s8(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o8(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function o8(e,t){if(!!e){if(typeof e=="string")return Zw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zw(e,t)}}function Zw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u8=function(t,r){return Pa(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=s8(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ba.default(i.value,2),o=s[0],u=s[1],l=Lf(Nf(r),u),c=ba.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},l8=Pa(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),c8=Pa(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),f8=Pa(function(e){return[Qs.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),d8=function(t,r){return Pa(function(n){if(Qs.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=ba.default(i[a],2),o=s[0],u=s[1],l=Lf(Nf(u),n[o]),c=ba.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function p8(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=v8(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function v8(e,t){if(!!e){if(typeof e=="string")return e_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e_(e,t)}}function e_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h8=function(t,r){return Pa(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=p8(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ba.default(i.value,2),o=s[0],u=s[1],l=Lf(Nf(r),u),c=ba.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};kr.array=h8;kr.custom=Pa;kr.literal=Zq;kr.nonEmptyArray=u8;kr.nonEmptyString=l8;kr.nonNegativeInteger=c8;kr.objectSchema=d8;kr.pureObject=f8;kr.runtimeTypeValidation=xf;kr.stringifyReceivedType=hk;kr.type=vk;kr.validateConstructorTypes=n8;kr.validateTypes=a8;kr.validateTypesAsync=i8;var Dy={},jf={exports:{}},yk={exports:{}};(function(e){var t=Xr.exports;function r(n,a){for(;!Object.prototype.hasOwnProperty.call(n,a)&&(n=t(n),n!==null););return n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(yk);(function(e){var t=yk.exports;function r(){return typeof Reflect<"u"&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(a,i,s){var o=t(a,i);if(!!o){var u=Object.getOwnPropertyDescriptor(o,i);return u.get?u.get.call(arguments.length<3?a:s):u.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(jf);/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(Dy,"__esModule",{value:!0});var y8=bi.exports,g8=Dn.exports,m8=ra.exports,b8=yi.exports,w8=jf.exports,_8=jn.exports,S8=Un.exports,$8=Xr.exports,T8=gi.exports;function Ma(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var t_=Ma(y8),k8=Ma(g8),E8=Ma(m8),I8=Ma(b8),Mi=Ma(w8),C8=Ma(_8),R8=Ma(S8),da=Ma($8),A8=Ma(T8),O8;function ni(){}ni.prototype=Object.create(null);function Nt(){Nt.init.call(this)}Nt.EventEmitter=Nt;Nt.usingDomains=!1;Nt.prototype.domain=void 0;Nt.prototype._events=void 0;Nt.prototype._maxListeners=void 0;Nt.defaultMaxListeners=10;Nt.init=function(){this.domain=null,Nt.usingDomains&&O8.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ni,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Nt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function gk(e){return e._maxListeners===void 0?Nt.defaultMaxListeners:e._maxListeners}Nt.prototype.getMaxListeners=function(){return gk(this)};function P8(e,t,r){if(t)e.call(r);else for(var n=e.length,a=fl(e,n),i=0;i<n;++i)a[i].call(r)}function M8(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=fl(e,a),s=0;s<a;++s)i[s].call(r,n)}function x8(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=fl(e,i),o=0;o<i;++o)s[o].call(r,n,a)}function N8(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,o=fl(e,s),u=0;u<s;++u)o[u].call(r,n,a,i)}function L8(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=fl(e,a),s=0;s<a;++s)i[s].apply(r,n)}Nt.prototype.emit=function(t){var r,n,a,i,s,o,u,l=t==="error";if(o=this._events,o)l=l&&o.error==null;else if(!l)return!1;if(u=this.domain,l){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=o[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:P8(n,h,this);break;case 2:M8(n,h,this,arguments[1]);break;case 3:x8(n,h,this,arguments[1],arguments[2]);break;case 4:N8(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];L8(n,h,this,i)}return!0};function mk(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ni,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=gk(e),a&&a>0&&s.length>a)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,j8(o)}return e}function j8(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Nt.prototype.addListener=function(t,r){return mk(this,t,r,!1)};Nt.prototype.on=Nt.prototype.addListener;Nt.prototype.prependListener=function(t,r){return mk(this,t,r,!0)};function bk(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}Nt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,bk(this,t,r)),this};Nt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,bk(this,t,r)),this};Nt.prototype.removeListener=function(t,r){var n,a,i,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ni:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ni,this;delete a[t]}else U8(n,i);a.removeListener&&this.emit("removeListener",t,o||r)}return this};Nt.prototype.off=function(e,t){return this.removeListener(e,t)};Nt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ni,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ni:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ni,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Nt.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=F8(r):n=[]):n=[],n};Nt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):wk.call(e,t)};Nt.prototype.listenerCount=wk;function wk(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Nt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function U8(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function fl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function F8(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function D8(e){var t=B8();return function(){var n=da.default(e),a;if(t){var i=da.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return R8.default(this,a)}}function B8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q8=function(e){C8.default(r,e);var t=D8(r);function r(){var n;return k8.default(this,r),n=t.call(this),A8.default(I8.default(n),"eventHistory",new Map),n}return E8.default(r,[{key:"on",value:function(a,i){return Mi.default(da.default(r.prototype),"on",this).call(this,a,i)}},{key:"once",value:function(a,i){return Mi.default(da.default(r.prototype),"once",this).call(this,a,i)}},{key:"off",value:function(a,i){return Mi.default(da.default(r.prototype),"off",this).call(this,a,i)}},{key:"emit",value:function(a){for(var i,s=arguments.length,o=new Array(s>1?s-1:0),u=1;u<s;u++)o[u-1]=arguments[u];return this.eventHistory.set(a,o),(i=Mi.default(da.default(r.prototype),"emit",this)).call.apply(i,[this,a].concat(o))}},{key:"addListener",value:function(a,i){return Mi.default(da.default(r.prototype),"addListener",this).call(this,a,i)}},{key:"removeListener",value:function(a,i){return Mi.default(da.default(r.prototype),"removeListener",this).call(this,a,i)}},{key:"addListenerWithReplay",value:function(a,i){var s=this.eventHistory.get(a);return s!==void 0&&i.apply(void 0,t_.default(s)),this.addListener(a,i)}},{key:"onWithReplay",value:function(a,i){return this.addListenerWithReplay(a,i)}},{key:"onceWithReplay",value:function(a,i){var s=this.eventHistory.get(a);return s!==void 0?(i.apply(void 0,t_.default(s)),this):Mi.default(da.default(r.prototype),"once",this).call(this,a,i)}}]),r}(Nt);Dy.ReplayEventEmitter=q8;var Kv={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",a=1,i=2,s=9007199254740991,o="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",h="[object Date]",w="[object Error]",b="[object Function]",$="[object GeneratorFunction]",A="[object Map]",x="[object Number]",U="[object Null]",D="[object Object]",de="[object Promise]",ue="[object Proxy]",Ae="[object RegExp]",we="[object Set]",he="[object String]",P="[object Symbol]",Q="[object Undefined]",ce="[object WeakMap]",W="[object ArrayBuffer]",ve="[object DataView]",te="[object Float32Array]",ae="[object Float64Array]",J="[object Int8Array]",ie="[object Int16Array]",Re="[object Int32Array]",ke="[object Uint8Array]",N="[object Uint8ClampedArray]",dt="[object Uint16Array]",pt="[object Uint32Array]",Ee=/[\\^$.*+?()[\]{}|]/g,Xe=/^\[object .+?Constructor\]$/,Ye=/^(?:0|[1-9]\d*)$/,B={};B[te]=B[ae]=B[J]=B[ie]=B[Re]=B[ke]=B[N]=B[dt]=B[pt]=!0,B[o]=B[u]=B[W]=B[c]=B[ve]=B[h]=B[w]=B[b]=B[A]=B[x]=B[D]=B[Ae]=B[we]=B[he]=B[ce]=!1;var T=typeof An=="object"&&An&&An.Object===Object&&An,Te=typeof self=="object"&&self&&self.Object===Object&&self,ye=T||Te||Function("return this")(),Ke=t&&!t.nodeType&&t,Qe=Ke&&!0&&e&&!e.nodeType&&e,Se=Qe&&Qe.exports===Ke,Ge=Se&&T.process,R=function(){try{return Ge&&Ge.binding&&Ge.binding("util")}catch{}}(),I=R&&R.isTypedArray;function K(M,X){for(var se=-1,Be=M==null?0:M.length,Bt=0,ut=[];++se<Be;){var Yt=M[se];X(Yt,se,M)&&(ut[Bt++]=Yt)}return ut}function pe(M,X){for(var se=-1,Be=X.length,Bt=M.length;++se<Be;)M[Bt+se]=X[se];return M}function G(M,X){for(var se=-1,Be=M==null?0:M.length;++se<Be;)if(X(M[se],se,M))return!0;return!1}function Pe(M,X){for(var se=-1,Be=Array(M);++se<M;)Be[se]=X(se);return Be}function be(M){return function(X){return M(X)}}function _e(M,X){return M.has(X)}function Oe(M,X){return M==null?void 0:M[X]}function ee(M){var X=-1,se=Array(M.size);return M.forEach(function(Be,Bt){se[++X]=[Bt,Be]}),se}function Fe(M,X){return function(se){return M(X(se))}}function Ue(M){var X=-1,se=Array(M.size);return M.forEach(function(Be){se[++X]=Be}),se}var Me=Array.prototype,oe=Function.prototype,F=Object.prototype,H=ye["__core-js_shared__"],Y=oe.toString,ge=F.hasOwnProperty,Ne=function(){var M=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||"");return M?"Symbol(src)_1."+M:""}(),qe=F.toString,ze=RegExp("^"+Y.call(ge).replace(Ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=Se?ye.Buffer:void 0,He=ye.Symbol,Le=ye.Uint8Array,Z=F.propertyIsEnumerable,ne=Me.splice,q=He?He.toStringTag:void 0,V=Object.getOwnPropertySymbols,re=De?De.isBuffer:void 0,me=Fe(Object.keys,Object),fe=vt(ye,"DataView"),je=vt(ye,"Map"),Ve=vt(ye,"Promise"),it=vt(ye,"Set"),rt=vt(ye,"WeakMap"),We=vt(Object,"create"),vr=p(fe),nt=p(je),Rr=p(Ve),Ft=p(it),bn=p(rt),nr=He?He.prototype:void 0,Bn=nr?nr.valueOf:void 0;function Rt(M){var X=-1,se=M==null?0:M.length;for(this.clear();++X<se;){var Be=M[X];this.set(Be[0],Be[1])}}function hr(){this.__data__=We?We(null):{},this.size=0}function qr(M){var X=this.has(M)&&delete this.__data__[M];return this.size-=X?1:0,X}function Hr(M){var X=this.__data__;if(We){var se=X[M];return se===n?void 0:se}return ge.call(X,M)?X[M]:void 0}function yr(M){var X=this.__data__;return We?X[M]!==void 0:ge.call(X,M)}function gs(M,X){var se=this.__data__;return this.size+=this.has(M)?0:1,se[M]=We&&X===void 0?n:X,this}Rt.prototype.clear=hr,Rt.prototype.delete=qr,Rt.prototype.get=Hr,Rt.prototype.has=yr,Rt.prototype.set=gs;function Nr(M){var X=-1,se=M==null?0:M.length;for(this.clear();++X<se;){var Be=M[X];this.set(Be[0],Be[1])}}function ms(){this.__data__=[],this.size=0}function Co(M){var X=this.__data__,se=Sn(X,M);if(se<0)return!1;var Be=X.length-1;return se==Be?X.pop():ne.call(X,se,1),--this.size,!0}function Ro(M){var X=this.__data__,se=Sn(X,M);return se<0?void 0:X[se][1]}function bs(M){return Sn(this.__data__,M)>-1}function Ao(M,X){var se=this.__data__,Be=Sn(se,M);return Be<0?(++this.size,se.push([M,X])):se[Be][1]=X,this}Nr.prototype.clear=ms,Nr.prototype.delete=Co,Nr.prototype.get=Ro,Nr.prototype.has=bs,Nr.prototype.set=Ao;function wn(M){var X=-1,se=M==null?0:M.length;for(this.clear();++X<se;){var Be=M[X];this.set(Be[0],Be[1])}}function _n(){this.size=0,this.__data__={hash:new Rt,map:new(je||Nr),string:new Rt}}function $t(M){var X=aa(this,M).delete(M);return this.size-=X?1:0,X}function Oo(M){return aa(this,M).get(M)}function Po(M){return aa(this,M).has(M)}function Mo(M,X){var se=aa(this,M),Be=se.size;return se.set(M,X),this.size+=se.size==Be?0:1,this}wn.prototype.clear=_n,wn.prototype.delete=$t,wn.prototype.get=Oo,wn.prototype.has=Po,wn.prototype.set=Mo;function na(M){var X=-1,se=M==null?0:M.length;for(this.__data__=new wn;++X<se;)this.add(M[X])}function ws(M){return this.__data__.set(M,n),this}function xo(M){return this.__data__.has(M)}na.prototype.add=na.prototype.push=ws,na.prototype.has=xo;function tn(M){var X=this.__data__=new Nr(M);this.size=X.size}function No(){this.__data__=new Nr,this.size=0}function gr(M){var X=this.__data__,se=X.delete(M);return this.size=X.size,se}function Lo(M){return this.__data__.get(M)}function jo(M){return this.__data__.has(M)}function Uo(M,X){var se=this.__data__;if(se instanceof Nr){var Be=se.__data__;if(!je||Be.length<r-1)return Be.push([M,X]),this.size=++se.size,this;se=this.__data__=new wn(Be)}return se.set(M,X),this.size=se.size,this}tn.prototype.clear=No,tn.prototype.delete=gr,tn.prototype.get=Lo,tn.prototype.has=jo,tn.prototype.set=Uo;function Fo(M,X){var se=y(M),Be=!se&&m(M),Bt=!se&&!Be&&E(M),ut=!se&&!Be&&!Bt&&Ze(M),Yt=se||Be||Bt||ut,ir=Yt?Pe(M.length,String):[],fr=ir.length;for(var zt in M)(X||ge.call(M,zt))&&!(Yt&&(zt=="length"||Bt&&(zt=="offset"||zt=="parent")||ut&&(zt=="buffer"||zt=="byteLength"||zt=="byteOffset")||S(zt,fr)))&&ir.push(zt);return ir}function Sn(M,X){for(var se=M.length;se--;)if(f(M[se][0],X))return se;return-1}function Do(M,X,se){var Be=X(M);return y(M)?Be:pe(Be,se(M))}function Lr(M){return M==null?M===void 0?Q:U:q&&q in Object(M)?$s(M):d(M)}function ja(M){return Dt(M)&&Lr(M)==o}function ki(M,X,se,Be,Bt){return M===X?!0:M==null||X==null||!Dt(M)&&!Dt(X)?M!==M&&X!==X:Bo(M,X,se,Be,ki,Bt)}function Bo(M,X,se,Be,Bt,ut){var Yt=y(M),ir=y(X),fr=Yt?u:O(M),zt=ir?u:O(X);fr=fr==o?D:fr,zt=zt==o?D:zt;var Wr=fr==D,$n=zt==D,br=fr==zt;if(br&&E(M)){if(!E(X))return!1;Yt=!0,Wr=!1}if(br&&!Wr)return ut||(ut=new tn),Yt||Ze(M)?yt(M,X,se,Be,Bt,ut):Ss(M,X,fr,se,Be,Bt,ut);if(!(se&a)){var rn=Wr&&ge.call(M,"__wrapped__"),nn=$n&&ge.call(X,"__wrapped__");if(rn||nn){var Fa=rn?M.value():M,ia=nn?X.value():X;return ut||(ut=new tn),Bt(Fa,ia,se,Be,ut)}}return br?(ut||(ut=new tn),Ua(M,X,se,Be,Bt,ut)):!1}function _s(M){if(!Je(M)||v(M))return!1;var X=j(M)?ze:Xe;return X.test(p(M))}function qo(M){return Dt(M)&&Ie(M.length)&&!!B[Lr(M)]}function Ho(M){if(!g(M))return me(M);var X=[];for(var se in Object(M))ge.call(M,se)&&se!="constructor"&&X.push(se);return X}function yt(M,X,se,Be,Bt,ut){var Yt=se&a,ir=M.length,fr=X.length;if(ir!=fr&&!(Yt&&fr>ir))return!1;var zt=ut.get(M);if(zt&&ut.get(X))return zt==X;var Wr=-1,$n=!0,br=se&i?new na:void 0;for(ut.set(M,X),ut.set(X,M);++Wr<ir;){var rn=M[Wr],nn=X[Wr];if(Be)var Fa=Yt?Be(nn,rn,Wr,X,M,ut):Be(rn,nn,Wr,M,X,ut);if(Fa!==void 0){if(Fa)continue;$n=!1;break}if(br){if(!G(X,function(ia,Ii){if(!_e(br,Ii)&&(rn===ia||Bt(rn,ia,se,Be,ut)))return br.push(Ii)})){$n=!1;break}}else if(!(rn===nn||Bt(rn,nn,se,Be,ut))){$n=!1;break}}return ut.delete(M),ut.delete(X),$n}function Ss(M,X,se,Be,Bt,ut,Yt){switch(se){case ve:if(M.byteLength!=X.byteLength||M.byteOffset!=X.byteOffset)return!1;M=M.buffer,X=X.buffer;case W:return!(M.byteLength!=X.byteLength||!ut(new Le(M),new Le(X)));case c:case h:case x:return f(+M,+X);case w:return M.name==X.name&&M.message==X.message;case Ae:case he:return M==X+"";case A:var ir=ee;case we:var fr=Be&a;if(ir||(ir=Ue),M.size!=X.size&&!fr)return!1;var zt=Yt.get(M);if(zt)return zt==X;Be|=i,Yt.set(M,X);var Wr=yt(ir(M),ir(X),Be,Bt,ut,Yt);return Yt.delete(M),Wr;case P:if(Bn)return Bn.call(M)==Bn.call(X)}return!1}function Ua(M,X,se,Be,Bt,ut){var Yt=se&a,ir=Ei(M),fr=ir.length,zt=Ei(X),Wr=zt.length;if(fr!=Wr&&!Yt)return!1;for(var $n=fr;$n--;){var br=ir[$n];if(!(Yt?br in X:ge.call(X,br)))return!1}var rn=ut.get(M);if(rn&&ut.get(X))return rn==X;var nn=!0;ut.set(M,X),ut.set(X,M);for(var Fa=Yt;++$n<fr;){br=ir[$n];var ia=M[br],Ii=X[br];if(Be)var Mg=Yt?Be(Ii,ia,br,X,M,ut):Be(ia,Ii,br,M,X,ut);if(!(Mg===void 0?ia===Ii||Bt(ia,Ii,se,Be,ut):Mg)){nn=!1;break}Fa||(Fa=br=="constructor")}if(nn&&!Fa){var bl=M.constructor,wl=X.constructor;bl!=wl&&"constructor"in M&&"constructor"in X&&!(typeof bl=="function"&&bl instanceof bl&&typeof wl=="function"&&wl instanceof wl)&&(nn=!1)}return ut.delete(M),ut.delete(X),nn}function Ei(M){return Do(M,mr,C)}function aa(M,X){var se=M.__data__;return _(X)?se[typeof X=="string"?"string":"hash"]:se.map}function vt(M,X){var se=Oe(M,X);return _s(se)?se:void 0}function $s(M){var X=ge.call(M,q),se=M[q];try{M[q]=void 0;var Be=!0}catch{}var Bt=qe.call(M);return Be&&(X?M[q]=se:delete M[q]),Bt}var C=V?function(M){return M==null?[]:(M=Object(M),K(V(M),function(X){return Z.call(M,X)}))}:cr,O=Lr;(fe&&O(new fe(new ArrayBuffer(1)))!=ve||je&&O(new je)!=A||Ve&&O(Ve.resolve())!=de||it&&O(new it)!=we||rt&&O(new rt)!=ce)&&(O=function(M){var X=Lr(M),se=X==D?M.constructor:void 0,Be=se?p(se):"";if(Be)switch(Be){case vr:return ve;case nt:return A;case Rr:return de;case Ft:return we;case bn:return ce}return X});function S(M,X){return X=X==null?s:X,!!X&&(typeof M=="number"||Ye.test(M))&&M>-1&&M%1==0&&M<X}function _(M){var X=typeof M;return X=="string"||X=="number"||X=="symbol"||X=="boolean"?M!=="__proto__":M===null}function v(M){return!!Ne&&Ne in M}function g(M){var X=M&&M.constructor,se=typeof X=="function"&&X.prototype||F;return M===se}function d(M){return qe.call(M)}function p(M){if(M!=null){try{return Y.call(M)}catch{}try{return M+""}catch{}}return""}function f(M,X){return M===X||M!==M&&X!==X}var m=ja(function(){return arguments}())?ja:function(M){return Dt(M)&&ge.call(M,"callee")&&!Z.call(M,"callee")},y=Array.isArray;function k(M){return M!=null&&Ie(M.length)&&!j(M)}var E=re||Ar;function L(M,X){return ki(M,X)}function j(M){if(!Je(M))return!1;var X=Lr(M);return X==b||X==$||X==l||X==ue}function Ie(M){return typeof M=="number"&&M>-1&&M%1==0&&M<=s}function Je(M){var X=typeof M;return M!=null&&(X=="object"||X=="function")}function Dt(M){return M!=null&&typeof M=="object"}var Ze=I?be(I):qo;function mr(M){return k(M)?Fo(M):Ho(M)}function cr(){return[]}function Ar(){return!1}e.exports=L})(Kv,Kv.exports);var By={exports:{}},H8=at,W8=H8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),G8=at,z8=Kt,V8=di,r_=W8,hc=Object.isExtensible,K8=G8(function(){hc(1)}),J8=K8||r_?function(t){return!z8(t)||r_&&V8(t)=="ArrayBuffer"?!1:hc?hc(t):!0}:hc,Y8=at,Q8=!Y8(function(){return Object.isExtensible(Object.preventExtensions({}))}),X8=ot,Z8=tt,eH=Yu,tH=Kt,qy=Jt,rH=tr.f,n_=pi,nH=iy,Hy=J8,aH=Vu,iH=Q8,_k=!1,wa=aH("meta"),sH=0,Wy=function(e){rH(e,wa,{value:{objectID:"O"+sH++,weakData:{}}})},oH=function(e,t){if(!tH(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!qy(e,wa)){if(!Hy(e))return"F";if(!t)return"E";Wy(e)}return e[wa].objectID},uH=function(e,t){if(!qy(e,wa)){if(!Hy(e))return!0;if(!t)return!1;Wy(e)}return e[wa].weakData},lH=function(e){return iH&&_k&&Hy(e)&&!qy(e,wa)&&Wy(e),e},cH=function(){fH.enable=function(){},_k=!0;var e=n_.f,t=Z8([].splice),r={};r[wa]=1,e(r).length&&(n_.f=function(n){for(var a=e(n),i=0,s=a.length;i<s;i++)if(a[i]===wa){t(a,i,1);break}return a},X8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:nH.f}))},fH=By.exports={enable:cH,fastKey:oH,getWeakData:uH,onFreeze:lH};eH[wa]=!0;var dH=ot,pH=ft,vH=tt,a_=vf,hH=Tr,yH=By.exports,gH=Ef,mH=ds,bH=Pt,wH=Zn,lp=Kt,cp=at,_H=If,SH=Ra,$H=Ay,Sk=function(e,t,r){var n=e.indexOf("Map")!==-1,a=e.indexOf("Weak")!==-1,i=n?"set":"add",s=pH[e],o=s&&s.prototype,u=s,l={},c=function(U){var D=vH(o[U]);hH(o,U,U=="add"?function(ue){return D(this,ue===0?0:ue),this}:U=="delete"?function(de){return a&&!lp(de)?!1:D(this,de===0?0:de)}:U=="get"?function(ue){return a&&!lp(ue)?void 0:D(this,ue===0?0:ue)}:U=="has"?function(ue){return a&&!lp(ue)?!1:D(this,ue===0?0:ue)}:function(ue,Ae){return D(this,ue===0?0:ue,Ae),this})},h=a_(e,!bH(s)||!(a||o.forEach&&!cp(function(){new s().entries().next()})));if(h)u=r.getConstructor(t,e,n,i),yH.enable();else if(a_(e,!0)){var w=new u,b=w[i](a?{}:-0,1)!=w,$=cp(function(){w.has(1)}),A=_H(function(U){new s(U)}),x=!a&&cp(function(){for(var U=new s,D=5;D--;)U[i](D,D);return!U.has(-0)});A||(u=t(function(U,D){mH(U,o);var de=$H(new s,U,u);return wH(D)||gH(D,de[i],{that:de,AS_ENTRIES:n}),de}),u.prototype=o,o.constructor=u),($||x)&&(c("delete"),c("has"),n&&c("get")),(x||b)&&c(i),a&&o.clear&&delete o.clear}return l[e]=u,dH({global:!0,constructor:!0,forced:u!=s},l),SH(u,e),a||r.setStrong(u,e,n),u},TH=Tr,Gy=function(e,t,r){for(var n in t)TH(e,n,t[n],r);return e},kH=tr.f,EH=hi,i_=Gy,IH=Oa,CH=ds,RH=Zn,AH=Ef,OH=Ty,ql=ky,PH=Sf,Yo=Ht,s_=By.exports.fastKey,$k=gn,o_=$k.set,fp=$k.getterFor,Tk={getConstructor:function(e,t,r,n){var a=e(function(l,c){CH(l,i),o_(l,{type:t,index:EH(null),first:void 0,last:void 0,size:0}),Yo||(l.size=0),RH(c)||AH(c,l[n],{that:l,AS_ENTRIES:r})}),i=a.prototype,s=fp(t),o=function(l,c,h){var w=s(l),b=u(l,c),$,A;return b?b.value=h:(w.last=b={index:A=s_(c,!0),key:c,value:h,previous:$=w.last,next:void 0,removed:!1},w.first||(w.first=b),$&&($.next=b),Yo?w.size++:l.size++,A!=="F"&&(w.index[A]=b)),l},u=function(l,c){var h=s(l),w=s_(c),b;if(w!=="F")return h.index[w];for(b=h.first;b;b=b.next)if(b.key==c)return b};return i_(i,{clear:function(){for(var c=this,h=s(c),w=h.index,b=h.first;b;)b.removed=!0,b.previous&&(b.previous=b.previous.next=void 0),delete w[b.index],b=b.next;h.first=h.last=void 0,Yo?h.size=0:c.size=0},delete:function(l){var c=this,h=s(c),w=u(c,l);if(w){var b=w.next,$=w.previous;delete h.index[w.index],w.removed=!0,$&&($.next=b),b&&(b.previous=$),h.first==w&&(h.first=b),h.last==w&&(h.last=$),Yo?h.size--:c.size--}return!!w},forEach:function(c){for(var h=s(this),w=IH(c,arguments.length>1?arguments[1]:void 0),b;b=b?b.next:h.first;)for(w(b.value,b.key,this);b&&b.removed;)b=b.previous},has:function(c){return!!u(this,c)}}),i_(i,r?{get:function(c){var h=u(this,c);return h&&h.value},set:function(c,h){return o(this,c===0?0:c,h)}}:{add:function(c){return o(this,c=c===0?0:c,c)}}),Yo&&kH(i,"size",{get:function(){return s(this).size}}),a},setStrong:function(e,t,r){var n=t+" Iterator",a=fp(t),i=fp(n);OH(e,t,function(s,o){o_(this,{type:n,target:s,state:a(s),kind:o,last:void 0})},function(){for(var s=i(this),o=s.kind,u=s.last;u&&u.removed;)u=u.previous;return!s.target||!(s.last=u=u?u.next:s.state.first)?(s.target=void 0,ql(void 0,!0)):o=="keys"?ql(u.key,!1):o=="values"?ql(u.value,!1):ql([u.key,u.value],!1)},r?"entries":"values",!r,!0),PH(t)}},MH=Sk,xH=Tk;MH("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},xH);var xa={};/*
@license
Copyright (c) 2016, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/Object.defineProperty(xa,"__esModule",{value:!0});var NH=Dn.exports,LH=ra.exports,jH=yi.exports,UH=jn.exports,FH=Un.exports,DH=Xr.exports,BH=gi.exports;function vs(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var zy=vs(NH),Vy=vs(LH),va=vs(jH),Ky=vs(UH),kk=vs(FH),Pc=vs(DH),ha=vs(BH),qH;function ai(){}ai.prototype=Object.create(null);function It(){It.init.call(this)}It.EventEmitter=It;It.usingDomains=!1;It.prototype.domain=void 0;It.prototype._events=void 0;It.prototype._maxListeners=void 0;It.defaultMaxListeners=10;It.init=function(){this.domain=null,It.usingDomains&&qH.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ai,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};It.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function Ek(e){return e._maxListeners===void 0?It.defaultMaxListeners:e._maxListeners}It.prototype.getMaxListeners=function(){return Ek(this)};function HH(e,t,r){if(t)e.call(r);else for(var n=e.length,a=dl(e,n),i=0;i<n;++i)a[i].call(r)}function WH(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=dl(e,a),s=0;s<a;++s)i[s].call(r,n)}function GH(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=dl(e,i),o=0;o<i;++o)s[o].call(r,n,a)}function zH(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,o=dl(e,s),u=0;u<s;++u)o[u].call(r,n,a,i)}function VH(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=dl(e,a),s=0;s<a;++s)i[s].apply(r,n)}It.prototype.emit=function(t){var r,n,a,i,s,o,u,l=t==="error";if(o=this._events,o)l=l&&o.error==null;else if(!l)return!1;if(u=this.domain,l){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=o[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:HH(n,h,this);break;case 2:WH(n,h,this,arguments[1]);break;case 3:GH(n,h,this,arguments[1],arguments[2]);break;case 4:zH(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];VH(n,h,this,i)}return!0};function Ik(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ai,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=Ek(e),a&&a>0&&s.length>a)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,KH(o)}return e}function KH(e){typeof console.warn=="function"?console.warn(e):console.log(e)}It.prototype.addListener=function(t,r){return Ik(this,t,r,!1)};It.prototype.on=It.prototype.addListener;It.prototype.prependListener=function(t,r){return Ik(this,t,r,!0)};function Ck(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}It.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,Ck(this,t,r)),this};It.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Ck(this,t,r)),this};It.prototype.removeListener=function(t,r){var n,a,i,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ai:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ai,this;delete a[t]}else JH(n,i);a.removeListener&&this.emit("removeListener",t,o||r)}return this};It.prototype.off=function(e,t){return this.removeListener(e,t)};It.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ai,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ai:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ai,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};It.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=YH(r):n=[]):n=[],n};It.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Rk.call(e,t)};It.prototype.listenerCount=Rk;function Rk(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}It.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function JH(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function dl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function YH(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Ak(e){var t=QH();return function(){var n=Pc.default(e),a;if(t){var i=Pc.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return kk.default(this,a)}}function QH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ok=function(e){Ky.default(r,e);var t=Ak(r);function r(n){var a;return zy.default(this,r),a=t.call(this),ha.default(va.default(a),"timeout",null),ha.default(va.default(a),"startTimestamp",-1),a.minDelay=n.min,a.maxDelay=n.max,a.initialDelay=n.initial||0,a.maxAttemptsCount=n.maxAttemptsCount||0,a.maxAttemptsTime=n.maxAttemptsTime||0,a.randomness=n.randomness||0,a.inProgress=!1,a.attemptNum=0,a.prevDelay=0,a.currDelay=0,a}return Vy.default(r,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(a){if(typeof a=="number")return this.prevDelay=0,this.currDelay=a,a;if(this.attemptNum==0)return this.initialDelay;if(this.attemptNum==1)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var i=this.currDelay+this.prevDelay;return this.maxDelay&&i>this.maxDelay&&(this.currDelay=this.maxDelay,i=this.maxDelay),this.currDelay=i,i}},{key:"randomize",value:function(a){var i=a*this.randomness,s=Math.round(Math.random()*i*2-i);return Math.max(0,a+s)}},{key:"scheduleAttempt",value:function(a){var i=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount){this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached"));return}var s=this.nextDelay(a);if(s=this.randomize(s),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+s){this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached"));return}this.timeout=setTimeout(function(){return i.attempt()},s)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(a){this.emit("succeeded",a)}},{key:"failed",value:function(a,i){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(i)}}]),r}(It),XH=function(e){Ky.default(r,e);var t=Ak(r);function r(n){var a;return zy.default(this,r),a=t.call(this),ha.default(va.default(a),"resolve",function(){}),ha.default(va.default(a),"reject",function(){}),a.retrier=new Ok(n),a}return Vy.default(r,[{key:"run",value:function(a){var i=this;return this.retrier.on("attempt",function(){a().then(function(s){return i.retrier.succeeded(s)}).catch(function(s){return i.retrier.failed(s)})}),this.retrier.on("succeeded",function(s){return i.resolve(s)}),this.retrier.on("cancelled",function(){return i.reject(new Error("Cancelled"))}),this.retrier.on("failed",function(s){return i.reject(s)}),new Promise(function(s,o){i.resolve=s,i.reject=o,i.retrier.start()})}},{key:"cancel",value:function(){this.retrier.cancel()}}]),r}(It);function ZH(e){var t=eW();return function(){var n=Pc.default(e),a;if(t){var i=Pc.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return kk.default(this,a)}}function eW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hl(e){return e!=null}var tW=function(e){Ky.default(r,e);var t=ZH(r);function r(n){var a;zy.default(this,r),a=t.call(this),ha.default(va.default(a),"backoffDelay",0),ha.default(va.default(a),"nextBackoffDelay",0),ha.default(va.default(a),"backoffNumber",0),ha.default(va.default(a),"timeoutID",null),ha.default(va.default(a),"maxNumberOfRetry",-1),n=n||{};var i=n,s=i.initialDelay,o=i.maxDelay,u=i.randomisationFactor,l=i.factor;if(Hl(s)&&s<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(Hl(o)&&o<=1)throw new Error("The maximal timeout must be greater than 1.");if(Hl(u)&&(u<0||u>1))throw new Error("The randomisation factor must be between 0 and 1.");if(Hl(l)&&l<=1)throw new Error("Exponential factor should be greater than 1.");if(a.initialDelay=s||100,a.maxDelay=o||1e4,a.maxDelay<=a.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return a.randomisationFactor=u||0,a.factor=l||2,a.reset(),a}return Vy.default(r,[{key:"backoff",value:function(a){this.timeoutID==null&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",a),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,a)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(a){if(a<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(a));this.maxNumberOfRetry=a}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var a=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*a))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(a){return new r(a)}}]),r}(It);xa.AsyncRetrier=XH;xa.Backoff=tW;xa.Retrier=Ok;var Uf={},rW=Ot,nW=Jt,aW=Ea,iW=ZT,u_=RegExp.prototype,sW=function(e){var t=e.flags;return t===void 0&&!("flags"in u_)&&!nW(e,"flags")&&aW(u_,e)?rW(iW,e):t},oW=Ju.PROPER,uW=Tr,lW=Qt,l_=lr,cW=at,fW=sW,Jy="toString",dW=RegExp.prototype,Pk=dW[Jy],pW=cW(function(){return Pk.call({source:"a",flags:"b"})!="/a/b"}),vW=oW&&Pk.name!=Jy;(pW||vW)&&uW(RegExp.prototype,Jy,function(){var t=lW(this),r=l_(t.source),n=l_(fW(t));return"/"+r+"/"+n},{unsafe:!0});var Er={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Er,"__esModule",{value:!0});var hW=Fn.exports,yW=mi.exports,gW=bi.exports,mW=Dn.exports,bW=jn.exports,wW=Un.exports,_W=Xr.exports;function hs(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Xs=hs(hW),ts=hs(yW),dp=hs(gW),SW=hs(mW),$W=hs(bW),TW=hs(wW),c_=hs(_W),_i=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function kW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=EW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function EW(e,t){if(!!e){if(typeof e=="string")return f_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f_(e,t)}}function f_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Mk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _i(function(a){var i=!1,s=[],o=kW(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||Xs.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function IW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=CW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function CW(e,t){if(!!e){if(typeof e=="string")return d_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d_(e,t)}}function d_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var RW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return _i(function(a){var i=!1,s=[],o=IW(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})},AW=_i(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),OW=_i(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),PW=_i(function(e){return[Xs.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]});function MW(e){var t=xW();return function(){var n=c_.default(e),a;if(t){var i=c_.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return TW.default(this,a)}}function xW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ju(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=NW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function NW(e,t){if(!!e){if(typeof e=="string")return p_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p_(e,t)}}function p_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ff=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=ju(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=ts.default(a.value,2),s=i[0],o=i[1],u=Xy(t[s],o),l=ts.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},xk=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(Xs.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Xs.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=Xs.default(t)),n},LW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Yy(r);return function(i){return function(s){$W.default(u,s);var o=MW(u);function u(){SW.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Ff(a,c),o.call.apply(o,[this].concat(c))}return u}(i)}},jW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Yy(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Ff(a,c),u.apply(this,c)}}},UW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Yy(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Ff(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},Yy=function(t){var r=[],n=ju(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Qy(i))}}catch(s){n.e(s)}finally{n.f()}return r},Qy=function(t){var r=[],n=Array.isArray(t)?t:[t],a=ju(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(Mk(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},Xy=function(t,r){var n=[],a,i=!1,s=ju(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=ju(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=ts.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(dp.default(n),[A]):[].concat(dp.default(n),dp.default(A)))}}catch(ue){l.e(ue)}finally{l.f()}}}catch(ue){s.e(ue)}finally{s.f()}if(i)return[!0];var U=a||xk(r),D=n.length-1,de=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,U,de,D>1?";":","]},FW=function(t,r){return _i(function(n){if(Xs.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=ts.default(i[a],2),o=s[0],u=s[1],l=Xy(Qy(u),n[o]),c=ts.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function DW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=BW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function BW(e,t){if(!!e){if(typeof e=="string")return v_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v_(e,t)}}function v_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qW=function(t,r){return _i(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=DW(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ts.default(i.value,2),o=s[0],u=s[1],l=Xy(Qy(r),u),c=ts.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Er.array=qW;Er.custom=_i;Er.literal=RW;Er.nonEmptyString=AW;Er.nonNegativeInteger=OW;Er.objectSchema=FW;Er.pureObject=PW;Er.runtimeTypeValidation=Ff;Er.stringifyReceivedType=xk;Er.type=Mk;Er.validateConstructorTypes=LW;Er.validateTypes=jW;Er.validateTypesAsync=UW;var HW=Sk,WW=Tk;HW("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},WW);var Nk={exports:{}};(function(e,t){(function(n,a){e.exports=a()})(An,function(){return function(r){var n={};function a(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return r[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=r,a.c=n,a.i=function(i){return i},a.d=function(i,s,o){a.o(i,s)||Object.defineProperty(i,s,{configurable:!1,enumerable:!0,get:o})},a.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(s,"a",s),s},a.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},a.p="",a(a.s=5)}([function(r,n,a){r.exports=function(i,s){var o,u,l;for(o=1;o<arguments.length;o++){u=arguments[o];for(l in u)u.hasOwnProperty(l)&&(i[l]=u[l])}return i}},function(r,n,a){var i=a(0);r.exports={build:function(s,o){var u,l,c,h=o.plugins;for(u=0,l=h.length;u<l;u++)c=h[u],c.methods&&i(s,c.methods),c.properties&&Object.defineProperties(s,c.properties)},hook:function(s,o,u){var l,c,h,w,b=s.config.plugins,$=[s.context];for(u&&($=$.concat(u)),l=0,c=b.length;l<c;l++)w=b[l],h=b[l][o],h&&h.apply(w,$)}}},function(r,n,a){function i(s){if(s.length===0)return s;var o,u,l=s.split(/[_-]/);if(l.length===1&&l[0][0].toLowerCase()===l[0][0])return s;for(u=l[0].toLowerCase(),o=1;o<l.length;o++)u=u+l[o].charAt(0).toUpperCase()+l[o].substring(1).toLowerCase();return u}i.prepended=function(s,o){return o=i(o),s+o[0].toUpperCase()+o.substring(1)},r.exports=i},function(r,n,a){var i=a(0),s=a(2);function o(u,l){u=u||{},this.options=u,this.defaults=l.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(u.init),this.data=this.configureData(u.data),this.methods=this.configureMethods(u.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(u.transitions||[]),this.plugins=this.configurePlugins(u.plugins,l.plugin)}i(o.prototype,{addState:function(u){this.map[u]||(this.states.push(u),this.addStateLifecycleNames(u),this.map[u]={})},addStateLifecycleNames:function(u){this.lifecycle.onEnter[u]=s.prepended("onEnter",u),this.lifecycle.onLeave[u]=s.prepended("onLeave",u),this.lifecycle.on[u]=s.prepended("on",u)},addTransition:function(u){this.transitions.indexOf(u)<0&&(this.transitions.push(u),this.addTransitionLifecycleNames(u))},addTransitionLifecycleNames:function(u){this.lifecycle.onBefore[u]=s.prepended("onBefore",u),this.lifecycle.onAfter[u]=s.prepended("onAfter",u),this.lifecycle.on[u]=s.prepended("on",u)},mapTransition:function(u){var l=u.name,c=u.from,h=u.to;return this.addState(c),typeof h!="function"&&this.addState(h),this.addTransition(l),this.map[c][l]=u,u},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(u){return typeof u=="string"?this.mapTransition(i({},this.defaults.init,{to:u,active:!0})):typeof u=="object"?this.mapTransition(i({},this.defaults.init,u,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(u){return typeof u=="function"?u:typeof u=="object"?function(){return u}:function(){return{}}},configureMethods:function(u){return u||{}},configurePlugins:function(u,l){u=u||[];var c,h,w;for(c=0,h=u.length;c<h;c++)w=u[c],typeof w=="function"&&(u[c]=w=w()),w.configure&&w.configure(this);return u},configureTransitions:function(u){var l,c,h,w,b,$=this.defaults.wildcard;for(c=0;c<u.length;c++)for(h=u[c],w=Array.isArray(h.from)?h.from:[h.from||$],b=h.to||$,l=0;l<w.length;l++)this.mapTransition({name:h.name,from:w[l],to:b})},transitionFor:function(u,l){var c=this.defaults.wildcard;return this.map[u][l]||this.map[c][l]},transitionsFor:function(u){var l=this.defaults.wildcard;return Object.keys(this.map[u]).concat(Object.keys(this.map[l]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),r.exports=o},function(r,n,a){var i=a(0),s=a(6),o=a(1),u=[null,[]];function l(c,h){this.context=c,this.config=h,this.state=h.init.from,this.observers=[c]}i(l.prototype,{init:function(c){if(i(this.context,this.config.data.apply(this.context,c)),o.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(c){return Array.isArray(c)?c.indexOf(this.state)>=0:this.state===c},isPending:function(){return this.pending},can:function(c){return!this.isPending()&&!!this.seek(c)},cannot:function(c){return!this.can(c)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(c,h){var w=this.config.defaults.wildcard,b=this.config.transitionFor(this.state,c),$=b&&b.to;return typeof $=="function"?$.apply(this.context,h):$===w?this.state:$},fire:function(c,h){return this.transit(c,this.state,this.seek(c,h),h)},transit:function(c,h,w,b){var $=this.config.lifecycle,A=this.config.options.observeUnchangedState||h!==w;return w?this.isPending()?this.context.onPendingTransition(c,h,w):(this.config.addState(w),this.beginTransit(),b.unshift({transition:c,from:h,to:w,fsm:this.context}),this.observeEvents([this.observersForEvent($.onBefore.transition),this.observersForEvent($.onBefore[c]),A?this.observersForEvent($.onLeave.state):u,A?this.observersForEvent($.onLeave[h]):u,this.observersForEvent($.on.transition),A?["doTransit",[this]]:u,A?this.observersForEvent($.onEnter.state):u,A?this.observersForEvent($.onEnter[w]):u,A?this.observersForEvent($.on[w]):u,this.observersForEvent($.onAfter.transition),this.observersForEvent($.onAfter[c]),this.observersForEvent($.on[c])],b)):this.context.onInvalidTransition(c,h,w)},beginTransit:function(){this.pending=!0},endTransit:function(c){return this.pending=!1,c},failTransit:function(c){throw this.pending=!1,c},doTransit:function(c){this.state=c.to},observe:function(c){if(c.length===2){var h={};h[c[0]]=c[1],this.observers.push(h)}else this.observers.push(c[0])},observersForEvent:function(c){for(var h=0,w=this.observers.length,b,$=[];h<w;h++)b=this.observers[h],b[c]&&$.push(b);return[c,$,!0]},observeEvents:function(c,h,w,b){if(c.length===0)return this.endTransit(b===void 0?!0:b);var $=c[0][0],A=c[0][1],x=c[0][2];if(h[0].event=$,$&&x&&$!==w&&o.hook(this,"lifecycle",h),A.length===0)return c.shift(),this.observeEvents(c,h,$,b);var U=A.shift(),D=U[$].apply(U,h);return D&&typeof D.then=="function"?D.then(this.observeEvents.bind(this,c,h,$)).catch(this.failTransit.bind(this)):D===!1?this.endTransit(!1):this.observeEvents(c,h,$,D)},onInvalidTransition:function(c,h,w){throw new s("transition is invalid in current state",c,h,w,this.state)},onPendingTransition:function(c,h,w){throw new s("transition is invalid while previous transition is still in progress",c,h,w,this.state)}}),r.exports=l},function(r,n,a){var i=a(0),s=a(2),o=a(1),u=a(3),l=a(4),c={is:function(x){return this._fsm.is(x)},can:function(x){return this._fsm.can(x)},cannot:function(x){return this._fsm.cannot(x)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(x,U,D){return this._fsm.onInvalidTransition(x,U,D)},onPendingTransition:function(x,U,D){return this._fsm.onPendingTransition(x,U,D)}},h={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(x){throw Error("use transitions to change state")}}};function w(x){return $(this||{},x)}function b(){var x,U;typeof arguments[0]=="function"?(x=arguments[0],U=arguments[1]||{}):(x=function(){this._fsm.apply(this,arguments)},U=arguments[0]||{});var D=new u(U,w);return A(x.prototype,D),x.prototype._fsm.config=D,x}function $(x,U){var D=new u(U,w);return A(x,D),x._fsm(),x}function A(x,U){if(typeof x!="object"||Array.isArray(x))throw Error("StateMachine can only be applied to objects");o.build(x,U),Object.defineProperties(x,h),i(x,c),i(x,U.methods),U.allTransitions().forEach(function(D){x[s(D)]=function(){return this._fsm.fire(D,[].slice.call(arguments))}}),x._fsm=function(){this._fsm=new l(this,U),this._fsm.init(arguments)}}w.version="3.0.1",w.factory=b,w.apply=$,w.defaults={wildcard:"*",init:{name:"init",from:"none"}},r.exports=w},function(r,n,a){r.exports=function(i,s,o,u,l){this.message=i,this.transition=s,this.from=o,this.to=u,this.current=l}}])})})(Nk);var Mc={exports:{}},h_=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(h_){var y_=new Uint8Array(16);Mc.exports=function(){return h_(y_),y_}}else{var g_=new Array(16);Mc.exports=function(){for(var t=0,r;t<16;t++)(t&3)===0&&(r=Math.random()*4294967296),g_[t]=r>>>((t&3)<<3)&255;return g_}}var Lk=[];for(var Wl=0;Wl<256;++Wl)Lk[Wl]=(Wl+256).toString(16).substr(1);function GW(e,t){var r=t||0,n=Lk;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var jk=GW,zW=Mc.exports,VW=jk,m_,pp,vp=0,hp=0;function KW(e,t,r){var n=t&&r||0,a=t||[];e=e||{};var i=e.node||m_,s=e.clockseq!==void 0?e.clockseq:pp;if(i==null||s==null){var o=zW();i==null&&(i=m_=[o[0]|1,o[1],o[2],o[3],o[4],o[5]]),s==null&&(s=pp=(o[6]<<8|o[7])&16383)}var u=e.msecs!==void 0?e.msecs:new Date().getTime(),l=e.nsecs!==void 0?e.nsecs:hp+1,c=u-vp+(l-hp)/1e4;if(c<0&&e.clockseq===void 0&&(s=s+1&16383),(c<0||u>vp)&&e.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");vp=u,hp=l,pp=s,u+=122192928e5;var h=((u&268435455)*1e4+l)%4294967296;a[n++]=h>>>24&255,a[n++]=h>>>16&255,a[n++]=h>>>8&255,a[n++]=h&255;var w=u/4294967296*1e4&268435455;a[n++]=w>>>8&255,a[n++]=w&255,a[n++]=w>>>24&15|16,a[n++]=w>>>16&255,a[n++]=s>>>8|128,a[n++]=s&255;for(var b=0;b<6;++b)a[n+b]=i[b];return t||VW(a)}var JW=KW,YW=Mc.exports,QW=jk;function XW(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||YW)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t)for(var i=0;i<16;++i)t[n+i]=a[i];return t||QW(a)}var ZW=XW,eG=JW,Uk=ZW,Zy=Uk;Zy.v1=eG;Zy.v4=Uk;var Df=Zy,Jv={exports:{}},Fk=typeof ArrayBuffer<"u"&&typeof DataView<"u",tG=Fk,eg=Ht,Mr=ft,Dk=Pt,Bf=Kt,fi=Jt,tg=Aa,rG=us,nG=Ia,Yv=Tr,aG=tr.f,iG=Ea,qf=Cf,Eo=To,sG=Mt,oG=Vu,Bk=gn,qk=Bk.enforce,uG=Bk.get,xc=Mr.Int8Array,Qv=xc&&xc.prototype,b_=Mr.Uint8ClampedArray,w_=b_&&b_.prototype,Kn=xc&&qf(xc),On=Qv&&qf(Qv),lG=Object.prototype,rg=Mr.TypeError,__=sG("toStringTag"),Xv=oG("TYPED_ARRAY_TAG"),Nc="TypedArrayConstructor",_a=tG&&!!Eo&&tg(Mr.opera)!=="Opera",Hk=!1,Fr,Ya,Zs,Sa={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ng={BigInt64Array:8,BigUint64Array:8},cG=function(t){if(!Bf(t))return!1;var r=tg(t);return r==="DataView"||fi(Sa,r)||fi(ng,r)},Wk=function(e){var t=qf(e);if(!!Bf(t)){var r=uG(t);return r&&fi(r,Nc)?r[Nc]:Wk(t)}},Gk=function(e){if(!Bf(e))return!1;var t=tg(e);return fi(Sa,t)||fi(ng,t)},fG=function(e){if(Gk(e))return e;throw rg("Target is not a typed array")},dG=function(e){if(Dk(e)&&(!Eo||iG(Kn,e)))return e;throw rg(rG(e)+" is not a typed array constructor")},pG=function(e,t,r,n){if(!!eg){if(r)for(var a in Sa){var i=Mr[a];if(i&&fi(i.prototype,e))try{delete i.prototype[e]}catch{try{i.prototype[e]=t}catch{}}}(!On[e]||r)&&Yv(On,e,r?t:_a&&Qv[e]||t,n)}},vG=function(e,t,r){var n,a;if(!!eg){if(Eo){if(r){for(n in Sa)if(a=Mr[n],a&&fi(a,e))try{delete a[e]}catch{}}if(!Kn[e]||r)try{return Yv(Kn,e,r?t:_a&&Kn[e]||t)}catch{}else return}for(n in Sa)a=Mr[n],a&&(!a[e]||r)&&Yv(a,e,t)}};for(Fr in Sa)Ya=Mr[Fr],Zs=Ya&&Ya.prototype,Zs?qk(Zs)[Nc]=Ya:_a=!1;for(Fr in ng)Ya=Mr[Fr],Zs=Ya&&Ya.prototype,Zs&&(qk(Zs)[Nc]=Ya);if((!_a||!Dk(Kn)||Kn===Function.prototype)&&(Kn=function(){throw rg("Incorrect invocation")},_a))for(Fr in Sa)Mr[Fr]&&Eo(Mr[Fr],Kn);if((!_a||!On||On===lG)&&(On=Kn.prototype,_a))for(Fr in Sa)Mr[Fr]&&Eo(Mr[Fr].prototype,On);_a&&qf(w_)!==On&&Eo(w_,On);if(eg&&!fi(On,__)){Hk=!0,aG(On,__,{get:function(){return Bf(this)?this[Xv]:void 0}});for(Fr in Sa)Mr[Fr]&&nG(Mr[Fr],Xv,Fr)}var Lt={NATIVE_ARRAY_BUFFER_VIEWS:_a,TYPED_ARRAY_TAG:Hk&&Xv,aTypedArray:fG,aTypedArrayConstructor:dG,exportTypedArrayMethod:pG,exportTypedArrayStaticMethod:vG,getTypedArrayConstructor:Wk,isView:cG,isTypedArray:Gk,TypedArray:Kn,TypedArrayPrototype:On},zk=ft,yp=at,hG=If,yG=Lt.NATIVE_ARRAY_BUFFER_VIEWS,gG=zk.ArrayBuffer,xi=zk.Int8Array,mG=!yG||!yp(function(){xi(1)})||!yp(function(){new xi(-1)})||!hG(function(e){new xi,new xi(null),new xi(1.5),new xi(e)},!0)||yp(function(){return new xi(new gG(2),1,void 0).length!==1}),bG=ta,wG=Ca,_G=RangeError,Vk=function(e){if(e===void 0)return 0;var t=bG(e),r=wG(t);if(t!==r)throw _G("Wrong length or index");return r},SG=Array,$G=Math.abs,pa=Math.pow,TG=Math.floor,kG=Math.log,EG=Math.LN2,IG=function(e,t,r){var n=SG(r),a=r*8-t-1,i=(1<<a)-1,s=i>>1,o=t===23?pa(2,-24)-pa(2,-77):0,u=e<0||e===0&&1/e<0?1:0,l=0,c,h,w;for(e=$G(e),e!=e||e===1/0?(h=e!=e?1:0,c=i):(c=TG(kG(e)/EG),w=pa(2,-c),e*w<1&&(c--,w*=2),c+s>=1?e+=o/w:e+=o*pa(2,1-s),e*w>=2&&(c++,w/=2),c+s>=i?(h=0,c=i):c+s>=1?(h=(e*w-1)*pa(2,t),c=c+s):(h=e*pa(2,s-1)*pa(2,t),c=0));t>=8;)n[l++]=h&255,h/=256,t-=8;for(c=c<<t|h,a+=t;a>0;)n[l++]=c&255,c/=256,a-=8;return n[--l]|=u*128,n},CG=function(e,t){var r=e.length,n=r*8-t-1,a=(1<<n)-1,i=a>>1,s=n-7,o=r-1,u=e[o--],l=u&127,c;for(u>>=7;s>0;)l=l*256+e[o--],s-=8;for(c=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)c=c*256+e[o--],s-=8;if(l===0)l=1-i;else{if(l===a)return c?NaN:u?-1/0:1/0;c=c+pa(2,t),l=l-i}return(u?-1:1)*c*pa(2,l-t)},RG={pack:IG,unpack:CG},AG=$r,S_=fs,OG=pr,Kk=function(t){for(var r=AG(this),n=OG(r),a=arguments.length,i=S_(a>1?arguments[1]:void 0,n),s=a>2?arguments[2]:void 0,o=s===void 0?n:S_(s,n);o>i;)r[i++]=t;return r},Hf=ft,ag=tt,gp=Ht,PG=Fk,Jk=Ju,$_=Ia,T_=Gy,mp=at,Gl=ds,MG=ta,xG=Ca,Lc=Vk,Yk=RG,NG=Cf,k_=To,LG=pi.f,jG=tr.f,UG=Kk,FG=el,Qk=Ra,Xk=gn,DG=Jk.PROPER,E_=Jk.CONFIGURABLE,po=Xk.get,I_=Xk.set,jc="ArrayBuffer",Zk="DataView",eo="prototype",BG="Wrong length",eE="Wrong index",ln=Hf[jc],zr=ln,As=zr&&zr[eo],Gn=Hf[Zk],Ni=Gn&&Gn[eo],C_=Object.prototype,qG=Hf.Array,Uc=Hf.RangeError,HG=ag(UG),WG=ag([].reverse),tE=Yk.pack,R_=Yk.unpack,A_=function(e){return[e&255]},O_=function(e){return[e&255,e>>8&255]},P_=function(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]},M_=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},GG=function(e){return tE(e,23,4)},zG=function(e){return tE(e,52,8)},zl=function(e,t){jG(e[eo],t,{get:function(){return po(this)[t]}})},Ha=function(e,t,r,n){var a=Lc(r),i=po(e);if(a+t>i.byteLength)throw Uc(eE);var s=po(i.buffer).bytes,o=a+i.byteOffset,u=FG(s,o,o+t);return n?u:WG(u)},Wa=function(e,t,r,n,a,i){var s=Lc(r),o=po(e);if(s+t>o.byteLength)throw Uc(eE);for(var u=po(o.buffer).bytes,l=s+o.byteOffset,c=n(+a),h=0;h<t;h++)u[l+h]=c[i?h:t-h-1]};if(!PG)zr=function(t){Gl(this,As);var r=Lc(t);I_(this,{bytes:HG(qG(r),0),byteLength:r}),gp||(this.byteLength=r)},As=zr[eo],Gn=function(t,r,n){Gl(this,Ni),Gl(t,As);var a=po(t).byteLength,i=MG(r);if(i<0||i>a)throw Uc("Wrong offset");if(n=n===void 0?a-i:xG(n),i+n>a)throw Uc(BG);I_(this,{buffer:t,byteLength:n,byteOffset:i}),gp||(this.buffer=t,this.byteLength=n,this.byteOffset=i)},Ni=Gn[eo],gp&&(zl(zr,"byteLength"),zl(Gn,"buffer"),zl(Gn,"byteLength"),zl(Gn,"byteOffset")),T_(Ni,{getInt8:function(t){return Ha(this,1,t)[0]<<24>>24},getUint8:function(t){return Ha(this,1,t)[0]},getInt16:function(t){var r=Ha(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t){var r=Ha(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function(t){return M_(Ha(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return M_(Ha(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return R_(Ha(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return R_(Ha(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,r){Wa(this,1,t,A_,r)},setUint8:function(t,r){Wa(this,1,t,A_,r)},setInt16:function(t,r){Wa(this,2,t,O_,r,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,r){Wa(this,2,t,O_,r,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,r){Wa(this,4,t,P_,r,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,r){Wa(this,4,t,P_,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,r){Wa(this,4,t,GG,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,r){Wa(this,8,t,zG,r,arguments.length>2?arguments[2]:void 0)}});else{var x_=DG&&ln.name!==jc;if(!mp(function(){ln(1)})||!mp(function(){new ln(-1)})||mp(function(){return new ln,new ln(1.5),new ln(NaN),ln.length!=1||x_&&!E_})){zr=function(t){return Gl(this,As),new ln(Lc(t))},zr[eo]=As;for(var N_=LG(ln),L_=0,bp;N_.length>L_;)(bp=N_[L_++])in zr||$_(zr,bp,ln[bp]);As.constructor=zr}else x_&&E_&&$_(ln,"name",jc);k_&&NG(Ni)!==C_&&k_(Ni,C_);var Vl=new Gn(new zr(2)),j_=ag(Ni.setInt8);Vl.setInt8(0,2147483648),Vl.setInt8(1,2147483649),(Vl.getInt8(0)||!Vl.getInt8(1))&&T_(Ni,{setInt8:function(t,r){j_(this,t,r<<24>>24)},setUint8:function(t,r){j_(this,t,r<<24>>24)}},{unsafe:!0})}Qk(zr,jc);Qk(Gn,Zk);var rE={ArrayBuffer:zr,DataView:Gn},VG=ta,KG=RangeError,JG=function(e){var t=VG(e);if(t<0)throw KG("The argument can't be less than 0");return t},YG=JG,QG=RangeError,nE=function(e,t){var r=YG(e);if(r%t)throw QG("Wrong offset");return r},XG=Aa,ZG=tt,ez=ZG("".slice),tz=function(e){return ez(XG(e),0,3)==="Big"},rz=Jh,nz=TypeError,aE=function(e){var t=rz(e,"number");if(typeof t=="number")throw nz("Can't convert number to bigint");return BigInt(t)},az=Oa,iz=Ot,sz=ry,oz=$r,uz=pr,lz=kf,cz=ul,fz=_y,dz=tz,pz=Lt.aTypedArrayConstructor,vz=aE,hz=function(t){var r=sz(this),n=oz(t),a=arguments.length,i=a>1?arguments[1]:void 0,s=i!==void 0,o=cz(n),u,l,c,h,w,b,$,A;if(o&&!fz(o))for($=lz(n,o),A=$.next,n=[];!(b=iz(A,$)).done;)n.push(b.value);for(s&&a>2&&(i=az(i,arguments[2])),l=uz(n),c=new(pz(r))(l),h=dz(c),u=0;l>u;u++)w=s?i(n[u],u):n[u],c[u]=h?vz(w):+w;return c},U_=ot,iE=ft,F_=Ot,yz=Ht,gz=mG,Io=Lt,sE=rE,D_=ds,mz=is,Qo=Ia,bz=dk,wz=Ca,B_=Vk,wp=nE,oE=Ku,Xo=Jt,_z=Aa,Zv=Kt,Sz=wo,$z=hi,Tz=Ea,Kl=To,kz=pi.f,q_=hz,Ez=Qr.forEach,Iz=Sf,uE=tr,lE=Xn,ig=gn,Cz=Ay,eh=ig.get,Rz=ig.set,Az=ig.enforce,sg=uE.f,Oz=lE.f,Pz=Math.round,_p=iE.RangeError,cE=sE.ArrayBuffer,Mz=cE.prototype,xz=sE.DataView,Jl=Io.NATIVE_ARRAY_BUFFER_VIEWS,H_=Io.TYPED_ARRAY_TAG,W_=Io.TypedArray,Zo=Io.TypedArrayPrototype,Nz=Io.aTypedArrayConstructor,th=Io.isTypedArray,Yl="BYTES_PER_ELEMENT",Sp="Wrong length",G_=function(e,t){Nz(e);for(var r=0,n=t.length,a=new e(n);n>r;)a[r]=t[r++];return a},Ql=function(e,t){sg(e,t,{get:function(){return eh(this)[t]}})},z_=function(e){var t;return Tz(Mz,e)||(t=_z(e))=="ArrayBuffer"||t=="SharedArrayBuffer"},fE=function(e,t){return th(e)&&!Sz(t)&&t in e&&bz(+t)&&t>=0},V_=function(t,r){return r=oE(r),fE(t,r)?mz(2,t[r]):Oz(t,r)},K_=function(t,r,n){return r=oE(r),fE(t,r)&&Zv(n)&&Xo(n,"value")&&!Xo(n,"get")&&!Xo(n,"set")&&!n.configurable&&(!Xo(n,"writable")||n.writable)&&(!Xo(n,"enumerable")||n.enumerable)?(t[r]=n.value,t):sg(t,r,n)};yz?(Jl||(lE.f=V_,uE.f=K_,Ql(Zo,"buffer"),Ql(Zo,"byteOffset"),Ql(Zo,"byteLength"),Ql(Zo,"length")),U_({target:"Object",stat:!0,forced:!Jl},{getOwnPropertyDescriptor:V_,defineProperty:K_}),Jv.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,a=e+(r?"Clamped":"")+"Array",i="get"+e,s="set"+e,o=iE[a],u=o,l=u&&u.prototype,c={},h=function(A,x){var U=eh(A);return U.view[i](x*n+U.byteOffset,!0)},w=function(A,x,U){var D=eh(A);r&&(U=(U=Pz(U))<0?0:U>255?255:U&255),D.view[s](x*n+D.byteOffset,U,!0)},b=function(A,x){sg(A,x,{get:function(){return h(this,x)},set:function(U){return w(this,x,U)},enumerable:!0})};Jl?gz&&(u=t(function(A,x,U,D){return D_(A,l),Cz(function(){return Zv(x)?z_(x)?D!==void 0?new o(x,wp(U,n),D):U!==void 0?new o(x,wp(U,n)):new o(x):th(x)?G_(u,x):F_(q_,u,x):new o(B_(x))}(),A,u)}),Kl&&Kl(u,W_),Ez(kz(o),function(A){A in u||Qo(u,A,o[A])}),u.prototype=l):(u=t(function(A,x,U,D){D_(A,l);var de=0,ue=0,Ae,we,he;if(!Zv(x))he=B_(x),we=he*n,Ae=new cE(we);else if(z_(x)){Ae=x,ue=wp(U,n);var P=x.byteLength;if(D===void 0){if(P%n||(we=P-ue,we<0))throw _p(Sp)}else if(we=wz(D)*n,we+ue>P)throw _p(Sp);he=we/n}else return th(x)?G_(u,x):F_(q_,u,x);for(Rz(A,{buffer:Ae,byteOffset:ue,byteLength:we,length:he,view:new xz(Ae)});de<he;)b(A,de++)}),Kl&&Kl(u,W_),l=u.prototype=$z(Zo)),l.constructor!==u&&Qo(l,"constructor",u),Az(l).TypedArrayConstructor=u,H_&&Qo(l,H_,a);var $=u!=o;c[a]=u,U_({global:!0,constructor:!0,forced:$,sham:!Jl},c),Yl in u||Qo(u,Yl,n),Yl in l||Qo(l,Yl,n),Iz(a)}):Jv.exports=function(){};var Lz=Jv.exports;Lz("Uint8",function(e){return function(r,n,a){return e(this,r,n,a)}});var J_=us,jz=TypeError,og=function(e,t){if(!delete e[t])throw jz("Cannot delete property "+J_(t)+" of "+J_(e))},Uz=$r,$p=fs,Fz=pr,Dz=og,Bz=Math.min,qz=[].copyWithin||function(t,r){var n=Uz(this),a=Fz(n),i=$p(t,a),s=$p(r,a),o=arguments.length>2?arguments[2]:void 0,u=Bz((o===void 0?a:$p(o,a))-s,a-i),l=1;for(s<i&&i<s+u&&(l=-1,s+=u-1,i+=u-1);u-- >0;)s in n?n[i]=n[s]:Dz(n,i),i+=l,s+=l;return n},Hz=tt,dE=Lt,Wz=qz,Gz=Hz(Wz),zz=dE.aTypedArray,Vz=dE.exportTypedArrayMethod;Vz("copyWithin",function(t,r){return Gz(zz(this),t,r,arguments.length>2?arguments[2]:void 0)});var pE=Lt,Kz=Qr.every,Jz=pE.aTypedArray,Yz=pE.exportTypedArrayMethod;Yz("every",function(t){return Kz(Jz(this),t,arguments.length>1?arguments[1]:void 0)});var vE=Lt,Qz=Kk,Xz=aE,Zz=Aa,e7=Ot,t7=tt,r7=at,n7=vE.aTypedArray,a7=vE.exportTypedArrayMethod,i7=t7("".slice),s7=r7(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),e!==1});a7("fill",function(t){var r=arguments.length;n7(this);var n=i7(Zz(this),0,3)==="Big"?Xz(t):+t;return e7(Qz,this,n,r>1?arguments[1]:void 0,r>2?arguments[2]:void 0)},s7);var o7=pr,u7=function(e,t){for(var r=0,n=o7(t),a=new e(n);n>r;)a[r]=t[r++];return a},hE=Lt,l7=py,c7=hE.aTypedArrayConstructor,f7=hE.getTypedArrayConstructor,Wf=function(e){return c7(l7(e,f7(e)))},d7=u7,p7=Wf,v7=function(e,t){return d7(p7(e),t)},yE=Lt,h7=Qr.filter,y7=v7,g7=yE.aTypedArray,m7=yE.exportTypedArrayMethod;m7("filter",function(t){var r=h7(g7(this),t,arguments.length>1?arguments[1]:void 0);return y7(this,r)});var gE=Lt,b7=Qr.find,w7=gE.aTypedArray,_7=gE.exportTypedArrayMethod;_7("find",function(t){return b7(w7(this),t,arguments.length>1?arguments[1]:void 0)});var mE=Lt,S7=Qr.findIndex,$7=mE.aTypedArray,T7=mE.exportTypedArrayMethod;T7("findIndex",function(t){return S7($7(this),t,arguments.length>1?arguments[1]:void 0)});var bE=Lt,k7=Qr.forEach,E7=bE.aTypedArray,I7=bE.exportTypedArrayMethod;I7("forEach",function(t){k7(E7(this),t,arguments.length>1?arguments[1]:void 0)});var wE=Lt,C7=pf.includes,R7=wE.aTypedArray,A7=wE.exportTypedArrayMethod;A7("includes",function(t){return C7(R7(this),t,arguments.length>1?arguments[1]:void 0)});var _E=Lt,O7=pf.indexOf,P7=_E.aTypedArray,M7=_E.exportTypedArrayMethod;M7("indexOf",function(t){return O7(P7(this),t,arguments.length>1?arguments[1]:void 0)});var x7=ft,N7=at,ug=tt,SE=Lt,lg=VT,L7=Mt,cg=L7("iterator"),Y_=x7.Uint8Array,j7=ug(lg.values),U7=ug(lg.keys),F7=ug(lg.entries),fg=SE.aTypedArray,Gf=SE.exportTypedArrayMethod,qs=Y_&&Y_.prototype,zf=!N7(function(){qs[cg].call([1])}),$E=!!qs&&qs.values&&qs[cg]===qs.values&&qs.values.name==="values",TE=function(){return j7(fg(this))};Gf("entries",function(){return F7(fg(this))},zf);Gf("keys",function(){return U7(fg(this))},zf);Gf("values",TE,zf||!$E,{name:"values"});Gf(cg,TE,zf||!$E,{name:"values"});var kE=Lt,D7=tt,B7=kE.aTypedArray,q7=kE.exportTypedArrayMethod,H7=D7([].join);q7("join",function(t){return H7(B7(this),t)});var W7=vi,G7=Yr,z7=ta,V7=pr,K7=ll,J7=Math.min,rh=[].lastIndexOf,EE=!!rh&&1/[1].lastIndexOf(1,-0)<0,Y7=K7("lastIndexOf"),Q7=EE||!Y7,X7=Q7?function(t){if(EE)return W7(rh,this,arguments)||0;var r=G7(this),n=V7(r),a=n-1;for(arguments.length>1&&(a=J7(a,z7(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in r&&r[a]===t)return a||0;return-1}:rh,IE=Lt,Z7=vi,eV=X7,tV=IE.aTypedArray,rV=IE.exportTypedArrayMethod;rV("lastIndexOf",function(t){var r=arguments.length;return Z7(eV,tV(this),r>1?[t,arguments[1]]:[t])});var CE=Lt,nV=Qr.map,aV=Wf,iV=CE.aTypedArray,sV=CE.exportTypedArrayMethod;sV("map",function(t){return nV(iV(this),t,arguments.length>1?arguments[1]:void 0,function(r,n){return new(aV(r))(n)})});var oV=Ln,uV=$r,lV=zu,cV=pr,fV=TypeError,Q_=function(e){return function(t,r,n,a){oV(r);var i=uV(t),s=lV(i),o=cV(i),u=e?o-1:0,l=e?-1:1;if(n<2)for(;;){if(u in s){a=s[u],u+=l;break}if(u+=l,e?u<0:o<=u)throw fV("Reduce of empty array with no initial value")}for(;e?u>=0:o>u;u+=l)u in s&&(a=r(a,s[u],u,i));return a}},dg={left:Q_(!1),right:Q_(!0)},RE=Lt,dV=dg.left,pV=RE.aTypedArray,vV=RE.exportTypedArrayMethod;vV("reduce",function(t){var r=arguments.length;return dV(pV(this),t,r,r>1?arguments[1]:void 0)});var AE=Lt,hV=dg.right,yV=AE.aTypedArray,gV=AE.exportTypedArrayMethod;gV("reduceRight",function(t){var r=arguments.length;return hV(yV(this),t,r,r>1?arguments[1]:void 0)});var OE=Lt,mV=OE.aTypedArray,bV=OE.exportTypedArrayMethod,wV=Math.floor;bV("reverse",function(){for(var t=this,r=mV(t).length,n=wV(r/2),a=0,i;a<n;)i=t[a],t[a++]=t[--r],t[r]=i;return t});var PE=ft,ME=Ot,pg=Lt,_V=pr,SV=nE,$V=$r,xE=at,TV=PE.RangeError,nh=PE.Int8Array,X_=nh&&nh.prototype,NE=X_&&X_.set,kV=pg.aTypedArray,EV=pg.exportTypedArrayMethod,ah=!xE(function(){var e=new Uint8ClampedArray(2);return ME(NE,e,{length:1,0:3},1),e[1]!==3}),IV=ah&&pg.NATIVE_ARRAY_BUFFER_VIEWS&&xE(function(){var e=new nh(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});EV("set",function(t){kV(this);var r=SV(arguments.length>1?arguments[1]:void 0,1),n=$V(t);if(ah)return ME(NE,this,n,r);var a=this.length,i=_V(n),s=0;if(i+r>a)throw TV("Wrong length");for(;s<i;)this[r+s]=n[s++]},!ah||IV);var LE=Lt,CV=Wf,RV=at,AV=_o,OV=LE.aTypedArray,PV=LE.exportTypedArrayMethod,MV=RV(function(){new Int8Array(1).slice()});PV("slice",function(t,r){for(var n=AV(OV(this),t,r),a=CV(this),i=0,s=n.length,o=new a(s);s>i;)o[i]=n[i++];return o},MV);var jE=Lt,xV=Qr.some,NV=jE.aTypedArray,LV=jE.exportTypedArrayMethod;LV("some",function(t){return xV(NV(this),t,arguments.length>1?arguments[1]:void 0)});var Z_=el,jV=Math.floor,ih=function(e,t){var r=e.length,n=jV(r/2);return r<8?UV(e,t):FV(e,ih(Z_(e,0,n),t),ih(Z_(e,n),t),t)},UV=function(e,t){for(var r=e.length,n=1,a,i;n<r;){for(i=n,a=e[n];i&&t(e[i-1],a)>0;)e[i]=e[--i];i!==n++&&(e[i]=a)}return e},FV=function(e,t,r,n){for(var a=t.length,i=r.length,s=0,o=0;s<a||o<i;)e[s+o]=s<a&&o<i?n(t[s],r[o])<=0?t[s++]:r[o++]:s<a?t[s++]:r[o++];return e},vg=ih,DV=ss,eS=DV.match(/firefox\/(\d+)/i),UE=!!eS&&+eS[1],BV=ss,FE=/MSIE|Trident/.test(BV),qV=ss,tS=qV.match(/AppleWebKit\/(\d+)\./),DE=!!tS&&+tS[1],HV=ft,WV=tt,sh=at,GV=Ln,zV=vg,BE=Lt,rS=UE,VV=FE,nS=os,aS=DE,KV=BE.aTypedArray,JV=BE.exportTypedArrayMethod,Uu=HV.Uint16Array,to=Uu&&WV(Uu.prototype.sort),YV=!!to&&!(sh(function(){to(new Uu(2),null)})&&sh(function(){to(new Uu(2),{})})),iS=!!to&&!sh(function(){if(nS)return nS<74;if(rS)return rS<67;if(VV)return!0;if(aS)return aS<602;var e=new Uu(516),t=Array(516),r,n;for(r=0;r<516;r++)n=r%4,e[r]=515-r,t[r]=r-2*n+3;for(to(e,function(a,i){return(a/4|0)-(i/4|0)}),r=0;r<516;r++)if(e[r]!==t[r])return!0}),QV=function(e){return function(t,r){return e!==void 0?+e(t,r)||0:r!==r?-1:t!==t?1:t===0&&r===0?1/t>0&&1/r<0?1:-1:t>r}};JV("sort",function(t){return t!==void 0&&GV(t),iS?to(this,t):zV(KV(this),QV(t))},!iS||YV);var qE=Lt,XV=Ca,sS=fs,ZV=Wf,eK=qE.aTypedArray,tK=qE.exportTypedArrayMethod;tK("subarray",function(t,r){var n=eK(this),a=n.length,i=sS(t,a),s=ZV(n);return new s(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,XV((r===void 0?a:sS(r,a))-i))});var rK=ft,nK=vi,HE=Lt,oh=at,oS=_o,Fc=rK.Int8Array,uS=HE.aTypedArray,aK=HE.exportTypedArrayMethod,WE=[].toLocaleString,iK=!!Fc&&oh(function(){WE.call(new Fc(1))}),sK=oh(function(){return[1,2].toLocaleString()!=new Fc([1,2]).toLocaleString()})||!oh(function(){Fc.prototype.toLocaleString.call([1,2])});aK("toLocaleString",function(){return nK(WE,iK?oS(uS(this)):uS(this),oS(arguments))},sK);var oK=Lt.exportTypedArrayMethod,uK=at,lK=ft,cK=tt,lS=lK.Uint8Array,fK=lS&&lS.prototype||{},Dc=[].toString,dK=cK([].join);uK(function(){Dc.call({})})&&(Dc=function(){return dK(this)});var pK=fK.toString!=Dc;oK("toString",Dc,pK);var vK=Kt,hK=di,yK=Mt,gK=yK("match"),GE=function(e){var t;return vK(e)&&((t=e[gK])!==void 0?!!t:hK(e)=="RegExp")},mK=vi,eu=Ot,hg=tt,bK=Of,wK=Qt,_K=Zn,SK=GE,cS=ea,$K=py,TK=Ny,kK=Ca,Tp=lr,EK=ls,fS=el,dS=Pf,IK=Af,CK=ek,RK=at,Os=CK.UNSUPPORTED_Y,pS=4294967295,AK=Math.min,zE=[].push,OK=hg(/./.exec),Ps=hg(zE),tu=hg("".slice),PK=!RK(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});bK("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(a,i){var s=Tp(cS(this)),o=i===void 0?pS:i>>>0;if(o===0)return[];if(a===void 0)return[s];if(!SK(a))return eu(t,s,a,o);for(var u=[],l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(a.sticky?"y":""),c=0,h=new RegExp(a.source,l+"g"),w,b,$;(w=eu(IK,h,s))&&(b=h.lastIndex,!(b>c&&(Ps(u,tu(s,c,w.index)),w.length>1&&w.index<s.length&&mK(zE,u,fS(w,1)),$=w[0].length,c=b,u.length>=o)));)h.lastIndex===w.index&&h.lastIndex++;return c===s.length?($||!OK(h,""))&&Ps(u,""):Ps(u,tu(s,c)),u.length>o?fS(u,0,o):u}:"0".split(void 0,0).length?n=function(a,i){return a===void 0&&i===0?[]:eu(t,this,a,i)}:n=t,[function(i,s){var o=cS(this),u=_K(i)?void 0:EK(i,e);return u?eu(u,i,o,s):eu(n,Tp(o),i,s)},function(a,i){var s=wK(this),o=Tp(a),u=r(n,s,o,i,n!==t);if(u.done)return u.value;var l=$K(s,RegExp),c=s.unicode,h=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(Os?"g":"y"),w=new l(Os?"^(?:"+s.source+")":s,h),b=i===void 0?pS:i>>>0;if(b===0)return[];if(o.length===0)return dS(w,o)===null?[o]:[];for(var $=0,A=0,x=[];A<o.length;){w.lastIndex=Os?0:A;var U=dS(w,Os?tu(o,A):o),D;if(U===null||(D=AK(kK(w.lastIndex+(Os?A:0)),o.length))===$)A=TK(o,A,c);else{if(Ps(x,tu(o,$,A)),x.length===b)return x;for(var de=1;de<=U.length-1;de++)if(Ps(x,U[de]),x.length===b)return x;A=$=D}}return Ps(x,tu(o,$)),x}]},!PK,Os);var yg={exports:{}},VE={exports:{}};(function(e){function t(r){return Function.toString.call(r).indexOf("[native code]")!==-1}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(VE);var KE={exports:{}},JE={exports:{}};(function(e){function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(JE);(function(e){var t=_f.exports,r=JE.exports;function n(a,i,s){return r()?(e.exports=n=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=n=function(u,l,c){var h=[null];h.push.apply(h,l);var w=Function.bind.apply(u,h),b=new w;return c&&t(b,c.prototype),b},e.exports.__esModule=!0,e.exports.default=e.exports),n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(KE);(function(e){var t=Xr.exports,r=_f.exports,n=VE.exports,a=KE.exports;function i(s){var o=typeof Map=="function"?new Map:void 0;return e.exports=i=function(l){if(l===null||!n(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(l))return o.get(l);o.set(l,c)}function c(){return a(l,arguments,t(this).constructor)}return c.prototype=Object.create(l.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),r(c,l)},e.exports.__esModule=!0,e.exports.default=e.exports,i(s)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(yg);var Bc={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(e,t){(function(){var r={function:!0,object:!0},n=r[typeof window]&&window||this,a=t,i=e&&!e.nodeType&&e,s=a&&i&&typeof An=="object"&&An;s&&(s.global===s||s.window===s||s.self===s)&&(n=s);var o=Math.pow(2,53)-1,u=/\bOpera/,l=Object.prototype,c=l.hasOwnProperty,h=l.toString;function w(P){return P=String(P),P.charAt(0).toUpperCase()+P.slice(1)}function b(P,Q,ce){var W={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Q&&ce&&/^Win/i.test(P)&&!/^Windows Phone /i.test(P)&&(W=W[/[\d.]+$/.exec(P)])&&(P="Windows "+W),P=String(P),Q&&ce&&(P=P.replace(RegExp(Q,"i"),ce)),P=A(P.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),P}function $(P,Q){var ce=-1,W=P?P.length:0;if(typeof W=="number"&&W>-1&&W<=o)for(;++ce<W;)Q(P[ce],ce,P);else x(P,Q)}function A(P){return P=Ae(P),/^(?:webOS|i(?:OS|P))/.test(P)?P:w(P)}function x(P,Q){for(var ce in P)c.call(P,ce)&&Q(P[ce],ce,P)}function U(P){return P==null?w(P):h.call(P).slice(8,-1)}function D(P,Q){var ce=P!=null?typeof P[Q]:"number";return!/^(?:boolean|number|string|undefined)$/.test(ce)&&(ce=="object"?!!P[Q]:!0)}function de(P){return String(P).replace(/([ -])(?!$)/g,"$1?")}function ue(P,Q){var ce=null;return $(P,function(W,ve){ce=Q(ce,W,ve,P)}),ce}function Ae(P){return String(P).replace(/^ +| +$/g,"")}function we(P){var Q=n,ce=P&&typeof P=="object"&&U(P)!="String";ce&&(Q=P,P=null);var W=Q.navigator||{},ve=W.userAgent||"";P||(P=ve);var te=ce?!!W.likeChrome:/\bChrome\b/.test(P)&&!/internal|\n/i.test(h.toString()),ae="Object",J=ce?ae:"ScriptBridgingProxyObject",ie=ce?ae:"Environment",Re=ce&&Q.java?"JavaPackage":U(Q.java),ke=ce?ae:"RuntimeObject",N=/\bJava/.test(Re)&&Q.java,dt=N&&U(Q.environment)==ie,pt=N?"a":"\u03B1",Ee=N?"b":"\u03B2",Xe=Q.document||{},Ye=Q.operamini||Q.opera,B=u.test(B=ce&&Ye?Ye["[[Class]]"]:U(Ye))?B:Ye=null,T,Te=P,ye=[],Ke=null,Qe=P==ve,Se=Qe&&Ye&&typeof Ye.version=="function"&&Ye.version(),Ge,R=Pe([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),I=_e(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),K=ee([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),pe=be({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),G=Oe(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Pe(oe){return ue(oe,function(F,H){return F||RegExp("\\b"+(H.pattern||de(H))+"\\b","i").exec(P)&&(H.label||H)})}function be(oe){return ue(oe,function(F,H,Y){return F||(H[K]||H[/^[a-z]+(?: +[a-z]+\b)*/i.exec(K)]||RegExp("\\b"+de(Y)+"(?:\\b|\\w*\\d)","i").exec(P))&&Y})}function _e(oe){return ue(oe,function(F,H){return F||RegExp("\\b"+(H.pattern||de(H))+"\\b","i").exec(P)&&(H.label||H)})}function Oe(oe){return ue(oe,function(F,H){var Y=H.pattern||de(H);return!F&&(F=RegExp("\\b"+Y+"(?:/[\\d.]+|[ \\w.]*)","i").exec(P))&&(F=b(F,Y,H.label||H)),F})}function ee(oe){return ue(oe,function(F,H){var Y=H.pattern||de(H);return!F&&(F=RegExp("\\b"+Y+" *\\d+[.\\w_]*","i").exec(P)||RegExp("\\b"+Y+" *\\w+-[\\w]*","i").exec(P)||RegExp("\\b"+Y+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(P))&&((F=String(H.label&&!RegExp(Y,"i").test(H.label)?H.label:F).split("/"))[1]&&!/[\d.]+/.test(F[0])&&(F[0]+=" "+F[1]),H=H.label||H,F=A(F[0].replace(RegExp(Y,"i"),H).replace(RegExp("; *(?:"+H+"[_-])?","i")," ").replace(RegExp("("+H+")[-_.]?(\\w)","i"),"$1 $2"))),F})}function Fe(oe){return ue(oe,function(F,H){return F||(RegExp(H+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(P)||0)[1]||null})}function Ue(){return this.description||""}if(R&&(R=[R]),/\bAndroid\b/.test(G)&&!K&&(T=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(P))&&(K=Ae(T[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),pe&&!K?K=ee([pe]):pe&&K&&(K=K.replace(RegExp("^("+de(pe)+")[-_.\\s]","i"),pe+" ").replace(RegExp("^("+de(pe)+")[-_.]?(\\w)","i"),pe+" $2")),(T=/\bGoogle TV\b/.exec(K))&&(K=T[0]),/\bSimulator\b/i.test(P)&&(K=(K?K+" ":"")+"Simulator"),I=="Opera Mini"&&/\bOPiOS\b/.test(P)&&ye.push("running in Turbo/Uncompressed mode"),I=="IE"&&/\blike iPhone OS\b/.test(P)?(T=we(P.replace(/like iPhone OS/,"")),pe=T.manufacturer,K=T.product):/^iP/.test(K)?(I||(I="Safari"),G="iOS"+((T=/ OS ([\d_]+)/i.exec(P))?" "+T[1].replace(/_/g,"."):"")):I=="Konqueror"&&/^Linux\b/i.test(G)?G="Kubuntu":pe&&pe!="Google"&&(/Chrome/.test(I)&&!/\bMobile Safari\b/i.test(P)||/\bVita\b/.test(K))||/\bAndroid\b/.test(G)&&/^Chrome/.test(I)&&/\bVersion\//i.test(P)?(I="Android Browser",G=/\bAndroid\b/.test(G)?G:"Android"):I=="Silk"?(/\bMobi/i.test(P)||(G="Android",ye.unshift("desktop mode")),/Accelerated *= *true/i.test(P)&&ye.unshift("accelerated")):I=="UC Browser"&&/\bUCWEB\b/.test(P)?ye.push("speed mode"):I=="PaleMoon"&&(T=/\bFirefox\/([\d.]+)\b/.exec(P))?ye.push("identifying as Firefox "+T[1]):I=="Firefox"&&(T=/\b(Mobile|Tablet|TV)\b/i.exec(P))?(G||(G="Firefox OS"),K||(K=T[1])):!I||(T=!/\bMinefield\b/i.test(P)&&/\b(?:Firefox|Safari)\b/.exec(I))?(I&&!K&&/[\/,]|^[^(]+?\)/.test(P.slice(P.indexOf(T+"/")+8))&&(I=null),(T=K||pe||G)&&(K||pe||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(G))&&(I=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(G)?G:T)+" Browser")):I=="Electron"&&(T=(/\bChrome\/([\d.]+)\b/.exec(P)||0)[1])&&ye.push("Chromium "+T),Se||(Se=Fe(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",de(I),"(?:Firefox|Minefield|NetFront)"])),(T=R=="iCab"&&parseFloat(Se)>3&&"WebKit"||/\bOpera\b/.test(I)&&(/\bOPR\b/.test(P)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(P)&&!/^(?:Trident|EdgeHTML)$/.test(R)&&"WebKit"||!R&&/\bMSIE\b/i.test(P)&&(G=="Mac OS"?"Tasman":"Trident")||R=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(I)&&"NetFront")&&(R=[T]),I=="IE"&&(T=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(P)||0)[1])?(I+=" Mobile",G="Windows Phone "+(/\+$/.test(T)?T:T+".x"),ye.unshift("desktop mode")):/\bWPDesktop\b/i.test(P)?(I="IE Mobile",G="Windows Phone 8.x",ye.unshift("desktop mode"),Se||(Se=(/\brv:([\d.]+)/.exec(P)||0)[1])):I!="IE"&&R=="Trident"&&(T=/\brv:([\d.]+)/.exec(P))&&(I&&ye.push("identifying as "+I+(Se?" "+Se:"")),I="IE",Se=T[1]),Qe){if(D(Q,"global"))if(N&&(T=N.lang.System,Te=T.getProperty("os.arch"),G=G||T.getProperty("os.name")+" "+T.getProperty("os.version")),dt){try{Se=Q.require("ringo/engine").version.join("."),I="RingoJS"}catch{(T=Q.system)&&T.global.system==Q.system&&(I="Narwhal",G||(G=T[0].os||null))}I||(I="Rhino")}else typeof Q.process=="object"&&!Q.process.browser&&(T=Q.process)&&(typeof T.versions=="object"&&(typeof T.versions.electron=="string"?(ye.push("Node "+T.versions.node),I="Electron",Se=T.versions.electron):typeof T.versions.nw=="string"&&(ye.push("Chromium "+Se,"Node "+T.versions.node),I="NW.js",Se=T.versions.nw)),I||(I="Node.js",Te=T.arch,G=T.platform,Se=/[\d.]+/.exec(T.version),Se=Se?Se[0]:null));else U(T=Q.runtime)==J?(I="Adobe AIR",G=T.flash.system.Capabilities.os):U(T=Q.phantom)==ke?(I="PhantomJS",Se=(T=T.version||null)&&T.major+"."+T.minor+"."+T.patch):typeof Xe.documentMode=="number"&&(T=/\bTrident\/(\d+)/i.exec(P))?(Se=[Se,Xe.documentMode],(T=+T[1]+4)!=Se[1]&&(ye.push("IE "+Se[1]+" mode"),R&&(R[1]=""),Se[1]=T),Se=I=="IE"?String(Se[1].toFixed(1)):Se[0]):typeof Xe.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(I)&&(ye.push("masking as "+I+" "+Se),I="IE",Se="11.0",R=["Trident"],G="Windows");G=G&&A(G)}if(Se&&(T=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Se)||/(?:alpha|beta)(?: ?\d)?/i.exec(P+";"+(Qe&&W.appMinorVersion))||/\bMinefield\b/i.test(P)&&"a")&&(Ke=/b/i.test(T)?"beta":"alpha",Se=Se.replace(RegExp(T+"\\+?$"),"")+(Ke=="beta"?Ee:pt)+(/\d+\+?/.exec(T)||"")),I=="Fennec"||I=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(G))I="Firefox Mobile";else if(I=="Maxthon"&&Se)Se=Se.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(K))K=="Xbox 360"&&(G=null),K=="Xbox 360"&&/\bIEMobile\b/.test(P)&&ye.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(I)||I&&!K&&!/Browser|Mobi/.test(I))&&(G=="Windows CE"||/Mobi/i.test(P)))I+=" Mobile";else if(I=="IE"&&Qe)try{Q.external===null&&ye.unshift("platform preview")}catch{ye.unshift("embedded")}else(/\bBlackBerry\b/.test(K)||/\bBB10\b/.test(P))&&(T=(RegExp(K.replace(/ +/g," *")+"/([.\\d]+)","i").exec(P)||0)[1]||Se)?(T=[T,/BB10/.test(P)],G=(T[1]?(K=null,pe="BlackBerry"):"Device Software")+" "+T[0],Se=null):this!=x&&K!="Wii"&&(Qe&&Ye||/Opera/.test(I)&&/\b(?:MSIE|Firefox)\b/i.test(P)||I=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(G)||I=="IE"&&(G&&!/^Win/.test(G)&&Se>5.5||/\bWindows XP\b/.test(G)&&Se>8||Se==8&&!/\bTrident\b/.test(P)))&&!u.test(T=we.call(x,P.replace(u,"")+";"))&&T.name&&(T="ing as "+T.name+((T=T.version)?" "+T:""),u.test(I)?(/\bIE\b/.test(T)&&G=="Mac OS"&&(G=null),T="identify"+T):(T="mask"+T,B?I=A(B.replace(/([a-z])([A-Z])/g,"$1 $2")):I="Opera",/\bIE\b/.test(T)&&(G=null),Qe||(Se=null)),R=["Presto"],ye.push(T));(T=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(P)||0)[1])&&(T=[parseFloat(T.replace(/\.(\d)$/,".0$1")),T],I=="Safari"&&T[1].slice(-1)=="+"?(I="WebKit Nightly",Ke="alpha",Se=T[1].slice(0,-1)):(Se==T[1]||Se==(T[2]=(/\bSafari\/([\d.]+\+?)/i.exec(P)||0)[1]))&&(Se=null),T[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(P)||0)[1],T[0]==537.36&&T[2]==537.36&&parseFloat(T[1])>=28&&R=="WebKit"&&(R=["Blink"]),!Qe||!te&&!T[1]?(R&&(R[1]="like Safari"),T=(T=T[0],T<400?1:T<500?2:T<526?3:T<533?4:T<534?"4+":T<535?5:T<537?6:T<538?7:T<601?8:T<602?9:T<604?10:T<606?11:T<608?12:"12")):(R&&(R[1]="like Chrome"),T=T[1]||(T=T[0],T<530?1:T<532?2:T<532.05?3:T<533?4:T<534.03?5:T<534.07?6:T<534.1?7:T<534.13?8:T<534.16?9:T<534.24?10:T<534.3?11:T<535.01?12:T<535.02?"13+":T<535.07?15:T<535.11?16:T<535.19?17:T<536.05?18:T<536.1?19:T<537.01?20:T<537.11?"21+":T<537.13?23:T<537.18?24:T<537.24?25:T<537.36?26:R!="Blink"?"27":"28")),R&&(R[1]+=" "+(T+=typeof T=="number"?".x":/[.+]/.test(T)?"":"+")),I=="Safari"&&(!Se||parseInt(Se)>45)?Se=T:I=="Chrome"&&/\bHeadlessChrome/i.test(P)&&ye.unshift("headless")),I=="Opera"&&(T=/\bzbov|zvav$/.exec(G))?(I+=" ",ye.unshift("desktop mode"),T=="zvav"?(I+="Mini",Se=null):I+="Mobile",G=G.replace(RegExp(" *"+T+"$"),"")):I=="Safari"&&/\bChrome\b/.exec(R&&R[1])?(ye.unshift("desktop mode"),I="Chrome Mobile",Se=null,/\bOS X\b/.test(G)?(pe="Apple",G="iOS 4.3+"):G=null):/\bSRWare Iron\b/.test(I)&&!Se&&(Se=Fe("Chrome")),Se&&Se.indexOf(T=/[\d.]+$/.exec(G))==0&&P.indexOf("/"+T+"-")>-1&&(G=Ae(G.replace(T,""))),G&&G.indexOf(I)!=-1&&!RegExp(I+" OS").test(G)&&(G=G.replace(RegExp(" *"+de(I)+" *"),"")),R&&!/\b(?:Avant|Nook)\b/.test(I)&&(/Browser|Lunascape|Maxthon/.test(I)||I!="Safari"&&/^iOS/.test(G)&&/\bSafari\b/.test(R[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(I)&&R[1])&&(T=R[R.length-1])&&ye.push(T),ye.length&&(ye=["("+ye.join("; ")+")"]),pe&&K&&K.indexOf(pe)<0&&ye.push("on "+pe),K&&ye.push((/^on /.test(ye[ye.length-1])?"":"on ")+K),G&&(T=/ ([\d.+]+)$/.exec(G),Ge=T&&G.charAt(G.length-T[0].length-1)=="/",G={architecture:32,family:T&&!Ge?G.replace(T[0],""):G,version:T?T[1]:null,toString:function(){var oe=this.version;return this.family+(oe&&!Ge?" "+oe:"")+(this.architecture==64?" 64-bit":"")}}),(T=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Te))&&!/\bi686\b/i.test(Te)?(G&&(G.architecture=64,G.family=G.family.replace(RegExp(" *"+T),"")),I&&(/\bWOW64\b/i.test(P)||Qe&&/\w(?:86|32)$/.test(W.cpuClass||W.platform)&&!/\bWin64; x64\b/i.test(P))&&ye.unshift("32-bit")):G&&/^OS X/.test(G.family)&&I=="Chrome"&&parseFloat(Se)>=39&&(G.architecture=64),P||(P=null);var Me={};return Me.description=P,Me.layout=R&&R[0],Me.manufacturer=pe,Me.name=I,Me.prerelease=Ke,Me.product=K,Me.ua=P,Me.version=I&&Se,Me.os=G||{architecture:null,family:null,version:null,toString:function(){return"null"}},Me.parse=we,Me.toString=Ue,Me.version&&ye.unshift(Se),Me.name&&ye.unshift(I),G&&I&&!(G==String(G).split(" ")[0]&&(G==I.split(" ")[0]||K))&&ye.push(K?"("+G+")":"on "+G),ye.length&&(Me.description=ye.join(" ")),Me}var he=we();a&&i?x(he,function(P,Q){a[Q]=P}):n.platform=he}).call(An)})(Bc,Bc.exports);var MK=Ot,xK=Of,NK=Qt,LK=Zn,jK=Ca,kp=lr,UK=ea,FK=ls,DK=Ny,vS=Pf;xK("match",function(e,t,r){return[function(a){var i=UK(this),s=LK(a)?void 0:FK(a,e);return s?MK(s,a,i):new RegExp(a)[e](kp(i))},function(n){var a=NK(this),i=kp(n),s=r(t,a,i);if(s.done)return s.value;if(!a.global)return vS(a,i);var o=a.unicode;a.lastIndex=0;for(var u=[],l=0,c;(c=vS(a,i))!==null;){var h=kp(c[0]);u[l]=h,h===""&&(a.lastIndex=DK(i,jK(a.lastIndex),o)),l++}return l===0?null:u}]});var BK=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},qK=Ot,HK=Of,WK=Qt,GK=Zn,zK=ea,hS=BK,yS=lr,VK=ls,KK=Pf;HK("search",function(e,t,r){return[function(a){var i=zK(this),s=GK(a)?void 0:VK(a,e);return s?qK(s,a,i):new RegExp(a)[e](yS(i))},function(n){var a=WK(this),i=yS(n),s=r(t,a,i);if(s.done)return s.value;var o=a.lastIndex;hS(o,0)||(a.lastIndex=0);var u=KK(a,i);return hS(a.lastIndex,o)||(a.lastIndex=o),u===null?-1:u.index}]});var JK=Ht,YK=tl,QK=TypeError,XK=Object.getOwnPropertyDescriptor,ZK=JK&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),e9=ZK?function(e,t){if(YK(e)&&!XK(e,"length").writable)throw QK("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},t9=ot,r9=$r,n9=fs,a9=ta,i9=pr,s9=e9,o9=MT,u9=oy,l9=So,Ep=og,c9=al,f9=c9("splice"),d9=Math.max,p9=Math.min;t9({target:"Array",proto:!0,forced:!f9},{splice:function(t,r){var n=r9(this),a=i9(n),i=n9(t,a),s=arguments.length,o,u,l,c,h,w;for(s===0?o=u=0:s===1?(o=0,u=a-i):(o=s-2,u=p9(d9(a9(r),0),a-i)),o9(a+o-u),l=u9(n,u),c=0;c<u;c++)h=i+c,h in n&&l9(l,c,n[h]);if(l.length=u,o<u){for(c=i;c<a-u;c++)h=c+u,w=c+o,h in n?n[w]=n[h]:Ep(n,w);for(c=a;c>a-u+o;c--)Ep(n,c-1)}else if(o>u)for(c=a-u;c>i;c--)h=c+u-1,w=c+o-1,h in n?n[w]=n[h]:Ep(n,w);for(c=0;c<o;c++)n[c+i]=arguments[c+2];return s9(n,a-u+o),l}});/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.


*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=$o.exports,n=ra.exports,a=yi.exports,i=jf.exports,s=jn.exports,o=Un.exports,u=Xr.exports,l=Dn.exports,c=gi.exports,h=cl,w=Fn.exports,b=Er,$=ps.exports,A=Nk.exports,x=Df,U=yg.exports,D=xa,de=Bc.exports;function ue(v){return v&&typeof v=="object"&&"default"in v?v:{default:v}}function Ae(v){if(v&&v.__esModule)return v;var g=Object.create(null);return v&&Object.keys(v).forEach(function(d){if(d!=="default"){var p=Object.getOwnPropertyDescriptor(v,d);Object.defineProperty(g,d,p.get?p:{enumerable:!0,get:function(){return v[d]}})}}),g.default=v,Object.freeze(g)}var we=ue(r),he=ue(n),P=ue(a),Q=ue(i),ce=ue(s),W=ue(o),ve=ue(u),te=ue(l),ae=ue(c),J=ue(h),ie=ue(w),Re=Ae($),ke=Ae(A),N=ue(U),dt=Ae(de);function pt(v,g,d,p){var f=arguments.length,m=f<3?g:p===null?p=Object.getOwnPropertyDescriptor(g,d):p,y;if((typeof Reflect>"u"?"undefined":ie.default(Reflect))==="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(v,g,d,p);else for(var k=v.length-1;k>=0;k--)(y=v[k])&&(m=(f<3?y(m):f>3?y(g,d,m):y(g,d))||m);return f>3&&m&&Object.defineProperty(g,d,m),m}function Ee(v,g){if((typeof Reflect>"u"?"undefined":ie.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(v,g)}var Xe;function Ye(){}Ye.prototype=Object.create(null);function B(){B.init.call(this)}B.EventEmitter=B,B.usingDomains=!1,B.prototype.domain=void 0,B.prototype._events=void 0,B.prototype._maxListeners=void 0,B.defaultMaxListeners=10,B.init=function(){this.domain=null,B.usingDomains&&Xe.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ye,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},B.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||isNaN(g))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=g,this};function T(v){return v._maxListeners===void 0?B.defaultMaxListeners:v._maxListeners}B.prototype.getMaxListeners=function(){return T(this)};function Te(v,g,d){if(g)v.call(d);else for(var p=v.length,f=G(v,p),m=0;m<p;++m)f[m].call(d)}function ye(v,g,d,p){if(g)v.call(d,p);else for(var f=v.length,m=G(v,f),y=0;y<f;++y)m[y].call(d,p)}function Ke(v,g,d,p,f){if(g)v.call(d,p,f);else for(var m=v.length,y=G(v,m),k=0;k<m;++k)y[k].call(d,p,f)}function Qe(v,g,d,p,f,m){if(g)v.call(d,p,f,m);else for(var y=v.length,k=G(v,y),E=0;E<y;++E)k[E].call(d,p,f,m)}function Se(v,g,d,p){if(g)v.apply(d,p);else for(var f=v.length,m=G(v,f),y=0;y<f;++y)m[y].apply(d,p)}B.prototype.emit=function(g){var d,p,f,m,y,k,E,L=g==="error";if(k=this._events,k)L=L&&k.error==null;else if(!L)return!1;if(E=this.domain,L){if(d=arguments[1],E)d||(d=new Error('Uncaught, unspecified "error" event')),d.domainEmitter=this,d.domain=E,d.domainThrown=!1,E.emit("error",d);else{if(d instanceof Error)throw d;var j=new Error('Uncaught, unspecified "error" event. ('+d+")");throw j.context=d,j}return!1}if(p=k[g],!p)return!1;var Ie=typeof p=="function";switch(f=arguments.length,f){case 1:Te(p,Ie,this);break;case 2:ye(p,Ie,this,arguments[1]);break;case 3:Ke(p,Ie,this,arguments[1],arguments[2]);break;case 4:Qe(p,Ie,this,arguments[1],arguments[2],arguments[3]);break;default:for(m=new Array(f-1),y=1;y<f;y++)m[y-1]=arguments[y];Se(p,Ie,this,m)}return!0};function Ge(v,g,d,p){var f,m,y;if(typeof d!="function")throw new TypeError('"listener" argument must be a function');if(m=v._events,m?(m.newListener&&(v.emit("newListener",g,d.listener?d.listener:d),m=v._events),y=m[g]):(m=v._events=new Ye,v._eventsCount=0),!y)y=m[g]=d,++v._eventsCount;else if(typeof y=="function"?y=m[g]=p?[d,y]:[y,d]:p?y.unshift(d):y.push(d),!y.warned&&(f=T(v),f&&f>0&&y.length>f)){y.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+y.length+" "+g+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=v,k.type=g,k.count=y.length,R(k)}return v}function R(v){typeof console.warn=="function"?console.warn(v):console.log(v)}B.prototype.addListener=function(g,d){return Ge(this,g,d,!1)},B.prototype.on=B.prototype.addListener,B.prototype.prependListener=function(g,d){return Ge(this,g,d,!0)};function I(v,g,d){var p=!1;function f(){v.removeListener(g,f),p||(p=!0,d.apply(v,arguments))}return f.listener=d,f}B.prototype.once=function(g,d){if(typeof d!="function")throw new TypeError('"listener" argument must be a function');return this.on(g,I(this,g,d)),this},B.prototype.prependOnceListener=function(g,d){if(typeof d!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(g,I(this,g,d)),this},B.prototype.removeListener=function(g,d){var p,f,m,y,k;if(typeof d!="function")throw new TypeError('"listener" argument must be a function');if(f=this._events,!f)return this;if(p=f[g],!p)return this;if(p===d||p.listener&&p.listener===d)--this._eventsCount===0?this._events=new Ye:(delete f[g],f.removeListener&&this.emit("removeListener",g,p.listener||d));else if(typeof p!="function"){for(m=-1,y=p.length;y-- >0;)if(p[y]===d||p[y].listener&&p[y].listener===d){k=p[y].listener,m=y;break}if(m<0)return this;if(p.length===1){if(p[0]=void 0,--this._eventsCount===0)return this._events=new Ye,this;delete f[g]}else pe(p,m);f.removeListener&&this.emit("removeListener",g,k||d)}return this},B.prototype.off=function(v,g){return this.removeListener(v,g)},B.prototype.removeAllListeners=function(g){var d,p;if(p=this._events,!p)return this;if(!p.removeListener)return arguments.length===0?(this._events=new Ye,this._eventsCount=0):p[g]&&(--this._eventsCount===0?this._events=new Ye:delete p[g]),this;if(arguments.length===0){for(var f=Object.keys(p),m=0,y;m<f.length;++m)y=f[m],y!=="removeListener"&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events=new Ye,this._eventsCount=0,this}if(d=p[g],typeof d=="function")this.removeListener(g,d);else if(d)do this.removeListener(g,d[d.length-1]);while(d[0]);return this},B.prototype.listeners=function(g){var d,p,f=this._events;return f?(d=f[g],d?typeof d=="function"?p=[d.listener||d]:p=Pe(d):p=[]):p=[],p},B.listenerCount=function(v,g){return typeof v.listenerCount=="function"?v.listenerCount(g):K.call(v,g)},B.prototype.listenerCount=K;function K(v){var g=this._events;if(g){var d=g[v];if(typeof d=="function")return 1;if(d)return d.length}return 0}B.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function pe(v,g){for(var d=g,p=d+1,f=v.length;p<f;d+=1,p+=1)v[d]=v[p];v.pop()}function G(v,g){for(var d=new Array(g);g--;)d[g]=v[g];return d}function Pe(v){for(var g=new Array(v.length),d=0;d<g.length;++d)g[d]=v[d].listener||v[d];return g}var be=Re.getLogger("twilsock");function _e(v,g){return["".concat(new Date().toISOString()," Twilsock ").concat(v,":")].concat(Array.from(g))}var Oe=function(){function v(g){te.default(this,v),ae.default(this,"prefix",""),this.prefix=g!=null&&g.length>0?" "+g+":":""}return he.default(v,[{key:"setLevel",value:function(d){be.setLevel(d)}},{key:"trace",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.trace.apply(null,_e("T",p))}},{key:"debug",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.debug.apply(null,_e("D",p))}},{key:"info",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.info.apply(null,_e("I",p))}},{key:"warn",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.warn.apply(null,_e("W",p))}},{key:"error",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.error.apply(null,_e("E",p))}}],[{key:"setLevel",value:function(d){be.setLevel(d)}},{key:"trace",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.trace.apply(null,_e("T",p))}},{key:"debug",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.debug.apply(null,_e("D",p))}},{key:"info",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.info.apply(null,_e("I",p))}},{key:"warn",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.warn.apply(null,_e("W",p))}},{key:"error",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];be.error.apply(null,_e("E",p))}}]),v}(),ee=new Oe(""),Fe="0.12.2",Ue=function(){function v(g,d,p){te.default(this,v),ae.default(this,"confirmedCapabilities",new Set),this.activeGrant=d,this._token=g;var f=p.region||"us1",m="wss://tsock.".concat(f,".twilio.com/v3/wsconnect"),y=p.twilsock||p.Twilsock||{};this.url=y.uri||m,this._continuationToken=p.continuationToken?p.continuationToken:null,this.logLevel=p.logLevel?p.logLevel:"error",this.retryPolicy=p.retryPolicy?p.retryPolicy:{min:1*1e3,max:2*60*1e3,randomness:.2},this.clientMetadata=p.clientMetadata?p.clientMetadata:{},this.clientMetadata.ver=Fe,this.initRegistrations=p.initRegistrations?p.initRegistrations:null,this.tweaks=p.tweaks?p.tweaks:null}return he.default(v,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(d){this._token=d}},{key:"updateContinuationToken",value:function(d){this._continuationToken=d}}]),v}(),Me=function v(g){te.default(this,v),this.id=g||"TM".concat(x.v4())};function oe(v){var g=F();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var H=function(v){ce.default(d,v);var g=oe(d);function d(p,f,m,y,k){var E;return te.default(this,d),E=g.call(this),ae.default(P.default(E),"method","init"),E.token=p,E.continuation_token=f,E.metadata=m,E.registrations=y,E.tweaks=k,E.capabilities=["client_update","offline_storage","telemetry.v1"],E}return d}(Me);function Y(v){var g=ge();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function ge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ne=function(v){ce.default(d,v);var g=Y(d);function d(p,f,m,y,k,E,L){var j;return te.default(this,d),j=g.call(this,p),j.continuationToken=f,j.continuationTokenStatus=y,j.offlineStorage=k,j.initRegistrations=E,j.debugInfo=L,j.confirmedCapabilities=m,j}return d}(Me);function qe(v){var g=ze();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function ze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var De=function(v){ce.default(d,v);var g=qe(d);function d(p){var f;return te.default(this,d),f=g.call(this),ae.default(P.default(f),"method","update"),f.token=p,f}return d}(Me);function He(v){var g=Le();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function Le(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Z=function(v){ce.default(d,v);var g=He(d);function d(p,f,m){var y;return te.default(this,d),y=g.call(this),ae.default(P.default(y),"method","message"),y.active_grant=p,y.payload_type=f,y.http_request=m,y}return d}(Me);function ne(v){var g=q();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var V=function(v){ce.default(d,v);var g=ne(d);function d(p){var f;return te.default(this,d),f=g.call(this,p),ae.default(P.default(f),"method","reply"),ae.default(P.default(f),"payload_type","application/json"),ae.default(P.default(f),"status",{code:200,status:"OK"}),f}return d}(Me);function re(v){var g=me();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function me(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fe=function(v){ce.default(d,v);var g=re(d);function d(){var p;return te.default(this,d),p=g.call(this),ae.default(P.default(p),"method","close"),p}return d}(Me);function je(v){var g=Ve();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function Ve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var it=function v(g,d,p,f,m,y){te.default(this,v),this.start=g,this.end=d,this.title=p,this.details=f,this.id=m,this.type=y},rt=function(v){ce.default(d,v);var g=je(d);function d(p){var f;return te.default(this,d),f=g.call(this),ae.default(P.default(f),"method","telemetry.v1"),f.events=p,f}return d}(Me);function We(v){var g=encodeURIComponent(v),d=g.replace(/%([0-9A-F]{2})/g,function(p,f){return String.fromCharCode(Number("0x"+f))});return d.length}function vr(v){var g=encodeURIComponent(v),d=g.replace(/%([0-9A-F]{2})/g,function(f,m){return String.fromCharCode(Number("0x"+m))}),p=new Uint8Array(d.length);return Array.prototype.forEach.call(d,function(f,m){p[m]=f.charCodeAt(0)}),p}function nt(v){var g=Array.prototype.map.call(v,function(p){return String.fromCharCode(p)}).join(""),d=g.replace(/(.)/g,function(p,f){var m=f.charCodeAt(0).toString(16).toUpperCase();return m.length<2&&(m="0"+m),"%"+m});return decodeURIComponent(d)}function Rr(v){return JSON.parse(nt(v))}function Ft(v){for(var g="",d=0;d<v.length;++d){var p=String.fromCharCode(v[d]);if(g+=p,p==="\r"){d+=2;break}}var f=g.split(" ");return{size:d,protocol:f[0],version:f[1],headerSize:Number(f[2])}}var bn=function(){function v(){te.default(this,v)}return he.default(v,null,[{key:"parse",value:function(d){var p=2,f=new Uint8Array(d),m=Ft(f);if(m.protocol!=="TWILSOCK"||m.version!=="V3.0")return ee.error("unsupported protocol: ".concat(m.protocol," ver ").concat(m.version)),null;var y;try{y=Rr(f.subarray(m.size,m.size+m.headerSize))}catch(j){return ee.error("failed to parse message header",j,d),null}ee.debug("message received: ",y.method),ee.trace("message received: ",y);var k;if(y.payload_size>0){var E=p+m.size+m.headerSize,L=y.payload_size;if(!y.hasOwnProperty("payload_type")||y.payload_type.indexOf("application/json")===0)try{k=Rr(f.subarray(E,E+L))}catch(j){return ee.error("failed to parse message body",j,d),null}else y.payload_type.indexOf("text/plain")===0&&(k=nt(f.subarray(E,E+L)))}return{method:y.method,header:y,payload:k}}},{key:"createPacket",value:function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";d.payload_size=We(p);var f=JSON.stringify(d),m="TWILSOCK V3.0 "+We(f);ee.debug("send request:",m+f+p);var y=vr(m+`\r
`+f+`\r
`+p);return y.buffer}}]),v}();function nr(v){var g=Bn();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function Bn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rt=function(v){ce.default(d,v);var g=nr(d);function d(p){return te.default(this,d),g.call(this,p)}return d}(N.default(Error));function hr(v){var g=qr();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function qr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Hr=function(v){ce.default(d,v);var g=hr(d);function d(p,f){var m;return te.default(this,d),m=g.call(this,p),m.reply=f,m}return d}(Rt);function yr(v,g){var d=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);g&&(p=p.filter(function(f){return Object.getOwnPropertyDescriptor(v,f).enumerable})),d.push.apply(d,p)}return d}function gs(v){for(var g=1;g<arguments.length;g++){var d=arguments[g]!=null?arguments[g]:{};g%2?yr(Object(d),!0).forEach(function(p){ae.default(v,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(d)):yr(Object(d)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(d,p))})}return v}function Nr(v){var g=ms();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function ms(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Co=function(v){ce.default(d,v);var g=Nr(d);function d(p){var f;return te.default(this,d),f=g.call(this),ae.default(P.default(f),"newBackoff",null),ae.default(P.default(f),"usedBackoff",null),ae.default(P.default(f),"retrier",null),f.options=p?gs({},p):{},f}return he.default(d,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(f){this.newBackoff=f}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");if(this.newBackoff){var f=!this.usedBackoff||this.usedBackoff<this.newBackoff;if(f)this.createRetrier();else{var m;(m=this.retrier)===null||m===void 0||m.failed(new Error)}}else{var y;(y=this.retrier)===null||y===void 0||y.failed(new Error)}}},{key:"cancel",value:function(){var f;(f=this.retrier)===null||f===void 0||f.cancel()}},{key:"cleanRetrier",value:function(){var f,m;(f=this.retrier)===null||f===void 0||f.removeAllListeners(),(m=this.retrier)===null||m===void 0||m.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var f=gs({},this.options);return this.newBackoff&&(f.min=this.newBackoff,f.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),f.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,f}},{key:"createRetrier",value:function(){var f=this;this.cleanRetrier();var m=this.getRetryPolicy();this.retrier=new D.Retrier(m),this.retrier.once("attempt",function(){var y,k;(y=f.retrier)===null||y===void 0||y.on("attempt",function(){return f.emit("attempt")}),(k=f.retrier)===null||k===void 0||k.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",function(y){return f.emit("failed",y)}),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),d}(B);function Ro(v){var g=bs();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function bs(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ao=3e3;function wn(v){setTimeout(v,0)}var _n=function(v){ce.default(d,v);var g=Ro(d);function d(p,f,m){var y;te.default(this,d),y=g.call(this),ae.default(P.default(y),"disconnectingTimer",null),ae.default(P.default(y),"disconnectedPromiseResolve",null),ae.default(P.default(y),"terminalStates",["disconnected","rejected"]),ae.default(P.default(y),"tokenExpiredSasCode",20104),ae.default(P.default(y),"terminationReason","Connection is not initialized"),y.websocket=p,y.websocket.on("connected",function(){return y.fsm.socketConnected()}),y.websocket.on("disconnected",function(){return y.fsm.socketClosed()}),y.websocket.on("message",function(E){return y.onIncomingMessage(E)}),y.websocket.on("socketError",function(E){return y.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(E.message),httpStatusCode:null,errorCode:null})}),y.transport=f,y.config=m,y.retrier=new Co(m.retryPolicy),y.retrier.on("attempt",function(){return y.retry()}),y.retrier.on("failed",function(E){ee.warn("Retrying failed: ".concat(E.message)),y.disconnect()}),typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",function(){ee.debug("Browser reported connectivity state: online"),y.resetBackoff(),y.fsm.systemOnline()}),window.addEventListener("offline",function(){ee.debug("Browser reported connectivity state: offline"),y.websocket.close(),y.fsm.socketClosed()}));var k=ke.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){y.setupSocket(),y.emit("connecting")},onEnterInitialising:function(){y.sendInit()},onLeaveInitialising:function(){y.cancelInit()},onEnterUpdating:function(){y.sendUpdate()},onLeaveUpdating:function(){y.cancelUpdate()},onEnterRetrying:function(){y.initRetry(),y.emit("connecting")},onEnterConnected:function(){y.resetBackoff(),y.onConnected()},onUserUpdateToken:function(){y.resetBackoff()},onTokenRejected:function(){y.resetBackoff(),y.closeSocket(!0),y.finalizeSocket()},onUserDisconnect:function(){y.closeSocket(!0)},onEnterDisconnecting:function(){y.startDisconnectTimer()},onLeaveDisconnecting:function(){y.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){y.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){y.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){y.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){y.cancelDisconnectTimer()},onDisconnected:function(){y.resetBackoff(),y.finalizeSocket()},onReceiveClose:function(){y.onCloseReceived()},onReceiveOffload:function(L,j){ee.debug("onreceiveoffload: ",j),y.modifyBackoff(j.body),y.onCloseReceived()},onUnsupported:function(){y.closeSocket(!0),y.finalizeSocket()},onError:function(L,j){y.closeSocket(j),y.finalizeSocket()},onEnterState:function(L){L.from!=="none"&&y.changeState(L)},onInvalidTransition:function(L,j,Ie){ee.warn("FSM: unexpected transition",j,Ie)}}});return y.fsm=new k,y}return he.default(d,[{key:"changeState",value:function(f){ee.debug("FSM: ".concat(f.transition,": ").concat(f.from," --> ").concat(f.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){ee.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(f){ee.trace("modifyBackoff",f);var m=f?f.backoff_policy:null;m&&typeof m.reconnect_min_ms=="number"&&this.retrier.modifyBackoff(m.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var f=this;ee.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(function(){ee.debug("disconnecting is timed out"),f.closeSocket(!0)},Ao)}},{key:"cancelDisconnectTimer",value:function(){ee.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return this.state==="connected"&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){ee.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){this.fsm.state!="connecting"?(ee.trace("retry"),this.websocket.close(),this.fsm.userRetry()):ee.trace("can	 retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){ee.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){ee.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(f){var m=bn.parse(f);if(!!m){var y=m.method,k=m.header,E=m.payload;if(y!=="reply"&&this.confirmReceiving(k),y==="notification")this.emit("message",k.message_type,E);else if(k.method==="reply")this.transport.processReply({id:k.id,status:k.status,header:k,body:E});else if(k.method==="client_update")k.client_update_type==="token_about_to_expire"&&this.emit("tokenAboutToExpire");else if(k.method==="close")if(k.status.code===308)ee.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:k.status.status,body:E});else if(k.status.code===406){var L="Server closed connection because can't parse protocol: ".concat(JSON.stringify(k.status));this.emitReplyConnectionError(L,k,!0),ee.error(L),this.fsm.receiveFatalClose()}else k.status.code===417?(ee.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(k.status))),this.fsm.receiveFatalClose(k.status.status)):k.status.code===410?(ee.warn("Server closed connection: ".concat(JSON.stringify(k.status))),this.fsm.receiveClose(k.status.status),this.emit("tokenExpired")):k.status.code===401?(ee.error("Server closed connection: ".concat(JSON.stringify(k.status))),this.fsm.receiveClose(k.status.status)):(ee.warn("unexpected message: ",k.status),this.fsm.receiveOffload({status:k.status.status,body:null}))}}},{key:"sendInit",value:function(){var p=we.default(J.default.mark(function m(){var y,k;return J.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return ee.trace("sendInit"),L.prev=1,this.emit("beforeSendInit"),L.next=5,this.transport.sendInit();case 5:y=L.sent,this.config.updateContinuationToken(y.continuationToken),this.config.confirmedCapabilities=y.confirmedCapabilities,this.fsm.initSuccess(y),this.emit("initialized",y),this.emit("tokenUpdated"),L.next=17;break;case 13:L.prev=13,L.t0=L.catch(1),L.t0 instanceof Hr?(k=!1,ee.warn("Init rejected by server: ".concat(JSON.stringify(L.t0.reply.status))),this.emit("sendInitFailed"),L.t0.reply.status.code===401||L.t0.reply.status.code===403?(k=!0,this.fsm.tokenRejected(L.t0.reply.status),L.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):L.t0.reply.status.code===429?(this.modifyBackoff(L.t0.reply.body),this.fsm.initError(!0)):L.t0.reply.status.code===500?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(L.t0.message,L.t0.reply,k)):(this.terminationReason=L.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(L.t0.message,`
`).concat(JSON.stringify(L.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",L.t0);case 17:case"end":return L.stop()}},m,this,[[1,13]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"sendUpdate",value:function(){var p=we.default(J.default.mark(function m(){var y,k,E;return J.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return ee.trace("sendUpdate"),y=new De(this.config.token),j.prev=2,j.next=5,this.transport.sendWithReply(y);case 5:k=j.sent,this.fsm.updateSuccess(k.body),this.emit("tokenUpdated"),j.next=14;break;case 10:j.prev=10,j.t0=j.catch(2),j.t0 instanceof Hr?(E=!1,ee.warn("Token update rejected by server: ".concat(JSON.stringify(j.t0.reply.status))),j.t0.reply.status.code===401||j.t0.reply.status.code===403?(E=!0,this.fsm.tokenRejected(j.t0.reply.status),j.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):j.t0.reply.status.code===429?(this.modifyBackoff(j.t0.reply.body),this.fsm.updateError(j.t0.reply.status)):this.fsm.updateError(j.t0.reply.status),this.emitReplyConnectionError(j.t0.message,j.t0.reply,E)):(this.emit("error",!1,j.t0.message,null,null),this.fsm.updateError(j.t0)),this.emit("tokenUpdated",j.t0);case 14:case"end":return j.stop()}},m,this,[[2,10]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"emitReplyConnectionError",value:function(f,m,y){var k=m.status&&m.status.description?m.status.description:f,E=m.status.code,L=m.status&&m.status.errorCode?m.status.errorCode:null;y&&(this.terminationReason=k),this.emit("connectionError",{terminal:y,message:"Connection error: ".concat(k),httpStatusCode:E,errorCode:L})}},{key:"cancelInit",value:function(){ee.trace("cancelInit")}},{key:"cancelUpdate",value:function(){ee.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(f){ee.trace("confirmReceiving");try{this.transport.send(new V(f.id))}catch(m){ee.debug("failed to confirm packet receiving",m)}}},{key:"closeSocket",value:function(f){var m=this;ee.trace("closeSocket (graceful: ".concat(f,")")),f&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),wn(function(){return m.fsm.socketClosed()})}},{key:"connect",value:function(){ee.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var f=this;return ee.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(function(m){f.disconnectedPromiseResolve=m,f.fsm.userDisconnect()})}},{key:"updateToken",value:function(f){var m=this;return ee.trace("updateToken:",f),new Promise(function(y,k){m.once("tokenUpdated",function(E){E?k(E):y()}),m.fsm.userUpdateToken()})}},{key:"isTerminalState",get:function(){return this.terminalStates.indexOf(this.fsm.state)!==-1}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),d}(B),$t=function(){function v(){te.default(this,v)}return he.default(v,null,[{key:"getMetadata",value:function(d){var p,f,m,y,k,E,L,j,Ie=d&&d.clientMetadata?d.clientMetadata:{},Je=["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"],Dt={env:(p=dt.name)!==null&&p!==void 0?p:"unknown",envv:(f=dt.version)!==null&&f!==void 0?f:"unknown",os:(m=(y=dt.os)===null||y===void 0?void 0:y.family)!==null&&m!==void 0?m:"unknown",osv:(k=(E=dt.os)===null||E===void 0?void 0:E.version)!==null&&k!==void 0?k:"unknown",osa:(L=(j=dt.os)===null||j===void 0?void 0:j.architecture)!==null&&L!==void 0?L:"unknown",sdk:"js-default"},Ze={};return Je.filter(function(mr){return mr in Ie||mr in Dt}).forEach(function(mr){return Ze[mr]=mr in Ie?Ie[mr]:Dt[mr]}),Ze}}]),v}(),Oo=3e4;function Po(v){return v>=200&&v<300}function Mo(v){switch(ie.default(v)){case"undefined":return"";case"object":return JSON.stringify(v);default:return v}}var na=function(){function v(g,d){var p=this;te.default(this,v),this.config=d,this.activeRequests=new Map,this.channel=g,this.channel.on("reply",function(f){return p.processReply(f)}),this.channel.on("disconnected",function(){p.activeRequests.forEach(function(f){clearTimeout(f.timeout),f.reject(new Rt("disconnected"))}),p.activeRequests.clear()})}return he.default(v,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(d){var p=this.activeRequests.get(d.id);p&&(clearTimeout(p.timeout),this.activeRequests.delete(d.id),Po(d.status.code)?p.resolve(d):(p.reject(new Hr("Transport failure: "+d.status.status,d)),ee.trace("message rejected")))}},{key:"storeRequest",value:function(d,p,f){var m={resolve:p,reject:f,timeout:setTimeout(function(){ee.trace("request",d,"is timed out"),f(new Rt("Twilsock: request timeout: "+d))},Oo)};this.activeRequests.set(d,m)}},{key:"shutdown",value:function(){this.activeRequests.forEach(function(d){clearTimeout(d.timeout),d.reject(new Rt("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}},{key:"sendInit",value:function(){var g=we.default(J.default.mark(function p(){var f,m,y;return J.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return ee.trace("sendInit"),f=$t.getMetadata(this.config),m=new H(this.config.token,this.config.continuationToken,f,this.config.initRegistrations,this.config.tweaks),E.next=5,this.sendWithReply(m);case 5:return y=E.sent,E.abrupt("return",new Ne(y.id,y.header.continuation_token,new Set(y.header.capabilities),y.header.continuation_token_status,y.header.offline_storage,y.header.init_registrations,y.header.debug_info));case 7:case"end":return E.stop()}},p,this)}));function d(){return g.apply(this,arguments)}return d}()},{key:"sendClose",value:function(){var d=new fe;this.send(d)}},{key:"sendWithReply",value:function(d,p){var f=this;return new Promise(function(m,y){var k=f.send(d,p);f.storeRequest(k,m,y)})}},{key:"send",value:function(d,p){d.id=d.id||"TM".concat(x.v4());var f=bn.createPacket(d,Mo(p));try{return this.channel.send(f),d.id}catch(m){throw ee.debug("failed to send ",d,m),ee.trace(m.stack),m}}}]),v}();function ws(v){var g=xo();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function xo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tn=function(v){ce.default(d,v);var g=ws(d);function d(p){var f;return te.default(this,d),f=g.call(this),ae.default(P.default(f),"socket",null),f.url=p,f.url=p,f.WebSocket=t.WebSocket||t.MozWebSocket||{},f}return he.default(d,[{key:"isConnected",get:function(){return!!this.socket&&this.socket.readyState===1}},{key:"connect",value:function(){var f=this;ee.trace("connecting to socket");var m;try{m=new this.WebSocket(this.url)}catch(y){ee.debug("Socket error: ".concat(this.url)),this.emit("socketError",y);return}m.binaryType="arraybuffer",m.onopen=function(){ee.debug("socket opened ".concat(f.url)),f.emit("connected")},m.onclose=function(y){ee.debug("socket closed",y),f.emit("disconnected",y)},m.onerror=function(y){ee.debug("Socket error:",y),f.emit("socketError",y)},m.onmessage=function(y){f.emit("message",y.data)},this.socket=m}},{key:"send",value:function(f){return this.socket&&this.socket.send(f)}},{key:"close",value:function(){if(ee.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),d}(B);function No(v){var g=gr();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function gr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lo=function(v){ce.default(d,v);var g=No(d);function d(p){var f;return te.default(this,d),f=g.call(this),f.transport=p,f.registrations=new Map,f.registrationsInProgress=new Map,f}return he.default(d,[{key:"putNotificationContext",value:function(){var p=we.default(J.default.mark(function m(y,k){var E;return J.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return E={method:"put_notification_ctx",notification_ctx_id:y},j.next=3,this.transport.sendWithReply(E,k);case 3:case"end":return j.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"deleteNotificationContext",value:function(){var p=we.default(J.default.mark(function m(y){var k;return J.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return k={method:"delete_notification_ctx",notification_ctx_id:y},L.next=3,this.transport.sendWithReply(k);case 3:case"end":return L.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"updateRegistration",value:function(){var p=we.default(J.default.mark(function m(y,k){var E,L;return J.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return ee.debug("update registration for context",y),E=this.registrationsInProgress.get(y),E||(E=new Set,this.registrationsInProgress.set(y,E)),L=x.v4(),E.add(L),Ie.prev=5,Ie.next=8,this.putNotificationContext(y,k);case 8:ee.debug("registration attempt succeeded for context",k),E.delete(L),E.size===0&&(this.registrationsInProgress.delete(y),this.emit("registered",y)),Ie.next=19;break;case 13:Ie.prev=13,Ie.t0=Ie.catch(5),ee.warn("registration attempt failed for context",k),ee.debug(Ie.t0),E.delete(L),E.size===0&&(this.registrationsInProgress.delete(y),this.emit("registrationFailed",y,Ie.t0));case 19:case"end":return Ie.stop()}},m,this,[[5,13]])}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"updateRegistrations",value:function(){var p=we.default(J.default.mark(function m(){var y=this,k;return J.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return ee.trace("refreshing ".concat(this.registrations.size," registrations")),k=[],this.registrations.forEach(function(j,Ie){k.push(y.updateRegistration(Ie,j))}),L.next=5,Promise.all(k);case 5:case"end":return L.stop()}},m,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=we.default(J.default.mark(function m(y,k){return J.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!(!y||!k)){L.next=2;break}throw new Rt("Invalid arguments provided");case 2:return this.registrations.set(y,k),L.next=5,this.updateRegistration(y,k);case 5:return L.abrupt("return",L.sent);case 6:case"end":return L.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=we.default(J.default.mark(function m(y){return J.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(this.registrations.has(y)){E.next=2;break}return E.abrupt("return");case 2:return E.next=4,this.deleteNotificationContext(y);case 4:this.transport.isConnected&&this.registrations.delete(y);case 5:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()}]),d}(B);function jo(v){var g=Uo();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function Uo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Fo=function(v){ce.default(d,v);var g=jo(d);function d(p,f,m){var y;return te.default(this,d),y=g.call(this,f),y.status=p,y.description=f,y.body=m,y}return d}(Rt);function Sn(v){var g=Do();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function Do(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lr=function(v){ce.default(d,v);var g=Sn(d);function d(p){return te.default(this,d),g.call(this,p)}return d}(Rt),ja=2e4;function ki(v){return v>=200&&v<300}function Bo(v){return v&&v.header&&v.header.http_status}function _s(v){var g=v.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(g){var d={protocol:g[1],host:g[2],hostname:g[3],port:g[4],pathname:g[5],search:g[6],hash:g[7],params:{}};if(d.search.length>0){var p=d.search.substring(1);d.params=p.split("&").map(function(f){return f.split("=")}).reduce(function(f,m){return f.hasOwnProperty(m[0])?Array.isArray(f[m[0]])?f[m[0]].push(m[1]):f[m[0]]=[f[m[0]],m[1]]:f[m[0]]=m[1],f},{})}return d}throw new Rt("Incorrect URI: "+v)}function qo(v,g){var d=_s(g),p={method:v,host:d.host,path:d.pathname};return d.params&&(p.params=d.params),p}function Ho(v,g,d,p,f){return{to:qo(v,g),headers:d,body:p,grant:f}}var yt=function(){function v(g,d,p){te.default(this,v),this.config=p,this.transport=g,this.pendingMessages=[],this.twilsock=d}return he.default(v,[{key:"saveMessage",value:function(d){var p=this;return new Promise(function(f,m){var y={message:d,resolve:f,reject:m,alreadyRejected:!1,timeout:setTimeout(function(){ee.debug("request is timed out"),m(new Rt("request '".concat(d.to.method,"' to '").concat(d.to.host,"' timed out"))),y.alreadyRejected=!0},ja)};p.pendingMessages.push(y)})}},{key:"sendPendingMessages",value:function(){for(var d=this,p=function(){var y=d.pendingMessages[0];if(!y.alreadyRejected)try{var k=y.message;d.actualSend(k).then(function(E){return y.resolve(E)}).catch(function(E){return y.reject(E)}),clearTimeout(y.timeout)}catch(E){return ee.debug("Failed to send pending message",E),"break"}d.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){var f=p();if(f==="break")break}}},{key:"rejectPendingMessages",value:function(){var d=this;this.pendingMessages.forEach(function(p){p.reject(new Lr("Unable to connect: "+d.twilsock.getTerminationReason)),p.alreadyRejected=!0,clearTimeout(p.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:function(){var g=we.default(J.default.mark(function p(f){var m,y,k,E,L,j,Ie,Je;return J.default.wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return y=f.to,k=f.headers,E=f.body,L=(m=f.grant)!==null&&m!==void 0?m:this.config.activeGrant,j={host:y.host,path:y.path,method:y.method,params:y.params,headers:k},Ie=new Z(L,k["Content-Type"]||"application/json",j),ee.trace("Sending upstream message",Ie),Ze.next=9,this.transport.sendWithReply(Ie,E);case 9:if(Je=Ze.sent,ee.trace("Received upstream message response",Je),!(Bo(Je)&&!ki(Je.header.http_status.code))){Ze.next=13;break}throw new Fo(Je.header.http_status.code,Je.header.http_status.status,Je.body);case 13:return Ze.abrupt("return",{status:Je.header.http_status,headers:Je.header.http_headers,body:Je.body});case 14:case"end":return Ze.stop()}},p,this)}));function d(p){return g.apply(this,arguments)}return d}()},{key:"send",value:function(d,p){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=arguments.length>3?arguments[3]:void 0,y=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new Lr("Unable to connect: "+this.twilsock.getTerminationReason));var k=Ho(d,p,f,m,y);return this.twilsock.isConnected?this.actualSend(k):this.saveMessage(k)}}]),v}(),Ss=function(){function v(){var g=this;te.default(this,v),this._promise=new Promise(function(d,p){g._resolve=d,g._reject=p})}return he.default(v,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(d){this._resolve(d)}},{key:"set",value:function(d){this._resolve(d)}},{key:"fail",value:function(d){this._reject(d)}}]),v}(),Ua=function(){function v(g){te.default(this,v),this.id=g}return he.default(v,null,[{key:"create",value:function(d){if(d instanceof Object&&"storage_id"in d)return new v(d.storage_id);throw new Rt('Field "storage_id" is missing')}}]),v}(),Ei=function(){function v(){return te.default(this,v),ae.default(this,"initializedFlag","twilio_twilsock_token_storage"),ae.default(this,"tokenStoragePrefix","twilio_continuation_token_"),v._instance||(this.initialize(),v._instance=this),v._instance}return he.default(v,[{key:"sessionStorage",value:function(){try{return t.sessionStorage}catch{return null}}},{key:"window",value:function(){try{return t.window}catch{return null}}},{key:"storeToken",value:function(d,p){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(p),d)}},{key:"getStoredToken",value:function(d){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(d)):null}},{key:"initialize",value:function(){var d=this;if(this.canStore()){var p=this.sessionStorage.getItem(this.initializedFlag);p&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var f=this.sessionStorage.removeItem;this.window.addEventListener("unload",function(){f(d.initializedFlag)})}}},{key:"clear",value:function(){if(this.canStore()){for(var d=[],p=0;p<this.sessionStorage.length;p++){var f=this.sessionStorage.key(p);f&&f.indexOf(this.tokenStoragePrefix)===0&&d.push(f)}var m=this.sessionStorage.removeItem;d.forEach(function(y){return m(y)}),m(this.initializedFlag)}}},{key:"getKeyName",value:function(d){return"".concat(this.tokenStoragePrefix).concat(d)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),v}();ae.default(Ei,"_instance",null);var aa=new Ei,vt=function(){function v(g,d,p,f,m,y){te.default(this,v),this.title=g,this.details=d,this.start=p,this.type=m,this.id=y,this.end=f}return he.default(v,[{key:"toTelemetryEvent",value:function(){var d=new Date,p=this.start,f=this.end?this.end:d;if(f<p){var m=f;f=p,p=m}var y=p.getTime()-d.getTime(),k=f.getTime()-d.getTime(),E=new it(y,k,this.title,this.details,this.id,this.type);return E}}]),v}();e.TelemetryPoint=void 0,function(v){v[v.Start=0]="Start",v[v.End=1]="End"}(e.TelemetryPoint||(e.TelemetryPoint={})),e.EventSendingLimitation=void 0,function(v){v[v.MinEventsPortion=0]="MinEventsPortion",v[v.AnyEvents=1]="AnyEvents",v[v.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(e.EventSendingLimitation||(e.EventSendingLimitation={}));var $s=function(){function v(g,d){te.default(this,v),ae.default(this,"minEventsPortionToSend",50),ae.default(this,"maxEventsPortionToSend",100),ae.default(this,"pendingEvents",new Map),ae.default(this,"readyEvents",[]),ae.default(this,"hasInitializationFinished",!1),ae.default(this,"_canSendTelemetry",!1),this.config=g,this.packetInterface=d}return he.default(v,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(d){ee.debug("TelemetryTracker.canSendTelemetry: ".concat(d," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!d&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=d,d&&this.sendTelemetry(e.EventSendingLimitation.AnyEvents),d&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(d){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(d)}},{key:"addPartialEvent",value:function(d,p,f){ee.debug("Adding ".concat(f===e.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(p,"' event"));var m=this.pendingEvents.has(p);if(f===e.TelemetryPoint.Start)m&&ee.debug("Overwriting starting point for '".concat(p,"' event")),this.pendingEvents.set(p,d);else{if(!m){ee.info("Could not find started event for '".concat(p,"' event"));return}this.addTelemetryEvent(this.merge(this.pendingEvents.get(p),d)),this.pendingEvents.delete(p)}}},{key:"getTelemetryToSend",value:function(d){return!this.canSendTelemetry||this.readyEvents.length==0?[]:d==e.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(d==e.EventSendingLimitation.AnyEventsIncludingUnfinished)}},{key:"getTelemetryPortion",value:function(d){var p=this,f=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),m=this.readyEvents.splice(0,f);return d&&m.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach(function(y,k){if(!(m.length>=p.maxEventsPortionToSend)){var E=p.pendingEvents.get(k);p.pendingEvents.delete(k),m.push(new vt("[UNFINISHED] ".concat(E.title),E.details,E.start,null,E.type,E.id))}}),m}},{key:"merge",value:function(d,p){return new vt(p.title?p.title:d.title,p.details?p.details:d.details,d.start,p.end,p.type?p.type:d.type,p.id?p.id:d.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(e.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(d){var p=this.getTelemetryToSend(d);if(p.length!==0)try{this.packetInterface.send(new rt(p.map(function(f){return f.toTelemetryEvent()})))}catch(f){ee.debug("Error while sending ".concat(p.length," telemetry events due to ").concat(f,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(p)}}}]),v}();function C(v){var g=O();return function(){var p=ve.default(v),f;if(g){var m=ve.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return W.default(this,f)}}function O(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var S=function v(){te.default(this,v)};ae.default(S,"TWILSOCK_CONNECT","twilsock.sdk.connect"),ae.default(S,"TWILSOCK_INIT","twilsock.sdk.init"),e.TwilsockClient=function(v){ce.default(d,v);var g=C(d);function d(p,f,m){var y;te.default(this,d),y=g.call(this),ae.default(P.default(y),"version",Fe),ae.default(P.default(y),"offlineStorageDeferred",new Ss),m.continuationToken=m.continuationToken?m.continuationToken:aa.getStoredToken(f);var k=y.config=new Ue(p,f,m);ee.setLevel(k.logLevel);var E=new tn(k.url),L=new na(E,k);return y.channel=new _n(E,L,k),y.registrations=new Lo(L),y.upstream=new yt(L,y.channel,k),y.telemetryTracker=new $s(k,L),y.channel.on("initialized",function(){return y.telemetryTracker.canSendTelemetry=!0}),E.on("disconnected",function(){return y.telemetryTracker.canSendTelemetry=!1}),y.registrations.on("registered",function(j){return y.emit("registered",j)}),y.channel.on("message",function(j,Ie){return setTimeout(function(){return y.emit("message",j,Ie)},0)}),y.channel.on("stateChanged",function(j){return setTimeout(function(){return y.emit("stateChanged",j)},0)}),y.channel.on("connectionError",function(j){return setTimeout(function(){return y.emit("connectionError",j)},0)}),y.channel.on("tokenAboutToExpire",function(){return setTimeout(function(){return y.emit("tokenAboutToExpire")},0)}),y.channel.on("tokenExpired",function(){return setTimeout(function(){return y.emit("tokenExpired")},0)}),y.channel.on("connected",function(){return y.registrations.updateRegistrations()}),y.channel.on("connected",function(){return y.upstream.sendPendingMessages()}),y.channel.on("connected",function(){return setTimeout(function(){return y.emit("connected")},0)}),y.channel.on("beforeConnect",function(){return y.telemetryTracker.addPartialEvent(new vt("Establish WebSocket connection","",new Date),S.TWILSOCK_CONNECT,e.TelemetryPoint.Start)}),y.channel.on("connected",function(){return y.telemetryTracker.addPartialEvent(new vt("Establish WebSocket connection","",new Date,new Date),S.TWILSOCK_CONNECT,e.TelemetryPoint.End)}),y.channel.on("beforeSendInit",function(){return y.telemetryTracker.addPartialEvent(new vt("Send Twilsock init","",new Date),S.TWILSOCK_INIT,e.TelemetryPoint.Start)}),y.channel.on("initialized",function(){return y.telemetryTracker.addPartialEvent(new vt("Send Twilsock init","Succeeded",new Date,new Date),S.TWILSOCK_INIT,e.TelemetryPoint.End)}),y.channel.on("sendInitFailed",function(){return y.telemetryTracker.addPartialEvent(new vt("Send Twilsock init","Failed",new Date,new Date),S.TWILSOCK_INIT,e.TelemetryPoint.End)}),y.channel.on("initialized",function(j){y.handleStorageId(f,j),aa.storeToken(j.continuationToken,f),setTimeout(function(){return y.emit("initialized",j)},0)}),y.channel.on("disconnected",function(){return setTimeout(function(){return y.emit("disconnected")},0)}),y.channel.on("disconnected",function(){return y.upstream.rejectPendingMessages()}),y.channel.on("disconnected",function(){return y.offlineStorageDeferred.fail(new Rt("Client disconnected"))}),y.offlineStorageDeferred.promise.catch(function(){}),y}return he.default(d,[{key:"emit",value:function(f){for(var m,y=arguments.length,k=new Array(y>1?y-1:0),E=1;E<y;E++)k[E-1]=arguments[E];return ee.debug("Emitting ".concat(f.toString(),"(").concat(k.map(function(L){return JSON.stringify(L)}).join(", "),")")),(m=Q.default(ve.default(d.prototype),"emit",this)).call.apply(m,[this,f].concat(k))}},{key:"handleStorageId",value:function(f,m){if(!m.offlineStorage)this.offlineStorageDeferred.fail(new Rt("No offline storage id"));else if(m.offlineStorage.hasOwnProperty(f))try{this.offlineStorageDeferred.set(Ua.create(m.offlineStorage[f])),ee.debug("Offline storage for '".concat(f,"' product: ").concat(JSON.stringify(m.offlineStorage[f]),"."))}catch(y){this.offlineStorageDeferred.fail(new Rt("Failed to parse offline storage for ".concat(f," ").concat(JSON.stringify(m.offlineStorage[f]),". ").concat(y,".")))}else this.offlineStorageDeferred.fail(new Rt("No offline storage id for '".concat(f,"' product: ").concat(JSON.stringify(m.offlineStorage))))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:function(){var p=we.default(J.default.mark(function m(y){return J.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(ee.trace("updating token '".concat(y,"'")),this.config.token!==y){E.next=3;break}return E.abrupt("return");case 3:return this.config.updateToken(y),E.next=6,this.channel.updateToken(y);case 6:return E.abrupt("return",E.sent);case 7:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=we.default(J.default.mark(function m(y,k){return J.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.registrations.setNotificationsContext(y,k);case 2:case"end":return L.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=we.default(J.default.mark(function m(y){return J.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.registrations.removeNotificationsContext(y);case 2:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){var p=we.default(J.default.mark(function m(){return J.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEventsIncludingUnfinished),k.next=3,this.channel.disconnect();case 3:return k.abrupt("return",k.sent);case 4:case"end":return k.stop()}},m,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"get",value:function(){var p=we.default(J.default.mark(function m(y,k,E){return J.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),j.next=3,this.upstream.send("GET",y,k,void 0,E);case 3:return j.abrupt("return",j.sent);case 4:case"end":return j.stop()}},m,this)}));function f(m,y,k){return p.apply(this,arguments)}return f}()},{key:"post",value:function(){var p=we.default(J.default.mark(function m(y,k,E,L){return J.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),Ie.next=3,this.upstream.send("POST",y,k,E,L);case 3:return Ie.abrupt("return",Ie.sent);case 4:case"end":return Ie.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"put",value:function(){var p=we.default(J.default.mark(function m(y,k,E,L){return J.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),Ie.next=3,this.upstream.send("PUT",y,k,E,L);case 3:return Ie.abrupt("return",Ie.sent);case 4:case"end":return Ie.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"delete",value:function(){var p=we.default(J.default.mark(function m(y,k,E,L){return J.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),Ie.next=3,this.upstream.send("DELETE",y,k,E,L);case 3:return Ie.abrupt("return",Ie.sent);case 4:case"end":return Ie.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"addTelemetryEvent",value:function(f){this.telemetryTracker.addTelemetryEvent(f),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(f,m,y){this.telemetryTracker.addPartialEvent(f,m,y),y===e.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),d}(B),e.TwilsockClient=pt([b.validateConstructorTypes(b.nonEmptyString,b.nonEmptyString,[b.pureObject,"undefined",b.literal(null)]),Ee("design:paramtypes",[String,String,Object])],e.TwilsockClient);var _=function(){function v(g){te.default(this,v),this.product=g,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return he.default(v,[{key:"populateInitRegistrations",value:function(d){var p=new Set(this.message_types);for(var f in d)p.add(d[f]);this.message_types=Array.from(p)}}]),v}();e.InitRegistration=_,e.TelemetryEventDescription=vt,e.TelemetryTracker=$s,e.TransportUnavailableError=Lr,e.Twilsock=e.TwilsockClient,e.TwilsockError=Rt})(Uf);var YE={},gS=Ht,v9=tt,h9=Ot,y9=at,Ip=Zu,g9=Qu,m9=Gu,b9=$r,w9=zu,Ms=Object.assign,mS=Object.defineProperty,_9=v9([].concat),QE=!Ms||y9(function(){if(gS&&Ms({b:1},Ms(mS({},"a",{enumerable:!0,get:function(){mS(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(a){t[a]=a}),Ms({},e)[r]!=7||Ip(Ms({},t)).join("")!=n})?function(t,r){for(var n=b9(t),a=arguments.length,i=1,s=g9.f,o=m9.f;a>i;)for(var u=w9(arguments[i++]),l=s?_9(Ip(u),s(u)):Ip(u),c=l.length,h=0,w;c>h;)w=l[h++],(!gS||h9(o,u,w))&&(n[w]=u[w]);return n}:Ms,S9=ot,bS=QE;S9({target:"Object",stat:!0,arity:2,forced:Object.assign!==bS},{assign:bS});var Ir={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Ir,"__esModule",{value:!0});var $9=Fn.exports,T9=mi.exports,k9=bi.exports,E9=ra.exports,I9=Dn.exports,C9=jn.exports,R9=Un.exports,A9=Xr.exports;function Si(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ro=Si($9),$a=Si(T9),Cp=Si(k9),O9=Si(E9),P9=Si(I9),M9=Si(C9),x9=Si(R9),wS=Si(A9),Na=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function N9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=L9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function L9(e,t){if(!!e){if(typeof e=="string")return _S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _S(e,t)}}function _S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var XE=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Na(function(a){var i=!1,s=[],o=N9(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||ro.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function j9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=U9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function U9(e,t){if(!!e){if(typeof e=="string")return SS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SS(e,t)}}function SS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var F9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Na(function(a){var i=!1,s=[],o=j9(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function D9(e){var t=B9();return function(){var n=wS.default(e),a;if(t){var i=wS.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return x9.default(this,a)}}function B9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=q9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function q9(e,t){if(!!e){if(typeof e=="string")return $S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $S(e,t)}}function $S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Vf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Fu(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=$a.default(a.value,2),s=i[0],o=i[1],u=Jf(t[s],o),l=$a.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},ZE=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(ro.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),ro.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=ro.default(t)),n},H9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=gg(r);return function(i){return function(s){M9.default(u,s);var o=D9(u);function u(){P9.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Vf(a,c),o.call.apply(o,[this].concat(c))}return O9.default(u)}(i)}},W9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=gg(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Vf(a,c),u.apply(this,c)}}},G9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=gg(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Vf(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},gg=function(t){var r=[],n=Fu(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Kf(i))}}catch(s){n.e(s)}finally{n.f()}return r},Kf=function(t){var r=[],n=Array.isArray(t)?t:[t],a=Fu(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(XE(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},Jf=function(t,r){var n=[],a,i=!1,s=Fu(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=Fu(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=$a.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(Cp.default(n),[A]):[].concat(Cp.default(n),Cp.default(A)))}}catch(ue){l.e(ue)}finally{l.f()}}}catch(ue){s.e(ue)}finally{s.f()}if(i)return[!0];var U=a||ZE(r),D=n.length-1,de=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,U,de,D>1?";":","]};function z9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=V9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function V9(e,t){if(!!e){if(typeof e=="string")return TS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TS(e,t)}}function TS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var K9=function(t,r){return Na(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=z9(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=$a.default(i.value,2),o=s[0],u=s[1],l=Jf(Kf(r),u),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},J9=Na(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),Y9=Na(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),Q9=Na(function(e){return[ro.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),X9=function(t,r){return Na(function(n){if(ro.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=$a.default(i[a],2),o=s[0],u=s[1],l=Jf(Kf(u),n[o]),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function Z9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=eJ(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function eJ(e,t){if(!!e){if(typeof e=="string")return kS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kS(e,t)}}function kS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tJ=function(t,r){return Na(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=Z9(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=$a.default(i.value,2),o=s[0],u=s[1],l=Jf(Kf(r),u),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Ir.array=tJ;Ir.custom=Na;Ir.literal=F9;Ir.nonEmptyArray=K9;Ir.nonEmptyString=J9;Ir.nonNegativeInteger=Y9;Ir.objectSchema=X9;Ir.pureObject=Q9;Ir.runtimeTypeValidation=Vf;Ir.stringifyReceivedType=ZE;Ir.type=XE;Ir.validateConstructorTypes=H9;Ir.validateTypes=W9;Ir.validateTypesAsync=G9;/*
@license
The MIT License (MIT)

Copyright (c) 2016 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=$o.exports,r=Dn.exports,n=ra.exports,a=jn.exports,i=Un.exports,s=Xr.exports,o=cl,u=Fn.exports,l=Uf,c=yi.exports,h=gi.exports,w=xa,b=mi.exports,$=bi.exports,A=ps.exports,x=Df,U=Ir;function D(Z){return Z&&typeof Z=="object"&&"default"in Z?Z:{default:Z}}function de(Z){if(Z&&Z.__esModule)return Z;var ne=Object.create(null);return Z&&Object.keys(Z).forEach(function(q){if(q!=="default"){var V=Object.getOwnPropertyDescriptor(Z,q);Object.defineProperty(ne,q,V.get?V:{enumerable:!0,get:function(){return Z[q]}})}}),ne.default=Z,Object.freeze(ne)}var ue=D(t),Ae=D(r),we=D(n),he=D(a),P=D(i),Q=D(s),ce=D(o),W=D(u),ve=D(c),te=D(h),ae=D(b),J=D($),ie=de(A),Re=de(x);function ke(Z,ne,q,V){var re=arguments.length,me=re<3?ne:V===null?V=Object.getOwnPropertyDescriptor(ne,q):V,fe;if((typeof Reflect>"u"?"undefined":W.default(Reflect))==="object"&&typeof Reflect.decorate=="function")me=Reflect.decorate(Z,ne,q,V);else for(var je=Z.length-1;je>=0;je--)(fe=Z[je])&&(me=(re<3?fe(me):re>3?fe(ne,q,me):fe(ne,q))||me);return re>3&&me&&Object.defineProperty(ne,q,me),me}function N(Z,ne){if((typeof Reflect>"u"?"undefined":W.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Z,ne)}var dt;function pt(){}pt.prototype=Object.create(null);function Ee(){Ee.init.call(this)}Ee.EventEmitter=Ee,Ee.usingDomains=!1,Ee.prototype.domain=void 0,Ee.prototype._events=void 0,Ee.prototype._maxListeners=void 0,Ee.defaultMaxListeners=10,Ee.init=function(){this.domain=null,Ee.usingDomains&&dt.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new pt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ee.prototype.setMaxListeners=function(ne){if(typeof ne!="number"||ne<0||isNaN(ne))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=ne,this};function Xe(Z){return Z._maxListeners===void 0?Ee.defaultMaxListeners:Z._maxListeners}Ee.prototype.getMaxListeners=function(){return Xe(this)};function Ye(Z,ne,q){if(ne)Z.call(q);else for(var V=Z.length,re=I(Z,V),me=0;me<V;++me)re[me].call(q)}function B(Z,ne,q,V){if(ne)Z.call(q,V);else for(var re=Z.length,me=I(Z,re),fe=0;fe<re;++fe)me[fe].call(q,V)}function T(Z,ne,q,V,re){if(ne)Z.call(q,V,re);else for(var me=Z.length,fe=I(Z,me),je=0;je<me;++je)fe[je].call(q,V,re)}function Te(Z,ne,q,V,re,me){if(ne)Z.call(q,V,re,me);else for(var fe=Z.length,je=I(Z,fe),Ve=0;Ve<fe;++Ve)je[Ve].call(q,V,re,me)}function ye(Z,ne,q,V){if(ne)Z.apply(q,V);else for(var re=Z.length,me=I(Z,re),fe=0;fe<re;++fe)me[fe].apply(q,V)}Ee.prototype.emit=function(ne){var q,V,re,me,fe,je,Ve,it=ne==="error";if(je=this._events,je)it=it&&je.error==null;else if(!it)return!1;if(Ve=this.domain,it){if(q=arguments[1],Ve)q||(q=new Error('Uncaught, unspecified "error" event')),q.domainEmitter=this,q.domain=Ve,q.domainThrown=!1,Ve.emit("error",q);else{if(q instanceof Error)throw q;var rt=new Error('Uncaught, unspecified "error" event. ('+q+")");throw rt.context=q,rt}return!1}if(V=je[ne],!V)return!1;var We=typeof V=="function";switch(re=arguments.length,re){case 1:Ye(V,We,this);break;case 2:B(V,We,this,arguments[1]);break;case 3:T(V,We,this,arguments[1],arguments[2]);break;case 4:Te(V,We,this,arguments[1],arguments[2],arguments[3]);break;default:for(me=new Array(re-1),fe=1;fe<re;fe++)me[fe-1]=arguments[fe];ye(V,We,this,me)}return!0};function Ke(Z,ne,q,V){var re,me,fe;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(me=Z._events,me?(me.newListener&&(Z.emit("newListener",ne,q.listener?q.listener:q),me=Z._events),fe=me[ne]):(me=Z._events=new pt,Z._eventsCount=0),!fe)fe=me[ne]=q,++Z._eventsCount;else if(typeof fe=="function"?fe=me[ne]=V?[q,fe]:[fe,q]:V?fe.unshift(q):fe.push(q),!fe.warned&&(re=Xe(Z),re&&re>0&&fe.length>re)){fe.warned=!0;var je=new Error("Possible EventEmitter memory leak detected. "+fe.length+" "+ne+" listeners added. Use emitter.setMaxListeners() to increase limit");je.name="MaxListenersExceededWarning",je.emitter=Z,je.type=ne,je.count=fe.length,Qe(je)}return Z}function Qe(Z){typeof console.warn=="function"?console.warn(Z):console.log(Z)}Ee.prototype.addListener=function(ne,q){return Ke(this,ne,q,!1)},Ee.prototype.on=Ee.prototype.addListener,Ee.prototype.prependListener=function(ne,q){return Ke(this,ne,q,!0)};function Se(Z,ne,q){var V=!1;function re(){Z.removeListener(ne,re),V||(V=!0,q.apply(Z,arguments))}return re.listener=q,re}Ee.prototype.once=function(ne,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.on(ne,Se(this,ne,q)),this},Ee.prototype.prependOnceListener=function(ne,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(ne,Se(this,ne,q)),this},Ee.prototype.removeListener=function(ne,q){var V,re,me,fe,je;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(re=this._events,!re)return this;if(V=re[ne],!V)return this;if(V===q||V.listener&&V.listener===q)--this._eventsCount===0?this._events=new pt:(delete re[ne],re.removeListener&&this.emit("removeListener",ne,V.listener||q));else if(typeof V!="function"){for(me=-1,fe=V.length;fe-- >0;)if(V[fe]===q||V[fe].listener&&V[fe].listener===q){je=V[fe].listener,me=fe;break}if(me<0)return this;if(V.length===1){if(V[0]=void 0,--this._eventsCount===0)return this._events=new pt,this;delete re[ne]}else R(V,me);re.removeListener&&this.emit("removeListener",ne,je||q)}return this},Ee.prototype.off=function(Z,ne){return this.removeListener(Z,ne)},Ee.prototype.removeAllListeners=function(ne){var q,V;if(V=this._events,!V)return this;if(!V.removeListener)return arguments.length===0?(this._events=new pt,this._eventsCount=0):V[ne]&&(--this._eventsCount===0?this._events=new pt:delete V[ne]),this;if(arguments.length===0){for(var re=Object.keys(V),me=0,fe;me<re.length;++me)fe=re[me],fe!=="removeListener"&&this.removeAllListeners(fe);return this.removeAllListeners("removeListener"),this._events=new pt,this._eventsCount=0,this}if(q=V[ne],typeof q=="function")this.removeListener(ne,q);else if(q)do this.removeListener(ne,q[q.length-1]);while(q[0]);return this},Ee.prototype.listeners=function(ne){var q,V,re=this._events;return re?(q=re[ne],q?typeof q=="function"?V=[q.listener||q]:V=K(q):V=[]):V=[],V},Ee.listenerCount=function(Z,ne){return typeof Z.listenerCount=="function"?Z.listenerCount(ne):Ge.call(Z,ne)},Ee.prototype.listenerCount=Ge;function Ge(Z){var ne=this._events;if(ne){var q=ne[Z];if(typeof q=="function")return 1;if(q)return q.length}return 0}Ee.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function R(Z,ne){for(var q=ne,V=q+1,re=Z.length;V<re;q+=1,V+=1)Z[q]=Z[V];Z.pop()}function I(Z,ne){for(var q=new Array(ne);ne--;)q[ne]=Z[ne];return q}function K(Z){for(var ne=new Array(Z.length),q=0;q<ne.length;++q)ne[q]=Z[q].listener||Z[q];return ne}var pe=ie.getLogger("twilio-notificatiions");function G(Z,ne){return["".concat(new Date().toISOString()," Twilio.Notifications ").concat(Z,":")].concat(Array.from(ne))}var Pe=function(){function Z(){Ae.default(this,Z)}return we.default(Z,[{key:"setLevel",value:function(q){pe.setLevel(q)}},{key:"trace",value:function(){for(var q=arguments.length,V=new Array(q),re=0;re<q;re++)V[re]=arguments[re];pe.trace.apply(null,G("T",V))}},{key:"debug",value:function(){for(var q=arguments.length,V=new Array(q),re=0;re<q;re++)V[re]=arguments[re];pe.debug.apply(null,G("D",V))}},{key:"info",value:function(){for(var q=arguments.length,V=new Array(q),re=0;re<q;re++)V[re]=arguments[re];pe.info.apply(null,G("I",V))}},{key:"warn",value:function(){for(var q=arguments.length,V=new Array(q),re=0;re<q;re++)V[re]=arguments[re];pe.warn.apply(null,G("W",V))}},{key:"error",value:function(){for(var q=arguments.length,V=new Array(q),re=0;re<q;re++)V[re]=arguments[re];pe.error.apply(null,G("E",V))}}]),Z}(),be=new Pe;function _e(Z){var ne=Oe();return function(){var V=Q.default(Z),re;if(ne){var me=Q.default(this).constructor;re=Reflect.construct(V,arguments,me)}else re=V.apply(this,arguments);return P.default(this,re)}}function Oe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ee=we.default(function Z(){var ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;Ae.default(this,Z),this.token=ne,this.notificationId=q,this.messageTypes=V});function Fe(Z,ne){return[].concat(J.default(J.default(Z).filter(function(q){return!ne.has(q)})),J.default(J.default(ne).filter(function(q){return!Z.has(q)})))}function Ue(Z,ne){var q=new Set;return Z.notificationId!==ne.notificationId&&q.add("notificationId"),Z.token!==ne.token&&q.add("token"),Fe(Z.messageTypes,ne.messageTypes).length>0&&q.add("messageType"),[q.size>0,q]}var Me=function(Z){he.default(q,Z);var ne=_e(q);function q(V){var re;return Ae.default(this,q),re=ne.call(this),te.default(ve.default(re),"desiredState",new ee),te.default(ve.default(re),"currentState",new ee),te.default(ve.default(re),"_hasActiveAttempt",!1),re.channelType=V,re}return we.default(q,[{key:"setNotificationId",value:function(re){this.desiredState.notificationId=re}},{key:"isActive",value:function(){return this.desiredState.notificationId!==""}},{key:"subscribe",value:function(re){if(this.desiredState.messageTypes.has(re)){be.debug("message type '".concat(re,"' for channel ").concat(this.channelType," is already registered"));return}this.desiredState.messageTypes.add(re)}},{key:"unsubscribe",value:function(re){!this.desiredState.messageTypes.has(re)||this.desiredState.messageTypes.delete(re)}},{key:"updateToken",value:function(re){this.desiredState.token=re}},{key:"commitChanges",value:function(){var V=ue.default(ce.default.mark(function me(){var fe,je,Ve,it,rt,We;return ce.default.wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(!this._hasActiveAttempt){nt.next=3;break}throw be.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(fe=Ue(this.desiredState,this.currentState),je=ae.default(fe,2),Ve=je[0],it=je[1],Ve){nt.next=6;break}return nt.abrupt("return");case 6:if(this.currentState.notificationId||it.delete("notificationId"),be.trace("Persisting ".concat(this.channelType," registration"),it,this.desiredState),nt.prev=8,this._hasActiveAttempt=!0,rt=new ee,rt.token=this.desiredState.token,rt.notificationId=this.desiredState.notificationId,rt.messageTypes=new Set(this.desiredState.messageTypes),!(rt.messageTypes.size>0)){nt.next=24;break}return nt.next=17,this.updateRegistration(rt,it);case 17:We=nt.sent,this.currentState.token=We.token,this.currentState.notificationId=We.notificationId,this.currentState.messageTypes=new Set(We.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),nt.next=30;break;case 24:return nt.next=26,this.removeRegistration();case 26:this.currentState.token=rt.token,this.currentState.notificationId=rt.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:nt.next=35;break;case 32:throw nt.prev=32,nt.t0=nt.catch(8),nt.t0;case 35:return nt.prev=35,this._hasActiveAttempt=!1,nt.finish(35);case 38:case"end":return nt.stop()}},me,this,[[8,32,35,38]])}));function re(){return V.apply(this,arguments)}return re}()}]),q}(Ee);function oe(Z){var ne=F();return function(){var V=Q.default(Z),re;if(ne){var me=Q.default(this).constructor;re=Reflect.construct(V,arguments,me)}else re=V.apply(this,arguments);return P.default(this,re)}}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var H={min:2e3,max:12e4,randomness:.2},Y=function(Z){he.default(q,Z);var ne=oe(q);function q(V,re,me,fe){var je;return Ae.default(this,q),je=ne.call(this,V),te.default(ve.default(je),"registrationId",null),je.context=re,je.twilsock=me,je.registrarUrl=fe,je}return we.default(q,[{key:"updateRegistration",value:function(){var V=ue.default(ce.default.mark(function me(fe,je){var Ve=this,it,rt,We,vr,nt;return ce.default.wrap(function(Ft){for(;;)switch(Ft.prev=Ft.next){case 0:if(!je.has("notificationId")){Ft.next=3;break}return Ft.next=3,this.removeRegistration();case 3:if(!(!fe.notificationId||!fe.notificationId.length)){Ft.next=6;break}throw be.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return be.trace("Registering",this.channelType,fe),it={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(fe.messageTypes),data:{registration_id:fe.notificationId}},rt=this.context.productId,We="".concat(this.registrarUrl,"?productId=").concat(rt),vr={"Content-Type":"application/json"},be.trace("Creating registration for channel ".concat(this.channelType)),Ft.prev=12,Ft.next=15,new w.AsyncRetrier(H).run(function(){return Ve.twilsock.post(We,vr,it,rt)});case 15:nt=Ft.sent,this.registrationId=nt.body.id,be.debug("Registration created: ",nt),Ft.next=24;break;case 20:throw Ft.prev=20,Ft.t0=Ft.catch(12),be.error("Registration failed: ",Ft.t0),Ft.t0;case 24:return Ft.abrupt("return",fe);case 25:case"end":return Ft.stop()}},me,this,[[12,20]])}));function re(me,fe){return V.apply(this,arguments)}return re}()},{key:"removeRegistration",value:function(){var V=ue.default(ce.default.mark(function me(){var fe=this,je,Ve,it;return ce.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(this.registrationId){We.next=2;break}return We.abrupt("return");case 2:return je=this.context.productId,Ve="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(je),it={"Content-Type":"application/json"},be.trace("Removing registration for ".concat(this.channelType)),We.prev=6,We.next=9,new w.AsyncRetrier(Object.assign(H,{maxAttemptsCount:3})).run(function(){return fe.twilsock.delete(Ve,it,{},je)});case 9:this.registrationId=null,this.currentState.notificationId="",be.debug("Registration removed for ".concat(this.channelType)),We.next=18;break;case 14:throw We.prev=14,We.t0=We.catch(6),be.error("Failed to remove registration ",this.channelType,We.t0),We.t0;case 18:case"end":return We.stop()}},me,this,[[6,14]])}));function re(){return V.apply(this,arguments)}return re}()},{key:"sendDeviceRemoveRequest",value:function(){var V=ue.default(ce.default.mark(function me(fe){var je=this,Ve,it,rt,We;return ce.default.wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:if(fe!==""){nt.next=2;break}throw new Error("Empty registration ID");case 2:return Ve=this.context.productId,it="".concat(this.registrarUrl,"?productId=").concat(Ve),rt={"Content-Type":"application/json"},We={binding_type:this.channelType,address:fe},nt.prev=6,be.trace("Removing old registrations for ".concat(this.channelType)),nt.next=10,new w.AsyncRetrier(Object.assign(H,{maxAttemptsCount:3})).run(function(){return je.twilsock.delete(it,rt,We,Ve)});case 10:this.registrationId=null,this.currentState.notificationId="",be.debug("Registration removed for ".concat(this.channelType)),nt.next=19;break;case 15:throw nt.prev=15,nt.t0=nt.catch(6),be.error("Failed to remove registration ",this.channelType,nt.t0),nt.t0;case 19:case"end":return nt.stop()}},me,this,[[6,15]])}));function re(me){return V.apply(this,arguments)}return re}()}]),q}(Me);function ge(Z){var ne=Ne();return function(){var V=Q.default(Z),re;if(ne){var me=Q.default(this).constructor;re=Reflect.construct(V,arguments,me)}else re=V.apply(this,arguments);return P.default(this,re)}}function Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qe=function(Z){he.default(q,Z);var ne=ge(q);function q(V,re,me){var fe;return Ae.default(this,q),fe=ne.call(this,"twilsock"),te.default(ve.default(fe),"contextId",Re.v4()),fe.productId=V,fe.platform=re,fe.twilsock=me,fe}return we.default(q,[{key:"updateRegistration",value:function(){var V=ue.default(ce.default.mark(function me(fe,je){var Ve,it;return ce.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(je.has("messageType")){We.next=2;break}return We.abrupt("return",fe);case 2:return Ve=Array.from(fe.messageTypes),it={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:Ve},We.prev=4,We.next=7,this.twilsock.setNotificationsContext(this.contextId,it);case 7:We.next=13;break;case 9:throw We.prev=9,We.t0=We.catch(4),be.error("Failed to update twilsock notification context: ".concat(We.t0)),We.t0;case 13:return We.abrupt("return",fe);case 14:case"end":return We.stop()}},me,this,[[4,9]])}));function re(me,fe){return V.apply(this,arguments)}return re}()},{key:"removeRegistration",value:function(){var V=ue.default(ce.default.mark(function me(){return ce.default.wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return je.prev=0,je.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:je.next=9;break;case 5:throw je.prev=5,je.t0=je.catch(0),be.error("Failed to remove twilsock notification context: ".concat(je.t0)),je.t0;case 9:case"end":return je.stop()}},me,this,[[0,5]])}));function re(){return V.apply(this,arguments)}return re}()},{key:"sendDeviceRemoveRequest",value:function(){var V=ue.default(ce.default.mark(function me(fe){return ce.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:case"end":return Ve.stop()}},me)}));function re(me){return V.apply(this,arguments)}return re}()}]),q}(Me);function ze(Z){var ne=De();return function(){var V=Q.default(Z),re;if(ne){var me=Q.default(this).constructor;re=Reflect.construct(V,arguments,me)}else re=V.apply(this,arguments);return P.default(this,re)}}function De(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var He,Le=U.literal("apn","fcm","twilsock");e.Notifications=He=function(Z){he.default(q,Z);var ne=ze(q);function q(V){var re,me,fe,je,Ve,it,rt,We=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ae.default(this,q),rt=ne.call(this),We.logLevel=(re=We.logLevel)!==null&&re!==void 0?re:"error",be.setLevel(We.logLevel);var vr=(me=We.productId)!==null&&me!==void 0?me:"notifications",nt=!We.twilsockClient,Rr=We.twilsockClient=(fe=We.twilsockClient)!==null&&fe!==void 0?fe:new l.TwilsockClient(V,vr,We),Ft=(je=We.notifications)!==null&&je!==void 0?je:{},bn=(Ve=(it=Ft.region)!==null&&it!==void 0?it:We.region)!==null&&Ve!==void 0?Ve:"us1",nr="https://ers.".concat(bn,".twilio.com/v1/registrations"),Bn=Ft.ersUrl||nr;rt.connectors=new Map;var Rt=He._detectPlatform();return rt.connectors.set("apn",new Y("apn",{protocolVersion:4,productId:vr,platform:Rt},Rr,Bn)),rt.connectors.set("fcm",new Y("fcm",{protocolVersion:3,productId:vr,platform:Rt},Rr,Bn)),rt.connectors.set("twilsock",new qe(vr,Rt,Rr)),Rr.on("stateChanged",function(hr){return rt.emit("transportState",hr)}),rt._connector("twilsock").on("stateChanged",function(hr,qr,Hr){return rt.emit("stateChanged",hr,qr,Hr)}),rt._connector("apn").on("stateChanged",function(hr,qr,Hr){return rt.emit("stateChanged",hr,qr,Hr)}),rt._connector("fcm").on("stateChanged",function(hr,qr,Hr){return rt.emit("stateChanged",hr,qr,Hr)}),Rr.on("message",function(hr,qr){return rt._routeMessage(hr,qr)}),rt.updateToken(V),nt&&(Rr.connect(),rt.twilsock=Rr),rt}return we.default(q,[{key:"shutdown",value:function(){var V=ue.default(ce.default.mark(function me(){return ce.default.wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(this.connectors.clear(),!this.twilsock){je.next=4;break}return je.next=4,this.twilsock.disconnect();case 4:case"end":return je.stop()}},me,this)}));function re(){return V.apply(this,arguments)}return re}()},{key:"setPushRegistrationId",value:function(re,me){be.debug("Set ".concat(re," push registration id '").concat(me,"'")),this._connector(re).setNotificationId(me)}},{key:"subscribe",value:function(re,me){be.debug("Add ".concat(re," subscriptions for message type ").concat(me)),this._connector(re).subscribe(me)}},{key:"unsubscribe",value:function(re,me){be.debug("Remove ".concat(re," subscriptions for message type ").concat(me)),this._connector(re).unsubscribe(me)}},{key:"updateToken",value:function(re){this.connectors.forEach(function(me){return me.updateToken(re)})}},{key:"commitChanges",value:function(){var V=ue.default(ce.default.mark(function me(){var fe;return ce.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return fe=[],this.connectors.forEach(function(it){it.isActive()&&fe.push(it.commitChanges())}),Ve.next=4,Promise.all(fe);case 4:case"end":return Ve.stop()}},me,this)}));function re(){return V.apply(this,arguments)}return re}()},{key:"removeRegistrations",value:function(){var V=ue.default(ce.default.mark(function me(fe,je){return ce.default.wrap(function(it){for(;;)switch(it.prev=it.next){case 0:return it.next=2,this._connector(fe).sendDeviceRemoveRequest(je);case 2:case"end":return it.stop()}},me,this)}));function re(me,fe){return V.apply(this,arguments)}return re}()},{key:"handlePushNotification",value:function(re){return{messageType:re.twi_message_type,payload:re.payload}}},{key:"_routeMessage",value:function(re,me){be.debug("Notification message arrived: ",re,me),this.emit("message",re,me)}},{key:"_connector",value:function(re){var me=this.connectors.get(re);if(!me)throw new Error("Unknown channel type: ".concat(re));return me}}],[{key:"_detectPlatform",value:function(){var re="";return typeof navigator<"u"?(re="unknown",typeof navigator.product<"u"&&(re=navigator.product),typeof navigator.userAgent<"u"&&(re=navigator.userAgent)):re="web",re.substring(0,128)}}]),q}(Ee),ke([U.validateTypes(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"setPushRegistrationId",null),ke([U.validateTypes(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"subscribe",null),ke([U.validateTypes(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"unsubscribe",null),ke([U.validateTypes(U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String]),N("design:returntype",void 0)],e.Notifications.prototype,"updateToken",null),ke([U.validateTypesAsync(Le,U.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",Promise)],e.Notifications.prototype,"removeRegistrations",null),e.Notifications=He=ke([U.validateConstructorTypes(U.nonEmptyString,[U.pureObject,"undefined",U.literal(null)]),N("design:paramtypes",[String,Object])],e.Notifications)})(YE);var Br={};/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes Backoff library under the following license

    Copyright (C) 2012 Mathieu Turcotte

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

This software includes Event-to-Promise library under the following license

    Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

    Permission to use, copy, modify, and/or distribute this software for any purpose
    with or without fee is hereby granted, provided that the above copyright notice
    and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
    OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
    THIS SOFTWARE.

*/Object.defineProperty(Br,"__esModule",{value:!0});var rJ=$o.exports,nJ=Dn.exports,aJ=ra.exports,iJ=yi.exports,sJ=jn.exports,oJ=Un.exports,uJ=Xr.exports,lJ=gi.exports,cJ=cl,fJ=Fn.exports,$e=Er,qc=Uf,dJ=yg.exports,pJ=ps.exports,vJ=mi.exports,eI=xa,tI=Df,hJ=jf.exports,yJ=Bc.exports;function Zr(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function mg(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var xe=Zr(rJ),gt=Zr(nJ),Tt=Zr(aJ),Jn=Zr(iJ),xr=Zr(sJ),$i=Zr(oJ),er=Zr(uJ),Et=Zr(lJ),z=Zr(cJ),rI=Zr(fJ),gJ=Zr(dJ),mJ=mg(pJ),nI=Zr(vJ),bJ=mg(tI),pl=Zr(hJ),Xl=mg(yJ);function wt(e,t,r,n){var a=arguments.length,i=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if((typeof Reflect>"u"?"undefined":rI.default(Reflect))==="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(i=(a<3?s(i):a>3?s(t,r,i):s(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function Ce(e,t){if((typeof Reflect>"u"?"undefined":rI.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var wJ;function ii(){}ii.prototype=Object.create(null);function Ct(){Ct.init.call(this)}Ct.EventEmitter=Ct;Ct.usingDomains=!1;Ct.prototype.domain=void 0;Ct.prototype._events=void 0;Ct.prototype._maxListeners=void 0;Ct.defaultMaxListeners=10;Ct.init=function(){this.domain=null,Ct.usingDomains&&wJ.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ii,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ct.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function aI(e){return e._maxListeners===void 0?Ct.defaultMaxListeners:e._maxListeners}Ct.prototype.getMaxListeners=function(){return aI(this)};function _J(e,t,r){if(t)e.call(r);else for(var n=e.length,a=vl(e,n),i=0;i<n;++i)a[i].call(r)}function SJ(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=vl(e,a),s=0;s<a;++s)i[s].call(r,n)}function $J(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=vl(e,i),o=0;o<i;++o)s[o].call(r,n,a)}function TJ(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,o=vl(e,s),u=0;u<s;++u)o[u].call(r,n,a,i)}function kJ(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=vl(e,a),s=0;s<a;++s)i[s].apply(r,n)}Ct.prototype.emit=function(t){var r,n,a,i,s,o,u,l=t==="error";if(o=this._events,o)l=l&&o.error==null;else if(!l)return!1;if(u=this.domain,l){if(r=arguments[1],u)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=u,r.domainThrown=!1,u.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=o[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:_J(n,h,this);break;case 2:SJ(n,h,this,arguments[1]);break;case 3:$J(n,h,this,arguments[1],arguments[2]);break;case 4:TJ(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];kJ(n,h,this,i)}return!0};function iI(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ii,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=aI(e),a&&a>0&&s.length>a)){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,EJ(o)}return e}function EJ(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Ct.prototype.addListener=function(t,r){return iI(this,t,r,!1)};Ct.prototype.on=Ct.prototype.addListener;Ct.prototype.prependListener=function(t,r){return iI(this,t,r,!0)};function sI(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}Ct.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,sI(this,t,r)),this};Ct.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,sI(this,t,r)),this};Ct.prototype.removeListener=function(t,r){var n,a,i,s,o;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ii:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){o=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ii,this;delete a[t]}else IJ(n,i);a.removeListener&&this.emit("removeListener",t,o||r)}return this};Ct.prototype.off=function(e,t){return this.removeListener(e,t)};Ct.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ii,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ii:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ii,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Ct.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=CJ(r):n=[]):n=[],n};Ct.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):oI.call(e,t)};Ct.prototype.listenerCount=oI;function oI(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Ct.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function IJ(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function vl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function CJ(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}var vo=function(){function e(t){gt.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return Tt.default(e,[{key:"pathSegment",value:function(r){return this.paths.push(encodeURIComponent(r)),this}},{key:"queryParam",value:function(r,n){return typeof n<"u"&&this.args.push(encodeURIComponent(r)+"="+encodeURIComponent(n)),this}},{key:"build",value:function(){var r=this.base;return this.paths.length&&(r+="/"+this.paths.join("/")),this.args.length&&(r+="?"+this.args.join("&")),r}}]),e}();function uI(e){var t=RJ();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function RJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dr=function(e){xr.default(r,e);var t=uI(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return gt.default(this,r),a=t.call(this),a.name=a.constructor.name,a.message="".concat(n," (status: ").concat(i,", code: ").concat(s,")"),a.status=i,a.code=s,a}return r}(gJ.default(Error)),AJ=function(e){xr.default(r,e);var t=uI(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0;return gt.default(this,r),a=t.call(this,n,i,s),a.body=o,a}return r}(Dr);function Pn(e){return JSON.parse(JSON.stringify(e))}function lI(e){var t=e===void 0||bg(e);if(!t)throw new Dr("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function OJ(e){return!isNaN(parseInt(e))&&isFinite(e)}function bg(e){return OJ(e)&&e>0}var xs=mJ.getLogger("twilio-sync");function ru(e,t){return["".concat(new Date().toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var _t={setLevel:function(t){xs.setLevel(t)},trace:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];xs.trace.apply(null,ru("T",r))},debug:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];xs.debug.apply(null,ru("D",r))},info:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];xs.info.apply(null,ru("I",r))},warn:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];xs.warn.apply(null,ru("W",r))},error:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];xs.error.apply(null,ru("E",r))}},PJ="/v4/Subscriptions",MJ="/v3/Maps",xJ="/v3/Lists",NJ="/v3/Documents",LJ="/v3/Streams",jJ="/v3/Insights";function UJ(e,t,r){return e&&typeof e[t]<"u"?e[t]:r}var FJ=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt.default(this,e);var r=t.region||"us1",n="https://cds.".concat(r,".twilio.com"),a=t.cdsUri||n;this.settings={subscriptionsUri:a+PJ,documentsUri:a+NJ,listsUri:a+xJ,mapsUri:a+MJ,streamsUri:a+LJ,insightsUri:a+jJ,sessionStorageEnabled:UJ(t.Sync,"enableSessionStorage",!0),productId:t.productId}}return Tt.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function nu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=DJ(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function DJ(e,t){if(!!e){if(typeof e=="string")return ES(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ES(e,t)}}function ES(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var BJ=function(){function e(t){gt.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return Tt.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(r,n){this.localObject._update(r,n)}},{key:"updatePending",value:function(r,n){this.pendingAction=r,this.pendingCorrelationId=n}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(r){this.rejectedWithError=r.error,this.updatePending(null,null),this.localObject.reportFailure(new Dr("Failed to subscribe on service events: ".concat(r.error.message),r.error.status,r.error.code))}},{key:"complete",value:function(r){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(r)}},{key:"setSubscriptionState",value:function(r){this.localObject._setSubscriptionState(r)}}]),e}(),qJ=function(){function e(t){var r=this;gt.default(this,e),Et.default(this,"isConnected",!1),Et.default(this,"maxBatchSize",100),Et.default(this,"subscriptionTtlTimer",null),Et.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;var n={randomisationFactor:.2,initialDelay:100,maxDelay:2*60*1e3};this.backoff=eI.Backoff.exponential(Object.assign(n,this.services.config.backoffConfig)),this.backoff.on("ready",function(){var a=r.getSubscriptionUpdateBatch(),i=a.action,s=a.subscriptions;i?r.applyNewSubscriptionUpdateBatch(i,s):(r.backoff.reset(),_t.debug("All subscriptions resolved."))})}return Tt.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function r(i,s,o,u){var l=[],c=nu(i),h;try{for(c.s();!(h=c.n()).done;){var w=nI.default(h.value,2),b=w[0],$=w[1],A=s.get(b);if(!A&&o!==$.pendingAction&&!$.rejectedWithError&&(l.push($),u&&l.length>=u))break}}catch(x){c.e(x)}finally{c.f()}return l}var n=r(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(n.length>0)return{action:"establish",subscriptions:n};var a=r(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return a.length>0?{action:"cancel",subscriptions:a}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:function(){var t=xe.default(z.default.mark(function n(a,i){var s=this,o,u,l,c,h,w,b,$,A,x,U,D,de,ue,Ae,we;return z.default.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(this.isConnected){P.next=4;break}return _t.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),this.backoff.reset(),P.abrupt("return");case 4:i=this.processLocalActions(a,i),o=new Date().getTime(),u=nu(i);try{for(u.s();!(l=u.n()).done;)c=l.value,this.recordActionAttemptOn(c,a,o)}catch(Q){u.e(Q)}finally{u.f()}return h=this.pendingPokeReason,this.pendingPokeReason=null,P.prev=10,P.next=13,this.request(a,o,h,i);case 13:w=P.sent,b=w.body.max_batch_size,!isNaN(parseInt(b))&&isFinite(b)&&b>0&&(this.maxBatchSize=b),this.subscriptionTtlTimer||($=w.body.ttl_in_s,A=!isNaN(parseFloat($))&&isFinite($),x=A&&$>0,x&&(this.subscriptionTtlTimer=setTimeout(function(){return s.onSubscriptionTtlElapsed()},$*1e3))),a==="establish"&&(U=w.body.estimated_delivery_in_ms,D=!isNaN(parseFloat(U))&&isFinite(U),de=D&&U>0,de?setTimeout(function(){return s.verifyPokeDelivery(o,U,i)},U):_t.error("Invalid timeout: ".concat(U)),i.filter(function(Q){return Q.pendingCorrelationId===o}).forEach(function(Q){return Q.setSubscriptionState("response_in_flight")})),this.backoff.reset(),P.next=26;break;case 21:P.prev=21,P.t0=P.catch(10),ue=nu(i);try{for(ue.s();!(Ae=ue.n()).done;)we=Ae.value,this.recordActionFailureOn(we,a)}catch(Q){ue.e(Q)}finally{ue.f()}P.t0 instanceof qc.TransportUnavailableError?(_t.debug("Twilsock connection (required for subscription) not ready (c:".concat(o,"); waiting\u2026")),this.backoff.reset()):(_t.debug("Failed an attempt to ".concat(a," subscriptions (c:").concat(o,"); retrying"),P.t0),this.persist());case 26:case"end":return P.stop()}},n,this,[[10,21]])}));function r(n,a){return t.apply(this,arguments)}return r}()},{key:"verifyPokeDelivery",value:function(r,n,a){var i=this,s=this.latestPokeResponseArrivalTimestampByCorrelationId.get(r),o=s?new Date().getTime()-s:n;if(o>=n)a.filter(function(l){return l.pendingCorrelationId===r}).forEach(function(l){l.updatePending(null,null),l.retryCount++,i.persisted.delete(l.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(r);else{var u=n-o;setTimeout(function(){return i.verifyPokeDelivery(r,n,a)},u)}}},{key:"processLocalActions",value:function(r,n){return r==="cancel"?n.filter(function(a){return!a.rejectedWithError}):n}},{key:"recordActionAttemptOn",value:function(r,n,a){if(r.setSubscriptionState("request_in_flight"),n==="establish")this.persisted.set(r.sid,r),r.updatePending(n,a);else{var i=this.persisted.get(r.sid);i&&i.updatePending(n,a)}}},{key:"recordActionFailureOn",value:function(r,n){r.setSubscriptionState("none"),r.updatePending(null,null),n==="establish"&&this.persisted.delete(r.sid)}},{key:"request",value:function(r,n,a,i){var s=i.map(function(l){return{object_sid:l.sid,object_type:l.type,last_event_id:r==="establish"?l.lastEventId:void 0,index_name:r==="establish"?l.indexName:void 0,query_string:r==="establish"?l.queryString:void 0}}),o=i.filter(function(l){return l.retryCount>0}).length;_t.debug("Attempting '".concat(r,"' request (c:").concat(n,"):"),s);var u={event_protocol_version:4,action:r,correlation_id:n,retried_requests:o,ttl_in_s:-1,requests:s};return a==="ttl"&&(u.reason=a),this.services.network.post(this.services.config.subscriptionsUri,u)}},{key:"add",value:function(r,n){_t.debug("Establishing intent to subscribe to ".concat(r));var a=this.subscriptions.get(r);a&&n&&a.lastEventId===n.lastEventId||(this.persisted.delete(r),this.subscriptions.set(r,new BJ(n)),this.persist())}},{key:"remove",value:function(r){_t.debug("Establishing intent to unsubscribe from ".concat(r));var n=this.subscriptions.delete(r);n&&this.persist()}},{key:"acceptMessage",value:function(r,n){_t.trace("Subscriptions received",r);var a=r.event_type,i=typeof r.events<"u"?r.events:[r.event],s=r.correlation_id;s&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(s,new Date().getTime());var o=nu(i),u;try{for(o.s();!(u=o.n()).done;){var l=u.value,c=void 0;switch(r.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(l,s);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(l,s);break;case"subscription_failed":this.applySubscriptionFailedMessage(l,s);break;case(c=a.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{var h=void 0;switch(c[0]){case"map_":h=l.map_sid;break;case"list_":h=l.list_sid;break;case"document_":h=l.document_sid;break;case"stream_":h=l.stream_sid;break;case"live_query_":h=l.query_id,n=!1,r.strictly_ordered===!0&&(n=!0);break;default:h=void 0}this.applyEventToSubscribedEntity(h,l,a,n);break}default:_t.debug("Dropping unknown message type ".concat(a));break}}}catch(w){o.e(w)}finally{o.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(r,n){var a=r.object_sid,i=this.persisted.get(r.object_sid);i&&i.pendingCorrelationId===n?r.replay_status==="interrupted"?(_t.debug("Event Replay for subscription to ".concat(a," (c:").concat(n,") interrupted; continuing eagerly.")),i.updatePending(null,null),this.persisted.delete(i.sid),this.backoff.reset()):r.replay_status==="completed"&&(_t.debug("Event Replay for subscription to ".concat(a," (c:").concat(n,") completed. Subscription is ready.")),i.complete(r.last_event_id),this.persisted.set(r.object_sid,i),i.setSubscriptionState("established"),this.backoff.reset()):_t.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(r,n){var a=this.persisted.get(r.object_sid);a&&a.pendingCorrelationId===n?(a.updatePending(null,null),a.setSubscriptionState("none"),this.persisted.delete(r.object_sid)):_t.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(r,n){var a=r.object_sid,i=this.subscriptions.get(a),s=this.persisted.get(a);i&&s?s.pendingCorrelationId===n&&(_t.error("Failed to subscribe on ".concat(s.sid),r.error),s.markAsFailed(r),s.setSubscriptionState("none")):!i&&s&&(this.persisted.delete(a),s.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(r,n,a,i){var s=this;if(!!r){i=i||function(){var u=s.persisted.get(r);return u&&u.isEstablished}();var o=this.subscriptions.get(r);o?(n.type=a,o.update(n,i)):_t.debug("Message dropped for SID '".concat(r,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(r){this.isConnected=r,r&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(r){_t.debug("Triggering event replay for all subscriptions, reason=".concat(r)),this.pendingPokeReason=r,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var n=[],a=nu(this.persisted.values()),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;s.reset(),s.rejectedWithError&&n.push(s)}}catch(c){a.e(c)}finally{a.f()}this.persisted.clear();for(var o=0,u=n;o<u.length;o++){var l=u[o];this.persisted.set(l.sid,l)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}(),HJ=4e3,WJ=6e4,GJ=9e4,zJ=.2;function IS(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function CS(e){return e.body?e.body.code:0}function au(e){return e.status===409?new AJ(IS(e),e.status,CS(e),e.body):e.status?new Dr(IS(e),e.status,CS(e)):e instanceof qc.TransportUnavailableError?e:new Dr(e.message,0,0)}var VJ=function(){function e(t,r,n){gt.default(this,e),this.clientInfo=t,this.config=r,this.transport=n}return Tt.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+bJ.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:HJ,max:WJ,maxAttemptsTime:GJ,randomness:zJ},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(r){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise(function(i,s){var o=[502,503,504];a&&o.push(429);var u=new eI.Retrier(n.backoffConfig());u.on("attempt",function(){r().then(function(l){return u.succeeded(l)}).catch(function(l){if(o.includes(l.status)){var c=parseInt(l.headers?l.headers["Retry-After"]:null);u.failed(au(l),isNaN(c)?null:c*1e3)}else l.message==="Twilsock disconnected"?u.failed(au(l)):(u.removeAllListeners(),u.cancel(),s(au(l)))})}),u.on("succeeded",function(l){i(l)}),u.on("cancelled",function(l){return s(au(l))}),u.on("failed",function(l){return s(au(l))}),u.start()})}},{key:"get",value:function(r){var n=this,a=this.createHeaders();return _t.debug("GET",r,"ID:",a["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.get(r,a,n.config.productId)},!0)}},{key:"post",value:function(r,n,a){var i=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.createHeaders();return typeof a<"u"&&a!==null&&(o["If-Match"]=a),_t.debug("POST",r,"ID:",o["Twilio-Request-Id"]),this.executeWithRetry(function(){return i.transport.post(r,o,n,i.config.productId)},s)}},{key:"put",value:function(r,n,a){var i=this,s=this.createHeaders();return typeof a<"u"&&a!==null&&(s["If-Match"]=a),_t.debug("PUT",r,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(function(){return i.transport.put(r,s,n,i.config.productId)},!1)}},{key:"delete",value:function(r){var n=this,a=this.createHeaders();return _t.debug("DELETE",r,"ID:",a["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.delete(r,a,n.config.productId)},!1)}}]),e}(),KJ=function(){function e(t,r){gt.default(this,e),this.config=t,this.storageId=null;try{this.storage=r||sessionStorage}catch{}}return Tt.default(e,[{key:"storageKey",value:function(r,n){return"".concat(this.storageId,"::").concat(r,"::").concat(n)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(r){this.storageId=r}},{key:"store",value:function(r,n,a){return this.isReady?this._store(this.storageKey(r,n),a):null}},{key:"read",value:function(r,n){return this.isReady?this._read(this.storageKey(r,n)):null}},{key:"remove",value:function(r,n,a){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(r,n)),a&&this.storage.removeItem(this.storageKey(r,a))}catch{}}},{key:"update",value:function(r,n,a,i){if(!this.isReady)return null;this._apply(this.storageKey(r,n),i),a&&this._apply(this.storageKey(r,a),i)}},{key:"_store",value:function(r,n){try{this.storage.setItem(r,JSON.stringify(n))}catch{}}},{key:"_read",value:function(r){try{var n=this.storage.getItem(r);if(n)return JSON.parse(n)}catch{}return null}},{key:"_apply",value:function(r,n){var a=this._read(r);if(!a)return!1;this._store(r,Object.assign(a,n))}}]),e}();function JJ(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=YJ(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function YJ(e,t){if(!!e){if(typeof e=="string")return RS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RS(e,t)}}function RS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hl=function(){function e(t,r){gt.default(this,e),this.services=t,this.removalHandler=r,this.subscriptionState="none",this._attachedListeners=new Map}return Tt.default(e,[{key:"_advanceLastEventId",value:function(r,n){}},{key:"reportFailure",value:function(r){r.status===404?this.onRemoved(!1):this.broadcastEventToListeners("failure",r)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(r){this.subscriptionState=r,this.broadcastEventToListeners("_subscriptionStateChanged",r)}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler!=null&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(r){var n=r.listenerUuid,a=this._attachedListeners.get(n);a||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(n,r))}},{key:"detach",value:function(r){this._attachedListeners.delete(r),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(r,n){var a=JJ(this._attachedListeners.values()),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;s.emit(r,n)}}catch(o){a.e(o)}finally{a.f()}}}]),e}(),cI=function(){function e(t){gt.default(this,e),Et.default(this,"queuedRequests",[]),Et.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return Tt.default(e,[{key:"add",value:function(r,n){var a=this,i=new Promise(function(s,o){return a.queuedRequests.push({input:r,requestFunction:n,resolve:s,reject:o})});return this.wakeupQueue(),i}},{key:"squashAndAdd",value:function(r,n){var a=this.queuedRequests;this.queuedRequests=[];var i;a.length>0?(i=a.map(function(o){return o.input}).reduce(this.inputMergingFunction),i=this.inputMergingFunction(i,r)):i=r;var s=this.add(i,n);return a.forEach(function(o){return s.then(o.resolve,o.reject)}),s}},{key:"isEmpty",value:function(){return this.queuedRequests.length===0&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var r=this;if(!(this.queuedRequests.length===0||this.isRequestInFlight)){var n=this.queuedRequests.shift();this.isRequestInFlight=!0,n.requestFunction(n.input).then(n.resolve,n.reject).then(function(a){r.isRequestInFlight=!1,r.wakeupQueue()})}}}]),e}(),fI=function(){function e(t){gt.default(this,e),Et.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}return Tt.default(e,[{key:"add",value:function(){var t=xe.default(z.default.mark(function n(a,i,s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(a,function(l){return l.add(i,s)}));case 1:case"end":return u.stop()}},n,this)}));function r(n,a,i){return t.apply(this,arguments)}return r}()},{key:"squashAndAdd",value:function(){var t=xe.default(z.default.mark(function n(a,i,s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.invokeQueueMethod(a,function(l){return l.squashAndAdd(i,s)}));case 1:case"end":return u.stop()}},n,this)}));function r(n,a,i){return t.apply(this,arguments)}return r}()},{key:"invokeQueueMethod",value:function(){var t=xe.default(z.default.mark(function n(a,i){var s,o;return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.queueByNamespaceKey.has(a)||this.queueByNamespaceKey.set(a,new cI(this.inputReducer)),s=this.queueByNamespaceKey.get(a),o=i(s),this.queueByNamespaceKey.get(a).isEmpty()&&this.queueByNamespaceKey.delete(a),l.abrupt("return",o);case 5:case"end":return l.stop()}},n,this)}));function r(n,a){return t.apply(this,arguments)}return r}()}]),e}();function QJ(e){var t=XJ();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function XJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var yl=function(e){xr.default(r,e);var t=QJ(r);function r(){var n;return gt.default(this,r),n=t.call(this),n.closed=!1,n.uuid=tI.v4(),n}return Tt.default(r,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),r}(Ct);function dI(e){var t=ZJ();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function ZJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var uh=function(e){xr.default(r,e);var t=dI(r);function r(n,a,i){var s;gt.default(this,r),s=t.call(this,n,i),Et.default(Jn.default(s),"isDeleted",!1);var o=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new cI(o),s.descriptor=a,s.descriptor.data=s.descriptor.data||{},s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return Tt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(a){switch(a.date_created=new Date(a.date_created),a.type){case"document_updated":if(a.id<=this.lastEventId){_t.trace("Document update skipped, current:",this.lastEventId,", remote:",a.id);break}var i=this.descriptor.data!==void 0?Pn(this.descriptor.data):null;this.descriptor.last_event_id=a.id,this.descriptor.revision=a.document_revision,this.descriptor.date_updated=a.date_created,this.descriptor.data=a.document_data,this.broadcastEventToListeners("updated",{data:a.document_data,isLocal:!1,previousData:i}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:a.id,revision:a.document_revision,date_updated:a.date_created,data:a.document_data});break;case"document_removed":this.onRemoved(!1);break}}},{key:"set",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u=this,l;return z.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=o||{},h.abrupt("return",this.updateMergingQueue.squashAndAdd(l,function(w){return u._setUnconditionally(s,w.ttl)}));case 2:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u=this,l;return z.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=o||{},h.abrupt("return",this.updateMergingQueue.add(l,function(w){return u._setWithIfMatch(s,w.ttl)}));case 2:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=xe.default(z.default.mark(function i(s,o){return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.mutate(function(c){return Object.assign(c,s)},o));case 1:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){var o;return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._postUpdateToServer({ttl:s});case 2:o=l.sent,this.descriptor.date_expires=o.date_expires;case 4:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_setUnconditionally",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u;return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._postUpdateToServer({data:s,revision:void 0,ttl:o});case 2:return u=c.sent,this._handleSuccessfulUpdateResult(u),c.abrupt("return",this.descriptor.data);case 5:case"end":return c.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_setWithIfMatch",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u,l,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(u=s(Pn(this.descriptor.data)),!u){w.next=22;break}return l=this.revision,w.prev=3,w.next=6,this._postUpdateToServer({data:u,revision:l,ttl:o});case 6:return c=w.sent,this._handleSuccessfulUpdateResult(c),w.abrupt("return",this.descriptor.data);case 11:if(w.prev=11,w.t0=w.catch(3),w.t0.status!==412){w.next=19;break}return w.next=16,this._softSync();case 16:return w.abrupt("return",this._setWithIfMatch(s));case 19:throw w.t0;case 20:w.next=23;break;case 22:return w.abrupt("return",this.descriptor.data);case 23:case"end":return w.stop()}},i,this,[[3,11]])}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_handleSuccessfulUpdateResult",value:function(a){if(!(a.last_event_id<=this.descriptor.last_event_id)){var i=this.descriptor.data!==void 0?Pn(this.descriptor.data):null;this.descriptor.revision=a.revision,this.descriptor.data=a.data,this.descriptor.last_event_id=a.last_event_id,this.descriptor.date_expires=a.date_expires,this.descriptor.date_updated=new Date(a.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:a.last_event_id,revision:a.revision,date_updated:a.date_updated,data:a.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:i})}}},{key:"_postUpdateToServer",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u,l;return z.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.isDeleted){h.next=17;break}return o={data:s.data},s.ttl!==void 0&&(o.ttl=s.ttl),u=s.revision,h.prev=4,h.next=7,this.services.network.post(this.uri,o,u);case 7:return l=h.sent,h.abrupt("return",{revision:l.body.revision,data:s.data,last_event_id:l.body.last_event_id,date_updated:l.body.date_updated,date_expires:l.body.date_expires});case 11:throw h.prev=11,h.t0=h.catch(4),h.t0.status===404&&this.onRemoved(!1),h.t0;case 15:h.next=18;break;case 17:return h.abrupt("return",Promise.reject(new Dr("The Document has been removed",404,54100)));case 18:case"end":return h.stop()}},i,this,[[4,11]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_softSync",value:function(){var n=xe.default(z.default.mark(function i(){var s=this;return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.network.get(this.uri).then(function(l){var c={type:"document_updated",id:l.body.last_event_id,document_revision:l.body.revision,document_data:l.body.data,date_created:l.body.date_updated};return s._update(c),s}).catch(function(l){l.status===404?s.onRemoved(!1):_t.error("Can't get updates for ".concat(s.sid,":"),l)}));case 1:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"onRemoved",value:function(a){if(!this.isDeleted){var i=this.descriptor.data!==void 0?Pn(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a,previousData:i})}}},{key:"removeDocument",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.isDeleted){o.next=6;break}return o.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),o.next=7;break;case 6:return o.abrupt("return",Promise.reject(new Dr("The Document has been removed",404,54100)));case 7:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()}],[{key:"type",get:function(){return"document"}}]),r}(hl),fn=function(e){xr.default(r,e);var t=dI(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncDocumentImpl=n,a.syncDocumentImpl.attach(Jn.default(a)),a}return Tt.default(r,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return uh.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:function(){var n=xe.default(z.default.mark(function i(s,o){return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.set(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=xe.default(z.default.mark(function i(s,o){return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.mutate(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=xe.default(z.default.mark(function i(s,o){return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.update(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncDocumentImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeDocument",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){pl.default(er.default(r.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return uh.type}}]),r}(yl);Et.default(fn,"removed","removed");Et.default(fn,"updated","updated");wt([$e.validateTypesAsync($e.pureObject,["undefined",$e.objectSchema("document metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object,Object]),Ce("design:returntype",Promise)],fn.prototype,"set",null);wt([$e.validateTypesAsync("function",["undefined",$e.objectSchema("document metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Function,Object]),Ce("design:returntype",Promise)],fn.prototype,"mutate",null);wt([$e.validateTypesAsync($e.pureObject,["undefined",$e.objectSchema("document metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object,Object]),Ce("design:returntype",Promise)],fn.prototype,"update",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number]),Ce("design:returntype",Promise)],fn.prototype,"setTtl",null);var lh=function(){function e(t){gt.default(this,e),this.descriptor=t}return Tt.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(r,n,a,i){return this.descriptor.lastEventId=r,this.descriptor.revision=n,this.descriptor.data=a,this.descriptor.dateUpdated=i,this}},{key:"updateDateExpires",value:function(r){this.descriptor.dateExpires=r}}]),e}(),wg=function(){function e(t,r,n,a){gt.default(this,e),this.prevToken=n,this.nextToken=a,this.items=t,this.source=r}return Tt.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:function(){var t=xe.default(z.default.mark(function n(){return z.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.hasNextPage){i.next=2;break}throw new Error("No next page");case 2:return i.abrupt("return",this.source(this.nextToken));case 3:case"end":return i.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"prevPage",value:function(){var t=xe.default(z.default.mark(function n(){return z.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.hasPrevPage){i.next=2;break}throw new Error("No previous page");case 2:return i.abrupt("return",this.source(this.prevToken));case 3:case"end":return i.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()}]),e}();function eY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=tY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function tY(e,t){if(!!e){if(typeof e=="string")return AS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AS(e,t)}}function AS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rY=function(){function e(t,r){gt.default(this,e),this.balanceFactor=0,this.key=t,this.value=r,this.parent=null,this.left=null,this.right=null}return Tt.default(e,[{key:"isRoot",get:function(){return this.parent===null}},{key:"isLeaf",get:function(){return this.left===null&&this.right===null}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(r){this.value=r}},{key:"replace",value:function(r,n){!r||(this.left===n?this.left=n:this.right===n&&(this.right=n))}}]),e}(),nY=function(){function e(t,r){gt.default(this,e),this.isLessThan=t||function(n,a){return n<a},this.isEqual=r||function(n,a){return n===a},this.root=null,this.count=null}return Tt.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(r,n){var a=this.getNode(r);a?a.update(n):this.insert(r,n)}},{key:"insert",value:function(r,n){var a=new rY(r,n);if(this.count++,!this.root){this.root=a;return}for(var i=this.root;;)if(this.isLessThan(r,i.key))if(i.left)i=i.left;else{i.left=a;break}else if(i.right)i=i.right;else{i.right=a;break}for(a.parent=i,i=a;i.parent;){var s=i.parent,o=s.balanceFactor;if(i.isLeftChild?s.balanceFactor++:s.balanceFactor--,Math.abs(s.balanceFactor)<Math.abs(o))break;if(s.balanceFactor<-1||s.balanceFactor>1){this.rebalance(s);break}i=s}}},{key:"get",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n.value;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"delete",value:function(r){var n=this.getNode(r);if(!n||n.key!==r)return null;var a=n.parent,i=n.left,s=n.right;if(!!i!=!!s){var o=i||s;!a&&!o?this.root=null:a&&!o?this.root=o:(a.replace(n,null),this.rebalance(a))}else{for(var u=n.left;u.right;)u=u.right;if(n.left===u)n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.balanceFactor=n.balanceFactor,n={parent:u,isLeftChild:!0};else{var l=u.parent,c=u.left;l.right=c,c&&(c.parent=l),n.isRoot?(this.root=u,u.parent=null):(n.isLeftChild?n.parent.left=u:n.parent.right=u,u.parent=n.parent),u.right=n.right,u.right.parent=u,u.left=n.left,u.left.parent=u,u.balanceFactor=n.balanceFactor,n={parent:l,isLeftChild:!1}}}for(this.count--;n.parent;){var h=n.parent,w=h.balanceFactor;if(n.isLeftChild?h.balanceFactor-=1:h.balanceFactor+=1,Math.abs(h.balanceFactor)>Math.abs(w))if(h.balanceFactor<-1||h.balanceFactor>1)if(this.rebalance(h),h.parent.balanceFactor===0)n=h.parent;else break;else break;else n=h}return null}},{key:"getNode",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"rebalance",value:function(r){r.balanceFactor<0?r.right.balanceFactor>0?(this.rotateRight(r.right),this.rotateLeft(r)):this.rotateLeft(r):r.balanceFactor>0&&(r.left.balanceFactor<0?(this.rotateLeft(r.left),this.rotateRight(r)):this.rotateRight(r))}},{key:"rotateLeft",value:function(r){var n=r.right;r.right=n.left,n.left!==null&&(n.left.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.left=r,r.parent=n,r.balanceFactor=r.balanceFactor+1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor+1-Math.max(r.balanceFactor,0)}},{key:"rotateRight",value:function(r){var n=r.left;r.left=n.right,n.right!==null&&(n.right.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.right=r,r.parent=n,r.balanceFactor=r.balanceFactor-1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor-1-Math.max(r.balanceFactor,0)}},{key:Symbol.iterator,value:z.default.mark(function t(){var r,n,a;return z.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=eY(this.getIterator()),s.prev=1,r.s();case 3:if((n=r.n()).done){s.next=9;break}return a=n.value,s.next=7,a;case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),r.e(s.t0);case 14:return s.prev=14,r.f(),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])})},{key:"getIterator",value:z.default.mark(function t(){var r,n,a,i=arguments;return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=i.length>0&&i[0]!==void 0?i[0]:null,n=this.root;case 2:if(!n){o.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.left)){o.next=5;break}return o.abrupt("break",8);case 5:this.isLessThan(r,n.key)||r===null?n=n.left:n=n.right,o.next=2;break;case 8:if(n){o.next=10;break}return o.abrupt("return",null);case 10:a=!0;case 11:if(!a){o.next=29;break}return o.next=14,[n.key,n.value];case 14:if(a=!1,!n.right){o.next=21;break}for(n=n.right;n.left;)n=n.left;a=!0,o.next=27;break;case 21:if(!n.parent){o.next=26;break}a=n.parent.left===n,n=n.parent,o.next=27;break;case 26:return o.abrupt("break",37);case 27:o.next=35;break;case 29:if(!n.parent){o.next=34;break}a=n.parent.left===n,n=n.parent,o.next=35;break;case 34:return o.abrupt("break",37);case 35:o.next=11;break;case 37:return o.abrupt("return",null);case 38:case"end":return o.stop()}},t,this)})},{key:"getReverseIterator",value:z.default.mark(function t(){var r,n,a,i=arguments;return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=i.length>0&&i[0]!==void 0?i[0]:null,n=this.root;case 2:if(!n){o.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.right)){o.next=5;break}return o.abrupt("break",8);case 5:!this.isLessThan(r,n.key)||r===null?n=n.right:n=n.left,o.next=2;break;case 8:if(n){o.next=10;break}return o.abrupt("return",null);case 10:a=!0;case 11:if(!a){o.next=29;break}return o.next=14,[n.key,n.value];case 14:if(a=!1,!n.left){o.next=21;break}for(n=n.left;n.right;)n=n.right;a=!0,o.next=27;break;case 21:if(!n.parent){o.next=26;break}a=n.parent.right===n,n=n.parent,o.next=27;break;case 26:return o.abrupt("break",37);case 27:o.next=35;break;case 29:if(!n.parent){o.next=34;break}a=n.parent.right===n,n=n.parent,o.next=35;break;case 34:return o.abrupt("break",37);case 35:o.next=11;break;case 37:return o.abrupt("return",null);case 38:case"end":return o.stop()}},t,this)})}]),e}();function aY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=iY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function iY(e,t){if(!!e){if(typeof e=="string")return OS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OS(e,t)}}function OS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sY=function(){function e(t,r){gt.default(this,e),this.value=t,this.revision=r||0}return Tt.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),oY=function(){function e(t){gt.default(this,e),this.revision=t}return Tt.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),_g=function(){function e(){gt.default(this,e),this.items=new nY}return Tt.default(e,[{key:"store",value:function(r,n,a){var i=this.items.get(r);return i&&i.revision>a?i.isValid?i.value:null:(this.items.set(r,new sY(n,a)),n)}},{key:"delete",value:function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.items.get(r);(!i||i.revision<n||i&&a===!0)&&this.items.set(r,new oY(n))}},{key:"isKnown",value:function(r,n){var a=this.items.get(r);return a&&a.revision>=n}},{key:"get",value:function(r){var n=this.items.get(r);return n&&n.isValid?n.value:null}},{key:"has",value:function(r){var n=this.items.get(r);return n&&n.isValid}},{key:"forEach",value:function(r){if(this.items){var n=aY(this.items),a;try{for(n.s();!(a=n.n()).done;){var i=nI.default(a.value,2),s=i[0],o=i[1];o.isValid&&r(s,o.value)}}catch(u){n.e(u)}finally{n.f()}}}}]),e}();function pI(e){var t=uY();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function uY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ch=function(e){xr.default(r,e);var t=pI(r);function r(n,a,i){var s;gt.default(this,r),s=t.call(this,n,i);var o=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new fI(o),s.cache=new _g,s.descriptor=a,s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return Tt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:function(){var n=xe.default(z.default.mark(function i(s,o,u,l){var c,h;return z.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c={data:o},l!==void 0&&(c.ttl=l),b.next=4,this.services.network.post(s,c,u);case 4:return h=b.sent,h.body.data=o,h.body.date_updated=new Date(h.body.date_updated),b.abrupt("return",h.body);case 8:case"end":return b.stop()}},i,this)}));function a(i,s,o,u){return n.apply(this,arguments)}return a}()},{key:"push",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u,l,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return u=(o||{}).ttl,w.next=3,this._addOrUpdateItemOnServer(this.links.items,s,void 0,u);case 3:return l=w.sent,c=Number(l.index),this._handleItemMutated(c,l.url,l.last_event_id,l.revision,s,l.date_updated,l.date_expires,!0,!1),w.abrupt("return",this.cache.get(c));case 7:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"set",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l=this,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.squashAndAdd(s,c,function(b){return l._updateItemUnconditionally(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_updateItemUnconditionally",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return l=w.sent,w.next=5,this._addOrUpdateItemOnServer(l.uri,o,void 0,u);case 5:return c=w.sent,this._handleItemMutated(s,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,!1,!1),w.abrupt("return",this.cache.get(s));case 8:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_updateItemWithIfMatch",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l,c,h,w;return z.default.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,this.get(s);case 2:if(l=$.sent,c=o(Pn(l.data)),!c){$.next=25;break}return h=l.revision,$.prev=6,$.next=9,this._addOrUpdateItemOnServer(l.uri,c,h,u);case 9:return w=$.sent,this._handleItemMutated(s,w.url,w.last_event_id,w.revision,w.data,w.date_updated,w.date_expires,!1,!1),$.abrupt("return",this.cache.get(s));case 14:if($.prev=14,$.t0=$.catch(6),$.t0.status!==412){$.next=22;break}return $.next=19,this._getItemFromServer(s);case 19:return $.abrupt("return",this._updateItemWithIfMatch(s,o,u));case 22:throw $.t0;case 23:$.next=26;break;case 25:return $.abrupt("return",l);case 26:case"end":return $.stop()}},i,this,[[6,14]])}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l=this,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.add(s,c,function(b){return l._updateItemWithIfMatch(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(s,function(h){return Object.assign(h,o)},u));case 1:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u,l;return z.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.get(s);case 2:return o=h.sent,u=Pn(o.data),h.next=6,this.services.network.delete(o.uri);case 6:l=h.sent,this._handleItemRemoved(s,l.body.last_event_id,u,new Date(l.body.date_updated),!1);case 8:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=xe.default(z.default.mark(function i(s){var o;return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(o=this.cache.get(s),!o){l.next=5;break}return l.abrupt("return",o);case 5:return l.abrupt("return",this._getItemFromServer(s));case 6:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getItemFromServer",value:function(){var n=xe.default(z.default.mark(function i(s){var o;return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({index:s});case 2:if(o=l.sent,!(o.items.length<1)){l.next=7;break}throw new Dr("No item with index ".concat(s," found"),404,54151);case 7:return l.abrupt("return",o.items[0]);case 8:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"queryItems",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this,u,l,c,h;return z.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},u=new vo(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Index",s.index).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(u);case 4:return l=b.sent,c=l.body.items.map(function($){$.date_updated=new Date($.date_updated);var A=o.cache.get($.index);return A?o._handleItemMutated($.index,$.url,$.last_event_id,$.revision,$.data,$.date_updated,$.date_expires,!1,!0):o.cache.store(Number($.index),new lh({index:Number($.index),uri:$.url,revision:$.revision,lastEventId:$.last_event_id,dateUpdated:$.date_updated,dateExpires:$.date_expires,data:$.data}),$.last_event_id),o.cache.get($.index)}),h=l.body.meta,b.abrupt("return",new wg(c,function($){return o.queryItems({pageToken:$})},h.previous_token,h.next_token));case 8:case"end":return b.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s=s||{},lI(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",u.abrupt("return",this.queryItems(s));case 5:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getContext",value:function(){var n=xe.default(z.default.mark(function i(){var s;return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.context){u.next=5;break}return u.next=3,this.services.network.get(this.links.context);case 3:s=u.sent,this._updateContextIfRequired(s.body.data,s.body.last_event_id);case 5:return u.abrupt("return",this.context);case 6:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u;return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,o={ttl:s},c.next=4,this.services.network.post(this.uri,o);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u,l,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return u=w.sent,l={ttl:o},w.next=6,this.services.network.post(u.uri,l);case 6:c=w.sent,u.updateDateExpires(c.body.date_expires);case 8:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeList",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}},{key:"shouldIgnoreEvent",value:function(a,i){return this.cache.isKnown(a,i)}},{key:"_update",value:function(a,i){var s=Number(a.item_index);switch(a.date_created=new Date(a.date_created),a.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(s,a.item_url,a.id,a.item_revision,a.item_data,a.date_created,void 0,a.type==="list_item_added",!0);break;case"list_item_removed":this._handleItemRemoved(s,a.id,a.item_data,a.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(a.context_data,a.id,a.date_created);break;case"list_removed":this.onRemoved(!1);break}i&&this._advanceLastEventId(a.id,a.list_revision)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a,i&&(this.descriptor.revision=i))}},{key:"_updateRootDateUpdated",value:function(a){(!this.descriptor.date_updated||a.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=a,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:a}))}},{key:"_handleItemMutated",value:function(a,i,s,o,u,l,c,h,w){if(this.shouldIgnoreEvent(a,s)){_t.trace("Item ".concat(a," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(s));return}this._updateRootDateUpdated(l);var b=this.cache.get(a);if(!b){var $=new lh({index:a,uri:i,lastEventId:s,revision:o,data:u,dateUpdated:l,dateExpires:c});this.cache.store(a,$,s),this.emitItemMutationEvent($,w,h);return}var A=Pn(b.data);b.update(s,o,u,l),this.cache.store(a,b,s),c!==void 0&&b.updateDateExpires(c),this.emitItemMutationEvent(b,w,!1,A)}},{key:"emitItemMutationEvent",value:function(a,i,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=s?"itemAdded":"itemUpdated",l={item:a,isLocal:!i};s||(l.previousItemData=o),this.broadcastEventToListeners(u,l)}},{key:"_handleItemRemoved",value:function(a,i,s,o,u){this._updateRootDateUpdated(o),this.cache.delete(a,i),this.broadcastEventToListeners("itemRemoved",{index:a,isLocal:!u,previousItemData:s})}},{key:"_handleContextUpdate",value:function(a,i,s){this._updateRootDateUpdated(s),this._updateContextIfRequired(a,i)&&this.broadcastEventToListeners("contextUpdated",{context:a,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(a,i){return!this.contextEventId||i>this.contextEventId?(this.context=a,this.contextEventId=i,!0):(_t.trace("Context update skipped, current:",this.lastEventId,", remote:",i),!1)}}],[{key:"type",get:function(){return"list"}}]),r}(hl),rr=function(e){xr.default(r,e);var t=pI(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncListImpl=n,a.syncListImpl.attach(Jn.default(a)),a}return Tt.default(r,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return ch.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:function(){var n=xe.default(z.default.mark(function i(s,o){return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.push(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"set",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.set(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.mutate(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.update(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.remove(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.get(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getContext",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.getItems(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=xe.default(z.default.mark(function i(s,o){return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.setItemTtl(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeList",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){pl.default(er.default(r.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return ch.type}}]),r}(yl);Et.default(rr,"itemAdded","itemAdded");Et.default(rr,"itemUpdated","itemUpdated");Et.default(rr,"itemRemoved","itemRemoved");Et.default(rr,"removed","removed");wt([$e.validateTypesAsync($e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object,Object]),Ce("design:returntype",Promise)],rr.prototype,"push",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Number,Object,Object]),Ce("design:returntype",Promise)],rr.prototype,"set",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,"function",["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Number,Function,Object]),Ce("design:returntype",Promise)],rr.prototype,"mutate",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Number,Object,Object]),Ce("design:returntype",Promise)],rr.prototype,"update",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number]),Ce("design:returntype",Promise)],rr.prototype,"remove",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number]),Ce("design:returntype",Promise)],rr.prototype,"get",null);wt([$e.validateTypesAsync(["undefined",$e.objectSchema("query options",{from:[$e.nonNegativeInteger,"undefined"],pageSize:[$e.custom(function(e){return[bg(e),"a positive integer"]}),"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],rr.prototype,"getItems",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number]),Ce("design:returntype",Promise)],rr.prototype,"setTtl",null);wt([$e.validateTypesAsync($e.nonNegativeInteger,$e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number,Number]),Ce("design:returntype",Promise)],rr.prototype,"setItemTtl",null);var cu=function(){function e(t){gt.default(this,e),this.descriptor=t}return Tt.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(r,n,a,i){return this.descriptor.last_event_id=r,this.descriptor.revision=n,this.descriptor.data=a,this.descriptor.date_updated=i,this}},{key:"updateDateExpires",value:function(r){this.descriptor.date_expires=r}}]),e}();function vI(e){var t=lY();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function lY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fh=function(e){xr.default(r,e);var t=vI(r);function r(n,a,i){var s;gt.default(this,r),s=t.call(this,n,i);var o=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new fI(o),s.cache=new _g,s.descriptor=a,s.descriptor.date_updated=new Date(s.descriptor.date_updated),a.items&&a.items.forEach(function(u){u.date_updated=new Date(u.date_updated),s.cache.store(u.key,new cu(u),u.last_event_id)}),s}return Tt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l=this,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.squashAndAdd(s,c,function(b){return l._putItemUnconditionally(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(s!=null){u.next=2;break}throw new Dr("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(s)){u.next=6;break}return u.abrupt("return",this.cache.get(s));case 6:return u.abrupt("return",this._getItemFromServer(s));case 7:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getItemFromServer",value:function(){var n=xe.default(z.default.mark(function i(s){var o;return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({key:s});case 2:if(o=l.sent,!(o.items.length<1)){l.next=7;break}throw new Dr("The specified Map Item does not exist",404,54201);case 7:return l.abrupt("return",o.items[0]);case 8:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l=this,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=u||{},w.abrupt("return",this.updateMergingQueue.add(s,c,function(b){return l._putItemWithIfMatch(s,o,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(s,function(h){return Object.assign(h,o)},u));case 1:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_putItemUnconditionally",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._putItemToServer(s,o,void 0,u);case 2:return l=w.sent,c=l.item,this._handleItemMutated(c.key,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,l.added,!1),w.abrupt("return",this.cache.get(c.key));case 6:case"end":return w.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_putItemWithIfMatch",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){var l,c,h,w,b;return z.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.get(s).catch(function(x){if(x.status===404)return new cu({key:s,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw x});case 2:if(l=A.sent,c=o(Pn(l.data)),!c){A.next=26;break}return h=l.revision,A.prev=6,A.next=9,this._putItemToServer(s,c,h,u);case 9:return w=A.sent,b=w.item,this._handleItemMutated(b.key,b.url,b.last_event_id,b.revision,b.data,b.date_updated,b.date_expires,w.added,!1),A.abrupt("return",this.cache.get(b.key));case 15:if(A.prev=15,A.t0=A.catch(6),A.t0.status!==412){A.next=23;break}return A.next=20,this._getItemFromServer(s);case 20:return A.abrupt("return",this._putItemWithIfMatch(s,o,u));case 23:throw A.t0;case 24:A.next=27;break;case 26:return A.abrupt("return",l);case 27:case"end":return A.stop()}},i,this,[[6,15]])}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"_putItemToServer",value:function(){var n=xe.default(z.default.mark(function i(s,o,u,l){var c,h,w,b,$;return z.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return c=new vo(this.links.items).pathSegment(s).build(),h={data:o},l!==void 0&&(h.ttl=l),x.prev=3,x.next=6,this.services.network.put(c,h,u);case 6:return w=x.sent,b=w.body,b.data=o,b.date_updated=new Date(b.date_updated),$=w.status.code===201,x.abrupt("return",{added:$,item:b});case 14:throw x.prev=14,x.t0=x.catch(3),x.t0.status===404&&this.onRemoved(!1),x.t0;case 18:case"end":return x.stop()}},i,this,[[3,14]])}));function a(i,s,o,u){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u,l;return z.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.get(s);case 2:return o=h.sent,u=Pn(o.data),h.next=6,this.services.network.delete(o.uri);case 6:l=h.sent,this._handleItemRemoved(s,l.body.last_event_id,u,new Date(l.body.date_updated),!1);case 8:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"queryItems",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this,u,l,c,h;return z.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},u=new vo(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Key",s.key).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(u);case 4:return l=b.sent,c=l.body.items.map(function($){$.date_updated=new Date($.date_updated);var A=o.cache.get($.key);return A?o._handleItemMutated($.key,$.url,$.last_event_id,$.revision,$.data,$.date_updated,$.date_expires,!1,!0):o.cache.store($.key,new cu($),$.last_event_id),o.cache.get($.key)}),h=l.body.meta,b.abrupt("return",new wg(c,function($){return o.queryItems({pageToken:$})},h.previous_token,h.next_token));case 8:case"end":return b.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return s=s||{},lI(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",u.abrupt("return",this.queryItems(s));case 5:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"shouldIgnoreEvent",value:function(a,i){return this.cache.isKnown(a,i)}},{key:"_update",value:function(a,i){switch(a.date_created=new Date(a.date_created),a.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(a.item_key,a.item_url,a.id,a.item_revision,a.item_data,a.date_created,void 0,a.type==="map_item_added",!0);break;case"map_item_removed":this._handleItemRemoved(a.item_key,a.id,a.item_data,a.date_created,!0);break;case"map_removed":this.onRemoved(!1);break}i&&this._advanceLastEventId(a.id,a.map_revision)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a,i&&(this.descriptor.revision=i))}},{key:"_updateRootDateUpdated",value:function(a){(!this.descriptor.date_updated||a.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=a,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:a}))}},{key:"_handleItemMutated",value:function(a,i,s,o,u,l,c,h,w){if(this.shouldIgnoreEvent(a,s)){_t.trace("SyncMapItem ",a," update skipped, current:",this.lastEventId,", remote:",s);return}this._updateRootDateUpdated(l);var b=this.cache.get(a);if(!b){var $=new cu({key:a,url:i,last_event_id:s,revision:o,data:u,date_updated:l,date_expires:c});this.cache.store(a,$,s),this.emitItemMutationEvent($,w,h);return}var A=Pn(b.data);b.update(s,o,u,l),this.cache.store(a,b,s),c!==void 0&&b.updateDateExpires(c),this.emitItemMutationEvent(b,w,!1,A)}},{key:"emitItemMutationEvent",value:function(a,i,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=s?"itemAdded":"itemUpdated",l={item:a,isLocal:!i};s||(l.previousItemData=o),this.broadcastEventToListeners(u,l)}},{key:"_handleItemRemoved",value:function(a,i,s,o,u){this._updateRootDateUpdated(o),this.cache.delete(a,i),this.broadcastEventToListeners("itemRemoved",{key:a,isLocal:!u,previousItemData:s})}},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u;return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,o={ttl:s},c.next=4,this.services.network.post(this.uri,o);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u,l,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return u=w.sent,l={ttl:o},w.next=6,this.services.network.post(u.uri,l);case 6:c=w.sent,u.updateDateExpires(c.body.date_expires);case 8:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeMap",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()}],[{key:"type",get:function(){return"map"}}]),r}(hl),ar=function(e){xr.default(r,e);var t=vI(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncMapImpl=n,a.syncMapImpl.attach(Jn.default(a)),a}return Tt.default(r,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return fh.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.set(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.get(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.mutate(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=xe.default(z.default.mark(function i(s,o,u){return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.update(s,o,u));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,o){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.remove(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.getItems(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncMapImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=xe.default(z.default.mark(function i(s,o){return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncMapImpl.setItemTtl(s,o));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeMap",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.next=3,this.syncMapImpl.removeMap();case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){pl.default(er.default(r.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return fh.type}}]),r}(yl);Et.default(ar,"itemAdded","itemAdded");Et.default(ar,"itemUpdated","itemUpdated");Et.default(ar,"itemRemoved","itemRemoved");Et.default(ar,"removed","removed");wt([$e.validateTypesAsync("string",$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[String,Object,Object]),Ce("design:returntype",Promise)],ar.prototype,"set",null);wt([$e.validateTypesAsync("string"),Ce("design:type",Function),Ce("design:paramtypes",[String]),Ce("design:returntype",Promise)],ar.prototype,"get",null);wt([$e.validateTypesAsync("string","function",["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[String,Function,Object]),Ce("design:returntype",Promise)],ar.prototype,"mutate",null);wt([$e.validateTypesAsync("string",$e.pureObject,["undefined",$e.objectSchema("item metadata",{ttl:[$e.nonNegativeInteger,"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[String,Object,Object]),Ce("design:returntype",Promise)],ar.prototype,"update",null);wt([$e.validateTypesAsync("string"),Ce("design:type",Function),Ce("design:paramtypes",[String]),Ce("design:returntype",Promise)],ar.prototype,"remove",null);wt([$e.validateTypesAsync(["undefined",$e.objectSchema("query options",{from:["string","undefined"],pageSize:[$e.custom(function(e){return[bg(e),"a positive integer"]}),"undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],ar.prototype,"getItems",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number]),Ce("design:returntype",Promise)],ar.prototype,"setTtl",null);wt([$e.validateTypesAsync("string",$e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[String,Number]),Ce("design:returntype",Promise)],ar.prototype,"setItemTtl",null);function hI(e){var t=cY();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function cY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Du=function(e){xr.default(r,e);var t=hI(r);function r(n,a,i){var s;return gt.default(this,r),s=t.call(this,n,i),s.descriptor=a,s}return Tt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u,l,c;return z.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return o={data:s},w.next=3,this.services.network.post(this.links.messages,o);case 3:return u=w.sent,l=u.body,c=this._handleMessagePublished(l.sid,s,!1),w.abrupt("return",c);case 7:case"end":return w.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u;return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,o={ttl:s},c.next=4,this.services.network.post(this.uri,o);case 4:u=c.sent,this.descriptor.date_expires=u.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeStream",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"_update",value:function(a){switch(a.type){case"stream_message_published":{this._handleMessagePublished(a.message_sid,a.message_data,!0);break}case"stream_removed":{this.onRemoved(!1);break}}}},{key:"_handleMessagePublished",value:function(a,i,s){var o={sid:a,data:i};return this.broadcastEventToListeners("messagePublished",{message:o,isLocal:!s}),o}},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}}],[{key:"type",get:function(){return"stream"}}]),r}(hl);wt([$e.validateTypesAsync($e.pureObject),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],Du.prototype,"publishMessage",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number]),Ce("design:returntype",Promise)],Du.prototype,"setTtl",null);var Vn=function(e){xr.default(r,e);var t=hI(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.syncStreamImpl=n,a.syncStreamImpl.attach(Jn.default(a)),a}return Tt.default(r,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return Du.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.publishMessage(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.setTtl(s));case 2:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeStream",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){pl.default(er.default(r.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Du.type}}]),r}(yl);Et.default(Vn,"messagePublished","messagePublished");Et.default(Vn,"removed","removed");wt([$e.validateTypesAsync($e.pureObject),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],Vn.prototype,"publishMessage",null);wt([$e.validateTypesAsync($e.nonNegativeInteger),Ce("design:type",Function),Ce("design:paramtypes",[Number]),Ce("design:returntype",Promise)],Vn.prototype,"setTtl",null);var fY=function e(t){gt.default(this,e),this.sdk="js",this.sdkVer=t,this.os=Xl.os.family,this.osVer=Xl.os.version,this.pl=Xl.name,this.plVer=Xl.version},dY=function(){function e(){gt.default(this,e),this.names=new Map,this.entities=new Map}return Tt.default(e,[{key:"store",value:function(r){var n=this.entities.get(r.sid);return n||(this.entities.set(r.sid,r),r.uniqueName&&this.names.set(r.type+"::"+r.uniqueName,r.sid),r)}},{key:"getResolved",value:function(r,n){var a=this.names.get(n+"::"+r);return a?this.entities.get(a):null}},{key:"get",value:function(r,n){return this.entities.get(r)||this.getResolved(r,n)||null}},{key:"remove",value:function(r){var n=this.entities.get(r);n&&(this.entities.delete(r),n.uniqueName&&this.names.delete(n.type+"::"+n.uniqueName))}}]),e}();function Sg(e){var t=pY();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function pY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vY=function e(){gt.default(this,e)},dh=function(e){xr.default(r,e);var t=Sg(r);function r(n,a,i,s){var o;return gt.default(this,r),o=t.call(this,a,i),o.descriptor=n,o.cache=new _g,s&&s.forEach(function(u){o.cache.store(u.key,{key:u.key,value:u.data},u.revision)}),o}return Tt.default(r,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return r.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var a={};return this.cache.forEach(function(i,s){a[i]=s.value}),a}},{key:"_update",value:function(a,i){switch(a.type){case"live_query_item_updated":this.handleItemMutated(a.item_key,a.item_data,a.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(a.item_key,a.item_revision);break;case"live_query_updated":this.handleBatchUpdate(a.items);break}i&&this._advanceLastEventId(a.last_event_id)}},{key:"handleItemMutated",value:function(a,i,s){if(this.shouldIgnoreEvent(a,s))_t.trace("Item ".concat(a," update skipped, revision: ").concat(s));else{var o={key:a,value:i};this.cache.store(a,o,s),this.broadcastEventToListeners("itemUpdated",o)}}},{key:"handleItemRemoved",value:function(a,i){var s=i===null;this.shouldIgnoreEvent(a,i)?_t.trace("Item ".concat(a," delete skipped, revision: ").concat(i)):(this.cache.delete(a,i,s),this.broadcastEventToListeners("itemRemoved",{key:a}))}},{key:"handleBatchUpdate",value:function(a){var i=this,s={};a!=null&&a.forEach(function(u){s[u.key]={data:u.data,revision:u.revision}}),this.cache.forEach(function(u,l){var c=s[u];c!=null?i.handleItemMutated(u,c.data,c.revision):i.handleItemRemoved(u,null),delete s[u]});for(var o in s)this.handleItemMutated(o,s[o].data,s[o].revision)}},{key:"shouldIgnoreEvent",value:function(a,i){return a!=null&&i!=null&&this.cache.isKnown(a,i)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a)}}],[{key:"type",get:function(){return"live_query"}}]),r}(hl);function yI(e){return ph.apply(this,arguments)}function ph(){return ph=xe.default(z.default.mark(function e(t){var r,n,a,i,s,o;return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(r=t.network,n=t.queryString,a=t.uri,i=t.type,n!=null){l.next=3;break}throw new Dr("Invalid query",400,54507);case 3:return s={query_string:n},i===ya.type&&(s.type=i),l.next=7,r.post(a,s,void 0,!0);case 7:return o=l.sent,l.abrupt("return",o.body);case 9:case"end":return l.stop()}},e)})),ph.apply(this,arguments)}var ya=function(e){xr.default(r,e);var t=Sg(r);function r(n){var a;return gt.default(this,r),a=t.call(this),a.liveQueryImpl=n,a.liveQueryImpl.attach(Jn.default(a)),a}return Tt.default(r,[{key:"type",get:function(){return dh.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){pl.default(er.default(r.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return dh.type}}]),r}(yl);Et.default(ya,"itemUpdated","itemUpdated");Et.default(ya,"itemRemoved","itemRemoved");var gl=function(e){xr.default(r,e);var t=Sg(r);function r(n){var a;return gt.default(this,r),a=t.call(this),Et.default(Jn.default(a),"queryExpression",null),Et.default(Jn.default(a),"items",{}),Object.assign(Jn.default(a),n),a.updateIndexName(n.indexName),a}return Tt.default(r,[{key:"type",get:function(){return r.type}},{key:"search",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this;return z.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.items={},l.abrupt("return",yI({network:this.network,uri:this.queryUri,queryString:s}).then(function(c){o.queryExpression=s,c.items&&c.items.forEach(function(h){o.items[h.key]=h.data}),o.emit("searchResult",o.getItems())}).catch(function(c){throw _t.error("Error '".concat(c.message,"' while executing query '").concat(s,"'")),o.queryExpression=null,c}));case 2:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"subscribe",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.queryExpression!=null){o.next=2;break}return o.abrupt("return",Promise.reject(new Dr("Invalid query",400,54507)));case 2:return o.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(a){this.indexName=a,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(a){return new vo(this.insightsUri).pathSegment(a).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),r}(Ct);Et.default(gl,"searchResult","searchResult");wt([$e.validateTypesAsync("string"),Ce("design:type",Function),Ce("design:paramtypes",[String]),Ce("design:returntype",Promise)],gl.prototype,"search",null);wt([$e.validateTypes($e.nonEmptyString),Ce("design:type",Function),Ce("design:paramtypes",[String]),Ce("design:returntype",void 0)],gl.prototype,"updateIndexName",null);var hY="3.1.0";function yY(e){var t=gY();return function(){var n=er.default(e),a;if(t){var i=er.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $i.default(this,a)}}function gY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function PS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function MS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PS(Object(r),!0).forEach(function(n){Et.default(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var mY="data_sync",Rp=hY;function Zl(e){if(e){if(typeof e=="string")return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return MS(MS({},e),{},{mode:t})}else return{mode:"create_new"}}var xS="com.twilio.rtd.cds.document",NS="com.twilio.rtd.cds.list",LS="com.twilio.rtd.cds.map",jS="twilio.sync.event",en=function(e){xr.default(r,e);var t=yY(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(gt.default(this,r),a=t.call(this),!n)throw new Error("Sync library needs a valid Twilio token to be passed");i.hasOwnProperty("logLevel")?_t.setLevel(i.logLevel):_t.setLevel("silent");var s=i.productId=i.productId||mY;i.clientMetadata=i.clientMetadata||{},i.clientMetadata.hasOwnProperty("type")||(i.clientMetadata.type="sync"),i.clientMetadata.hasOwnProperty("sdk")||(i.clientMetadata.sdk="JS",i.clientMetadata.sdkv=Rp);var o=!i.twilsockClient;if(!i.initRegistrations){var u=new qc.InitRegistration(s);r.populateInitRegistrations(u),i.initRegistrations=[u]}var l=i.twilsockClient=i.twilsockClient||new qc.Twilsock(n,s,i);l.on("tokenAboutToExpire",function(b){return a.emit("tokenAboutToExpire",b)}),l.on("tokenExpired",function(){return a.emit("tokenExpired")}),l.on("connectionError",function(b){return a.emit("connectionError",b)}),l.on("stateChanged",function(b){a.emit("connectionStateChanged",b),a.services.subscriptions.onConnectionStateChanged(b==="connected")}),l.on("message",function(b,$){return a._routeMessage(b,$)});var c=new FJ(i),h=new VJ(new fY(Rp),c,l),w=new KJ(c);return a.services={config:c,twilsock:l,network:h,storage:w,router:Jn.default(a),subscriptions:null},a.services.subscriptions=new qJ(a.services),a.entities=new dY,o&&l.connect(),a}return Tt.default(r,[{key:"_routeMessage",value:function(a,i){switch(_t.trace("Notification type:",a,"content:",i),a){case xS:case NS:case LS:this.services.subscriptions.acceptMessage(i,!1);break;case jS:this.services.subscriptions.acceptMessage(i,!0);break}}},{key:"_subscribe",value:function(a,i){this.services.subscriptions.add(a,i)}},{key:"_unsubscribe",value:function(a){this.services.subscriptions.remove(a)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:function(){var n=xe.default(z.default.mark(function i(){var s;return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.services.config.sessionStorageEnabled){u.next=2;break}return u.abrupt("return");case 2:return u.prev=2,u.next=5,this.services.twilsock.storageId();case 5:s=u.sent,this.services.storage.updateStorageId(s.id),u.next=12;break;case 9:u.prev=9,u.t0=u.catch(2),_t.warn("Failed to initialize storage",u.t0);case 12:case"end":return u.stop()}},i,this,[[2,9]])}));function a(){return n.apply(this,arguments)}return a}()},{key:"storeRootInSessionCache",value:function(a,i,s){if(!(!this.services.config.sessionStorageEnabled||!i)){var o=Pn(s);(a===rr.type||a===ar.type)&&(o.last_event_id=null,delete o.items),this.services.storage.store(a,i,o)}}},{key:"readRootFromSessionCache",value:function(a,i){return!this.services.config.sessionStorageEnabled||!i?null:this.services.storage.read(a,i)}},{key:"_get",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u,l,c,h=arguments;return z.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(u=h.length>2&&h[2]!==void 0?h[2]:!1,o){b.next=3;break}throw new Dr("Cannot get entity without id",404);case 3:return l=new vo(s).pathSegment(o).queryParam("Include",u?"items":void 0).build(),b.next=6,this.services.network.get(l);case 6:return c=b.sent,b.abrupt("return",c.body);case 8:case"end":return b.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_createDocument",value:function(a,i,s){var o={unique_name:a,data:i||{}};return s!==void 0&&(o.ttl=s),this.services.network.post(this.services.config.documentsUri,o).then(function(u){return u.body.data=o.data,u.body})}},{key:"_getDocument",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(fn.type,s)||this._get(this.services.config.documentsUri,s));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createList",value:function(a,i,s,o){var u={unique_name:a,purpose:i,context:s};return o!==void 0&&(u.ttl=o),this.services.network.post(this.services.config.listsUri,u).then(function(l){return l.body})}},{key:"_getList",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(rr.type,s)||this._get(this.services.config.listsUri,s));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createMap",value:function(a,i){var s={unique_name:a};return i!==void 0&&(s.ttl=i),this.services.network.post(this.services.config.mapsUri,s).then(function(o){return o.body})}},{key:"_getMap",value:function(){var n=xe.default(z.default.mark(function i(s){var o,u=arguments;return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=u.length>1&&u[1]!==void 0?u[1]:!1,c.abrupt("return",this.readRootFromSessionCache(ar.type,s)||this._get(this.services.config.mapsUri,s,o));case 2:case"end":return c.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getStream",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.readRootFromSessionCache(Vn.type,s)||this._get(this.services.config.streamsUri,s,!1));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createStream",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u,l;return z.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return u={unique_name:s},o!==void 0&&(u.ttl=o),h.next=4,this.services.network.post(this.services.config.streamsUri,u);case 4:return l=h.sent,h.abrupt("return",l.body);case 6:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_getLiveQuery",value:function(a){return this.readRootFromSessionCache(ya.type,a)}},{key:"getCached",value:function(a,i){return a&&this.entities.get(a,i)||null}},{key:"removeFromCacheAndSession",value:function(a,i,s){this.entities.remove(i),this.services.config.sessionStorageEnabled&&this.services.storage.remove(a,i,s)}},{key:"document",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this,u,l,c,h;return z.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=Zl(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createDocument(u.id,u.data,u.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(u.id,fn.type),!c){b.next=14;break}return b.abrupt("return",new fn(c));case 14:return b.prev=14,b.next=17,this._getDocument(u.id);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createDocument(u.id,u.data,u.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.document(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(fn.type,u.id,l),h=new uh(this.services,l,function($,A,x){return o.removeFromCacheAndSession($,A,x)}),h=this.entities.store(h),b.abrupt("return",new fn(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"map",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this,u,l,c,h;return z.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=Zl(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createMap(u.id,u.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(u.id,ar.type),!c){b.next=14;break}return b.abrupt("return",new ar(c));case 14:return b.prev=14,b.next=17,this._getMap(u.id,u.includeItems);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createMap(u.id,u.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.map(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(ar.type,u.id,l),h=new fh(this.services,l,function($,A,x){return o.removeFromCacheAndSession($,A,x)}),h=this.entities.store(h),b.abrupt("return",new ar(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"list",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this,u,l,c,h;return z.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(u=Zl(s),u.mode!=="create_new"){b.next=9;break}return b.next=6,this._createList(u.id,u.purpose,u.context,u.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(u.id,rr.type),!c){b.next=14;break}return b.abrupt("return",new rr(c));case 14:return b.prev=14,b.next=17,this._getList(u.id);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||u.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createList(u.id,u.purpose,u.context,u.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.list(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(rr.type,u.id,l),h=new ch(this.services,l,function($,A,x){return o.removeFromCacheAndSession($,A,x)}),h=this.entities.store(h),b.abrupt("return",new rr(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"stream",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this,u,l,c,h,w;return z.default.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,this.ensureReady();case 2:if(u=Zl(s),u.mode!=="create_new"){$.next=9;break}return $.next=6,this._createStream(u.id,u.ttl);case 6:l=$.sent,$.next=39;break;case 9:if(c=this.getCached(u.id,Vn.type),!c){$.next=14;break}return $.abrupt("return",new Vn(c));case 14:return $.prev=14,$.next=17,this._getStream(u.id);case 17:l=$.sent,$.next=39;break;case 20:if($.prev=20,$.t0=$.catch(14),!($.t0.status!==404||u.mode==="open_existing")){$.next=26;break}throw $.t0;case 26:return $.prev=26,$.next=29,this._createStream(u.id,u.ttl);case 29:l=$.sent,$.next=39;break;case 32:if($.prev=32,$.t1=$.catch(26),$.t1.status!==409){$.next=38;break}return $.abrupt("return",this.stream(s));case 38:throw $.t1;case 39:return this.storeRootInSessionCache(Vn.type,u.id,l),h=function(x,U,D){return o.removeFromCacheAndSession(x,U,D)},w=new Du(this.services,l,h),w=this.entities.store(w),$.abrupt("return",new Vn(w));case 44:case"end":return $.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"shutdown",value:function(){var n=xe.default(z.default.mark(function i(){return z.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.services.subscriptions.shutdown();case 2:return o.next=4,this.services.twilsock.disconnect();case 4:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"updateToken",value:function(){var n=xe.default(z.default.mark(function i(s){return z.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",this.services.twilsock.updateToken(s).catch(function(l){var c,h=l==null||(c=l.reply)===null||c===void 0?void 0:c.status;throw(h==null?void 0:h.code)===401&&(h==null?void 0:h.status)==="UNAUTHORIZED"?new Dr("Updated token was rejected by server",400,51130):l}));case 1:case"end":return u.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"liveQuery",value:function(){var n=xe.default(z.default.mark(function i(s,o){var u=this,l,c,h,w,b;return z.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.ensureReady();case 2:return l=new vo(this.services.config.insightsUri).pathSegment(s).pathSegment("Items").build(),A.next=5,yI({network:this.services.network,uri:l,queryString:o,type:ya.type});case 5:return c=A.sent,h=this.getCached(c.query_id,ya.type),h||(w=this._getLiveQuery(c.query_id),w||(w={indexName:s,queryExpression:o,sid:c.query_id,queryUri:l,last_event_id:c.last_event_id}),b=function(U,D,de){return u.removeFromCacheAndSession(U,D,de)},h=new dh(w,this.services,b,c.items)),this.storeRootInSessionCache(ya.type,c.query_id,h.liveQueryDescriptor),h=this.entities.store(h),A.abrupt("return",new ya(h));case 11:case"end":return A.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"instantQuery",value:function(){var n=xe.default(z.default.mark(function i(s){var o=this,u;return z.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.ensureReady();case 2:return u=function(w,b){return o.liveQuery(w,b)},c.abrupt("return",new gl({indexName:s,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:u}));case 4:case"end":return c.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()}],[{key:"populateInitRegistrations",value:function(a){a.populateInitRegistrations([jS,xS,NS,LS])}},{key:"version",get:function(){return Rp}}]),r}(Ct);Et.default(en,"connectionStateChanged","connectionStateChanged");Et.default(en,"connectionError","connectionError");Et.default(en,"tokenAboutToExpire","tokenAboutToExpire");Et.default(en,"tokenExpired","tokenExpired");wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open document options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],en.prototype,"document",null);wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open map options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)],includeItems:["boolean","undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],en.prototype,"map",null);wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open list options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)],purpose:["string","undefined"],context:[$e.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],en.prototype,"list",null);wt([$e.validateTypesAsync(["undefined","string",$e.objectSchema("open stream options",{id:["string","undefined"],mode:[$e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[$e.nonNegativeInteger,"undefined"],data:[$e.pureObject,"undefined",$e.literal(null)]})]),Ce("design:type",Function),Ce("design:paramtypes",[Object]),Ce("design:returntype",Promise)],en.prototype,"stream",null);wt([$e.validateTypesAsync($e.nonEmptyString),Ce("design:type",Function),Ce("design:paramtypes",[String]),Ce("design:returntype",Promise)],en.prototype,"updateToken",null);wt([$e.validateTypesAsync($e.nonEmptyString,"string"),Ce("design:type",Function),Ce("design:paramtypes",[String,String]),Ce("design:returntype",Promise)],en.prototype,"liveQuery",null);wt([$e.validateTypesAsync($e.nonEmptyString),Ce("design:type",Function),Ce("design:paramtypes",[String]),Ce("design:returntype",Promise)],en.prototype,"instantQuery",null);Br.Client=en;Br.InsightsItem=vY;Br.InstantQuery=gl;Br.LiveQuery=ya;Br.Paginator=wg;Br.SyncClient=en;Br.SyncDocument=fn;Br.SyncList=rr;Br.SyncListItem=lh;Br.SyncMap=ar;Br.SyncMapItem=cu;Br.SyncStream=Vn;var gI={},bY=GE,wY=TypeError,mI=function(e){if(bY(e))throw wY("The method doesn't accept regular expressions");return e},_Y=Mt,SY=_Y("match"),bI=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[SY]=!1,"/./"[e](t)}catch{}}return!1},$Y=ot,wI=tt,TY=Xn.f,kY=Ca,US=lr,EY=mI,IY=ea,CY=bI,FS=wI("".startsWith),RY=wI("".slice),AY=Math.min,_I=CY("startsWith"),OY=!_I&&!!function(){var e=TY(String.prototype,"startsWith");return e&&!e.writable}();$Y({target:"String",proto:!0,forced:!OY&&!_I},{startsWith:function(t){var r=US(IY(this));EY(t);var n=kY(AY(arguments.length>1?arguments[1]:void 0,r.length)),a=US(t);return FS?FS(r,a,n):RY(r,n,n+a.length)===a}});var PY=ot,MY=dg.left,xY=ll,DS=os,NY=il,LY=xY("reduce"),jY=!NY&&DS>79&&DS<83;PY({target:"Array",proto:!0,forced:!LY||jY},{reduce:function(t){var r=arguments.length;return MY(this,t,r,r>1?arguments[1]:void 0)}});var UY=at,FY=Mt,DY=Nx,BY=FY("iterator"),SI=!UY(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(n,a){t.delete("b"),r+=a+n}),DY&&!e.toJSON||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[BY]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||r!=="a1c3"||new URL("http://x",void 0).host!=="x"}),BS=Yh.exports,qY=tr,HY=function(e,t,r){return r.get&&BS(r.get,t,{getter:!0}),r.set&&BS(r.set,t,{setter:!0}),qY.f(e,t,r)},ys=tt,Ap=2147483647,_u=36,$I=1,vh=26,WY=38,GY=700,zY=72,VY=128,KY="-",JY=/[^\0-\u007E]/,TI=/[.\u3002\uFF0E\uFF61]/g,qS="Overflow: input needs wider integers to process",Op=_u-$I,HS=RangeError,YY=ys(TI.exec),zs=Math.floor,Pp=String.fromCharCode,WS=ys("".charCodeAt),kI=ys([].join),Qa=ys([].push),QY=ys("".replace),XY=ys("".split),ZY=ys("".toLowerCase),eQ=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=WS(e,r++);if(a>=55296&&a<=56319&&r<n){var i=WS(e,r++);(i&64512)==56320?Qa(t,((a&1023)<<10)+(i&1023)+65536):(Qa(t,a),r--)}else Qa(t,a)}return t},GS=function(e){return e+22+75*(e<26)},tQ=function(e,t,r){var n=0;for(e=r?zs(e/GY):e>>1,e+=zs(e/t);e>Op*vh>>1;)e=zs(e/Op),n+=_u;return zs(n+(Op+1)*e/(e+WY))},rQ=function(e){var t=[];e=eQ(e);var r=e.length,n=VY,a=0,i=zY,s,o;for(s=0;s<e.length;s++)o=e[s],o<128&&Qa(t,Pp(o));var u=t.length,l=u;for(u&&Qa(t,KY);l<r;){var c=Ap;for(s=0;s<e.length;s++)o=e[s],o>=n&&o<c&&(c=o);var h=l+1;if(c-n>zs((Ap-a)/h))throw HS(qS);for(a+=(c-n)*h,n=c,s=0;s<e.length;s++){if(o=e[s],o<n&&++a>Ap)throw HS(qS);if(o==n){for(var w=a,b=_u;;){var $=b<=i?$I:b>=i+vh?vh:b-i;if(w<$)break;var A=w-$,x=_u-$;Qa(t,Pp(GS($+A%x))),w=zs(A/x),b+=_u}Qa(t,Pp(GS(w))),i=tQ(a,h,l==u),a=0,l++}}a++,n++}return kI(t,"")},nQ=function(e){var t=[],r=XY(QY(ZY(e),TI,"."),"."),n,a;for(n=0;n<r.length;n++)a=r[n],Qa(t,YY(JY,a)?"xn--"+rQ(a):a);return kI(t,".")},hh=ot,ho=ft,ec=Ot,Qn=tt,aQ=Ht,EI=SI,II=Tr,iQ=Gy,sQ=Ra,oQ=UT,$g=gn,CI=ds,Mp=Pt,uQ=Jt,lQ=Oa,cQ=Aa,fQ=Qt,RI=Kt,Vr=lr,dQ=hi,zS=is,yh=kf,pQ=ul,Ns=vy,vQ=Mt,hQ=vg,yQ=vQ("iterator"),ml="URLSearchParams",AI=ml+"Iterator",OI=$g.set,kn=$g.getterFor(ml),gQ=$g.getterFor(AI),mQ=Object.getOwnPropertyDescriptor,Tg=function(e){if(!aQ)return ho[e];var t=mQ(ho,e);return t&&t.value},VS=Tg("fetch"),Hc=Tg("Request"),Su=Tg("Headers"),xp=Hc&&Hc.prototype,KS=Su&&Su.prototype,bQ=ho.RegExp,wQ=ho.TypeError,PI=ho.decodeURIComponent,_Q=ho.encodeURIComponent,SQ=Qn("".charAt),JS=Qn([].join),Gi=Qn([].push),gh=Qn("".replace),$Q=Qn([].shift),YS=Qn([].splice),QS=Qn("".split),TQ=Qn("".slice),kQ=/\+/g,XS=Array(4),EQ=function(e){return XS[e-1]||(XS[e-1]=bQ("((?:%[\\da-f]{2}){"+e+"})","gi"))},IQ=function(e){try{return PI(e)}catch{return e}},ZS=function(e){var t=gh(e,kQ," "),r=4;try{return PI(t)}catch{for(;r;)t=gh(t,EQ(r--),IQ);return t}},CQ=/[!'()~]|%20/g,RQ={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},AQ=function(e){return RQ[e]},e0=function(e){return gh(_Q(e),CQ,AQ)},Np=oQ(function(t,r){OI(this,{type:AI,iterator:yh(kn(t).entries),kind:r})},"Iterator",function(){var t=gQ(this),r=t.kind,n=t.iterator.next(),a=n.value;return n.done||(n.value=r==="keys"?a.key:r==="values"?a.value:[a.key,a.value]),n},!0),MI=function(e){this.entries=[],this.url=null,e!==void 0&&(RI(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?SQ(e,0)==="?"?TQ(e,1):e:Vr(e)))};MI.prototype={type:ml,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t=pQ(e),r,n,a,i,s,o,u;if(t)for(r=yh(e,t),n=r.next;!(a=ec(n,r)).done;){if(i=yh(fQ(a.value)),s=i.next,(o=ec(s,i)).done||(u=ec(s,i)).done||!ec(s,i).done)throw wQ("Expected sequence with length 2");Gi(this.entries,{key:Vr(o.value),value:Vr(u.value)})}else for(var l in e)uQ(e,l)&&Gi(this.entries,{key:l,value:Vr(e[l])})},parseQuery:function(e){if(e)for(var t=QS(e,"&"),r=0,n,a;r<t.length;)n=t[r++],n.length&&(a=QS(n,"="),Gi(this.entries,{key:ZS($Q(a)),value:ZS(JS(a,"="))}))},serialize:function(){for(var e=this.entries,t=[],r=0,n;r<e.length;)n=e[r++],Gi(t,e0(n.key)+"="+e0(n.value));return JS(t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Yf=function(){CI(this,Bu);var t=arguments.length>0?arguments[0]:void 0;OI(this,new MI(t))},Bu=Yf.prototype;iQ(Bu,{append:function(t,r){Ns(arguments.length,2);var n=kn(this);Gi(n.entries,{key:Vr(t),value:Vr(r)}),n.updateURL()},delete:function(e){Ns(arguments.length,1);for(var t=kn(this),r=t.entries,n=Vr(e),a=0;a<r.length;)r[a].key===n?YS(r,a,1):a++;t.updateURL()},get:function(t){Ns(arguments.length,1);for(var r=kn(this).entries,n=Vr(t),a=0;a<r.length;a++)if(r[a].key===n)return r[a].value;return null},getAll:function(t){Ns(arguments.length,1);for(var r=kn(this).entries,n=Vr(t),a=[],i=0;i<r.length;i++)r[i].key===n&&Gi(a,r[i].value);return a},has:function(t){Ns(arguments.length,1);for(var r=kn(this).entries,n=Vr(t),a=0;a<r.length;)if(r[a++].key===n)return!0;return!1},set:function(t,r){Ns(arguments.length,1);for(var n=kn(this),a=n.entries,i=!1,s=Vr(t),o=Vr(r),u=0,l;u<a.length;u++)l=a[u],l.key===s&&(i?YS(a,u--,1):(i=!0,l.value=o));i||Gi(a,{key:s,value:o}),n.updateURL()},sort:function(){var t=kn(this);hQ(t.entries,function(r,n){return r.key>n.key?1:-1}),t.updateURL()},forEach:function(t){for(var r=kn(this).entries,n=lQ(t,arguments.length>1?arguments[1]:void 0),a=0,i;a<r.length;)i=r[a++],n(i.value,i.key,this)},keys:function(){return new Np(this,"keys")},values:function(){return new Np(this,"values")},entries:function(){return new Np(this,"entries")}},{enumerable:!0});II(Bu,yQ,Bu.entries,{name:"entries"});II(Bu,"toString",function(){return kn(this).serialize()},{enumerable:!0});sQ(Yf,ml);hh({global:!0,constructor:!0,forced:!EI},{URLSearchParams:Yf});if(!EI&&Mp(Su)){var OQ=Qn(KS.has),PQ=Qn(KS.set),t0=function(e){if(RI(e)){var t=e.body,r;if(cQ(t)===ml)return r=e.headers?new Su(e.headers):new Su,OQ(r,"content-type")||PQ(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),dQ(e,{body:zS(0,Vr(t)),headers:zS(0,r)})}return e};if(Mp(VS)&&hh({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return VS(t,arguments.length>1?t0(arguments[1]):{})}}),Mp(Hc)){var Lp=function(t){return CI(this,xp),new Hc(t,arguments.length>1?t0(arguments[1]):{})};xp.constructor=Lp,Lp.prototype=xp,hh({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Lp})}}var MQ={URLSearchParams:Yf,getState:kn},xQ=ot,kg=Ht,NQ=SI,Eg=ft,r0=Oa,mn=tt,Wc=Tr,sn=HY,LQ=ds,mh=Jt,Ig=QE,Ls=NT,Tn=el,jQ=$y.codeAt,UQ=nQ,ua=lr,FQ=Ra,DQ=vy,xI=MQ,NI=gn,BQ=NI.set,Gc=NI.getterFor("URL"),qQ=xI.URLSearchParams,HQ=xI.getState,iu=Eg.URL,bh=Eg.TypeError,zc=Eg.parseInt,WQ=Math.floor,n0=Math.pow,cn=mn("".charAt),Cn=mn(/./.exec),fu=mn([].join),GQ=mn(1 .toString),zQ=mn([].pop),Hs=mn([].push),a0=mn("".replace),VQ=mn([].shift),KQ=mn("".split),$u=mn("".slice),Vc=mn("".toLowerCase),JQ=mn([].unshift),YQ="Invalid authority",jp="Invalid scheme",Li="Invalid host",i0="Invalid port",LI=/[a-z]/i,QQ=/[\d+-.a-z]/i,wh=/\d/,XQ=/^0x/i,ZQ=/^[0-7]+$/,eX=/^\d+$/,jI=/^[\da-f]+$/i,tX=/[\0\t\n\r #%/:<>?@[\\\]^|]/,rX=/[\0\t\n\r #/:<>?@[\\\]^|]/,nX=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,aX=/[\t\n\r]/g,on,iX=function(e){var t=KQ(e,"."),r,n,a,i,s,o,u;if(t.length&&t[t.length-1]==""&&t.length--,r=t.length,r>4)return e;for(n=[],a=0;a<r;a++){if(i=t[a],i=="")return e;if(s=10,i.length>1&&cn(i,0)=="0"&&(s=Cn(XQ,i)?16:8,i=$u(i,s==8?1:2)),i==="")o=0;else{if(!Cn(s==10?eX:s==8?ZQ:jI,i))return e;o=zc(i,s)}Hs(n,o)}for(a=0;a<r;a++)if(o=n[a],a==r-1){if(o>=n0(256,5-r))return null}else if(o>255)return null;for(u=zQ(n),a=0;a<n.length;a++)u+=n[a]*n0(256,3-a);return u},sX=function(e){var t=[0,0,0,0,0,0,0,0],r=0,n=null,a=0,i,s,o,u,l,c,h,w=function(){return cn(e,a)};if(w()==":"){if(cn(e,1)!=":")return;a+=2,r++,n=r}for(;w();){if(r==8)return;if(w()==":"){if(n!==null)return;a++,r++,n=r;continue}for(i=s=0;s<4&&Cn(jI,w());)i=i*16+zc(w(),16),a++,s++;if(w()=="."){if(s==0||(a-=s,r>6))return;for(o=0;w();){if(u=null,o>0)if(w()=="."&&o<4)a++;else return;if(!Cn(wh,w()))return;for(;Cn(wh,w());){if(l=zc(w(),10),u===null)u=l;else{if(u==0)return;u=u*10+l}if(u>255)return;a++}t[r]=t[r]*256+u,o++,(o==2||o==4)&&r++}if(o!=4)return;break}else if(w()==":"){if(a++,!w())return}else if(w())return;t[r++]=i}if(n!==null)for(c=r-n,r=7;r!=0&&c>0;)h=t[r],t[r--]=t[n+c-1],t[n+--c]=h;else if(r!=8)return;return t},oX=function(e){for(var t=null,r=1,n=null,a=0,i=0;i<8;i++)e[i]!==0?(a>r&&(t=n,r=a),n=null,a=0):(n===null&&(n=i),++a);return a>r&&(t=n,r=a),t},su=function(e){var t,r,n,a;if(typeof e=="number"){for(t=[],r=0;r<4;r++)JQ(t,e%256),e=WQ(e/256);return fu(t,".")}else if(typeof e=="object"){for(t="",n=oX(e),r=0;r<8;r++)a&&e[r]===0||(a&&(a=!1),n===r?(t+=r?":":"::",a=!0):(t+=GQ(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},yc={},UI=Ig({},yc,{" ":1,'"':1,"<":1,">":1,"`":1}),FI=Ig({},UI,{"#":1,"?":1,"{":1,"}":1}),Up=Ig({},FI,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ga=function(e,t){var r=jQ(e,0);return r>32&&r<127&&!mh(t,e)?e:encodeURIComponent(e)},tc={ftp:21,file:null,http:80,https:443,ws:80,wss:443},du=function(e,t){var r;return e.length==2&&Cn(LI,cn(e,0))&&((r=cn(e,1))==":"||!t&&r=="|")},s0=function(e){var t;return e.length>1&&du($u(e,0,2))&&(e.length==2||(t=cn(e,2))==="/"||t==="\\"||t==="?"||t==="#")},uX=function(e){return e==="."||Vc(e)==="%2e"},lX=function(e){return e=Vc(e),e===".."||e==="%2e."||e===".%2e"||e==="%2e%2e"},Fp={},o0={},Dp={},u0={},l0={},Bp={},c0={},f0={},rc={},nc={},qp={},Hp={},Wp={},Gp={},d0={},zp={},js={},Hn={},p0={},ji={},oa={},Cg=function(e,t,r){var n=ua(e),a,i,s;if(t){if(i=this.parse(n),i)throw bh(i);this.searchParams=null}else{if(r!==void 0&&(a=new Cg(r,!0)),i=this.parse(n,null,a),i)throw bh(i);s=HQ(new qQ),s.bindURL(this),this.searchParams=s}};Cg.prototype={type:"URL",parse:function(e,t,r){var n=this,a=t||Fp,i=0,s="",o=!1,u=!1,l=!1,c,h,w,b;for(e=ua(e),t||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,e=a0(e,nX,"")),e=a0(e,aX,""),c=Ls(e);i<=c.length;){switch(h=c[i],a){case Fp:if(h&&Cn(LI,h))s+=Vc(h),a=o0;else{if(t)return jp;a=Dp;continue}break;case o0:if(h&&(Cn(QQ,h)||h=="+"||h=="-"||h=="."))s+=Vc(h);else if(h==":"){if(t&&(n.isSpecial()!=mh(tc,s)||s=="file"&&(n.includesCredentials()||n.port!==null)||n.scheme=="file"&&!n.host))return;if(n.scheme=s,t){n.isSpecial()&&tc[n.scheme]==n.port&&(n.port=null);return}s="",n.scheme=="file"?a=Gp:n.isSpecial()&&r&&r.scheme==n.scheme?a=u0:n.isSpecial()?a=f0:c[i+1]=="/"?(a=l0,i++):(n.cannotBeABaseURL=!0,Hs(n.path,""),a=p0)}else{if(t)return jp;s="",a=Dp,i=0;continue}break;case Dp:if(!r||r.cannotBeABaseURL&&h!="#")return jp;if(r.cannotBeABaseURL&&h=="#"){n.scheme=r.scheme,n.path=Tn(r.path),n.query=r.query,n.fragment="",n.cannotBeABaseURL=!0,a=oa;break}a=r.scheme=="file"?Gp:Bp;continue;case u0:if(h=="/"&&c[i+1]=="/")a=rc,i++;else{a=Bp;continue}break;case l0:if(h=="/"){a=nc;break}else{a=Hn;continue}case Bp:if(n.scheme=r.scheme,h==on)n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=Tn(r.path),n.query=r.query;else if(h=="/"||h=="\\"&&n.isSpecial())a=c0;else if(h=="?")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=Tn(r.path),n.query="",a=ji;else if(h=="#")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=Tn(r.path),n.query=r.query,n.fragment="",a=oa;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=Tn(r.path),n.path.length--,a=Hn;continue}break;case c0:if(n.isSpecial()&&(h=="/"||h=="\\"))a=rc;else if(h=="/")a=nc;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,a=Hn;continue}break;case f0:if(a=rc,h!="/"||cn(s,i+1)!="/")continue;i++;break;case rc:if(h!="/"&&h!="\\"){a=nc;continue}break;case nc:if(h=="@"){o&&(s="%40"+s),o=!0,w=Ls(s);for(var $=0;$<w.length;$++){var A=w[$];if(A==":"&&!l){l=!0;continue}var x=Ga(A,Up);l?n.password+=x:n.username+=x}s=""}else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()){if(o&&s=="")return YQ;i-=Ls(s).length+1,s="",a=qp}else s+=h;break;case qp:case Hp:if(t&&n.scheme=="file"){a=zp;continue}else if(h==":"&&!u){if(s=="")return Li;if(b=n.parseHost(s),b)return b;if(s="",a=Wp,t==Hp)return}else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()){if(n.isSpecial()&&s=="")return Li;if(t&&s==""&&(n.includesCredentials()||n.port!==null))return;if(b=n.parseHost(s),b)return b;if(s="",a=js,t)return;continue}else h=="["?u=!0:h=="]"&&(u=!1),s+=h;break;case Wp:if(Cn(wh,h))s+=h;else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()||t){if(s!=""){var U=zc(s,10);if(U>65535)return i0;n.port=n.isSpecial()&&U===tc[n.scheme]?null:U,s=""}if(t)return;a=js;continue}else return i0;break;case Gp:if(n.scheme="file",h=="/"||h=="\\")a=d0;else if(r&&r.scheme=="file")if(h==on)n.host=r.host,n.path=Tn(r.path),n.query=r.query;else if(h=="?")n.host=r.host,n.path=Tn(r.path),n.query="",a=ji;else if(h=="#")n.host=r.host,n.path=Tn(r.path),n.query=r.query,n.fragment="",a=oa;else{s0(fu(Tn(c,i),""))||(n.host=r.host,n.path=Tn(r.path),n.shortenPath()),a=Hn;continue}else{a=Hn;continue}break;case d0:if(h=="/"||h=="\\"){a=zp;break}r&&r.scheme=="file"&&!s0(fu(Tn(c,i),""))&&(du(r.path[0],!0)?Hs(n.path,r.path[0]):n.host=r.host),a=Hn;continue;case zp:if(h==on||h=="/"||h=="\\"||h=="?"||h=="#"){if(!t&&du(s))a=Hn;else if(s==""){if(n.host="",t)return;a=js}else{if(b=n.parseHost(s),b)return b;if(n.host=="localhost"&&(n.host=""),t)return;s="",a=js}continue}else s+=h;break;case js:if(n.isSpecial()){if(a=Hn,h!="/"&&h!="\\")continue}else if(!t&&h=="?")n.query="",a=ji;else if(!t&&h=="#")n.fragment="",a=oa;else if(h!=on&&(a=Hn,h!="/"))continue;break;case Hn:if(h==on||h=="/"||h=="\\"&&n.isSpecial()||!t&&(h=="?"||h=="#")){if(lX(s)?(n.shortenPath(),h!="/"&&!(h=="\\"&&n.isSpecial())&&Hs(n.path,"")):uX(s)?h!="/"&&!(h=="\\"&&n.isSpecial())&&Hs(n.path,""):(n.scheme=="file"&&!n.path.length&&du(s)&&(n.host&&(n.host=""),s=cn(s,0)+":"),Hs(n.path,s)),s="",n.scheme=="file"&&(h==on||h=="?"||h=="#"))for(;n.path.length>1&&n.path[0]==="";)VQ(n.path);h=="?"?(n.query="",a=ji):h=="#"&&(n.fragment="",a=oa)}else s+=Ga(h,FI);break;case p0:h=="?"?(n.query="",a=ji):h=="#"?(n.fragment="",a=oa):h!=on&&(n.path[0]+=Ga(h,yc));break;case ji:!t&&h=="#"?(n.fragment="",a=oa):h!=on&&(h=="'"&&n.isSpecial()?n.query+="%27":h=="#"?n.query+="%23":n.query+=Ga(h,yc));break;case oa:h!=on&&(n.fragment+=Ga(h,UI));break}i++}},parseHost:function(e){var t,r,n;if(cn(e,0)=="["){if(cn(e,e.length-1)!="]"||(t=sX($u(e,1,-1)),!t))return Li;this.host=t}else if(this.isSpecial()){if(e=UQ(e),Cn(tX,e)||(t=iX(e),t===null))return Li;this.host=t}else{if(Cn(rX,e))return Li;for(t="",r=Ls(e),n=0;n<r.length;n++)t+=Ga(r[n],yc);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return mh(tc,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;t&&(this.scheme!="file"||t!=1||!du(e[0],!0))&&e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,a=e.host,i=e.port,s=e.path,o=e.query,u=e.fragment,l=t+":";return a!==null?(l+="//",e.includesCredentials()&&(l+=r+(n?":"+n:"")+"@"),l+=su(a),i!==null&&(l+=":"+i)):t=="file"&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+fu(s,"/"):"",o!==null&&(l+="?"+o),u!==null&&(l+="#"+u),l},setHref:function(e){var t=this.parse(e);if(t)throw bh(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new yo(e.path[0]).origin}catch{return"null"}return e=="file"||!this.isSpecial()?"null":e+"://"+su(this.host)+(t!==null?":"+t:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(ua(e)+":",Fp)},getUsername:function(){return this.username},setUsername:function(e){var t=Ls(ua(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Ga(t[r],Up)}},getPassword:function(){return this.password},setPassword:function(e){var t=Ls(ua(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Ga(t[r],Up)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?su(e):su(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,qp)},getHostname:function(){var e=this.host;return e===null?"":su(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Hp)},getPort:function(){var e=this.port;return e===null?"":ua(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=ua(e),e==""?this.port=null:this.parse(e,Wp))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+fu(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,js))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=ua(e),e==""?this.query=null:(cn(e,0)=="?"&&(e=$u(e,1)),this.query="",this.parse(e,ji)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){if(e=ua(e),e==""){this.fragment=null;return}cn(e,0)=="#"&&(e=$u(e,1)),this.fragment="",this.parse(e,oa)},update:function(){this.query=this.searchParams.serialize()||null}};var yo=function(t){var r=LQ(this,Pr),n=DQ(arguments.length,1)>1?arguments[1]:void 0,a=BQ(r,new Cg(t,!1,n));kg||(r.href=a.serialize(),r.origin=a.getOrigin(),r.protocol=a.getProtocol(),r.username=a.getUsername(),r.password=a.getPassword(),r.host=a.getHost(),r.hostname=a.getHostname(),r.port=a.getPort(),r.pathname=a.getPathname(),r.search=a.getSearch(),r.searchParams=a.getSearchParams(),r.hash=a.getHash())},Pr=yo.prototype,un=function(e,t){return{get:function(){return Gc(this)[e]()},set:t&&function(r){return Gc(this)[t](r)},configurable:!0,enumerable:!0}};kg&&(sn(Pr,"href",un("serialize","setHref")),sn(Pr,"origin",un("getOrigin")),sn(Pr,"protocol",un("getProtocol","setProtocol")),sn(Pr,"username",un("getUsername","setUsername")),sn(Pr,"password",un("getPassword","setPassword")),sn(Pr,"host",un("getHost","setHost")),sn(Pr,"hostname",un("getHostname","setHostname")),sn(Pr,"port",un("getPort","setPort")),sn(Pr,"pathname",un("getPathname","setPathname")),sn(Pr,"search",un("getSearch","setSearch")),sn(Pr,"searchParams",un("getSearchParams")),sn(Pr,"hash",un("getHash","setHash")));Wc(Pr,"toJSON",function(){return Gc(this).serialize()},{enumerable:!0});Wc(Pr,"toString",function(){return Gc(this).serialize()},{enumerable:!0});if(iu){var v0=iu.createObjectURL,h0=iu.revokeObjectURL;v0&&Wc(yo,"createObjectURL",r0(v0,iu)),h0&&Wc(yo,"revokeObjectURL",r0(h0,iu))}FQ(yo,"URL");xQ({global:!0,constructor:!0,forced:!NQ,sham:!kg},{URL:yo});var Cr={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Cr,"__esModule",{value:!0});var cX=Fn.exports,fX=mi.exports,dX=bi.exports,pX=ra.exports,vX=Dn.exports,hX=jn.exports,yX=Un.exports,gX=Xr.exports;function Ti(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var no=Ti(cX),Ta=Ti(fX),Vp=Ti(dX),mX=Ti(pX),bX=Ti(vX),wX=Ti(hX),_X=Ti(yX),y0=Ti(gX),La=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function SX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=$X(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function $X(e,t){if(!!e){if(typeof e=="string")return g0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g0(e,t)}}function g0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DI=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return La(function(a){var i=!1,s=[],o=SX(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;if(typeof l=="string"){i=i||no.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function TX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=kX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function kX(e,t){if(!!e){if(typeof e=="string")return m0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m0(e,t)}}function m0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var EX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return La(function(a){var i=!1,s=[],o=TX(r),u;try{for(o.s();!(u=o.n()).done;){var l=u.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){o.e(c)}finally{o.f()}return[i,s]})};function IX(e){var t=CX();return function(){var n=y0.default(e),a;if(t){var i=y0.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return _X.default(this,a)}}function CX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=RX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function RX(e,t){if(!!e){if(typeof e=="string")return b0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b0(e,t)}}function b0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Qf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=qu(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=Ta.default(a.value,2),s=i[0],o=i[1],u=Zf(t[s],o),l=Ta.default(u,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(A){n.e(A)}finally{n.f()}},BI=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(no.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),no.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=no.default(t)),n},AX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Rg(r);return function(i){return function(s){wX.default(u,s);var o=IX(u);function u(){bX.default(this,u);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Qf(a,c),o.call.apply(o,[this].concat(c))}return mX.default(u)}(i)}},OX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Rg(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Qf(a,c),u.apply(this,c)}}},PX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Rg(r);return function(i,s,o){if(typeof o.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var u=o.value;o.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Qf(a,c)}catch(w){return Promise.reject(w)}return u.apply(this,c)}}},Rg=function(t){var r=[],n=qu(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Xf(i))}}catch(s){n.e(s)}finally{n.f()}return r},Xf=function(t){var r=[],n=Array.isArray(t)?t:[t],a=qu(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(DI(s));continue}r.push(s)}}catch(o){a.e(o)}finally{a.f()}return r},Zf=function(t,r){var n=[],a,i=!1,s=qu(t),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=qu(u.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=Ta.default(w,3),$=b[0],A=b[1],x=b[2];i=i||$,!a&&x&&(a=x),A&&(n=typeof A=="string"?[].concat(Vp.default(n),[A]):[].concat(Vp.default(n),Vp.default(A)))}}catch(ue){l.e(ue)}finally{l.f()}}}catch(ue){s.e(ue)}finally{s.f()}if(i)return[!0];var U=a||BI(r),D=n.length-1,de=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,U,de,D>1?";":","]};function MX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=xX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function xX(e,t){if(!!e){if(typeof e=="string")return w0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w0(e,t)}}function w0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var NX=function(t,r){return La(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=MX(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=Ta.default(i.value,2),o=s[0],u=s[1],l=Zf(Xf(r),u),c=Ta.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},LX=La(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),jX=La(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),UX=La(function(e){return[no.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),FX=function(t,r){return La(function(n){if(no.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=Ta.default(i[a],2),o=s[0],u=s[1],l=Zf(Xf(u),n[o]),c=Ta.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(o,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(o,'" is ').concat(w,")")]}return[!0]})};function DX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=BX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,o;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,o=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}}}function BX(e,t){if(!!e){if(typeof e=="string")return _0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _0(e,t)}}function _0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qX=function(t,r){return La(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=DX(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=Ta.default(i.value,2),o=s[0],u=s[1],l=Zf(Xf(r),u),c=Ta.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(o," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(o," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Cr.array=qX;Cr.custom=La;Cr.literal=EX;Cr.nonEmptyArray=NX;Cr.nonEmptyString=LX;Cr.nonNegativeInteger=jX;Cr.objectSchema=FX;Cr.pureObject=UX;Cr.runtimeTypeValidation=Qf;Cr.stringifyReceivedType=BI;Cr.type=DI;Cr.validateConstructorTypes=AX;Cr.validateTypes=OX;Cr.validateTypesAsync=PX;/*
@license
Copyright (c) 2018, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=gi.exports,n=$o.exports,a=cl,i=ps.exports,s=xa,o=Cr;function u(oe){return oe&&typeof oe=="object"&&"default"in oe?oe:{default:oe}}function l(oe){if(oe&&oe.__esModule)return oe;var F=Object.create(null);return oe&&Object.keys(oe).forEach(function(H){if(H!=="default"){var Y=Object.getOwnPropertyDescriptor(oe,H);Object.defineProperty(F,H,Y.get?Y:{enumerable:!0,get:function(){return oe[H]}})}}),F.default=oe,Object.freeze(F)}var c=u(r),h=u(n),w=u(a),b=l(i),$={exports:{}},A=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(A){var x=new Uint8Array(16);$.exports=function(){return A(x),x}}else{var U=new Array(16);$.exports=function(){for(var F=0,H;F<16;F++)(F&3)===0&&(H=Math.random()*4294967296),U[F]=H>>>((F&3)<<3)&255;return U}}for(var D=[],de=0;de<256;++de)D[de]=(de+256).toString(16).substr(1);function ue(oe,F){var H=F||0,Y=D;return[Y[oe[H++]],Y[oe[H++]],Y[oe[H++]],Y[oe[H++]],"-",Y[oe[H++]],Y[oe[H++]],"-",Y[oe[H++]],Y[oe[H++]],"-",Y[oe[H++]],Y[oe[H++]],"-",Y[oe[H++]],Y[oe[H++]],Y[oe[H++]],Y[oe[H++]],Y[oe[H++]],Y[oe[H++]]].join("")}var Ae=ue,we=$.exports,he=Ae,P,Q,ce=0,W=0;function ve(oe,F,H){var Y=F&&H||0,ge=F||[];oe=oe||{};var Ne=oe.node||P,qe=oe.clockseq!==void 0?oe.clockseq:Q;if(Ne==null||qe==null){var ze=we();Ne==null&&(Ne=P=[ze[0]|1,ze[1],ze[2],ze[3],ze[4],ze[5]]),qe==null&&(qe=Q=(ze[6]<<8|ze[7])&16383)}var De=oe.msecs!==void 0?oe.msecs:new Date().getTime(),He=oe.nsecs!==void 0?oe.nsecs:W+1,Le=De-ce+(He-W)/1e4;if(Le<0&&oe.clockseq===void 0&&(qe=qe+1&16383),(Le<0||De>ce)&&oe.nsecs===void 0&&(He=0),He>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ce=De,W=He,Q=qe,De+=122192928e5;var Z=((De&268435455)*1e4+He)%4294967296;ge[Y++]=Z>>>24&255,ge[Y++]=Z>>>16&255,ge[Y++]=Z>>>8&255,ge[Y++]=Z&255;var ne=De/4294967296*1e4&268435455;ge[Y++]=ne>>>8&255,ge[Y++]=ne&255,ge[Y++]=ne>>>24&15|16,ge[Y++]=ne>>>16&255,ge[Y++]=qe>>>8|128,ge[Y++]=qe&255;for(var q=0;q<6;++q)ge[Y+q]=Ne[q];return F||he(ge)}var te=ve,ae=$.exports,J=Ae;function ie(oe,F,H){var Y=F&&H||0;typeof oe=="string"&&(F=oe==="binary"?new Array(16):null,oe=null),oe=oe||{};var ge=oe.random||(oe.rng||ae)();if(ge[6]=ge[6]&15|64,ge[8]=ge[8]&63|128,F)for(var Ne=0;Ne<16;++Ne)F[Y+Ne]=ge[Ne];return F||J(ge)}var Re=ie,ke=te,N=Re,dt=N;dt.v1=ke,dt.v4=N;var pt=dt;class Ee extends Promise{constructor(F){var H=pt.v4(),Y;super((ge,Ne)=>(Y=Ne,F(qe=>{Ee.cancellationMap.delete(H),ge(qe)},qe=>{Ee.cancellationMap.delete(H),Ne(qe)},qe=>{Ee.cancellationMap.set(H,qe)}))),this.id=H,this.rejectPromise=Y}cancel(){var F=Ee.cancellationMap.get(this.id);return F==null||F(),this.rejectPromise&&(this.catch(()=>{}),this.rejectPromise(new Error("Promise was cancelled"))),this}}c.default(Ee,"cancellationMap",new Map);function Xe(oe,F,H,Y){var ge=arguments.length,Ne=ge<3?F:Y===null?Y=Object.getOwnPropertyDescriptor(F,H):Y,qe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Ne=Reflect.decorate(oe,F,H,Y);else for(var ze=oe.length-1;ze>=0;ze--)(qe=oe[ze])&&(Ne=(ge<3?qe(Ne):ge>3?qe(F,H,Ne):qe(F,H))||Ne);return ge>3&&Ne&&Object.defineProperty(F,H,Ne),Ne}function Ye(oe,F){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(oe,F)}function B(oe,F){return["".concat(new Date().toISOString()," MCS Client ").concat(oe,":")].concat(Array.from(F))}class T{constructor(F){c.default(this,"prefix",""),this.prefix=F!=null&&F.length>0?F+" ":""}static scope(F){return new T(F)}setLevel(F){b.setLevel(F)}static setLevel(F){b.setLevel(F)}trace(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.trace.apply(null,B(this.prefix+"T",H))}debug(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.debug.apply(null,B(this.prefix+"D",H))}info(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.info.apply(null,B(this.prefix+"I",H))}warn(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.warn.apply(null,B(this.prefix+"W",H))}error(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.error.apply(null,B(this.prefix+"E",H))}static trace(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.trace.apply(null,B("T",H))}static debug(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.debug.apply(null,B("D",H))}static info(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.info.apply(null,B("I",H))}static warn(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.warn.apply(null,B("W",H))}static error(){for(var F=arguments.length,H=new Array(F),Y=0;Y<F;Y++)H[Y]=arguments[Y];b.error.apply(null,B("E",H))}}var Te=1e3,ye=4e3,Ke=3,Qe=!0,Se=oe=>"https://mcs.".concat(oe!=null?oe:"us1",".twilio.com"),Ge=oe=>oe.startsWith("http"),R=(oe,F)=>"".concat(Ge(oe)?"":Se(F)).concat(oe);class I{constructor(F,H,Y,ge){var Ne,qe,ze,De,He,Le,Z=(Ne=(qe=ge.MCS)!==null&&qe!==void 0?qe:ge)!==null&&Ne!==void 0?Ne:{};this.region=(ze=(De=Z.region)!==null&&De!==void 0?De:ge.region)!==null&&ze!==void 0?ze:"us1",this.mediaUrl=R(H,this.region),this.mediaSetUrl=Y?R(Y):"".concat(this.mediaUrl,"Set"),this.token=F,this.retryWhenThrottledOverride=(He=Z.retryWhenThrottledOverride)!==null&&He!==void 0?He:Qe,this.backoffConfigOverride=(Le=Z.backoffConfigOverride)!==null&&Le!==void 0?Le:I.backoffConfigDefault}static get backoffConfigDefault(){return{min:Te,max:ye,maxAttemptsCount:Ke}}static get retryWhenThrottledDefault(){return Qe}updateToken(F){this.token=F}}class K{constructor(F,H,Y){this.config=F,this.network=H,this._update(Y)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var F=this;return new Ee(function(){var H=h.default(w.default.mark(function Y(ge,Ne,qe){var ze,De;return w.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return ze=F.network.get("".concat(F.config.mediaUrl,"/").concat(F.sid)),qe(()=>ze.cancel()),Le.prev=2,Le.next=5,ze;case 5:De=Le.sent,F._update(De.body),ge(F.state.contentDirectUrl),Le.next=13;break;case 10:Le.prev=10,Le.t0=Le.catch(2),Ne(Le.t0);case 13:case"end":return Le.stop()}},Y,null,[[2,10]])}));return function(Y,ge,Ne){return H.apply(this,arguments)}}())}_update(F){var H,Y,ge,Ne;this.state={sid:F.sid,serviceSid:F.service_sid,channelSid:F.channel_sid,messageSid:F.message_sid,dateCreated:F.date_created?new Date(F.date_created):null,dateUploadUpdated:F.date_upload_updated?new Date(F.date_upload_updated):null,dateUpdated:F.date_updated?new Date(F.date_updated):null,size:F.size,contentType:F.content_type,author:F.author,url:F.url,contentUrl:F.links.content,contentDirectUrl:(H=F.links.content_direct_temporary)!==null&&H!==void 0?H:null,filename:(Y=F.filename)!==null&&Y!==void 0?Y:null,category:(ge=F.category)!==null&&ge!==void 0?ge:"media",isMultipartUpstream:(Ne=F.is_multipart_upstream)!==null&&Ne!==void 0?Ne:!1}}}class pe extends Error{constructor(F,H,Y,ge,Ne){super(F),this.code=H,this.body=Y,this.status=ge,this.headers=Ne}}var G=t.XMLHttpRequest||{};function Pe(oe){return oe?oe.split(`\r
`).map(F=>F.split(": ")).filter(F=>F.length===2&&F[1].length>0).reduce((F,H)=>(F[H[0]]=H[1],F),{}):{}}function be(oe){var F=oe.getResponseHeader("Content-Type");if(!F||F.indexOf("application/json")!==0||oe.responseText.length===0)return oe.responseText;try{return JSON.parse(oe.responseText)}catch{return oe.responseText}}class _e{static request(F,H,Y,ge){return new Ee((Ne,qe,ze)=>{var De=new G,He=!1;ze(()=>{De.abort(),He=!0}),De.open(F,H,!0),De.onreadystatechange=function(){if(!(De.readyState!==4||He)){var ne=Pe(De.getAllResponseHeaders()),q=be(De);if(200<=De.status&&De.status<300)Ne({status:De.status,headers:ne,body:q});else{var V,re=(V=De.statusText)!==null&&V!==void 0?V:"NONE",me;if(typeof q=="string")if(q&&q.split(`
`,2).length===1)me=q;else{var fe,je=(fe=q.replace(/<.*?>/g,"").split(/\r\n/g).filter(it=>it.length)[0])===null||fe===void 0?void 0:fe.split(" ");me=(je==null?void 0:je.length)>2?je==null?void 0:je.slice(1).join(" "):""}else me=JSON.stringify(q);var Ve="".concat(De.status,": [").concat(re,"] ").concat(me);qe(new pe(Ve,De.status,q,re,ne))}}};for(var Le in Y)De.setRequestHeader(Le,Y[Le]),Le==="Content-Type"&&Y[Le]==="application/json"&&(ge=JSON.stringify(ge));De.send(ge)})}get(F,H){return _e.request("GET",F,H)}post(F,H,Y){return _e.request("POST",F,H,Y)}}var Oe=T.scope("Network");class ee{constructor(F,H){this.config=F,this.transport=H}backoffConfig(){return Object.assign(I.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var F,H;return(F=(H=this.config.retryWhenThrottledOverride)!==null&&H!==void 0?H:I.retryWhenThrottledDefault)!==null&&F!==void 0?F:!1}executeWithRetry(F,H){var Y=this;return new Ee(function(){var ge=h.default(w.default.mark(function Ne(qe,ze,De){var He,Le;return w.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:He=new s.Retrier(Y.backoffConfig()),Le=[502,503,504],H&&Le.push(429),De(()=>{He.cancel(),He.removeAllListeners()}),He.on("attempt",h.default(w.default.mark(function q(){var V,re;return w.default.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return fe.prev=0,V=F(),De(()=>{V.cancel(),He.cancel(),He.removeAllListeners()}),fe.next=5,V;case 5:re=fe.sent,He.succeeded(re),fe.next=12;break;case 9:fe.prev=9,fe.t0=fe.catch(0),Le.indexOf(fe.t0.status)>-1||fe.t0.message==="Twilsock disconnected"?He.failed(fe.t0):(He.removeAllListeners(),He.cancel(),ze(fe.t0));case 12:case"end":return fe.stop()}},q,null,[[0,9]])}))),He.on("succeeded",q=>{qe(q)}),He.on("cancelled",q=>ze(q)),He.on("failed",q=>ze(q)),He.start();case 9:case"end":return ne.stop()}},Ne)}));return function(Ne,qe,ze){return ge.apply(this,arguments)}}())}get(F){var H=this;return new Ee(function(){var Y=h.default(w.default.mark(function ge(Ne,qe,ze){var De,He,Le;return w.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return De={"X-Twilio-Token":H.config.token},He=H.executeWithRetry(()=>H.transport.get(F,De),H.retryWhenThrottled()),Oe.trace("sending GET request to ",F," headers ",De),ze(()=>He.cancel()),ne.prev=4,ne.next=7,He;case 7:Le=ne.sent,Oe.trace("response",Le),Ne(Le),ne.next=16;break;case 12:ne.prev=12,ne.t0=ne.catch(4),Oe.debug("get() error ".concat(ne.t0)),qe(ne.t0);case 16:case"end":return ne.stop()}},ge,null,[[4,12]])}));return function(ge,Ne,qe){return Y.apply(this,arguments)}}())}post(F,H,Y,ge,Ne){var qe=this,ze={"X-Twilio-Token":this.config.token};(typeof FormData>"u"||!(Y instanceof FormData))&&ge&&Object.assign(ze,{"Content-Type":ge});var De=new URL(F);return H&&De.searchParams.append("Category",H),Ne&&De.searchParams.append("Filename",Ne),new Ee(function(){var He=h.default(w.default.mark(function Le(Z,ne,q){var V,re;return w.default.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return V=qe.transport.post(De.href,ze,Y),q(()=>V.cancel()),Oe.trace("sending POST request to ".concat(F," with headers ").concat(ze)),fe.prev=3,fe.next=6,V;case 6:re=fe.sent,fe.next=17;break;case 9:if(fe.prev=9,fe.t0=fe.catch(3),!(t.XMLHttpRequest===void 0&&Y instanceof FormData)){fe.next=14;break}return ne(new TypeError("Posting FormData supported only with browser engine's FormData")),fe.abrupt("return");case 14:return Oe.debug("post() error ".concat(fe.t0)),ne(fe.t0),fe.abrupt("return");case 17:Oe.trace("response",re),Z(re);case 19:case"end":return fe.stop()}},Le,null,[[3,9]])}));return function(Le,Z,ne){return He.apply(this,arguments)}}())}}var Fe="0.6.1",Ue,Me=T.scope("");e.default=(Ue=class{constructor(F,H,Y){var ge,Ne,qe=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.options=qe,this.options.logLevel=(ge=this.options.logLevel)!==null&&ge!==void 0?ge:"silent",this.config=new I(F,H,Y,this.options),Me.setLevel(this.options.logLevel),this.options.transport=(Ne=this.options.transport)!==null&&Ne!==void 0?Ne:new _e,this.transport=this.options.transport,this.network=new ee(this.config,this.transport)}updateToken(F){Me.info("updateToken"),this.config.updateToken(F)}get(F){var H=this;return new Ee(function(){var Y=h.default(w.default.mark(function ge(Ne,qe,ze){var De,He;return w.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return De=H.network.get("".concat(H.config.mediaUrl,"/").concat(F)),ze(()=>De.cancel()),Z.prev=2,Z.next=5,De;case 5:He=Z.sent,Ne(new K(H.config,H.network,He.body)),Z.next=12;break;case 9:Z.prev=9,Z.t0=Z.catch(2),qe(Z.t0);case 12:case"end":return Z.stop()}},ge,null,[[2,9]])}));return function(ge,Ne,qe){return Y.apply(this,arguments)}}())}post(F,H,Y,ge){var Ne=this;return new Ee(function(){var qe=h.default(w.default.mark(function ze(De,He,Le){var Z,ne;return w.default.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return Z=Ne.network.post(Ne.config.mediaUrl,Y!=null?Y:"media",H,F,ge),Le(()=>Z.cancel()),V.prev=2,V.next=5,Z;case 5:ne=V.sent,De(new K(Ne.config,Ne.network,ne.body)),V.next=12;break;case 9:V.prev=9,V.t0=V.catch(2),He(V.t0);case 12:case"end":return V.stop()}},ze,null,[[2,9]])}));return function(ze,De,He){return qe.apply(this,arguments)}}())}postFormData(F,H){var Y=this;return new Ee(function(){var ge=h.default(w.default.mark(function Ne(qe,ze,De){var He,Le;return w.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return He=Y.network.post(Y.config.mediaUrl,H!=null?H:"media",F),De(()=>He.cancel()),ne.prev=2,ne.next=5,He;case 5:Le=ne.sent,qe(new K(Y.config,Y.network,Le.body)),ne.next=12;break;case 9:ne.prev=9,ne.t0=ne.catch(2),ze(ne.t0);case 12:case"end":return ne.stop()}},Ne,null,[[2,9]])}));return function(Ne,qe,ze){return ge.apply(this,arguments)}}())}mediaSetGet(F){var H=this;return new Ee(function(){var Y=h.default(w.default.mark(function ge(Ne,qe,ze){var De,He,Le,Z;return w.default.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return De={command:"get",list:F.map(V=>({media_sid:V}))},He=H.network.post("".concat(H.config.mediaSetUrl),null,De,"application/json"),ze(()=>He.cancel()),q.prev=3,q.next=6,He;case 6:Le=q.sent,Z=Le.body.map(V=>{if(V.code!==200){qe("Failed to obtain detailed information about Media items (failed SID ".concat(V.media_record.sid,")"));return}return new K(H.config,H.network,V.media_record)}),Ne(Z),q.next=14;break;case 11:q.prev=11,q.t0=q.catch(3),qe(q.t0);case 14:case"end":return q.stop()}},ge,null,[[3,11]])}));return function(ge,Ne,qe){return Y.apply(this,arguments)}}())}mediaSetGetContentUrls(F){var H=this;return new Ee(function(){var Y=h.default(w.default.mark(function ge(Ne,qe,ze){var De,He,Le,Z;return w.default.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return De={command:"get",list:F.map(V=>({media_sid:V}))},He=H.network.post("".concat(H.config.mediaSetUrl),null,De,"application/json"),ze(()=>He.cancel()),q.prev=3,q.next=6,He;case 6:Le=q.sent,Z=new Map,Le.body.forEach(V=>{if(V.code!==200){qe("Failed to obtain detailed information about Media items (failed SID ".concat(V.media_record.sid,")"));return}Z.set(V.media_record.sid,V.media_record.links.content_direct_temporary)}),Ne(Z),q.next=15;break;case 12:q.prev=12,q.t0=q.catch(3),qe(q.t0);case 15:case"end":return q.stop()}},ge,null,[[3,12]])}));return function(ge,Ne,qe){return Y.apply(this,arguments)}}())}},c.default(Ue,"version",Fe),Ue),Xe([o.validateTypes(o.nonEmptyString),Ye("design:type",Function),Ye("design:paramtypes",[String]),Ye("design:returntype",void 0)],e.default.prototype,"updateToken",null),Xe([o.validateTypesAsync(o.nonEmptyString),Ye("design:type",Function),Ye("design:paramtypes",[String]),Ye("design:returntype",Ee)],e.default.prototype,"get",null),e.default=Xe([o.validateConstructorTypes(o.nonEmptyString,o.nonEmptyString,[o.nonEmptyString,o.literal(null)],[o.pureObject,"undefined"]),Ye("design:paramtypes",[String,String,Object,Object])],e.default),e.CancellablePromise=Ee,e.Client=e.default,e.McsClient=e.default,e.McsMedia=K,e.Media=K})(gI);var qI=Lt,HX=pr,WX=ta,GX=qI.aTypedArray,zX=qI.exportTypedArrayMethod;zX("at",function(t){var r=GX(this),n=HX(r),a=WX(t),i=a>=0?a:n+a;return i<0||i>=n?void 0:r[i]});var VX=ot,KX=ft,JX=rE,YX=Sf,Ag="ArrayBuffer",S0=JX[Ag],QX=KX[Ag];VX({global:!0,constructor:!0,forced:QX!==S0},{ArrayBuffer:S0});YX(Ag);var XX=ot,HI=tt,ZX=Ln,eZ=$r,$0=pr,tZ=og,T0=lr,Og=at,rZ=vg,nZ=ll,k0=UE,aZ=FE,E0=os,I0=DE,Xa=[],C0=HI(Xa.sort),iZ=HI(Xa.push),sZ=Og(function(){Xa.sort(void 0)}),oZ=Og(function(){Xa.sort(null)}),uZ=nZ("sort"),WI=!Og(function(){if(E0)return E0<70;if(!(k0&&k0>3)){if(aZ)return!0;if(I0)return I0<603;var e="",t,r,n,a;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)Xa.push({k:r+a,v:n})}for(Xa.sort(function(i,s){return s.v-i.v}),a=0;a<Xa.length;a++)r=Xa[a].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),lZ=sZ||!oZ||!uZ||!WI,cZ=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:T0(t)>T0(r)?1:-1}};XX({target:"Array",proto:!0,forced:lZ},{sort:function(t){t!==void 0&&ZX(t);var r=eZ(this);if(WI)return t===void 0?C0(r):C0(r,t);var n=[],a=$0(r),i,s;for(s=0;s<a;s++)s in r&&iZ(n,r[s]);for(rZ(n,cZ(t)),i=$0(n),s=0;s<i;)r[s]=n[s++];for(;s<a;)tZ(r,s++);return r}});var fZ=ot,dZ=tt,pZ=mI,vZ=ea,R0=lr,hZ=bI,yZ=dZ("".indexOf);fZ({target:"String",proto:!0,forced:!hZ("includes")},{includes:function(t){return!!~yZ(R0(vZ(this)),R0(pZ(t)),arguments.length>1?arguments[1]:void 0)}});var ed={};/*
@license
Copyright (c) 2022 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(ed,"__esModule",{value:!0});var gZ=ps.exports;function mZ(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ac=mZ(gZ),bZ=function(t,r,n){return function(a,i,s){if(typeof s.value!="function"&&(s==null?void 0:s.get)===void 0)throw new Error("The deprecated decorator can only be applied to methods or getters");if(typeof s.value=="function"){var o=s.value;s.value=function(){_h("The method ".concat(t," is deprecated").concat(r?", use "+r+" instead":"").concat(n?", "+n:"."));for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return o.apply(this,c)};return}var u=s.get;s.get=function(){return _h("The getter ".concat(t," is deprecated").concat(r?", use "+r+" instead":"").concat(n?", "+n:".")),u==null?void 0:u.apply(this)}}},_h=function(t){var r=ac.default.getLevel();ac.default.setLevel("warn"),ac.default.warn(t),ac.default.setLevel(r)};ed.deprecated=bZ;ed.deprecationWarning=_h;var wZ=ot,_Z=Qr.find,SZ=Cy,Sh="find",GI=!0;Sh in[]&&Array(1)[Sh](function(){GI=!1});wZ({target:"Array",proto:!0,forced:GI},{find:function(t){return _Z(this,t,arguments.length>1?arguments[1]:void 0)}});SZ(Sh);/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2019, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes q under the following license.

    Copyright 20092014 Kristopher Michael Kowal. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

This software includes platform.js under the following license.

    Copyright 2014 Benjamin Tan <https://d10.github.io/>
    Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=$o.exports,r=yi.exports,n=jn.exports,a=Un.exports,i=Xr.exports,s=gi.exports,o=ra.exports,u=Dn.exports,l=cl,c=Fn.exports,h=ps.exports,w=x4,b=kr,$=Dy,A=Kv.exports,x=mi.exports,U=xa,D=Uf,de=YE,ue=Br,Ae=gI,we=bi.exports,he=ed,P=Df;function Q(C){return C&&typeof C=="object"&&"default"in C?C:{default:C}}function ce(C){if(C&&C.__esModule)return C;var O=Object.create(null);return C&&Object.keys(C).forEach(function(S){if(S!=="default"){var _=Object.getOwnPropertyDescriptor(C,S);Object.defineProperty(O,S,_.get?_:{enumerable:!0,get:function(){return C[S]}})}}),O.default=C,Object.freeze(O)}var W=Q(t),ve=Q(r),te=Q(n),ae=Q(a),J=Q(i),ie=Q(s),Re=Q(o),ke=Q(u),N=Q(l),dt=Q(c),pt=ce(h),Ee=Q(A),Xe=Q(x),Ye=Q(we);function B(C,O,S,_){var v=arguments.length,g=v<3?O:_===null?_=Object.getOwnPropertyDescriptor(O,S):_,d;if((typeof Reflect>"u"?"undefined":dt.default(Reflect))==="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(C,O,S,_);else for(var p=C.length-1;p>=0;p--)(d=C[p])&&(g=(v<3?d(g):v>3?d(O,S,g):d(O,S))||g);return v>3&&g&&Object.defineProperty(O,S,g),g}function T(C,O){if((typeof Reflect>"u"?"undefined":dt.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,O)}function Te(C,O){return["".concat(new Date().toISOString()," Conversations ").concat(C,":")].concat(Array.from(O))}var ye=pt.getLogger("twilio-conversations"),Ke=function(){function C(O){ke.default(this,C),ie.default(this,"prefix",""),this.prefix=O!=null&&O.length>0?O+" ":""}return Re.default(C,[{key:"setLevel",value:function(S){ye.setLevel(S)}},{key:"trace",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.trace.apply(null,Te(this.prefix+"T",_))}},{key:"debug",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.debug.apply(null,Te(this.prefix+"D",_))}},{key:"info",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.info.apply(null,Te(this.prefix+"I",_))}},{key:"warn",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.warn.apply(null,Te(this.prefix+"W",_))}},{key:"error",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.error.apply(null,Te(this.prefix+"E",_))}}],[{key:"scope",value:function(S){return new C(S)}},{key:"setLevel",value:function(S){ye.setLevel(S)}},{key:"trace",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.trace.apply(null,Te("T",_))}},{key:"debug",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.debug.apply(null,Te("D",_))}},{key:"info",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.info.apply(null,Te("I",_))}},{key:"warn",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.warn.apply(null,Te("W",_))}},{key:"error",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];ye.error.apply(null,Te("E",_))}}]),C}();function Qe(C,O){var S=Object.keys(C);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(C);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(C,v).enumerable})),S.push.apply(S,_)}return S}function Se(C){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?Qe(Object(S),!0).forEach(function(_){ie.default(C,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(S)):Qe(Object(S)).forEach(function(_){Object.defineProperty(C,_,Object.getOwnPropertyDescriptor(S,_))})}return C}var Ge=5,R="PT5S",I="PT5S",K=100,pe=1e3,G=4e3,Pe=3,be=!0,_e=Re.default(function C(){var O,S,_,v,g,d,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0,m=arguments.length>2?arguments[2]:void 0;ke.default(this,C),ie.default(this,"typingIndicatorTimeoutDefault",Ge*1e3);var y=p.Chat||p.IPMessaging||p||{};this.productId=y.productId,this.links={myConversations:f.links.my_conversations,conversations:f.links.conversations,users:f.links.users,currentUser:f.links.current_user,typing:f.links.typing,mediaService:f.links.media_service,mediaSetService:f.links.media_set_service,messagesReceipts:f.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:f.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:f.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:f.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedContentTypes:f.options.email_histories_allowed_mime_types,emailBodiesAllowedContentTypes:f.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=y.typingIndicatorTimeoutOverride,this.backoffConfiguration=Se({min:pe,max:G,maxAttemptsCount:Pe},y.backoffConfigOverride),this.retryWhenThrottled=y.retryWhenThrottledOverride!==void 0?y.retryWhenThrottledOverride:be,this.userInfosToSubscribe=(O=(S=y.userInfosToSubscribeOverride)!==null&&S!==void 0?S:f.options.user_infos_to_subscribe)!==null&&O!==void 0?O:K,this.reachabilityEnabled=f.options.reachability_enabled,this.userIdentity=f.identity,this.userInfo=f.sync_objects.my_user_info,this.myConversations=f.sync_objects.my_conversations;var k=(_=(v=y.httpCacheIntervalOverride)!==null&&v!==void 0?v:f.options.http_cache_interval)!==null&&_!==void 0?_:R;try{this.httpCacheInterval=w.toSeconds(w.parse(k))}catch{m.error("Failed to parse http cache interval ".concat(k,", using default value ").concat(R)),this.httpCacheInterval=w.toSeconds(w.parse(R))}var E=(g=(d=y.consumptionReportIntervalOverride)!==null&&d!==void 0?d:f.options.consumption_report_interval)!==null&&g!==void 0?g:I;try{this.consumptionReportInterval=w.toSeconds(w.parse(E))}catch{m.error("Failed to parse consumption report interval ".concat(E,", using default value ").concat(I)),this.consumptionReportInterval=w.toSeconds(w.parse(I))}});function Oe(C){return JSON.parse(JSON.stringify(C))}function ee(C){return typeof C<"u"&&!isNaN(Number(C))?Number(C):null}function Fe(C){try{return new Date(C)}catch{return null}}function Ue(C,O,S){var _={};if(C)try{_=JSON.parse(C)}catch(v){S.warn(O,v)}return _}var Me=function(){function C(O){ke.default(this,C),this.base=O.replace(/\/$/,""),this.args=[],this.paths=[]}return Re.default(C,[{key:"arg",value:function(S,_){return typeof _<"u"&&this.args.push(encodeURIComponent(S)+"="+encodeURIComponent(_)),this}},{key:"path",value:function(S){return this.paths.push(encodeURIComponent(S)),this}},{key:"build",value:function(){var S=this.base;return this.paths.length&&(S+="/"+this.paths.join("/")),this.args.length&&(S+="?"+this.args.join("&")),S}}]),C}(),oe=b.custom(function(C){return[["string","number","boolean","object"].includes(dt.default(C)),"a JSON type"]}),F=b.custom(function(C){return[["undefined","string","number","boolean","object"].includes(dt.default(C)),"an optional JSON type"]});function H(C){var O=Y();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function Y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ge=Ke.scope("User"),Ne=function(C){te.default(S,C);var O=H(S);function S(_,v,g,d){var p;return ke.default(this,S),p=O.call(this),ie.default(ve.default(p),"promiseToFetch",null),ie.default(ve.default(p),"updated","updated"),ie.default(ve.default(p),"userSubscribed","userSubscribed"),ie.default(ve.default(p),"userUnsubscribed","userUnsubscribed"),p.services=d,p.subscribed="initializing",p.setMaxListeners(0),p.state={identity:_,entityName:v,friendlyName:null,attributes:{},online:null,notifiable:null},p._initializationPromise=new Promise(function(f){p._resolveInitializationPromise=f}),g!==null&&p._resolveInitialization(g,_,v,!1),p}return Re.default(S,[{key:"identity",get:function(){return this.state.identity},set:function(v){this.state.identity=v}},{key:"entityName",set:function(v){this.state.entityName=v}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return this.subscribed=="subscribed"}},{key:"_update",value:function(){var _=W.default(N.default.mark(function g(d,p){var f,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this._initializationPromise;case 2:f=[],ge.debug("User for",this.state.identity,"updated:",d,p),k.t0=d,k.next=k.t0==="friendlyName"?7:k.t0==="attributes"?9:k.t0==="reachability"?12:15;break;case 7:return this.state.friendlyName!==p.value&&(f.push("friendlyName"),this.state.friendlyName=p.value),k.abrupt("break",16);case 9:return m=Ue(p.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),ge),Ee.default(this.state.attributes,m)||(this.state.attributes=m,f.push("attributes")),k.abrupt("break",16);case 12:return this.state.online!==p.online&&(this.state.online=p.online,f.push("reachabilityOnline")),this.state.notifiable!==p.notifiable&&(this.state.notifiable=p.notifiable,f.push("reachabilityNotifiable")),k.abrupt("break",16);case 15:return k.abrupt("return");case 16:f.length>0&&this.emit("updated",{user:this,updateReasons:f});case 17:case"end":return k.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_updateReachabilityInfo",value:function(){var _=W.default(N.default.mark(function g(d,p){var f=this;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){y.next=4;break}return y.abrupt("return",Promise.resolve());case 4:return y.abrupt("return",d.get("reachability").then(p).catch(function(k){ge.warn("Failed to get reachability info for ",f.state.identity,k)}));case 5:case"end":return y.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_fetch",value:function(){var _=W.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.state.entityName){f.next=4;break}return f.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then(function(m){return d.entity=m,m.on("itemUpdated",function(y){return ge.debug(d.state.entityName+" ("+d.state.identity+") itemUpdated: "+y.item.key),d._update(y.item.key,y.item.data)}),Promise.all([m.get("friendlyName").then(function(y){return d._update(y.key,y.data)}),m.get("attributes").then(function(y){return d._update(y.key,y.data)}),d._updateReachabilityInfo(m,function(y){return d._update(y.key,y.data)})])}).then(function(){return ge.debug("Fetched for",d.identity),d.subscribed="subscribed",d.emit("userSubscribed",d),d}).catch(function(m){throw d.promiseToFetch=null,m}),f.abrupt("return",this.promiseToFetch);case 6:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_ensureFetched",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._initializationPromise;case 2:return p.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){f.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return f.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(d)});case 6:return f.abrupt("return",this);case 7:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateFriendlyName",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){f.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return f.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:d});case 6:return f.abrupt("return",this);case 7:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"unsubscribe",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){p.next=9;break}return p.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_resolveInitialization",value:function(v,g,d,p){this.configuration=v,this.identity=g,this.entityName=d,this.links={self:"".concat(this.configuration.links.users,"/").concat(encodeURIComponent(this.identity))},this._resolveInitializationPromise(),p&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),S}($.ReplayEventEmitter);B([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],Ne.prototype,"updateAttributes",null),B([b.validateTypesAsync(["string"]),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],Ne.prototype,"updateFriendlyName",null);function qe(C,O){var S=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!S){if(Array.isArray(C)||(S=ze(C))||O&&C&&typeof C.length=="number"){S&&(C=S);var _=0,v=function(){};return{s:v,n:function(){return _>=C.length?{done:!0}:{done:!1,value:C[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(C)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function ze(C,O){if(!!C){if(typeof C=="string")return De(C,O);var S=Object.prototype.toString.call(C).slice(8,-1);if(S==="Object"&&C.constructor&&(S=C.constructor.name),S==="Map"||S==="Set")return Array.from(C);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return De(C,O)}}function De(C,O){(O==null||O>C.length)&&(O=C.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=C[S];return _}var He=function(){function C(O,S){ke.default(this,C),this.configuration=O,this.services=S,this.cache=new Map,this.cacheLifetime=this.configuration.httpCacheInterval*100,this.cleanupCache()}return Re.default(C,[{key:"isExpired",value:function(S){return!this.cacheLifetime||Date.now()-S>this.cacheLifetime}},{key:"cleanupCache",value:function(){var S=qe(this.cache),_;try{for(S.s();!(_=S.n()).done;){var v=Xe.default(_.value,2),g=v[0],d=v[1];this.isExpired(d.timestamp)&&this.cache.delete(g)}}catch(p){S.e(p)}finally{S.f()}this.cache.size===0&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var S=this;this.timer=this.timer||setInterval(function(){return S.cleanupCache()},this.cacheLifetime*2)}},{key:"executeWithRetry",value:function(S){var _=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise(function(g,d){var p=[502,503,504];v&&p.push(429);var f=new U.Retrier(_.configuration.backoffConfiguration);f.on("attempt",function(){S().then(function(m){return f.succeeded(m)}).catch(function(m){p.indexOf(m.status)>-1||m.message==="Twilsock disconnected"?f.failed(m):(f.removeAllListeners(),f.cancel(),d(m))})}),f.on("succeeded",function(m){g(m)}),f.on("cancelled",function(m){return d(m)}),f.on("failed",function(m){return d(m)}),f.start()})}},{key:"get",value:function(){var O=W.default(N.default.mark(function _(v){var g=this,d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d=this.cache.get(v),!(d&&!this.isExpired(d.timestamp))){y.next=3;break}return y.abrupt("return",d.response);case 3:return p={},y.next=6,this.executeWithRetry(function(){return g.services.transport.get(v,p,g.configuration.productId)},this.configuration.retryWhenThrottled);case 6:return f=y.sent,this.cache.set(v,{response:f,timestamp:Date.now()}),this.pokeTimer(),y.abrupt("return",f);case 10:case"end":return y.stop()}},_,this)}));function S(_){return O.apply(this,arguments)}return S}()}]),C}(),Le=Re.default(function C(){ke.default(this,C)});ie.default(Le,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),ie.default(Le,"NEW_MESSAGE","twilio.conversations.new_message"),ie.default(Le,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),ie.default(Le,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),ie.default(Le,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");function Z(C){var O=ne();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q=Ke.scope("Participant"),V=function(C){te.default(S,C);var O=Z(S);function S(_,v,g,d,p){var f,m,y;if(ke.default(this,S),y=O.call(this),y.conversation=g,y.links=d,y.services=p,y.state={attributes:Ue(_.attributes,"Retrieved malformed attributes from the server for participant: "+v,q),dateCreated:_.dateCreated?Fe(_.dateCreated):null,dateUpdated:_.dateCreated?Fe(_.dateUpdated):null,sid:v,typingTimeout:null,isTyping:!1,identity:_.identity,roleSid:(f=_.roleSid)!==null&&f!==void 0?f:"",lastReadMessageIndex:Number.isInteger(_.lastConsumedMessageIndex)?_.lastConsumedMessageIndex:null,lastReadTimestamp:_.lastConsumptionTimestamp?Fe(_.lastConsumptionTimestamp):null,type:_.type||"chat",userInfo:_.userInfo,bindings:(m=_.bindings)!==null&&m!==void 0?m:{}},!_.identity&&!_.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return y}return Re.default(S,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var v;return(v=this.state.bindings)!==null&&v!==void 0?v:{}}},{key:"_startTyping",value:function(v){var g=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout(function(){return g._endTyping()},v)),this}},{key:"_endTyping",value:function(){!this.state.typingTimeout||(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(v){var g=[],d=Ue(v.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,q);v.attributes&&!Ee.default(this.state.attributes,d)&&(this.state.attributes=d,g.push("attributes"));var p=Fe(v.dateUpdated);v.dateUpdated&&(p==null?void 0:p.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=p,g.push("dateUpdated"));var f=Fe(v.dateCreated);if(v.dateCreated&&(f==null?void 0:f.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=f,g.push("dateCreated")),v.roleSid&&this.state.roleSid!==v.roleSid&&(this.state.roleSid=v.roleSid,g.push("roleSid")),(Number.isInteger(v.lastConsumedMessageIndex)||v.lastConsumedMessageIndex===null)&&this.state.lastReadMessageIndex!==v.lastConsumedMessageIndex&&(this.state.lastReadMessageIndex=v.lastConsumedMessageIndex,g.push("lastReadMessageIndex")),v.lastConsumptionTimestamp){var m=new Date(v.lastConsumptionTimestamp);(!this.state.lastReadTimestamp||this.state.lastReadTimestamp.getTime()!==m.getTime())&&(this.state.lastReadTimestamp=m,g.push("lastReadTimestamp"))}return v.bindings&&!Ee.default(this.state.bindings,v.bindings)&&(this.state.bindings=v.bindings,g.push("bindings")),g.length>0&&this.emit("updated",{participant:this,updateReasons:g}),this}},{key:"getUser",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.type=="chat"){p.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return p.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(d)});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter);ie.default(V,"typingStarted","typingStarted"),ie.default(V,"typingEnded","typingEnded"),ie.default(V,"updated","updated"),B([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],V.prototype,"updateAttributes",null);function re(C){var O=me();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function me(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var fe=Ke.scope("Participants"),je=function(C){te.default(S,C);var O=re(S);function S(_,v,g,d,p){var f;return ke.default(this,S),f=O.call(this),ie.default(ve.default(f),"rosterEntityPromise",null),f.conversation=_,f.participants=v,f.links=g,f.configuration=d,f.services=p,f}return Re.default(S,[{key:"unsubscribe",value:function(){var _=W.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this.rosterEntityPromise){f.next=6;break}return f.next=3,this.rosterEntityPromise;case 3:d=f.sent,d.close(),this.rosterEntityPromise=null;case 6:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"subscribe",value:function(v){var g=this,d=typeof v=="string"?this.services.syncClient.map({id:v,mode:"open_existing"}):Promise.resolve(v);return this.rosterEntityPromise=this.rosterEntityPromise||d.then(function(p){p.on("itemAdded",function(y){fe.debug(g.conversation.sid+" itemAdded: "+y.item.key),g.upsertParticipant(y.item.key,y.item.data).then(function(k){g.emit("participantJoined",k)})}),p.on("itemRemoved",function(y){fe.debug(g.conversation.sid+" itemRemoved: "+y.key);var k=y.key;if(!!g.participants.has(k)){var E=g.participants.get(k);g.participants.delete(k),E&&g.emit("participantLeft",E)}}),p.on("itemUpdated",function(y){fe.debug(g.conversation.sid+" itemUpdated: "+y.item.key),g.upsertParticipant(y.item.key,y.item.data)});var f=[],m=function y(k){return k.items.forEach(function(E){f.push(g.upsertParticipant(E.key,E.data))}),k.hasNextPage?k.nextPage().then(y):null};return p.getItems().then(m).then(function(){return Promise.all(f)}).then(function(){return p})}).catch(function(p){throw g.rosterEntityPromise=null,g.services.syncClient.connectionState!="disconnected"&&fe.error("Failed to get roster object for conversation",g.conversation.sid,p),fe.debug("ERROR: Failed to get roster object for conversation",g.conversation.sid,p),p})}},{key:"upsertParticipantFromResponse",value:function(){var _=W.default(N.default.mark(function g(d){var p,f,m,y,k,E,L,j;return N.default.wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:return f=d.sid,m=d.attributes,y=d.date_created,k=d.date_updated,E=d.identity,L=d.role_sid,j=d.messaging_binding,Je.next=3,this.upsertParticipant(f,{attributes:m,dateCreated:new Date(y),dateUpdated:new Date(k),identity:E,roleSid:L,lastConsumedMessageIndex:null,lastConsumptionTimestamp:null,type:(p=j==null?void 0:j.type)!==null&&p!==void 0?p:"chat"});case 3:return Je.abrupt("return",Je.sent);case 4:case"end":return Je.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"upsertParticipant",value:function(){var _=W.default(N.default.mark(function g(d,p){var f=this,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(m=this.participants.get(d),!m){E.next=3;break}return E.abrupt("return",m._update(p));case 3:return y={self:"".concat(this.links.participants,"/").concat(d)},m=new V(p,d,this.conversation,y,this.services),this.participants.set(d,m),m.on("updated",function(L){return f.emit("participantUpdated",L)}),E.abrupt("return",m);case 8:case"end":return E.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"getParticipants",value:function(){var _=W.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var m=[];return d.participants.forEach(function(y){return m.push(y)}),m}):[]);case 1:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantBySid",value:function(){var _=W.default(N.default.mark(function g(d){var p=this;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var y=p.participants.get(d);if(!y)throw new Error("Participant with SID "+d+" was not found");return y}):null);case 1:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getParticipantByIdentity",value:function(){var _=W.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return f=null,y.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){if(p.participants.forEach(function(k){k.identity===d&&(f=k)}),!f)throw new Error("Participant with identity "+d+" was not found");return f}):null);case 2:case"end":return y.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"add",value:function(){var _=W.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:d,attributes:typeof p<"u"?JSON.stringify(p):void 0});case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"addNonChatParticipant",value:function(){var _=W.default(N.default.mark(function g(d,p){var f,m,y,k,E=arguments;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return y=E.length>2&&E[2]!==void 0?E[2]:{},k=E.length>3&&E[3]!==void 0?E[3]:{},j.next=4,this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:typeof y<"u"?JSON.stringify(y):void 0,messaging_binding:{address:p,proxy_address:d,name:k==null||(f=k.email)===null||f===void 0?void 0:f.name,level:k==null||(m=k.email)===null||m===void 0?void 0:m.level}});case 4:return j.abrupt("return",j.sent);case 5:case"end":return j.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(v){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(v))}}]),S}($.ReplayEventEmitter),Ve=function(){function C(O,S){ke.default(this,C),ie.default(this,"mcsMedia",null),this.services=S,O instanceof Ae.McsMedia&&(this.mcsMedia=O),this.state={sid:O.sid,category:O.category,filename:O.filename,contentType:O.contentType,size:O.size}}return Re.default(C,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:function(){var S=this;return new Ae.CancellablePromise(function(){var _=W.default(N.default.mark(function v(g,d,p){var f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(m=S._fetchMcsMedia(),y=(f=S.mcsMedia)===null||f===void 0?void 0:f.getContentUrl(),p(function(){m.cancel(),y&&y.cancel()}),L.prev=3,S.mcsMedia){L.next=9;break}return L.next=7,m;case 7:k=L.sent,y=k.getContentUrl();case 9:if(L.t0=g,!y){L.next=16;break}return L.next=13,y;case 13:L.t1=L.sent,L.next=17;break;case 16:L.t1=null;case 17:L.t2=L.t1,(0,L.t0)(L.t2),L.next=24;break;case 21:L.prev=21,L.t3=L.catch(3),d(L.t3);case 24:case"end":return L.stop()}},v,null,[[3,21]])}));return function(v,g,d){return _.apply(this,arguments)}}())}},{key:"_fetchMcsMedia",value:function(){var S=this;return new Ae.CancellablePromise(function(){var _=W.default(N.default.mark(function v(g,d,p){var f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(f=S.services.mcsClient.get(S.state.sid),!S.services.mcsClient){y.next=14;break}return p(function(){return f.cancel()}),y.prev=3,y.next=6,f;case 6:S.mcsMedia=y.sent,g(S.mcsMedia),y.next=13;break;case 10:y.prev=10,y.t0=y.catch(3),d(y.t0);case 13:return y.abrupt("return");case 14:d(new Error("Media Content Service is unavailable"));case 15:case"end":return y.stop()}},v,null,[[3,10]])}));return function(v,g,d){return _.apply(this,arguments)}}())}}]),C}(),it=function(){function C(O){ke.default(this,C),this.state=O}return Re.default(C,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(S){this.state=S}},{key:"_isEquals",value:function(S){var _=this.total===S.total,v=this.sent===S.sent,g=this.delivered===S.delivered,d=this.read===S.read,p=this.undelivered===S.undelivered,f=this.failed===S.failed;return _&&v&&g&&d&&p&&f}}]),C}(),rt=function(){function C(O,S,_,v){ke.default(this,C),this.state={prevToken:_,nextToken:v,source:S,items:O}}return Re.default(C,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),C}(),We=Re.default(function C(O){ke.default(this,C),this.sid=O.sid,this.messageSid=O.message_sid,this.conversationSid=O.conversation_sid,this.channelMessageSid=O.channel_message_sid,this.participantSid=O.participant_sid,this.status=O.status||"queued",this.errorCode=O.error_code||0,this.dateCreated=O.date_created,this.dateUpdated=O.date_updated});function vr(C,O){var S=Object.keys(C);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(C);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(C,v).enumerable})),S.push.apply(S,_)}return S}function nt(C){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?vr(Object(S),!0).forEach(function(_){ie.default(C,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(S)):vr(Object(S)).forEach(function(_){Object.defineProperty(C,_,Object.getOwnPropertyDescriptor(S,_))})}return C}function Rr(C){var O=Ft();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function Ft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var bn=Ke.scope("Message"),nr=function(C){te.default(S,C);var O=Rr(S);function S(_,v,g,d,p,f){var m,y,k,E,L;return ke.default(this,S),L=O.call(this),L.conversation=g,L.links=d,L.configuration=p,L.services=f,L.state={sid:v.sid,index:_,author:v.author,subject:v.subject,body:(m=v.text)!==null&&m!==void 0?m:null,timestamp:v.timestamp?new Date(v.timestamp):null,dateUpdated:v.dateUpdated?new Date(v.dateUpdated):null,lastUpdatedBy:(y=v.lastUpdatedBy)!==null&&y!==void 0?y:null,attributes:Ue(v.attributes,"Got malformed attributes for the message ".concat(v.sid),bn),type:(k=v.type)!==null&&k!==void 0?k:"text",media:v.type==="media"&&v.media?new Ve(v.media,L.services):null,medias:v.type==="media"&&v.medias?v.medias.map(function(j){return new Ve(j,L.services)}):v.type==="media"&&v.media&&!v.medias?[new Ve(nt(nt({},v.media),{},{category:"media"}),L.services)]:null,participantSid:(E=v.memberSid)!==null&&E!==void 0?E:null,aggregatedDeliveryReceipt:v.delivery?new it(v.delivery):null},L}return Re.default(S,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategories(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(v){return this.getMediaByCategories(v)}},{key:"getMediaByCategories",value:function(v){var g;return((g=this.state.medias)!==null&&g!==void 0?g:[]).filter(function(d){return v.includes(d.category)})}},{key:"getEmailBody",value:function(){var v,g,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(v=(g=this.getMediaByCategories(["body"]))===null||g===void 0?void 0:g.filter(function(p){return p.contentType==d}).shift())!==null&&v!==void 0?v:null}},{key:"getEmailHistory",value:function(){var v,g,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(v=(g=this.getMediaByCategories(["history"]))===null||g===void 0?void 0:g.filter(function(p){return p.contentType==d}).shift())!==null&&v!==void 0?v:null}},{key:"_update",value:function(v){var g=[];(v.text||typeof v.text=="string")&&v.text!==this.state.body&&(this.state.body=v.text,g.push("body")),v.subject&&v.subject!==this.state.subject&&(this.state.subject=v.subject,g.push("subject")),v.lastUpdatedBy&&v.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=v.lastUpdatedBy,g.push("lastUpdatedBy")),v.author&&v.author!==this.state.author&&(this.state.author=v.author,g.push("author")),v.dateUpdated&&new Date(v.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(v.dateUpdated),g.push("dateUpdated")),v.timestamp&&new Date(v.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(v.timestamp),g.push("dateCreated"));var d=Ue(v.attributes,"Got malformed attributes for the message ".concat(this.sid),bn);Ee.default(this.state.attributes,d)||(this.state.attributes=d,g.push("attributes"));var p=v.delivery,f=this.state.aggregatedDeliveryReceipt,m=!!p&&!!p.total&&!!p.delivered&&!!p.failed&&!!p.read&&!!p.sent&&!!p.undelivered;m&&(f?f._isEquals(p)||(f._update(p),g.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new it(p),g.push("deliveryReceipt"))),g.length>0&&this.emit("updated",{message:this,updateReasons:g})}},{key:"getParticipant",value:function(){var _=W.default(N.default.mark(function g(){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(p=null,!this.state.participantSid){y.next=5;break}return y.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch(function(){return bn.debug('Participant with sid "'.concat(d.participantSid,'" not found for message ').concat(d.sid)),null});case 4:p=y.sent;case 5:if(!(!p&&this.state.author)){y.next=9;break}return y.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch(function(){return bn.debug('Participant with identity "'.concat(d.author,'" not found for message ').concat(d.sid)),null});case 8:p=y.sent;case 9:if(!p){y.next=11;break}return y.abrupt("return",p);case 11:throw f="Participant with ",this.state.participantSid&&(f+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(f+="or "),f+="identity '"+this.state.author+"' "),f==="Participant with "&&(f="Participant "),f+="was not found",new Error(f);case 17:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getDetailedDeliveryReceipts",value:function(){var _=W.default(N.default.mark(function g(){var d,p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:d=m.sent,p=d.items;case 4:if(!d.hasNextPage){m.next=11;break}return m.next=7,d.nextPage();case 7:d=m.sent,p=[].concat(Ye.default(p),Ye.default(d.items)),m.next=4;break;case 11:return m.abrupt("return",p);case 12:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateBody",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:d});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:typeof d<"u"?JSON.stringify(d):void 0});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"attachTemporaryUrlsFor",value:function(){var _=W.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(f=d==null?void 0:d.map(function(k){return k.sid}),!(this.services.mcsClient&&f)){y.next=7;break}return y.next=4,this.services.mcsClient.mediaSetGet(f);case 4:return y.abrupt("return",y.sent.map(function(k){return new Ve(k,p.services)}));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return y.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getTemporaryContentUrlsForMedia",value:function(v){var g=v.map(function(d){return d.sid});return this.getTemporaryContentUrlsForMediaSids(g)}},{key:"getTemporaryContentUrlsForMediaSids",value:function(v){var g=this;return new Ae.CancellablePromise(function(){var d=W.default(N.default.mark(function p(f,m,y){var k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(k=g.services.mcsClient.mediaSetGetContentUrls(v!=null?v:[]),!(!g.services.mcsClient||!v)){j.next=4;break}return m(new Error("Media Content Service is unavailable")),j.abrupt("return");case 4:return y(function(){k.cancel()}),j.prev=5,j.next=8,k;case 8:E=j.sent,f(E),j.next=15;break;case 12:j.prev=12,j.t0=j.catch(5),m(j.t0);case 15:case"end":return j.stop()}},p,null,[[5,12]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForAttachedMedia",value:function(){var v,g=this.attachedMedia,d=(v=g==null?void 0:g.map(function(p){return p.sid}))!==null&&v!==void 0?v:[];return this.getTemporaryContentUrlsForMediaSids(d)}},{key:"_getDetailedDeliveryReceiptsPaginator",value:function(){var _=W.default(N.default.mark(function g(d){var p=this,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return f=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),m=new Me(f).arg("PageToken",d==null?void 0:d.pageToken).arg("PageSize",d==null?void 0:d.pageSize).build(),E.next=4,this.services.network.get(m);case 4:return y=E.sent,E.abrupt("return",new rt(y.body.delivery_receipts.map(function(L){return new We(L)}),function(L,j){return p._getDetailedDeliveryReceiptsPaginator({pageToken:L,pageSize:j})},y.body.meta.previous_token,y.body.meta.next_token));case 6:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter);ie.default(nr,"updated","updated"),B([he.deprecated("getMediaByCategory","getMediaByCategories"),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Array)],nr.prototype,"getMediaByCategory",null),B([b.validateTypes([b.nonEmptyString,"undefined"]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Ve)],nr.prototype,"getEmailBody",null),B([b.validateTypes([b.nonEmptyString,"undefined"]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Ve)],nr.prototype,"getEmailHistory",null),B([b.validateTypesAsync("string"),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],nr.prototype,"updateBody",null),B([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],nr.prototype,"updateAttributes",null),B([he.deprecated("attachTemporaryUrlsFor","getTemporaryContentUrlsForMedia"),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Promise)],nr.prototype,"attachTemporaryUrlsFor",null),B([b.validateTypesAsync(b.nonEmptyArray("media",Ve)),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Ae.CancellablePromise)],nr.prototype,"getTemporaryContentUrlsForMedia",null),B([b.validateTypesAsync(b.nonEmptyArray("strings","string")),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Ae.CancellablePromise)],nr.prototype,"getTemporaryContentUrlsForMediaSids",null);function Bn(C,O){var S=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!S){if(Array.isArray(C)||(S=Rt(C))||O&&C&&typeof C.length=="number"){S&&(C=S);var _=0,v=function(){};return{s:v,n:function(){return _>=C.length?{done:!0}:{done:!1,value:C[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(C)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Rt(C,O){if(!!C){if(typeof C=="string")return hr(C,O);var S=Object.prototype.toString.call(C).slice(8,-1);if(S==="Object"&&C.constructor&&(S=C.constructor.name),S==="Map"||S==="Set")return Array.from(C);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return hr(C,O)}}function hr(C,O){(O==null||O>C.length)&&(O=C.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=C[S];return _}function qr(C){var O=Hr();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function Hr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var yr=Ke.scope("Messages"),gs=function(C){te.default(S,C);var O=qr(S);function S(_,v,g){var d;return ke.default(this,S),d=O.call(this),d.conversation=_,d.configuration=v,d.services=g,d.messagesByIndex=new Map,d.messagesListPromise=null,d}return Re.default(S,[{key:"subscribe",value:function(){var _=W.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!this.messagesListPromise){y.next=2;break}return y.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=typeof d=="string"?this.services.syncClient.list({id:d,mode:"open_existing"}):Promise.resolve(d),y.prev=3,y.next=6,this.messagesListPromise;case 6:return f=y.sent,f.on("itemAdded",function(k){yr.debug("".concat(p.conversation.sid," itemAdded: ").concat(k.item.index));var E={self:"".concat(p.conversation._links.messages,"/").concat(k.item.data.sid),conversation:p.conversation._links.self,messages_receipts:"".concat(p.conversation._links.messages,"/").concat(k.item.data.sid,"/Receipts")},L=new nr(k.item.index,k.item.data,p.conversation,E,p.configuration,p.services);if(p.messagesByIndex.has(L.index)){yr.debug("Message arrived, but is already known and ignored",p.conversation.sid,L.index);return}p.messagesByIndex.set(L.index,L),L.on("updated",function(j){return p.emit("messageUpdated",j)}),p.emit("messageAdded",L)}),f.on("itemRemoved",function(k){yr.debug("#{this.conversation.sid} itemRemoved: ".concat(k.index));var E=k.index;if(p.messagesByIndex.has(E)){var L=p.messagesByIndex.get(E);if(!L)return;p.messagesByIndex.delete(L.index),L.removeAllListeners("updated"),p.emit("messageRemoved",L)}}),f.on("itemUpdated",function(k){yr.debug("".concat(p.conversation.sid," itemUpdated: ").concat(k.item.index));var E=p.messagesByIndex.get(k.item.index);E&&E._update(k.item.data)}),y.abrupt("return",f);case 13:throw y.prev=13,y.t0=y.catch(3),this.messagesListPromise=null,this.services.syncClient.connectionState!=="disconnected"&&yr.error("Failed to get messages object for conversation",this.conversation.sid,y.t0),yr.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,y.t0),y.t0;case 19:case"end":return y.stop()}},g,this,[[3,13]])}));function v(g){return _.apply(this,arguments)}return v}()},{key:"unsubscribe",value:function(){var _=W.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.messagesListPromise){f.next=2;break}return f.abrupt("return");case 2:return f.next=4,this.messagesListPromise;case 4:d=f.sent,d.close(),this.messagesListPromise=null;case 7:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"sendV2",value:function(v){var g=this;return yr.debug("Sending message V2",v.mediaContent,v.attributes,v.emailOptions),new Ae.CancellablePromise(function(){var d=W.default(N.default.mark(function p(f,m,y){var k,E,L,j,Ie,Je,Dt,Ze,mr,cr,Ar,M;return N.default.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:E=[],L=[],y(function(){L.forEach(function(Be){return Be.cancel()})}),j=Bn(v.mediaContent),se.prev=4,j.s();case 6:if((Ie=j.n()).done){se.next=25;break}return Je=Xe.default(Ie.value,2),Dt=Je[0],Ze=Je[1],se.prev=8,yr.debug("Adding media to a message as ".concat(Ze instanceof FormData?"FormData":"SendMediaOptions"),Ze),Ar=Ze instanceof FormData?g.services.mcsClient.postFormData(Ze,Dt):g.services.mcsClient.post((mr=Ze.contentType)!==null&&mr!==void 0?mr:"",(cr=Ze.media)!==null&&cr!==void 0?cr:"",Dt,Ze.filename),L.push(Ar),se.t0=E,se.next=15,Ar;case 15:se.t1=se.sent,se.t0.push.call(se.t0,se.t1),se.next=23;break;case 19:return se.prev=19,se.t2=se.catch(8),m(se.t2),se.abrupt("return");case 23:se.next=6;break;case 25:se.next=30;break;case 27:se.prev=27,se.t3=se.catch(4),j.e(se.t3);case 30:return se.prev=30,j.f(),se.finish(30);case 33:return M=g.services.commandExecutor.mutateResource("post",g.conversation._links.messages,{body:v.text,subject:(k=v.emailOptions)===null||k===void 0?void 0:k.subject,media_sids:E.map(function(Be){return Be.sid}),attributes:typeof v.attributes<"u"?JSON.stringify(v.attributes):void 0}),se.prev=34,se.t4=f,se.next=38,M;case 38:se.t5=se.sent,(0,se.t4)(se.t5),se.next=45;break;case 42:se.prev=42,se.t6=se.catch(34),m(se.t6);case 45:case"end":return se.stop()}},p,null,[[4,27,30,33],[8,19],[34,42]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"send",value:function(){var _=W.default(N.default.mark(function g(d){var p,f,m=arguments;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return p=m.length>1&&m[1]!==void 0?m[1]:{},f=m.length>2?m[2]:void 0,yr.debug("Sending text message",d,p,f),k.abrupt("return",this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{body:d!=null?d:"",attributes:typeof p<"u"?JSON.stringify(p):void 0,subject:f==null?void 0:f.subject}));case 4:case"end":return k.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"sendMedia",value:function(){var _=W.default(N.default.mark(function g(d){var p,f,m,y,k,E=arguments;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(m=E.length>1&&E[1]!==void 0?E[1]:{},y=E.length>2?E[2]:void 0,yr.debug("Sending media message",d,m,y),yr.debug("Sending media message as ".concat(d instanceof FormData?"FormData":"SendMediaOptions"),d,m),!(d instanceof FormData)){j.next=10;break}return j.next=7,this.services.mcsClient.postFormData(d);case 7:j.t0=j.sent,j.next=13;break;case 10:return j.next=12,this.services.mcsClient.post((p=d.contentType)!==null&&p!==void 0?p:"",(f=d.media)!==null&&f!==void 0?f:"","media",d.filename);case 12:j.t0=j.sent;case 13:return k=j.t0,j.next=16,this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{media_sids:[k.sid],attributes:typeof m<"u"?JSON.stringify(m):void 0});case 16:return j.abrupt("return",j.sent);case 17:case"end":return j.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getMessages",value:function(){var _=W.default(N.default.mark(function g(d,p){var f,m=arguments;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=m.length>2&&m[2]!==void 0?m[2]:"backwards",k.abrupt("return",this._getMessages(d,p,f));case 2:case"end":return k.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_wrapPaginator",value:function(v,g,d){var p=this,f=v==="desc",m=function(){return g.nextPage().then(function(E){return p._wrapPaginator(v,E,d)})},y=function(){return g.prevPage().then(function(E){return p._wrapPaginator(v,E,d)})};return d(g.items).then(function(k){return{items:k.sort(function(E,L){return E.index-L.index}),hasPrevPage:f?g.hasNextPage:g.hasPrevPage,hasNextPage:f?g.hasPrevPage:g.hasNextPage,prevPage:f?m:y,nextPage:f?y:m}})}},{key:"_upsertMessage",value:function(v,g){var d=this,p=this.messagesByIndex.get(v);if(p)return p;var f={self:"".concat(this.conversation._links.messages,"/").concat(g.sid),conversation:this.conversation._links.self,messages_receipts:"".concat(this.conversation._links.messages,"/").concat(g.sid,"/Receipts")},m=new nr(v,g,this.conversation,f,this.configuration,this.services);return this.messagesByIndex.set(m.index,m),m.on("updated",function(y){return d.emit("messageUpdated",y)}),m}},{key:"_getMessages",value:function(){var _=W.default(N.default.mark(function g(){var d=this,p,f,m,y,k,E,L=arguments;return N.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return p=L.length>0&&L[0]!==void 0?L[0]:30,f=L.length>1&&L[1]!==void 0?L[1]:"end",m=L.length>2&&L[2]!==void 0?L[2]:"forward",y=m==="backwards"?"desc":"asc",Ie.next=6,this.messagesListPromise;case 6:return k=Ie.sent,Ie.next=9,k==null?void 0:k.getItems({from:f!=="end"?f:void 0,pageSize:p,order:y,limit:p});case 9:return E=Ie.sent,Ie.next=12,this._wrapPaginator(y,E,function(Je){return Promise.all(Je.map(function(Dt){return d._upsertMessage(Dt.index,Dt.data)}))});case 12:return Ie.abrupt("return",Ie.sent);case 13:case"end":return Ie.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter),Nr=function(){function C(O){ke.default(this,C),ie.default(this,"attributes",{}),ie.default(this,"mediaContent",[]),ie.default(this,"emailOptions",{}),this.messagesEntity=O}return Re.default(C,[{key:"send",value:function(){var S=this;return new Ae.CancellablePromise(function(){var _=W.default(N.default.mark(function v(g,d,p){var f,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=S.messagesEntity.sendV2(S),p(function(){return f.cancel()}),k.prev=2,k.next=5,f;case 5:m=k.sent,g(ee(m.index)),k.next=12;break;case 9:k.prev=9,k.t0=k.catch(2),d(k.t0);case 12:case"end":return k.stop()}},v,null,[[2,9]])}));return function(v,g,d){return _.apply(this,arguments)}}())}}]),C}(),ms=function(){function C(O,S){ke.default(this,C),this.limits=O,this.message=new Nr(S),this.emailBodies=new Map,this.emailHistories=new Map}return Re.default(C,[{key:"setBody",value:function(S){return this.message.text=S,this}},{key:"setSubject",value:function(S){return this.message.emailOptions.subject=S,this}},{key:"setAttributes",value:function(S){return this.message.attributes=S,this}},{key:"setEmailBody",value:function(S,_){return this.emailBodies.set(S,_),this}},{key:"setEmailHistory",value:function(S,_){return this.emailHistories.set(S,_),this}},{key:"addMedia",value:function(S){if(typeof FormData>"u"&&S instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(S instanceof FormData)){var _=S;if(!_.contentType||!_.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",S]),this}},{key:"build",value:function(){var S=this;if(this.emailBodies.forEach(function(_,v){if(!S.limits.emailBodiesAllowedContentTypes.includes(v))throw new Error("Unsupported email body content type ".concat(v))}),this.emailHistories.forEach(function(_,v){if(!S.limits.emailHistoriesAllowedContentTypes.includes(v))throw new Error("Unsupported email history content type ".concat(v))}),this.emailBodies.size>this.limits.emailBodiesAllowedContentTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedContentTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedContentTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedContentTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach(function(_){S.message.mediaContent.push(["body",_])}),this.emailHistories.forEach(function(_){S.message.mediaContent.push(["history",_])}),this.message}},{key:"buildAndSend",value:function(){return this.build().send()}},{key:"getPayloadContentType",value:function(S){return typeof FormData<"u"&&S instanceof FormData?S.get("Content-Type"):S.contentType}}]),C}();function Co(C,O){var S=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!S){if(Array.isArray(C)||(S=Ro(C))||O&&C&&typeof C.length=="number"){S&&(C=S);var _=0,v=function(){};return{s:v,n:function(){return _>=C.length?{done:!0}:{done:!1,value:C[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(C)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Ro(C,O){if(!!C){if(typeof C=="string")return bs(C,O);var S=Object.prototype.toString.call(C).slice(8,-1);if(S==="Object"&&C.constructor&&(S=C.constructor.name),S==="Map"||S==="Set")return Array.from(C);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return bs(C,O)}}function bs(C,O){(O==null||O>C.length)&&(O=C.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=C[S];return _}function Ao(C){var O=wn();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function wn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _n={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"},$t=function(C){te.default(S,C);var O=Ao(S);function S(_,v,g,d,p){var f,m,y;ke.default(this,S),y=O.call(this),y.sid=v,y._links=g,y._configuration=d,y._services=p,y._entityName=_.channel,y._internalState={uniqueName:_.uniqueName||null,status:"notParticipating",attributes:(f=_.attributes)!==null&&f!==void 0?f:{},createdBy:_.createdBy,dateCreated:Fe(_.dateCreated),dateUpdated:Fe(_.dateUpdated),friendlyName:_.friendlyName||null,lastReadMessageIndex:Number.isInteger(_.lastConsumedMessageIndex)?_.lastConsumedMessageIndex:null,bindings:(m=_.bindings)!==null&&m!==void 0?m:{}},_.notificationLevel&&(y._internalState.notificationLevel=_.notificationLevel);var k={participants:y._links.participants};return y._participants=new Map,y._participantsEntity=new je(ve.default(y),y._participants,k,y._configuration,y._services),y._participantsEntity.on("participantJoined",function(E){return y.emit("participantJoined",E)}),y._participantsEntity.on("participantLeft",function(E){return y.emit("participantLeft",E)}),y._participantsEntity.on("participantUpdated",function(E){return y.emit("participantUpdated",E)}),y._messagesEntity=new gs(ve.default(y),d,p),y._messagesEntity.on("messageAdded",function(E){return y._onMessageAdded(E)}),y._messagesEntity.on("messageUpdated",function(E){return y.emit("messageUpdated",E)}),y._messagesEntity.on("messageRemoved",function(E){return y.emit("messageRemoved",E)}),y}return Re.default(S,[{key:"uniqueName",get:function(){return this._internalState.uniqueName}},{key:"status",get:function(){return this._internalState.status}},{key:"friendlyName",get:function(){return this._internalState.friendlyName}},{key:"dateUpdated",get:function(){return this._internalState.dateUpdated}},{key:"dateCreated",get:function(){return this._internalState.dateCreated}},{key:"createdBy",get:function(){var v;return(v=this._internalState.createdBy)!==null&&v!==void 0?v:""}},{key:"attributes",get:function(){return this._internalState.attributes}},{key:"lastReadMessageIndex",get:function(){return this._internalState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var v;return(v=this._internalState.lastMessage)!==null&&v!==void 0?v:void 0}},{key:"notificationLevel",get:function(){var v;return(v=this._internalState.notificationLevel)!==null&&v!==void 0?v:"default"}},{key:"bindings",get:function(){return this._internalState.bindings}},{key:"limits",get:function(){return this._configuration.limits}},{key:"state",get:function(){return this._internalState.state}},{key:"_statusSource",get:function(){return this._dataSource}},{key:"add",value:function(){var _=W.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",this._participantsEntity.add(d,p!=null?p:{}));case 1:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"addNonChatParticipant",value:function(){var _=W.default(N.default.mark(function g(d,p){var f,m,y=arguments;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return f=y.length>2&&y[2]!==void 0?y[2]:{},m=y.length>3&&y[3]!==void 0?y[3]:{},E.abrupt("return",this._participantsEntity.addNonChatParticipant(d,p,f!=null?f:{},m!=null?m:{}));case 3:case"end":return E.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"advanceLastReadMessageIndex",value:function(){var _=W.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._subscribeStreams();case 2:if(!(d<((p=this.lastReadMessageIndex)!==null&&p!==void 0?p:0))){m.next=6;break}return m.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return m.abrupt("return",m.sent);case 6:return m.next=8,this._setLastReadMessageIndex(d);case 8:return m.abrupt("return",m.sent);case 9:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"delete",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._services.commandExecutor.mutateResource("delete",this._links.self);case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getAttributes",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribe();case 2:return p.abrupt("return",this.attributes);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getMessages",value:function(){var _=W.default(N.default.mark(function g(d,p,f){return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._subscribeStreams();case 2:return y.abrupt("return",this._messagesEntity.getMessages(d,p,f));case 3:case"end":return y.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"getParticipants",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribeStreams();case 2:return p.abrupt("return",this._participantsEntity.getParticipants());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantsCount",value:function(){var _=W.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=new Me(this._configuration.links.conversations).path(this.sid).build(),y.next=3,this._services.network.get(p);case 3:return f=y.sent,y.abrupt("return",(d=f.body.participants_count)!==null&&d!==void 0?d:0);case 5:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantBySid",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this._participantsEntity.getParticipantBySid(d));case 1:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getParticipantByIdentity",value:function(){var _=W.default(N.default.mark(function g(){var d,p=arguments;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return d=p.length>0&&p[0]!==void 0?p[0]:"",m.abrupt("return",this._participantsEntity.getParticipantByIdentity(d!=null?d:""));case 2:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getMessagesCount",value:function(){var _=W.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=new Me(this._configuration.links.conversations).path(this.sid).build(),y.next=3,this._services.network.get(p);case 3:return f=y.sent,y.abrupt("return",(d=f.body.messages_count)!==null&&d!==void 0?d:0);case 5:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getUnreadMessagesCount",value:function(){var _=W.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d=new Me(this._configuration.links.myConversations).path(this.sid).build(),y.next=3,this._services.network.get(d);case 3:if(p=y.sent,p.body.conversation_sid===this.sid){y.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if(f=p.body.unread_messages_count,typeof f!="number"){y.next=9;break}return y.abrupt("return",f);case 9:return y.abrupt("return",null);case 10:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"join",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._services.commandExecutor.mutateResource("post",this._links.participants,{identity:this._configuration.userIdentity});case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"leave",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this._internalState.status!=="joined"){p.next=3;break}return p.next=3,this._services.commandExecutor.mutateResource("delete","".concat(this._links.participants,"/").concat(this._configuration.userIdentity));case 3:return p.abrupt("return",this);case 4:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"removeParticipant",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._participantsEntity.remove(typeof d=="string"?d:d.sid);case 2:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"sendMessage",value:function(){var _=W.default(N.default.mark(function g(d,p,f){var m,y,k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!(typeof d=="string"||d===null)){j.next=5;break}return j.next=3,this._messagesEntity.send(d,p,f);case 3:return k=j.sent,j.abrupt("return",(y=ee(k.index))!==null&&y!==void 0?y:0);case 5:return j.next=7,this._messagesEntity.sendMedia(d,p,f);case 7:return E=j.sent,j.abrupt("return",(m=ee(E.index))!==null&&m!==void 0?m:0);case 9:case"end":return j.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"prepareMessage",value:function(){return new ms(this.limits,this._messagesEntity)}},{key:"setAllMessagesRead",value:function(){var _=W.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._subscribeStreams();case 2:return f.next=4,this.getMessages(1);case 4:if(d=f.sent,!(d.items.length>0)){f.next=7;break}return f.abrupt("return",this.advanceLastReadMessageIndex(d.items[0].index));case 7:return f.abrupt("return",0);case 8:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"setAllMessagesUnread",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribeStreams();case 2:return p.next=4,this._setLastReadMessageIndex(null);case 4:return p.abrupt("return",p.sent);case 5:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"setUserNotificationLevel",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{notification_level:d});case 2:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"typing",value:function(){return this._services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._services.commandExecutor.mutateResource("post",this._links.self,{attributes:d!==void 0?JSON.stringify(d):void 0});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateFriendlyName",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this._internalState.friendlyName===d){f.next=3;break}return f.next=3,this._services.commandExecutor.mutateResource("post",this._links.self,{friendly_name:d});case 3:return f.abrupt("return",this);case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateLastReadMessageIndex",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._subscribeStreams();case 2:return f.abrupt("return",this._setLastReadMessageIndex(d));case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateUniqueName",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this._internalState.uniqueName===d){f.next=4;break}return d||(d=""),f.next=4,this._services.commandExecutor.mutateResource("post",this._links.self,{unique_name:d});case 4:return f.abrupt("return",this);case 5:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"_subscribe",value:function(){var _=W.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this._entityPromise){f.next=2;break}return f.abrupt("return",this._entityPromise);case 2:return this._entityPromise=this._services.syncClient.document({id:this._entityName,mode:"open_existing"}),f.prev=3,f.next=6,this._entityPromise;case 6:return this._entity=f.sent,this._entity.on("updated",function(m){return d._update(m.data)}),this._entity.on("removed",function(){return d.emit("removed",d)}),this._update(this._entity.data),f.abrupt("return",this._entity);case 13:throw f.prev=13,f.t0=f.catch(3),this._entity=null,this._entityPromise=null,this._services.syncClient.connectionState!="disconnected"&&S._logger.error("Failed to get conversation object",f.t0),S._logger.debug("ERROR: Failed to get conversation object",f.t0),f.t0;case 20:case"end":return f.stop()}},g,this,[[3,13]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"_fetchStreams",value:function(){var _=W.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._subscribe();case 2:return S._logger.trace("_streamsAvailable, this.entity.data=",(d=this._entity)===null||d===void 0?void 0:d.data),f=(p=this._entity)===null||p===void 0?void 0:p.data,y.next=6,this._services.syncClient.list({id:f.messages,mode:"open_existing"});case 6:return this._messagesList=y.sent,y.next=9,this._services.syncClient.map({id:f.roster,mode:"open_existing"});case 9:this._participantsMap=y.sent;case 10:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_subscribeStreams",value:function(){var _=W.default(N.default.mark(function g(){var d,p,f,m,y,k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,j.next=3,this._subscribe();case 3:return S._logger.trace("_subscribeStreams, this.entity.data=",(d=this._entity)===null||d===void 0?void 0:d.data),y=(p=this._entity)===null||p===void 0?void 0:p.data,k=y.messages,E=y.roster,j.next=9,Promise.all([this._messagesEntity.subscribe((f=this._messagesList)!==null&&f!==void 0?f:k),this._participantsEntity.subscribe((m=this._participantsMap)!==null&&m!==void 0?m:E)]);case 9:j.next=16;break;case 11:throw j.prev=11,j.t0=j.catch(0),this._services.syncClient.connectionState!=="disconnected"&&S._logger.error("Failed to subscribe on conversation objects",this.sid,j.t0),S._logger.debug("ERROR: Failed to subscribe on conversation objects",this.sid,j.t0),j.t0;case 16:case"end":return j.stop()}},g,this,[[0,11]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"_unsubscribe",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!this._entity){p.next=5;break}return p.next=3,this._entity.close();case 3:this._entity=null,this._entityPromise=null;case 5:return p.abrupt("return",Promise.all([this._participantsEntity.unsubscribe(),this._messagesEntity.unsubscribe()]));case 6:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_setStatus",value:function(v,g){var d=this;if(this._dataSource=g,this._internalState.status!==v){if(this._internalState.status=v,v==="joined"){this._subscribeStreams().catch(function(p){if(S._logger.debug("ERROR while setting conversation status "+v,p),d._services.syncClient.connectionState!=="disconnected")throw p});return}this._entityPromise&&this._unsubscribe().catch(function(p){if(S._logger.debug("ERROR while setting conversation status "+v,p),d._services.syncClient.connectionState!=="disconnected")throw p})}}},{key:"_update",value:function(v){var g,d,p,f,m;S._logger.trace("_update",v),S.preprocessUpdate(v,this.sid);for(var y=new Set,k=0,E=Object.keys(v);k<E.length;k++){var L=E[k],j=_n[L];if(!!j)switch(j){case _n.status:if(!v.status||v.status==="unknown"||this._internalState.status===v.status)break;this._internalState.status=v.status,y.add(j);break;case _n.attributes:if(Ee.default(this._internalState.attributes,v.attributes))break;this._internalState.attributes=v.attributes,y.add(j);break;case _n.lastConsumedMessageIndex:if(v.lastConsumedMessageIndex===void 0||v.lastConsumedMessageIndex===this._internalState.lastReadMessageIndex)break;this._internalState.lastReadMessageIndex=v.lastConsumedMessageIndex,y.add("lastReadMessageIndex");break;case _n.lastMessage:if(this._internalState.lastMessage&&!v.lastMessage){delete this._internalState.lastMessage,y.add(j);break}this._internalState.lastMessage=this._internalState.lastMessage||{},((g=v.lastMessage)===null||g===void 0?void 0:g.index)!==void 0&&v.lastMessage.index!==this._internalState.lastMessage.index&&(this._internalState.lastMessage.index=v.lastMessage.index,y.add(j)),((d=v.lastMessage)===null||d===void 0?void 0:d.timestamp)!==void 0&&((p=this._internalState.lastMessage)===null||p===void 0||(f=p.dateCreated)===null||f===void 0?void 0:f.getTime())!==v.lastMessage.timestamp.getTime()&&(this._internalState.lastMessage.dateCreated=v.lastMessage.timestamp,y.add(j)),Ee.default(this._internalState.lastMessage,{})&&delete this._internalState.lastMessage;break;case _n.state:var Ie=v.state||void 0;if(Ie!==void 0&&(Ie.dateUpdated=new Date(Ie.dateUpdated)),Ee.default(this._internalState.state,Ie))break;this._internalState.state=Ie,y.add(j);break;case _n.bindings:if(Ee.default(this._internalState.bindings,v.bindings))break;this._internalState.bindings=v.bindings,y.add(j);break;default:var Je=v[L]instanceof Date,Dt=Je&&((m=this._internalState[j])===null||m===void 0?void 0:m.getTime())===v[L].getTime(),Ze=!Je&&this[j]===v[L];if(Dt||Ze)break;this._internalState[j]=v[L],y.add(j)}}y.size>0&&this.emit("updated",{conversation:this,updateReasons:Ye.default(y)})}},{key:"_onMessageAdded",value:function(v){var g=Co(this._participants.values()),d;try{for(g.s();!(d=g.n()).done;){var p=d.value;if(p.identity===v.author){p._endTyping();break}}}catch(f){g.e(f)}finally{g.f()}this.emit("messageAdded",v)}},{key:"_setLastReadMessageIndex",value:function(){var _=W.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:d});case 2:return p=m.sent,m.abrupt("return",p.unread_messages_count);case 4:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}],[{key:"preprocessUpdate",value:function(v,g){try{typeof v.attributes=="string"?v.attributes=JSON.parse(v.attributes):v.attributes&&JSON.stringify(v.attributes)}catch{S._logger.warn("Retrieved malformed attributes from the server for conversation: "+g),v.attributes={}}try{v.dateCreated&&(v.dateCreated=new Date(v.dateCreated))}catch{S._logger.warn("Retrieved malformed dateCreated from the server for conversation: "+g),delete v.dateCreated}try{v.dateUpdated&&(v.dateUpdated=new Date(v.dateUpdated))}catch{S._logger.warn("Retrieved malformed dateUpdated from the server for conversation: "+g),delete v.dateUpdated}try{v.lastMessage&&v.lastMessage.timestamp&&(v.lastMessage.timestamp=new Date(v.lastMessage.timestamp))}catch{S._logger.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+g),delete v.lastMessage.timestamp}}}]),S}($.ReplayEventEmitter);ie.default($t,"participantJoined","participantJoined"),ie.default($t,"participantLeft","participantLeft"),ie.default($t,"participantUpdated","participantUpdated"),ie.default($t,"messageAdded","messageAdded"),ie.default($t,"messageRemoved","messageRemoved"),ie.default($t,"messageUpdated","messageUpdated"),ie.default($t,"typingEnded","typingEnded"),ie.default($t,"typingStarted","typingStarted"),ie.default($t,"updated","updated"),ie.default($t,"removed","removed"),ie.default($t,"_logger",Ke.scope("Conversation")),B([b.validateTypesAsync(b.nonEmptyString,F),T("design:type",Function),T("design:paramtypes",[String,Object]),T("design:returntype",Promise)],$t.prototype,"add",null),B([b.validateTypesAsync(b.nonEmptyString,b.nonEmptyString,F),T("design:type",Function),T("design:paramtypes",[String,String,Object,Object]),T("design:returntype",Promise)],$t.prototype,"addNonChatParticipant",null),B([b.validateTypesAsync(b.nonNegativeInteger),T("design:type",Function),T("design:paramtypes",[Number]),T("design:returntype",Promise)],$t.prototype,"advanceLastReadMessageIndex",null),B([b.validateTypesAsync(["undefined",b.nonNegativeInteger],["undefined",b.nonNegativeInteger],["undefined",b.literal("backwards","forward")]),T("design:type",Function),T("design:paramtypes",[Number,Number,String]),T("design:returntype",Promise)],$t.prototype,"getMessages",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],$t.prototype,"getParticipantBySid",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],$t.prototype,"getParticipantByIdentity",null),B([b.validateTypesAsync([b.nonEmptyString,V]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],$t.prototype,"removeParticipant",null),B([b.validateTypesAsync(["string",FormData,b.literal(null),b.objectSchema("media options",{contentType:b.nonEmptyString,media:b.custom(function(C){var O=typeof C=="string"&&C.length>0||C instanceof Uint8Array||C instanceof ArrayBuffer;return typeof Blob=="function"&&(O=O||C instanceof Blob),[O,"a non-empty string, an instance of Buffer or an instance of Blob"]})})],F,["undefined",b.literal(null),b.objectSchema("email attributes",{subject:[b.nonEmptyString,"undefined"]})]),T("design:type",Function),T("design:paramtypes",[Object,Object,Object]),T("design:returntype",Promise)],$t.prototype,"sendMessage",null),B([b.validateTypesAsync(b.literal("default","muted")),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],$t.prototype,"setUserNotificationLevel",null),B([b.validateTypesAsync(oe),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],$t.prototype,"updateAttributes",null),B([b.validateTypesAsync("string"),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],$t.prototype,"updateFriendlyName",null),B([b.validateTypesAsync([b.literal(null),b.nonNegativeInteger]),T("design:type",Function),T("design:paramtypes",[Number]),T("design:returntype",Promise)],$t.prototype,"updateLastReadMessageIndex",null),B([b.validateTypesAsync(["string",b.literal(null)]),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],$t.prototype,"updateUniqueName",null);var Oo=function(){function C(){var O=this;ke.default(this,C),this._promise=new Promise(function(S,_){O._resolve=S,O._reject=_})}return Re.default(C,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(S){this._resolve(S)}},{key:"set",value:function(S){this.current=S,this._resolve(S)}},{key:"fail",value:function(S){this._reject(S)}}]),C}();function Po(C,O){var S=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!S){if(Array.isArray(C)||(S=Mo(C))||O&&C&&typeof C.length=="number"){S&&(C=S);var _=0,v=function(){};return{s:v,n:function(){return _>=C.length?{done:!0}:{done:!1,value:C[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(C)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Mo(C,O){if(!!C){if(typeof C=="string")return na(C,O);var S=Object.prototype.toString.call(C).slice(8,-1);if(S==="Object"&&C.constructor&&(S=C.constructor.name),S==="Map"||S==="Set")return Array.from(C);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return na(C,O)}}function na(C,O){(O==null||O>C.length)&&(O=C.length);for(var S=0,_=new Array(O);S<O;S++)_[S]=C[S];return _}function ws(C,O){var S=Object.keys(C);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(C);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(C,v).enumerable})),S.push.apply(S,_)}return S}function xo(C){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?ws(Object(S),!0).forEach(function(_){ie.default(C,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(S)):ws(Object(S)).forEach(function(_){Object.defineProperty(C,_,Object.getOwnPropertyDescriptor(S,_))})}return C}function tn(C){var O=No();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function No(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gr=Ke.scope("Conversations"),Lo=function(C){te.default(S,C);var O=tn(S);function S(_,v){var g;return ke.default(this,S),g=O.call(this),ie.default(ve.default(g),"conversations",new Map),ie.default(ve.default(g),"myConversationsRead",new Oo),ie.default(ve.default(g),"tombstones",new Set),ie.default(ve.default(g),"myConversationsFetched",!1),g.configuration=_,g.services=v,g}return Re.default(S,[{key:"addConversation",value:function(){var _=W.default(N.default.mark(function g(d){var p,f,m,y,k,E,L,j,Ie,Je;return N.default.wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return y=typeof(d==null?void 0:d.attributes)<"u"?d.attributes:{},Ze.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:d.friendlyName,unique_name:d.uniqueName,attributes:typeof y<"u"?JSON.stringify(y):void 0});case 3:if(k=Ze.sent,E=(p=k.sid)!==null&&p!==void 0?p:null,L=(f=(m=k.sync_objects)===null||m===void 0?void 0:m.conversation)!==null&&f!==void 0?f:null,j=xo({self:k.url},k.links),Ie=this.conversations.get(E),!Ie){Ze.next=12;break}return Ze.next=11,Ie._subscribe();case 11:return Ze.abrupt("return",Ie);case 12:return Je=new $t({channel:L,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},E,j,this.configuration,this.services),this.conversations.set(Je.sid,Je),this._registerForEvents(Je),Ze.next=17,Je._subscribe();case 17:return this.emit("conversationAdded",Je),Ze.abrupt("return",Je);case 19:case"end":return Ze.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"fetchConversations",value:function(){var _=W.default(N.default.mark(function g(){var d=this,p,f,m,y,k,E,L;return N.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.prev=0,Ie.next=3,this._getMap();case 3:return p=Ie.sent,p.on("itemAdded",function(Je){gr.debug("itemAdded: ".concat(Je.item.key)),d._upsertConversation("sync",Je.item.key,Je.item.data)}),p.on("itemRemoved",function(Je){gr.debug("itemRemoved: ".concat(Je.key));var Dt=Je.key;d.myConversationsFetched||d.tombstones.add(Dt);var Ze=d.conversations.get(Dt);!Ze||(Ze.status==="joined"&&(Ze._setStatus("notParticipating","sync"),d.emit("conversationLeft",Ze)),d.conversations.delete(Dt),d.emit("conversationRemoved",Ze),Ze.emit("removed",Ze))}),p.on("itemUpdated",function(Je){gr.debug("itemUpdated: ".concat(Je.item.key)),d._upsertConversation("sync",Je.item.key,Je.item.data)}),Ie.next=9,this._fetchMyConversations();case 9:f=Ie.sent,m=[],y=Po(f);try{for(y.s();!(k=y.n()).done;)E=k.value,m.push(this._upsertConversation("rest",E.channel_sid,E))}catch(Je){y.e(Je)}finally{y.f()}return this.myConversationsRead.set(!0),Ie.next=16,Promise.all(m);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),gr.debug("The conversations list has been successfully fetched"),Ie.abrupt("return",this);case 22:throw Ie.prev=22,Ie.t0=Ie.catch(0),L="Failed to fetch the conversations list",this.services.syncClient.connectionState!=="disconnected"&&gr.error(L,Ie.t0),gr.debug("ERROR: ".concat(L),Ie.t0),Ie.t0;case 28:case"end":return Ie.stop()}},g,this,[[0,22]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"getConversations",value:function(){var _=W.default(N.default.mark(function g(){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._getMap();case 2:return p=y.sent,y.next=5,p.getItems();case 5:return f=y.sent,y.abrupt("return",this._wrapPaginator(f,function(k){return Promise.all(k.map(function(E){return d._upsertConversation("sync",E.key,E.data)}))}));case 7:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getConversation",value:function(){var _=W.default(N.default.mark(function g(d){var p=this,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._getMap();case 2:return f=E.sent,E.next=5,f.getItems({key:d});case 5:return m=E.sent,y=m.items.map(function(L){return p._upsertConversation("sync",L.key,L.data)}),E.abrupt("return",y.length>0?y[0]:null);case 8:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationByUniqueName",value:function(){var _=W.default(N.default.mark(function g(d){var p,f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return p=new Me(this.configuration.links.myConversations).path(d).build(),L.next=3,this.services.network.get(p);case 3:return f=L.sent,m=f.body,y=m.conversation_sid,k={entityName:null,lastConsumedMessageIndex:m.last_read_message_index,status:(m==null?void 0:m.status)||"unknown",friendlyName:m.friendly_name,dateUpdated:m.date_updated,dateCreated:m.date_created,uniqueName:m.unique_name,createdBy:m.created_by,attributes:m.attributes,channel:m.sync_objects.conversation,notificationLevel:m==null?void 0:m.notification_level,sid:y},L.abrupt("return",y?this._upsertConversation("sync",y,k):null);case 8:case"end":return L.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"peekConversation",value:function(){var _=W.default(N.default.mark(function g(d){var p,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return p=new Me(this.configuration.links.conversations).path(d).build(),E.next=3,this.services.network.get(p);case 3:return f=E.sent,m=f.body,y={entityName:null,status:(m==null?void 0:m.status)||"unknown",friendlyName:m.friendly_name,dateUpdated:m.date_updated,dateCreated:m.date_created,uniqueName:m.unique_name,createdBy:m.created_by,attributes:m.attributes,channel:"".concat(d,".channel"),sid:d},E.abrupt("return",this._upsertConversation("sync",d,y));case 7:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"_getMap",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_wrapPaginator",value:function(){var _=W.default(N.default.mark(function g(d,p){var f=this,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,p(d.items);case 2:return m=k.sent,k.abrupt("return",{items:m.filter(function(E){return E!==null}),hasNextPage:d.hasNextPage,hasPrevPage:d.hasPrevPage,nextPage:function(){return d.nextPage().then(function(L){return f._wrapPaginator(L,p)})},prevPage:function(){return d.prevPage().then(function(L){return f._wrapPaginator(L,p)})}});case 4:case"end":return k.stop()}},g)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_updateConversation",value:function(){var _=W.default(N.default.mark(function g(d,p,f){var m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(m=p._statusSource!==void 0&&d!==p._statusSource,y=d!=="rest"||p._statusSource==="sync",!(m&&y&&d!=="sync")){L.next=5;break}return gr.trace("upsertConversation: conversation is known from sync and came from REST, ignoring",{sid:p.sid,data:f.status,conversation:p.status}),L.abrupt("return");case 5:if(!(f.status==="joined"&&p.status!=="joined")){L.next=15;break}return p._setStatus("joined",d),k={},typeof f.notificationLevel<"u"&&(k.notificationLevel=f.notificationLevel),typeof f.lastConsumedMessageIndex<"u"&&(k.lastConsumedMessageIndex=f.lastConsumedMessageIndex),Ee.default(k,{})||p._update(k),L.next=13,p._subscribe();case 13:return this.emit("conversationJoined",p),L.abrupt("return");case 15:if(!(f.status==="notParticipating"&&p.status==="joined")){L.next=22;break}return p._setStatus("notParticipating",d),p._update(f),L.next=20,p._subscribe();case 20:return this.emit("conversationLeft",p),L.abrupt("return");case 22:if(f.status!=="notParticipating"){L.next=26;break}return L.next=25,p._subscribe();case 25:return L.abrupt("return");case 26:p._update(f);case 27:case"end":return L.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"_upsertConversation",value:function(){var _=W.default(N.default.mark(function g(d,p,f){var m,y,k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(gr.trace("upsertConversation called for ".concat(p),f),m=this.conversations.get(p),!m){j.next=9;break}return gr.trace("upsertConversation: the conversation ".concat(m.sid," is known;")+"its status is known from the source ".concat(m._statusSource," ")+"and the update came from the source ".concat(d),m),j.next=6,this._updateConversation(d,m,f);case 6:return j.next=8,m._subscribe();case 8:return j.abrupt("return",m);case 9:if(!(d==="rest"&&this.tombstones.has(p))){j.next=12;break}return gr.trace("upsertChannel: the conversation is deleted but reappeared again from REST, ignoring",p),j.abrupt("return",null);case 12:return gr.trace("upsertConversation: creating a local conversation object with sid "+p,f),y="".concat(this.configuration.links.conversations,"/").concat(p),k={self:y,messages:"".concat(y,"/Messages"),participants:"".concat(y,"/Participants")},E=new $t(f,p,k,this.configuration,this.services),this.conversations.set(p,E),j.prev=17,j.next=20,E._subscribe();case 20:if(f.status!=="joined"){j.next=23;break}return j.next=23,E._fetchStreams();case 23:j.next=32;break;case 25:if(j.prev=25,j.t0=j.catch(17),j.t0.name==="SyncError"){j.next=29;break}throw j.t0;case 29:return gr.trace("upsertChannel: the conversation is missing some Sync entity(ies), ignoring",p,j.t0),this.conversations.delete(p),j.abrupt("return",null);case 32:return this._registerForEvents(E),this.emit("conversationAdded",E),f.status==="joined"&&(E._setStatus("joined",d),this.emit("conversationJoined",E)),j.abrupt("return",E);case 36:case"end":return j.stop()}},g,this,[[17,25]])}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"_fetchMyConversations",value:function(){var _=W.default(N.default.mark(function g(){var d,p,f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:d=[],p=null;case 2:return m=new Me(this.configuration.links.myConversations),p&&m.arg("PageToken",p),L.next=6,this.services.network.get(m.build());case 6:y=L.sent,k=(f=y.body)===null||f===void 0?void 0:f.conversations.map(function(j){return{descriptor:j,channel_sid:j.conversation_sid,status:j.status,channel:j.sync_objects.conversation,messages:j.sync_objects.messages,roster:"".concat(j.conversation_sid,".roster"),lastConsumedMessageIndex:j.last_read_message_index,notificationLevel:j.notification_level}}),p=y.body.meta.next_token,d=[].concat(Ye.default(d),Ye.default(k));case 10:if(p){L.next=2;break}case 11:return L.abrupt("return",d);case 12:case"end":return L.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_onConversationRemoved",value:function(v){var g=this.conversations.get(v);g&&(this.conversations.delete(v),this.emit("conversationRemoved",g))}},{key:"_registerForEvents",value:function(v){var g=this;v.on("removed",function(){return g._onConversationRemoved(v.sid)}),v.on("updated",function(d){return g.emit("conversationUpdated",d)}),v.on("participantJoined",function(d){return g.emit("participantJoined",d)}),v.on("participantLeft",function(d){return g.emit("participantLeft",d)}),v.on("participantUpdated",function(d){return g.emit("participantUpdated",d)}),v.on("messageAdded",function(d){return g.emit("messageAdded",d)}),v.on("messageUpdated",function(d){return g.emit("messageUpdated",d)}),v.on("messageRemoved",function(d){return g.emit("messageRemoved",d)}),v.on("typingStarted",function(d){return g.emit("typingStarted",d)}),v.on("typingEnded",function(d){return g.emit("typingEnded",d)})}}]),S}($.ReplayEventEmitter);function jo(C){var O=Uo();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function Uo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Fo=function(C){te.default(S,C);var O=jo(S);function S(_,v,g){var d;return ke.default(this,S),d=O.call(this),d.configuration=v,d.services=g,d.fifoStack=[],d.myself=_,d.myself.on("updated",function(p){return d.emit("userUpdated",p)}),d.myself.on("userSubscribed",function(){return d.emit("userSubscribed",d.myself)}),d.myself.on("userUnsubscribed",function(){d.emit("userUnsubscribed",d.myself),d.myself._ensureFetched()}),d.subscribedUsers=new Map,d}return Re.default(S,[{key:"handleUnsubscribeUser",value:function(v){this.subscribedUsers.has(v.identity)&&this.subscribedUsers.delete(v.identity);var g=0,d=this.fifoStack.find(function(p,f){return p==v.identity?(g=f,!0):!1});d&&this.fifoStack.splice(g,1),this.emit("userUnsubscribed",v)}},{key:"handleSubscribeUser",value:function(v){if(!this.subscribedUsers.has(v.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var g,d,p=this.fifoStack.shift();(g=this.subscribedUsers)===null||g===void 0||(d=g.get(p))===null||d===void 0||d.unsubscribe()}this.fifoStack.push(v.identity),this.subscribedUsers.set(v.identity,v),this.emit("userSubscribed",v)}}},{key:"getUser",value:function(){var _=W.default(N.default.mark(function g(d,p){var f,m=this,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.myself._ensureFetched();case 2:if(d!=this.myself.identity){L.next=4;break}return L.abrupt("return",this.myself);case 4:if(y=this.subscribedUsers.get(d),!y){L.next=7;break}return L.abrupt("return",y);case 7:if(!((f=p)!==null&&f!==void 0)){L.next=11;break}L.next=14;break;case 11:return L.next=13,this.getSyncUniqueName(d);case 13:p=L.sent;case 14:return k=new Ne(d,p,this.configuration,this.services),k.on("updated",function(j){return m.emit("userUpdated",j)}),k.on("userSubscribed",function(){return m.handleSubscribeUser(k)}),k.on("userUnsubscribed",function(){return m.handleUnsubscribeUser(k)}),L.next=20,k._ensureFetched();case 20:return L.abrupt("return",k);case 21:case"end":return L.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"getSubscribedUsers",value:function(){var _=W.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.myself._ensureFetched();case 2:return d=[this.myself],this.subscribedUsers.forEach(function(m){return d.push(m)}),f.abrupt("return",d);case 5:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getSyncUniqueName",value:function(){var _=W.default(N.default.mark(function g(d){var p,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return m=new Me(this.configuration.links.users).path(d).build(),E.next=3,this.services.network.get(m);case 3:return y=E.sent,E.abrupt("return",(p=(f=y.body)===null||f===void 0?void 0:f.sync_objects.user_info_map)!==null&&p!==void 0?p:"");case 5:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter),Sn=Ke.scope("TypingIndicator"),Do=function(){function C(O,S,_){ke.default(this,C),this.configuration=S,this.services=_,this.getConversation=O,this.serviceTypingTimeout=null,this.sentUpdates=new Map}return Re.default(C,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var S=this;this.services.notificationClient.on("message",function(){var _=W.default(N.default.mark(function v(g,d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(g!==Le.TYPING_INDICATOR){f.next=3;break}return f.next=3,S._handleRemoteTyping(d);case 3:case"end":return f.stop()}},v)}));return function(v,g){return _.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:function(){var O=W.default(N.default.mark(function _(v){var g=this;return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:Sn.trace("Got new typing indicator ",v),this.getConversation(v.channel_sid).then(function(f){!f||f._participants.forEach(function(m){if(m.identity===v.identity){var y=g.configuration.typingIndicatorTimeoutOverride?g.configuration.typingIndicatorTimeoutOverride+1e3:v.typing_timeout*1e3;m._startTyping(y)}})}).catch(function(f){throw Sn.error(f),f});case 2:case"end":return p.stop()}},_,this)}));function S(_){return O.apply(this,arguments)}return S}()},{key:"send",value:function(S){var _=this.sentUpdates.get(S);return _&&_>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(S,Date.now()),this._send(S))}},{key:"_send",value:function(S){var _=this;Sn.trace("Sending typing indicator");var v=this.configuration.links.typing,g={"Content-Type":"application/x-www-form-urlencoded"},d="ChannelSid=".concat(S);return this.services.twilsockClient.post(v,g,d,this.configuration.productId).then(function(p){p.body.hasOwnProperty("typing_timeout")&&(_.serviceTypingTimeout=p.body.typing_timeout*1e3)}).catch(function(p){throw Sn.error("Failed to send typing indicator:",p),p})}}]),C}(),Lr=Re.default(function C(O){ke.default(this,C),this.title=O.title||null,this.body=O.body||null,this.sound=O.sound||null,this.badge=O.badge||null,this.action=O.action||null,this.type=O.type||null,this.data=O.data||{}}),ja="2.2.0";function ki(C,O){var S=Object.keys(C);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(C);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(C,v).enumerable})),S.push.apply(S,_)}return S}function Bo(C){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?ki(Object(S),!0).forEach(function(_){ie.default(C,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(S)):ki(Object(S)).forEach(function(_){Object.defineProperty(C,_,Object.getOwnPropertyDescriptor(S,_))})}return C}var _s=function(O){return O.replace(/(^\/+|\/+$)/g,"")},qo=function(O){return O.status.code===202},Ho=function(){function C(O,S,_){ke.default(this,C),this._serviceUrl=O,this._services=S,this._productId=_}return Re.default(C,[{key:"_preProcessUrl",value:function(S){var _=_s(S);return/^https?:\/\//.test(S)?_:"".concat(_s(this._serviceUrl),"/").concat(_)}},{key:"_makeRequest",value:function(){var O=W.default(N.default.mark(function _(v,g,d,p){var f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:f=this._preProcessUrl(g),m=Bo({"Content-Type":"application/json; charset=utf-8"},p||{}),L.t0=v,L.next=L.t0==="get"?5:L.t0==="post"?11:L.t0==="delete"?15:19;break;case 5:return k=f,d&&(k+="?"+Object.entries(d).map(function(j){return j.map(encodeURIComponent).join("=")}).join("&")),L.next=9,this._services.transport.get(k,m,this._productId);case 9:return y=L.sent,L.abrupt("break",19);case 11:return L.next=13,this._services.transport.post(f,m,JSON.stringify(d),this._productId);case 13:return y=L.sent,L.abrupt("break",19);case 15:return L.next=17,this._services.transport.delete(f,m,{},this._productId);case 17:return y=L.sent,L.abrupt("break",19);case 19:if(!(y.status.code<200||y.status.code>=300)){L.next=21;break}throw new Error("Request responded with a non-success code ".concat(y.status.code));case 21:return L.abrupt("return",y);case 22:case"end":return L.stop()}},_,this)}));function S(_,v,g,d){return O.apply(this,arguments)}return S}()},{key:"fetchResource",value:function(){var O=W.default(N.default.mark(function _(v,g){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=6,y.prev=1,y.next=4,new U.AsyncRetrier({min:50,max:1600,maxAttemptsCount:p}).run(function(){return d._makeRequest("get",v,g)});case 4:return f=y.sent,y.abrupt("return",f.body);case 8:throw y.prev=8,y.t0=y.catch(1),new Error('Fetch resource from "'.concat(v,'" failed.'));case 11:case"end":return y.stop()}},_,null,[[1,8]])}));function S(_,v){return O.apply(this,arguments)}return S}()},{key:"mutateResource",value:function(){var O=W.default(N.default.mark(function _(v,g,d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._makeRequest(v,g,d,{"X-Twilio-Mutation-Id":P.v4()});case 2:if(p=m.sent,!qo(p)){m.next=7;break}return m.next=6,this.fetchResource(p.body.resource_url);case 6:return m.abrupt("return",m.sent);case 7:return m.abrupt("return",p.body);case 8:case"end":return m.stop()}},_,this)}));function S(_,v,g){return O.apply(this,arguments)}return S}()}]),C}(),yt;function Ss(C,O){var S=Object.keys(C);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(C);O&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(C,v).enumerable})),S.push.apply(S,_)}return S}function Ua(C){for(var O=1;O<arguments.length;O++){var S=arguments[O]!=null?arguments[O]:{};O%2?Ss(Object(S),!0).forEach(function(_){ie.default(C,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(S)):Ss(Object(S)).forEach(function(_){Object.defineProperty(C,_,Object.getOwnPropertyDescriptor(S,_))})}return C}function Ei(C){var O=aa();return function(){var _=J.default(C),v;if(O){var g=J.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return ae.default(this,v)}}function aa(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vt,$s=Re.default(function C(){ke.default(this,C)});e.Client=vt=(yt=function(C){te.default(S,C);var O=Ei(S);function S(_){var v,g,d,p,f,m,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ke.default(this,S),m=O.call(this),ie.default(ve.default(m),"version",ja),ie.default(ve.default(m),"connectionState","unknown"),ie.default(ve.default(m),"parsePushNotification",vt.parsePushNotification),m._fpaToken=_!=null?_:"",m._options=y!=null?y:{},!m._options.disableDeepClone){var k=Ua(Ua({},m._options),{},{transport:void 0,twilsockClient:void 0});k=Oe(k),k.transport=m._options.transport,k.twilsockClient=m._options.twilsockClient,m._options=k}m._options.logLevel=(v=m._options.logLevel)!==null&&v!==void 0?v:"silent",vt._logger.setLevel(m._options.logLevel);var E=m._options.productId="ip_messaging";if(m._options.clientMetadata=m._options.clientMetadata||{},m._options.clientMetadata.hasOwnProperty("type")||(m._options.clientMetadata.type="conversations"),m._options.clientMetadata.hasOwnProperty("sdk")||(m._options.clientMetadata.sdk="JS",m._options.clientMetadata.sdkv=ja),m._options.Sync=m._options.Sync||{},typeof m._options.Sync.enableSessionStorage>"u"&&(m._options.Sync.enableSessionStorage=!0),m._options.region&&(m._options.Sync.region=m._options.region),!_)throw new Error("A valid Twilio token should be provided");m._services=new $s,m._myself=new Ne("","",null,m._services);var L=!m._options.twilsockClient;if(!m._options.initRegistrations){var j=new D.InitRegistration(E);vt.populateInitRegistrations(j),m._options.initRegistrations=[j]}m._services.twilsockClient=m._options.twilsockClient=(g=m._options.twilsockClient)!==null&&g!==void 0?g:new D.TwilsockClient(_,E,m._options),m._services.twilsockClient.on("tokenAboutToExpire",function(){return m.emit("tokenAboutToExpire")}),m._services.twilsockClient.on("tokenExpired",function(){return m.emit("tokenExpired")}),m._services.twilsockClient.on("connectionError",function(cr){return m.emit("connectionError",cr)}),m._services.twilsockClient.on("stateChanged",function(cr){vt._logger.debug("Handling stateChanged for ConversationsClient: new state ".concat(cr)),cr!==m.connectionState&&(m.connectionState=cr,m.emit("connectionStateChanged",m.connectionState))}),m._services.transport=m._options.transport=(d=m._options.transport)!==null&&d!==void 0?d:m._options.twilsockClient,m._services.notificationClient=m._options.notificationsClient=(p=m._options.notificationsClient)!==null&&p!==void 0?p:new de.Notifications(_,m._options),m._services.syncClient=m._options.syncClient=(f=m._options.syncClient)!==null&&f!==void 0?f:new ue.SyncClient(_,m._options);var Ie=(y==null?void 0:y.Chat)||(y==null?void 0:y.IPMessaging)||y||{},Je=Ie.region||(y==null?void 0:y.region),Dt=Ie.apiUri||Ie.typingUri||"https://aim.".concat(Je||"us1",".twilio.com");m._services.commandExecutor=new Ho(Dt,{transport:m._options.transport},E);var Ze=function(Ar){m._rejectEnsureReady(Ar),m.emit("stateChanged","failed"),m.emit("initFailed",{error:Ar})},mr=function(){Ze({terminal:!0,message:"Twilsock has disconnected."})};return m._services.twilsockClient.once("connectionError",Ze),m._services.twilsockClient.once("disconnected",mr),m._services.twilsockClient.once("connected",W.default(N.default.mark(function cr(){var Ar,M;return N.default.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return vt._logger.debug("ConversationsClient started INITIALIZING"),m._services.twilsockClient.off("connectionError",Ze),m._services.twilsockClient.off("disconnected",mr),se.prev=3,Ar="conversations.client.startup",m._services.twilsockClient.addPartialTelemetryEvent(new D.TelemetryEventDescription(Ar,"Conversations client startup",new Date),Ar,D.TelemetryPoint.Start),se.next=8,m._initialize();case 8:m._services.twilsockClient.addPartialTelemetryEvent(new D.TelemetryEventDescription("","",new Date),Ar,D.TelemetryPoint.End),se.next=17;break;case 11:se.prev=11,se.t0=se.catch(3),M={terminal:!0,message:se.t0.message},m._rejectEnsureReady(M),m.emit("stateChanged","failed"),m.emit("initFailed",{error:M});case 17:case"end":return se.stop()}},cr,null,[[3,11]])}))),m._ensureReady=new Promise(function(cr,Ar){m._resolveEnsureReady=cr,m._rejectEnsureReady=Ar}).catch(function(){}),L&&m._services.twilsockClient.connect(),m}return Re.default(S,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this._configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this._configuration.reachabilityEnabled}},{key:"token",get:function(){return this._fpaToken}},{key:"shutdown",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.next=4,this._services.twilsockClient.disconnect();case 4:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateToken",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:if(vt._logger.info("updateToken"),this._fpaToken!==d){f.next=5;break}return f.abrupt("return",this);case 5:return f.next=7,this._services.twilsockClient.updateToken(d);case 7:return f.next=9,this._services.notificationClient.updateToken(d);case 9:return f.next=11,this._services.mcsClient.updateToken(d);case 11:return this._fpaToken=d,f.abrupt("return",this);case 13:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationBySid",value:function(){var _=W.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return m.next=6,this._conversationsEntity.getConversation(d);case 6:if(p=m.sent,p){m.next=12;break}return he.deprecationWarning("The method getConversationBySid is deprecated to retrieve conversations you're not part of. Use peekConversationBySid instead."),m.next=11,this.peekConversationBySid(d);case 11:p=m.sent;case 12:if(p){m.next=14;break}throw new Error("Conversation with SID ".concat(d," was not found."));case 14:return m.abrupt("return",p);case 15:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"peekConversationBySid",value:function(){var _=W.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.peekConversation(d);case 4:if(p=m.sent,p){m.next=7;break}throw new Error("Conversation with SID ".concat(d," was not found."));case 7:return m.abrupt("return",p);case 8:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationByUniqueName",value:function(){var _=W.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return m.next=6,this._conversationsEntity.getConversationByUniqueName(d);case 6:if(p=m.sent,p){m.next=9;break}throw new Error("Conversation with unique name ".concat(d," was not found."));case 9:return m.abrupt("return",p);case 10:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getSubscribedConversations",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.abrupt("return",this._conversationsPromise.then(function(f){return f.getConversations()}));case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"createConversation",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return d=d||{},f.abrupt("return",this._conversationsPromise.then(function(m){return m.addConversation(d)}));case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"setPushRegistrationId",value:function(){var _=W.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(d),this._services.notificationClient.setPushRegistrationId(d,p),m.next=6,this._services.notificationClient.commitChanges();case 6:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"unsetPushRegistrationId",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(d),f.next=5,this._services.notificationClient.commitChanges();case 5:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"removePushRegistrations",value:function(){var _=W.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.notificationClient.removeRegistrations(d,p);case 2:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"handlePushNotification",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:vt._logger.debug("handlePushNotification, notificationPayload=",d),this.emit("pushNotification",vt.parsePushNotification(d));case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getUser",value:function(){var _=W.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return f.abrupt("return",this._services.users.getUser(d));case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getSubscribedUsers",value:function(){var _=W.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.abrupt("return",this._services.users.getSubscribedUsers());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getTemporaryContentUrlsForMediaSids",value:function(v){var g=this;return new Ae.CancellablePromise(function(){var d=W.default(N.default.mark(function p(f,m,y){var k,E;return N.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!(!g._services.mcsClient||!v)){j.next=3;break}return m(new Error("Media Content Service is unavailable")),j.abrupt("return");case 3:return k=g._services.mcsClient.mediaSetGetContentUrls(v),y(function(){k.cancel()}),j.prev=5,j.next=8,k;case 8:E=j.sent,f(E),j.next=15;break;case 12:j.prev=12,j.t0=j.catch(5),m(j.t0);case 15:case"end":return j.stop()}},p,null,[[5,12]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForMedia",value:function(v){var g=v.map(function(d){return d.sid});return this.getTemporaryContentUrlsForMediaSids(g)}},{key:"_initialize",value:function(){var _=W.default(N.default.mark(function g(){var d=this,p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return p=m.sent,this._configuration=new _e(this._options,p,vt._logger),this._myself._resolveInitialization(this._configuration,this._configuration.userIdentity,this._configuration.userInfo,!0),this._services.typingIndicator=new Do(this.getConversationBySid.bind(this),this._configuration,this._services),this._services.network=new He(this._configuration,this._services),this._services.users=new Fo(this._myself,this._configuration,this._services),this._services.users.on("userSubscribed",function(y){d.emit("userSubscribed",y)}),this._services.users.on("userUpdated",function(y){return d.emit("userUpdated",y)}),this._services.users.on("userUnsubscribed",function(y){d.emit("userUnsubscribed",y)}),this._conversationsEntity=new Lo(this._configuration,this._services),this._conversationsEntity.on("conversationAdded",function(y){d.emit("conversationAdded",y)}),this._conversationsEntity.on("conversationRemoved",function(y){d.emit("conversationRemoved",y)}),this._conversationsEntity.on("conversationJoined",function(y){d.emit("conversationJoined",y)}),this._conversationsEntity.on("conversationLeft",function(y){d.emit("conversationLeft",y)}),this._conversationsEntity.on("conversationUpdated",function(y){return d.emit("conversationUpdated",y)}),this._conversationsEntity.on("participantJoined",function(y){d.emit("participantJoined",y)}),this._conversationsEntity.on("participantLeft",function(y){d.emit("participantLeft",y)}),this._conversationsEntity.on("participantUpdated",function(y){return d.emit("participantUpdated",y)}),this._conversationsEntity.on("messageAdded",function(y){return d.emit("messageAdded",y)}),this._conversationsEntity.on("messageUpdated",function(y){return d.emit("messageUpdated",y)}),this._conversationsEntity.on("messageRemoved",function(y){return d.emit("messageRemoved",y)}),this._conversationsEntity.on("typingStarted",function(y){return d.emit("typingStarted",y)}),this._conversationsEntity.on("typingEnded",function(y){return d.emit("typingEnded",y)}),this._conversationsPromise=this._conversationsEntity.fetchConversations().then(function(){return d._conversationsEntity}).catch(function(y){throw y}),m.next=28,this._services.users.myself._ensureFetched();case 28:vt._supportedPushChannels.forEach(function(y){return d._subscribeToPushNotifications(y)}),this._services.typingIndicator.initialize(),this._services.mcsClient=new Ae.McsClient(this._fpaToken,this._configuration.links.mediaService,this._configuration.links.mediaSetService,Ua(Ua({},this._options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized"),this.emit("initialized");case 34:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_subscribeToPushNotifications",value:function(v){var g=this;[Le.NEW_MESSAGE,Le.ADDED_TO_CONVERSATION,Le.REMOVED_FROM_CONVERSATION,Le.TYPING_INDICATOR,Le.CONSUMPTION_UPDATE].forEach(function(d){g._services.notificationClient.subscribe(v,d)})}},{key:"_unsubscribeFromPushNotifications",value:function(v){var g=this;[Le.NEW_MESSAGE,Le.ADDED_TO_CONVERSATION,Le.REMOVED_FROM_CONVERSATION,Le.TYPING_INDICATOR,Le.CONSUMPTION_UPDATE].forEach(function(d){g._services.notificationClient.unsubscribe(v,d)})}}],[{key:"create",value:function(){var _=W.default(N.default.mark(function g(d,p){var f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(p!=null&&p.twilsockClient)){y.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return f=new vt(d,p),y.next=5,f._ensureReady;case 5:return y.abrupt("return",f);case 6:case"end":return y.stop()}},g)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"parsePushNotification",value:function(v){if(vt._logger.debug("parsePushNotification, notificationPayload=",v),typeof v.aps<"u"){if(!v.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var g=vt._parsePushNotificationChatData(v),d=v.aps,p,f=null;if(typeof d.alert=="string")p=d.alert||null;else{var m,y;p=((m=d.alert)===null||m===void 0?void 0:m.body)||null,f=((y=d.alert)===null||y===void 0?void 0:y.title)||null}return new Lr({title:f,body:p,sound:d.sound||null,badge:d.badge||null,action:d.category||null,type:v.twi_message_type,data:g})}if(typeof v.data<"u"){var k=v.data;if(!k.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var E=vt._parsePushNotificationChatData(v.data);return new Lr({title:k.twi_title||null,body:k.twi_body||null,sound:k.twi_sound||null,badge:null,action:k.twi_action||null,type:k.twi_message_type,data:E})}throw new Error("Provided push notification payload is not Programmable Chat notification")}},{key:"_parsePushNotificationChatData",value:function(v){var g={};for(var d in vt._supportedPushDataFields){var p=v[d];if(!(typeof p>"u"||p===null)){if(d==="message_index"||d==="media_count"){var f=ee(p);f!==null&&(g[vt._supportedPushDataFields[d]]=f);continue}if(d==="media"){if(typeof p=="string")try{g[vt._supportedPushDataFields[d]]=JSON.parse(p)}catch{vt._logger.debug("Media message notification parsing error")}continue}g[vt._supportedPushDataFields[d]]=p}}return g}},{key:"populateInitRegistrations",value:function(v){v.populateInitRegistrations([Le.TYPING_INDICATOR]),ue.SyncClient.populateInitRegistrations(v)}}]),S}($.ReplayEventEmitter),ie.default(yt,"conversationAdded","conversationAdded"),ie.default(yt,"conversationJoined","conversationJoined"),ie.default(yt,"conversationLeft","conversationLeft"),ie.default(yt,"conversationRemoved","conversationRemoved"),ie.default(yt,"conversationUpdated","conversationUpdated"),ie.default(yt,"participantJoined","participantJoined"),ie.default(yt,"participantLeft","participantLeft"),ie.default(yt,"participantUpdated","participantUpdated"),ie.default(yt,"messageAdded","messageAdded"),ie.default(yt,"messageRemoved","messageRemoved"),ie.default(yt,"messageUpdated","messageUpdated"),ie.default(yt,"tokenAboutToExpire","tokenAboutToExpire"),ie.default(yt,"tokenExpired","tokenExpired"),ie.default(yt,"typingEnded","typingEnded"),ie.default(yt,"typingStarted","typingStarted"),ie.default(yt,"pushNotification","pushNotification"),ie.default(yt,"userSubscribed","userSubscribed"),ie.default(yt,"userUnsubscribed","userUnsubscribed"),ie.default(yt,"userUpdated","userUpdated"),ie.default(yt,"stateChanged","stateChanged"),ie.default(yt,"initialized","initialized"),ie.default(yt,"initFailed","initFailed"),ie.default(yt,"connectionStateChanged","connectionStateChanged"),ie.default(yt,"connectionError","connectionError"),ie.default(yt,"version",ja),ie.default(yt,"_logger",Ke.scope("Client")),ie.default(yt,"_supportedPushChannels",["fcm","apn"]),ie.default(yt,"_supportedPushDataFields",{conversation_sid:"conversationSid",conversation_title:"conversationTitle",message_sid:"messageSid",message_index:"messageIndex",media_count:"mediaCount",media:"media"}),yt),B([he.deprecated("token"),T("design:type",String),T("design:paramtypes",[])],e.Client.prototype,"token",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"updateToken",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getConversationBySid",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"peekConversationBySid",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getConversationByUniqueName",null),B([b.validateTypesAsync(["undefined",b.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],e.Client.prototype,"createConversation",null),B([b.validateTypesAsync(b.literal("fcm","apn"),"string"),T("design:type",Function),T("design:paramtypes",[String,String]),T("design:returntype",Promise)],e.Client.prototype,"setPushRegistrationId",null),B([b.validateTypesAsync(b.literal("fcm","apn")),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"unsetPushRegistrationId",null),B([b.validateTypesAsync(b.literal("fcm","apn"),b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String,String]),T("design:returntype",Promise)],e.Client.prototype,"removePushRegistrations",null),B([b.validateTypesAsync(b.pureObject),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],e.Client.prototype,"handlePushNotification",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getUser",null),B([b.validateTypesAsync(b.nonEmptyArray("strings","string")),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Ae.CancellablePromise)],e.Client.prototype,"getTemporaryContentUrlsForMediaSids",null),B([b.validateTypesAsync(b.nonEmptyArray("media",Ve)),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Ae.CancellablePromise)],e.Client.prototype,"getTemporaryContentUrlsForMedia",null),B([he.deprecated("Client.create()","new Client()"),b.validateTypesAsync("string",["undefined",b.pureObject]),T("design:type",Function),T("design:paramtypes",[String,Object]),T("design:returntype",Promise)],e.Client,"create",null),B([b.validateTypes(b.pureObject),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Lr)],e.Client,"parsePushNotification",null),e.Client=vt=B([b.validateConstructorTypes(b.nonEmptyString,[b.pureObject,"undefined"]),T("design:paramtypes",[String,Object])],e.Client),Object.defineProperty(e,"CancellablePromise",{enumerable:!0,get:function(){return Ae.CancellablePromise}}),e.AggregatedDeliveryReceipt=it,e.Conversation=$t,e.DetailedDeliveryReceipt=We,e.Media=Ve,e.Message=nr,e.MessageBuilder=ms,e.NotificationTypes=Le,e.Participant=V,e.PushNotification=Lr,e.RestPaginator=rt,e.UnsentMessage=Nr,e.User=Ne})(t1);function zI(e){return e.replace("EndUser:","")}async function VI(e){try{let t=`/conversations/conversation-message-media-url?mediaSid=${e}`;const r=await fetch(t,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(r.ok)return(await r.json()).contentUrl}catch(t){console.log("getMediaUrl error => ",t)}}function KI(e,t,r,n,a,i){const s=qt(()=>Object.keys(r).length===0?!1:!!(r.mType!==void 0&&r.mType.startsWith("chatButton"))),o=qt(()=>!!(e!=null&&e.enduser!=null&&e.enduser||(t.startsWith("+")||t.startsWith("whatsapp"))&&!e.agent||r.mType!==void 0&&r.mType==="clientChat")),u=qt(()=>!!(e!=null&&e.chat!=null&&e.chat||r.mType!==void 0&&r.mType==="agentChat"||r.mType!==void 0&&r.mType==="clientChat")),l=qt(()=>t===n),c=qt(()=>e!=null&&e.agent!=null&&e.agent==!0||r.mType!==void 0&&r.agentMessage===!0),h=qt(()=>!!(e!=null&&e.sms!=null&&e.sms||t.startsWith("+"))),w=qt(()=>!!(e!=null&&e.whatsapp!=null&&e.whatsapp||t.startsWith("whatsapp"))),b=qt(()=>a===null&&i!==null);return{isChatButton:s,isCustomer:o,isChat:u,isBot:l,isAgent:c,isSms:h,isWhatsapp:w,isMedia:b}}const $Z={props:["author","content","dateCreated","cSid","participant","mSid","pSid","media","mAttributes"],setup(e,t){const r=cf(),n=e.author,a=e.content,i=e.media,s=e.dateCreated,o=e.cSid,u=e.mSid,l=e.pSid,c=e.mAttributes,h=e.participant,w=ht("/placeholder.png");let{isChatButton:b,isCustomer:$,isChat:A,isBot:x,isAgent:U,isSms:D,isWhatsapp:de,isMedia:ue}=KI(h,n,c,o,a,i);nf(async()=>{if(a===null&&i!==null){let we=null,he=bt(i);he[0]!==void 0?we=he[0].sid:he.state!==void 0&&(we=he.state.sid),we!=null&&(w.value=await VI(we))}});function Ae(we,he,P,Q){alert(`Optionally trigger action in web browser.

fn("${r.endUser.name}","${we}","${he}","${P}")`),t.emit("sendAnswer",{id:we,title:he,answer:P,person:r.endUser.name,style:Q})}return{author:n,content:a,dateCreated:s,participant:h,mSid:u,pSid:l,isMedia:ue,mAttributes:c,imageUrl:w,isChatButton:b,isSms:D,isChat:A,isCustomer:$,isBot:x,isWhatsapp:de,isAgent:U,formatDate:e1,formatAuthor:zI,answerQuestion:Ae}}},TZ={key:0,class:"bi-phone"},kZ={key:1,class:"bi-person-workspace"},EZ={key:2,class:"bi-phone"},IZ={key:3,class:"bi-robot"},CZ={key:4,class:"ms-2"},RZ={key:5},AZ=["src"],OZ={class:"mt-1"},PZ={class:"fst-italic"},MZ={key:1,class:"text-start mb-4"},xZ={key:0},NZ={class:"btn-group d-flex",role:"group","aria-label":"..."},LZ=["onClick"],jZ={key:1},UZ={class:"fst-italic"};function FZ(e,t,r,n,a,i){return et(),ct("div",null,[n.isChatButton?Xt("",!0):(et(),ct("div",{key:0,class:dn(["bg-warning text-start mb-2",{"text-start":n.isCustomer,"text-end":!n.isCustomer}])},[le("span",{class:dn(["fs-4 fw-bold badge text-wrap",{"text-start":n.isCustomer,"text-end":!n.isCustomer,"bg-light":n.isCustomer,"text-dark":n.isCustomer,"bg-success":n.isAgent,"bg-secondary":n.isBot}])},[n.isSms?(et(),ct("i",TZ)):Xt("",!0),n.isChat?(et(),ct("i",kZ)):Xt("",!0),n.isWhatsapp?(et(),ct("i",EZ)):Xt("",!0),n.isBot?(et(),ct("i",IZ)):Xt("",!0),n.isMedia?Xt("",!0):(et(),ct("span",CZ,Wt(n.content),1)),n.isMedia?(et(),ct("span",RZ,[le("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"ms-2 img-fluid rounded"},null,8,AZ)])):Xt("",!0)],2),le("p",OZ,[le("small",null,[le("span",PZ,Wt(n.author)+" - "+Wt(n.formatDate(n.dateCreated)),1)])])],2)),n.isChatButton?(et(),ct("div",MZ,[n.mAttributes.mType==="chatButton"?(et(),ct("div",xZ,[le("h5",null,Wt(n.mAttributes.question),1),le("div",NZ,[(et(!0),ct(dr,null,Cu(n.mAttributes.options,s=>(et(),ct("button",{onClick:o=>n.answerQuestion(n.mAttributes.id,n.mAttributes.question,s.value,s.style),key:s.value,class:dn(["btn border",[s.style]])},Wt(s.label),11,LZ))),128))])])):Xt("",!0),n.mAttributes.mType==="chatButtonResponse"?(et(),ct("div",jZ,[le("h5",null,[le("span",UZ,Wt(n.mAttributes.title),1),Ut(" "+Wt(n.mAttributes.person)+" replied: ",1),le("button",{disabled:"",class:dn(["btn",[n.mAttributes.style]])},Wt(n.mAttributes.answer),3)])])):Xt("",!0)])):Xt("",!0)])}const DZ=as($Z,[["render",FZ]]);function BZ(e){return new Date(e).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}const qZ={props:["author","content","dateCreated","cSid","participant","mSid","pSid","media","mAttributes"],setup(e,t){const r=cf(),n=e.author,a=e.content,i=e.media,s=e.dateCreated,o=e.cSid,u=e.mSid,l=e.pSid,c=e.mAttributes,h=e.participant,w=ht("/placeholder.png");let{isChatButton:b,isCustomer:$,isChat:A,isBot:x,isAgent:U,isSms:D,isWhatsapp:de,isMedia:ue}=KI(h,n,c,o,a,i);nf(async()=>{if(a===null&&i!==null){let he=null,P=bt(i);P[0]!==void 0?he=P[0].sid:P.state!==void 0&&(he=P.state.sid),he!=null&&(w.value=await VI(he))}});function Ae(he,P,Q,ce){alert(`Optionally trigger action in web browser.

fn("${r.endUser.name}","${he}","${P}","${Q}")`),t.emit("sendAnswer",{id:he,title:P,answer:Q,person:r.endUser.name,style:ce})}const we=qt(()=>h!==void 0&&h.avatar!==void 0&&h.avatar!==""?h.avatar:"https://picsum.photos/id/237/50");return{author:n,content:a,dateCreated:s,participant:h,mSid:u,pSid:l,isMedia:ue,mAttributes:c,imageUrl:w,isChatButton:b,isSms:D,isChat:A,isCustomer:$,isBot:x,isWhatsapp:de,isAgent:U,formatJustTime:BZ,formatAuthor:zI,answerQuestion:Ae,getAvatar:we}}},HZ={key:0,class:"mb-2 ms-4"},WZ={class:"table align-top"},GZ={class:"align-top",style:{width:"50px"}},zZ=["src"],VZ={class:"align-top pt-0"},KZ={class:"pt-0 pb-0 mb-1 lh-1"},JZ={class:"pt-0 fw-bold fs-4"},YZ={class:"pt-0 fs-5 ms-2"},QZ={key:0,class:"pt-0 lead"},XZ={key:1,class:"pt-0 lead"},ZZ=["src"],eee={key:1,class:"text-start ms-4 mb-4"},tee={key:0},ree={class:"btn-group d-flex",role:"group","aria-label":"..."},nee=["onClick"],aee={key:1},iee={class:"fst-italic"};function see(e,t,r,n,a,i){return et(),ct("div",null,[n.isChatButton?Xt("",!0):(et(),ct("div",HZ,[le("table",WZ,[le("tr",null,[le("td",GZ,[le("img",{src:n.getAvatar,class:"rounded p-0"},null,8,zZ)]),le("td",VZ,[le("p",KZ,[le("span",JZ,Wt(n.author),1),le("span",YZ,Wt(n.formatJustTime(n.dateCreated)),1)]),n.isMedia?Xt("",!0):(et(),ct("p",QZ,Wt(n.content),1)),n.isMedia?(et(),ct("p",XZ,[le("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"img-fluid rounded"},null,8,ZZ)])):Xt("",!0)])])])])),n.isChatButton?(et(),ct("div",eee,[n.mAttributes.mType==="chatButton"?(et(),ct("div",tee,[le("h5",null,Wt(n.mAttributes.question),1),le("div",ree,[(et(!0),ct(dr,null,Cu(n.mAttributes.options,s=>(et(),ct("button",{onClick:o=>n.answerQuestion(n.mAttributes.id,n.mAttributes.question,s.value,s.style),key:s.value,class:dn(["btn border",[s.style]])},Wt(s.label),11,nee))),128))])])):Xt("",!0),n.mAttributes.mType==="chatButtonResponse"?(et(),ct("div",aee,[le("h5",null,[le("span",iee,Wt(n.mAttributes.title),1),Ut(" "+Wt(n.mAttributes.person)+" replied: ",1),le("button",{disabled:"",class:dn(["btn",[n.mAttributes.style]])},Wt(n.mAttributes.answer),3)])])):Xt("",!0)])):Xt("",!0)])}const oee=as(qZ,[["render",see]]),uee={class:"container"},lee={class:"row row-height mt-2"},cee=le("div",{class:"col-1 pb-5"},"\xA0",-1),fee={class:"col-10 pb-5"},dee={class:"pb-0 mb-0 fs-4 fw-bold fst-italic"},pee={class:"pb-5"},vee={key:0},hee={class:"alert alert-danger"},yee=le("i",{class:"bi-plug"},null,-1),gee=Ut(" Connect"),mee=[yee,gee],bee=le("h5",{class:"alert-heading"},"Not Connected",-1),wee=Ut(" Trouble connecting? "),_ee=Ut("Refresh Token"),See=le("p",null,[le("b",null,"Your token has expired!")],-1),$ee=le("i",{class:"bi-recycle"},null,-1),Tee=Ut(" Refresh Token "),kee=[$ee,Tee],Eee={class:"spinner-border text-info mt-5",role:"status"},Iee=le("span",{class:"visually-hidden"},"Loading...",-1),Cee=[Iee],Ree={class:"alert alert-danger"},Aee=le("h2",{class:"alert-heading mb-3"},"This conversation has ended!",-1),Oee=le("h5",{class:"alert-heading mb-5"}," You can return to the home page to start a new Conversation. ",-1),Pee=le("i",{class:"bi-house"},null,-1),Mee=Ut(" Home "),xee={class:"input-group"},Nee=le("i",{class:"bi-lightning"},null,-1),Lee=Ut(" SEND"),jee=[Nee,Lee],Uee={class:"mt-1 text-end"},Fee=le("i",{class:"bi-image"},null,-1),Dee=Ut(" Send Image "),Bee=[Fee,Dee],qee={class:"mt-3"},Hee={class:"text-end"},Wee={key:0,class:"mt-2 ms-2 mb-2 fs-4 fw-bold text-end"},Gee=["src"],zee={key:1,class:"ms-2 mb-2 fs-4 fw-bold"},Vee=["src"],Kee={key:1,class:"bi-person-workspace"},Jee={key:2,ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},Yee={key:3,ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},Qee={class:"float-end"},Xee={__name:"Conversation",setup(e){const t=cf(),r=MO(),n=r.params.sid?r.params.sid:"Not Found",a=ht([]),i=ns({details:{}}),s=ht(!0),o=ht(!1),u=ht(!1),l=ht(!1),c=ht(!1),h=ht("");let w=null,b=null;ht(!0),ht(""),ht("");const $=ht(!1),A=async()=>{try{w=await new t1.Client(t.endUser.accessToken)}catch(ve){console.log("failed to connect to conversation => ",ve);return}if(w.connectionState==="denied"){x();return}w.on("initialized",async()=>{try{b=await w.getConversationBySid(n)}catch(ve){console.log("failed to getConversation => ",ve),o.value=!0,l.value=!0,t.logout();return}o.value=!0,b.on("messageAdded",ve=>{let te=he.value[ve.participantSid];te==null&&(te=JSON.parse(gv("bot","bot","Webhook"))),ve.participantAttributes=te,a.value.unshift(ve)}),b.on("messageRemoved",ve=>{console.log("Message Removed from conversation..."),Q()})}),w.on("tokenExpired",ve=>{console.log("Token Expired!"),o.value=!1,u.value=!0}),w.on("disconnected",ve=>{console.log("Conversations disconnected!"),o.value=!1,u.value=!0}),w.on("conversationRemoved",ve=>{console.log("Conversations removed!"),l.value=!0,t.logout()}),await Q()},x=async()=>{console.log("in refreshToken..."),c.value=!0;try{await t.getToken(),await A(),c.value=!1}catch(ve){console.log("failed to refresh token => ",ve)}},U=async()=>{let ve=h.value;h.value="...";let te={mType:"clientChat",author:t.endUser.name};await b.prepareMessage().setBody(ve).setAttributes(te).build().send(),h.value="",console.log("Sent Message...")},D=ht(!1),de=ht(null),ue=async()=>{let ve={mType:"clientChat",author:t.endUser.name};const te={contentType:de.value.files[0].type,filename:de.value.files[0].name,media:de.value.files[0]};await b.prepareMessage().setAttributes(ve).addMedia(te).build().send(),D.value=!1,de.value=ht(null)},Ae=async()=>{try{let ve=`/conversations/conversation-details?sid=${n}`;const te=await fetch(ve,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(te.ok){let ae=await te.json();i.details=ae,typeof JSON.parse(i.details.attributes)=="object"?i.details.attributes=JSON.parse(i.details.attributes):i.details.attributes=JSON.parse(JSON.parse(i.details.attributes)),i.details.attributes.conversationType==="ChatChannel"&&($.value=!0)}}catch(ve){console.log("getConversationDetails error => ",ve)}},we=ht([]),he=ht({}),P=async()=>{try{let ve=`/conversations/conversation-participants?sid=${n}`;const te=await fetch(ve,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(te.ok){let ae=await te.json();we.value=ae;for(let J=0;J<we.value.length;J++)typeof JSON.parse(we.value[J].attributes)=="object"?we.value[J].attributes=JSON.parse(we.value[J].attributes):we.value[J].attributes=JSON.parse(JSON.parse(we.value[J].attributes)),he.value[we.value[J].sid]=we.value[J].attributes}}catch(ve){console.log("getConversationParticipants error => ",ve)}},Q=async()=>{try{let ve=`/conversations/conversation-messages?sid=${n}`;const te=await fetch(ve,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(te.ok){let ae=await te.json();a.value=ae.reverse();for(let J=0;J<a.value.length;J++){Object.keys(a.value[J].attributes).length===0?a.value[J].attributes={attributes:"none"}:a.value[J].attributes=JSON.parse(a.value[J].attributes);let ie=he.value[a.value[J].participantSid];ie==null&&(ie=JSON.parse(gv("bot","bot","Webhook"))),a.value[J].participantAttributes=ie}}}catch(ve){console.log("getConversationMessages error => ",ve)}},ce=async ve=>{try{let te={mType:"chatButtonResponse",id:ve.id,title:ve.title,answer:ve.answer,person:ve.person,style:ve.style};await b.prepareMessage().setBody("<Chat Button Response>").setAttributes(te).build().send()}catch(te){o.value=!1,console.log("Chat Button Response Error => ",te)}},W=async()=>{await Ae(),await P(),await Q()};return v$(async()=>{await W(),await A()}),(ve,te)=>{const ae=ui("router-link");return et(),ct("div",uee,[le("div",lee,[cee,le("div",fee,[le("p",dee,Wt(i.details.friendlyName),1),le("div",pee,[s.value?(et(),ct("div",vee,[kt(le("div",hee,[kt(le("button",{type:"button",class:"btn btn-sm btn-danger float-end",onClick:te[0]||(te[0]=J=>A())},mee,512),[[xt,!u.value]]),bee,kt(le("p",null,"Connecting automatically...",512),[[xt,!u.value]]),kt(le("p",null,[wee,Vt(ae,{to:"/"},{default:oi(()=>[_ee]),_:1})],512),[[xt,!u.value]]),kt(le("div",null,[See,kt(le("button",{class:"btn btn-lg btn-danger",onClick:te[1]||(te[1]=J=>x())},kee,512),[[xt,!c.value]]),kt(le("div",Eee,Cee,512),[[xt,c.value]])],512),[[xt,u.value]])],512),[[xt,!o.value]]),kt(le("div",Ree,[Aee,Oee,Vt(ae,{class:"btn btn-primary",to:"/"},{default:oi(()=>[Pee,Mee]),_:1})],512),[[xt,o.value&&l.value]]),o.value&&!l.value?(et(),ct("div",{key:0,class:dn(["alert",{"alert-warning":$.value,"alert-primary":!$.value}])},[le("form",{onSubmit:te[5]||(te[5]=yA((...J)=>ve.submitForm&&ve.submitForm(...J),["prevent"]))},[le("div",xee,[kt(le("input",{onKeyup:te[2]||(te[2]=mA(J=>U(),["enter"])),type:"text",class:"form-control","onUpdate:modelValue":te[3]||(te[3]=J=>h.value=J),"aria-describedby":"btnGroupAddon"},null,544),[[P$,h.value]]),le("button",{type:"button",class:"btn btn-primary",onClick:te[4]||(te[4]=J=>U())},jee)])],32),kt(le("div",Uee,[le("button",{onClick:te[6]||(te[6]=J=>D.value=!0),class:"btn btn-sm btn-link"},Bee)],512),[[xt,!D.value]]),kt(le("div",qee,[le("input",{ref_key:"file",ref:de,onChange:te[7]||(te[7]=J=>ue()),class:"form-control form-control-sm",id:"formFileSm",type:"file"},null,544)],512),[[xt,D.value]]),kt(le("div",Hee,[le("button",{onClick:te[8]||(te[8]=J=>D.value=!1),class:"btn btn-sm btn-link"}," Cancel ")],512),[[xt,D.value]])],2)):Xt("",!0)])):Xt("",!0),le("div",{class:dn(["border rounded",{"bg-light":$.value,"bg-warning":!$.value}]),style:{"min-height":"200px"}},[$.value?(et(),ct("p",Wee,[Ut(Wt(St(t).endUser.name)+" ",1),le("img",{src:St(t).endUser.avatar,class:"rounded me-2"},null,8,Gee)])):(et(),ct("p",zee,[$.value?(et(),ct("img",{key:0,src:St(t).endUser.avatar,class:"rounded float-start me-2"},null,8,Vee)):(et(),ct("i",Kee)),Ut(" "+Wt(St(t).endUser.name),1)])),$.value?Xt("",!0):(et(),ct("div",Jee,[(et(!0),ct(dr,null,Cu(a.value,J=>(et(),Xi(DZ,{onSendAnswer:te[9]||(te[9]=ie=>ce(ie)),participant:J.participantAttributes,mAttributes:J.attributes,key:J.sid,mSid:J.sid,pSid:J.participantSid,dateCreated:J.dateCreated,author:J.author,content:J.body,media:J.media,cSid:i.details.sid},null,8,["participant","mAttributes","mSid","pSid","dateCreated","author","content","media","cSid"]))),128))],512)),$.value?(et(),ct("div",Yee,[(et(!0),ct(dr,null,Cu(a.value,J=>(et(),Xi(oee,{onSendAnswer:te[10]||(te[10]=ie=>ce(ie)),participant:J.participantAttributes,mAttributes:J.attributes,key:J.sid,mSid:J.sid,pSid:J.participantSid,dateCreated:J.dateCreated,author:J.author,content:J.body,media:J.media,cSid:i.details.sid},null,8,["participant","mAttributes","mSid","pSid","dateCreated","author","content","media","cSid"]))),128))],512)):Xt("",!0)],2),le("p",Qee,[le("em",null,Wt(i.details.sid),1)])])])])])}}},Zee={name:"App",components:{Layout:J$,Conversation:Xee}};function ete(e,t,r,n,a,i){const s=ui("Conversation"),o=ui("Layout");return et(),Xi(o,null,{default:oi(()=>[Vt(s)]),_:1})}const tte=as(Zee,[["render",ete]]),rte=AO({history:KA(),routes:[{path:"/",name:"home",component:JM},{name:"conversation",path:"/conversation/:sid",component:tte}]}),Pg=_A(xO);Pg.use(TA());Pg.use(rte);Pg.mount("#app");
